(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var zW=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sL(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var my={exports:{}},If={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F_;function oL(){if(F_)return If;F_=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,o){var l=null;if(o!==void 0&&(l=""+o),s.key!==void 0&&(l=""+s.key),"key"in s){o={};for(var c in s)c!=="key"&&(o[c]=s[c])}else o=s;return s=o.ref,{$$typeof:n,type:i,key:l,ref:s!==void 0?s:null,props:o}}return If.Fragment=e,If.jsx=t,If.jsxs=t,If}var $_;function rL(){return $_||($_=1,my.exports=oL()),my.exports}var u=rL(),py={exports:{}},qn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B_;function aL(){if(B_)return qn;B_=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function _(W){return W===null||typeof W!="object"?null:(W=v&&W[v]||W["@@iterator"],typeof W=="function"?W:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,C={};function A(W,te,j){this.props=W,this.context=te,this.refs=C,this.updater=j||b}A.prototype.isReactComponent={},A.prototype.setState=function(W,te){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,te,"setState")},A.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function I(){}I.prototype=A.prototype;function ee(W,te,j){this.props=W,this.context=te,this.refs=C,this.updater=j||b}var G=ee.prototype=new I;G.constructor=ee,T(G,A.prototype),G.isPureReactComponent=!0;var K=Array.isArray,de={H:null,A:null,T:null,S:null,V:null},le=Object.prototype.hasOwnProperty;function z(W,te,j,U,$,X){return j=X.ref,{$$typeof:n,type:W,key:te,ref:j!==void 0?j:null,props:X}}function R(W,te){return z(W.type,te,void 0,void 0,void 0,W.props)}function D(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function F(W){var te={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(j){return te[j]})}var E=/\/+/g;function O(W,te){return typeof W=="object"&&W!==null&&W.key!=null?F(""+W.key):te.toString(36)}function M(){}function Y(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(M,M):(W.status="pending",W.then(function(te){W.status==="pending"&&(W.status="fulfilled",W.value=te)},function(te){W.status==="pending"&&(W.status="rejected",W.reason=te)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function ie(W,te,j,U,$){var X=typeof W;(X==="undefined"||X==="boolean")&&(W=null);var Q=!1;if(W===null)Q=!0;else switch(X){case"bigint":case"string":case"number":Q=!0;break;case"object":switch(W.$$typeof){case n:case e:Q=!0;break;case p:return Q=W._init,ie(Q(W._payload),te,j,U,$)}}if(Q)return $=$(W),Q=U===""?"."+O(W,0):U,K($)?(j="",Q!=null&&(j=Q.replace(E,"$&/")+"/"),ie($,te,j,"",function(De){return De})):$!=null&&(D($)&&($=R($,j+($.key==null||W&&W.key===$.key?"":(""+$.key).replace(E,"$&/")+"/")+Q)),te.push($)),1;Q=0;var ye=U===""?".":U+":";if(K(W))for(var Ae=0;Ae<W.length;Ae++)U=W[Ae],X=ye+O(U,Ae),Q+=ie(U,te,j,X,$);else if(Ae=_(W),typeof Ae=="function")for(W=Ae.call(W),Ae=0;!(U=W.next()).done;)U=U.value,X=ye+O(U,Ae++),Q+=ie(U,te,j,X,$);else if(X==="object"){if(typeof W.then=="function")return ie(Y(W),te,j,U,$);throw te=String(W),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Q}function q(W,te,j){if(W==null)return W;var U=[],$=0;return ie(W,U,"","",function(X){return te.call(j,X,$++)}),U}function re(W){if(W._status===-1){var te=W._result;te=te(),te.then(function(j){(W._status===0||W._status===-1)&&(W._status=1,W._result=j)},function(j){(W._status===0||W._status===-1)&&(W._status=2,W._result=j)}),W._status===-1&&(W._status=0,W._result=te)}if(W._status===1)return W._result.default;throw W._result}var V=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)};function se(){}return qn.Children={map:q,forEach:function(W,te,j){q(W,function(){te.apply(this,arguments)},j)},count:function(W){var te=0;return q(W,function(){te++}),te},toArray:function(W){return q(W,function(te){return te})||[]},only:function(W){if(!D(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},qn.Component=A,qn.Fragment=t,qn.Profiler=s,qn.PureComponent=ee,qn.StrictMode=i,qn.Suspense=d,qn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=de,qn.__COMPILER_RUNTIME={__proto__:null,c:function(W){return de.H.useMemoCache(W)}},qn.cache=function(W){return function(){return W.apply(null,arguments)}},qn.cloneElement=function(W,te,j){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var U=T({},W.props),$=W.key,X=void 0;if(te!=null)for(Q in te.ref!==void 0&&(X=void 0),te.key!==void 0&&($=""+te.key),te)!le.call(te,Q)||Q==="key"||Q==="__self"||Q==="__source"||Q==="ref"&&te.ref===void 0||(U[Q]=te[Q]);var Q=arguments.length-2;if(Q===1)U.children=j;else if(1<Q){for(var ye=Array(Q),Ae=0;Ae<Q;Ae++)ye[Ae]=arguments[Ae+2];U.children=ye}return z(W.type,$,void 0,void 0,X,U)},qn.createContext=function(W){return W={$$typeof:l,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:o,_context:W},W},qn.createElement=function(W,te,j){var U,$={},X=null;if(te!=null)for(U in te.key!==void 0&&(X=""+te.key),te)le.call(te,U)&&U!=="key"&&U!=="__self"&&U!=="__source"&&($[U]=te[U]);var Q=arguments.length-2;if(Q===1)$.children=j;else if(1<Q){for(var ye=Array(Q),Ae=0;Ae<Q;Ae++)ye[Ae]=arguments[Ae+2];$.children=ye}if(W&&W.defaultProps)for(U in Q=W.defaultProps,Q)$[U]===void 0&&($[U]=Q[U]);return z(W,X,void 0,void 0,null,$)},qn.createRef=function(){return{current:null}},qn.forwardRef=function(W){return{$$typeof:c,render:W}},qn.isValidElement=D,qn.lazy=function(W){return{$$typeof:p,_payload:{_status:-1,_result:W},_init:re}},qn.memo=function(W,te){return{$$typeof:f,type:W,compare:te===void 0?null:te}},qn.startTransition=function(W){var te=de.T,j={};de.T=j;try{var U=W(),$=de.S;$!==null&&$(j,U),typeof U=="object"&&U!==null&&typeof U.then=="function"&&U.then(se,V)}catch(X){V(X)}finally{de.T=te}},qn.unstable_useCacheRefresh=function(){return de.H.useCacheRefresh()},qn.use=function(W){return de.H.use(W)},qn.useActionState=function(W,te,j){return de.H.useActionState(W,te,j)},qn.useCallback=function(W,te){return de.H.useCallback(W,te)},qn.useContext=function(W){return de.H.useContext(W)},qn.useDebugValue=function(){},qn.useDeferredValue=function(W,te){return de.H.useDeferredValue(W,te)},qn.useEffect=function(W,te,j){var U=de.H;if(typeof j=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return U.useEffect(W,te)},qn.useId=function(){return de.H.useId()},qn.useImperativeHandle=function(W,te,j){return de.H.useImperativeHandle(W,te,j)},qn.useInsertionEffect=function(W,te){return de.H.useInsertionEffect(W,te)},qn.useLayoutEffect=function(W,te){return de.H.useLayoutEffect(W,te)},qn.useMemo=function(W,te){return de.H.useMemo(W,te)},qn.useOptimistic=function(W,te){return de.H.useOptimistic(W,te)},qn.useReducer=function(W,te,j){return de.H.useReducer(W,te,j)},qn.useRef=function(W){return de.H.useRef(W)},qn.useState=function(W){return de.H.useState(W)},qn.useSyncExternalStore=function(W,te,j){return de.H.useSyncExternalStore(W,te,j)},qn.useTransition=function(){return de.H.useTransition()},qn.version="19.1.1",qn}var W_;function pv(){return W_||(W_=1,py.exports=aL()),py.exports}var me=pv();const w4=sL(me);var gy={exports:{}},Pf={},yy={exports:{}},vy={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z_;function lL(){return z_||(z_=1,(function(n){function e(q,re){var V=q.length;q.push(re);e:for(;0<V;){var se=V-1>>>1,W=q[se];if(0<s(W,re))q[se]=re,q[V]=W,V=se;else break e}}function t(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var re=q[0],V=q.pop();if(V!==re){q[0]=V;e:for(var se=0,W=q.length,te=W>>>1;se<te;){var j=2*(se+1)-1,U=q[j],$=j+1,X=q[$];if(0>s(U,V))$<W&&0>s(X,U)?(q[se]=X,q[$]=V,se=$):(q[se]=U,q[j]=V,se=j);else if($<W&&0>s(X,V))q[se]=X,q[$]=V,se=$;else break e}}return re}function s(q,re){var V=q.sortIndex-re.sortIndex;return V!==0?V:q.id-re.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var d=[],f=[],p=1,v=null,_=3,b=!1,T=!1,C=!1,A=!1,I=typeof setTimeout=="function"?setTimeout:null,ee=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;function K(q){for(var re=t(f);re!==null;){if(re.callback===null)i(f);else if(re.startTime<=q)i(f),re.sortIndex=re.expirationTime,e(d,re);else break;re=t(f)}}function de(q){if(C=!1,K(q),!T)if(t(d)!==null)T=!0,le||(le=!0,O());else{var re=t(f);re!==null&&ie(de,re.startTime-q)}}var le=!1,z=-1,R=5,D=-1;function F(){return A?!0:!(n.unstable_now()-D<R)}function E(){if(A=!1,le){var q=n.unstable_now();D=q;var re=!0;try{e:{T=!1,C&&(C=!1,ee(z),z=-1),b=!0;var V=_;try{t:{for(K(q),v=t(d);v!==null&&!(v.expirationTime>q&&F());){var se=v.callback;if(typeof se=="function"){v.callback=null,_=v.priorityLevel;var W=se(v.expirationTime<=q);if(q=n.unstable_now(),typeof W=="function"){v.callback=W,K(q),re=!0;break t}v===t(d)&&i(d),K(q)}else i(d);v=t(d)}if(v!==null)re=!0;else{var te=t(f);te!==null&&ie(de,te.startTime-q),re=!1}}break e}finally{v=null,_=V,b=!1}re=void 0}}finally{re?O():le=!1}}}var O;if(typeof G=="function")O=function(){G(E)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,Y=M.port2;M.port1.onmessage=E,O=function(){Y.postMessage(null)}}else O=function(){I(E,0)};function ie(q,re){z=I(function(){q(n.unstable_now())},re)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_next=function(q){switch(_){case 1:case 2:case 3:var re=3;break;default:re=_}var V=_;_=re;try{return q()}finally{_=V}},n.unstable_requestPaint=function(){A=!0},n.unstable_runWithPriority=function(q,re){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var V=_;_=q;try{return re()}finally{_=V}},n.unstable_scheduleCallback=function(q,re,V){var se=n.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?se+V:se):V=se,q){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=V+W,q={id:p++,callback:re,priorityLevel:q,startTime:V,expirationTime:W,sortIndex:-1},V>se?(q.sortIndex=V,e(f,q),t(d)===null&&q===t(f)&&(C?(ee(z),z=-1):C=!0,ie(de,V-se))):(q.sortIndex=W,e(d,q),T||b||(T=!0,le||(le=!0,O()))),q},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(q){var re=_;return function(){var V=_;_=re;try{return q.apply(this,arguments)}finally{_=V}}}})(vy)),vy}var H_;function cL(){return H_||(H_=1,yy.exports=lL()),yy.exports}var by={exports:{}},Wo={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q_;function uL(){if(q_)return Wo;q_=1;var n=pv();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(d,f,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:d,containerInfo:f,implementation:p}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Wo.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Wo.createPortal=function(d,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return o(d,f,null,p)},Wo.flushSync=function(d){var f=l.T,p=i.p;try{if(l.T=null,i.p=2,d)return d()}finally{l.T=f,i.p=p,i.d.f()}},Wo.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},Wo.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Wo.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var p=f.as,v=c(p,f.crossOrigin),_=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:b}):p==="script"&&i.d.X(d,{crossOrigin:v,integrity:_,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Wo.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=c(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},Wo.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,v=c(p,f.crossOrigin);i.d.L(d,p,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Wo.preloadModule=function(d,f){if(typeof d=="string")if(f){var p=c(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},Wo.requestFormReset=function(d){i.d.r(d)},Wo.unstable_batchedUpdates=function(d,f){return d(f)},Wo.useFormState=function(d,f,p){return l.H.useFormState(d,f,p)},Wo.useFormStatus=function(){return l.H.useHostTransitionStatus()},Wo.version="19.1.1",Wo}var V_;function dL(){if(V_)return by.exports;V_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),by.exports=uL(),by.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y_;function hL(){if(Y_)return Pf;Y_=1;var n=cL(),e=pv(),t=dL();function i(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,h=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(h=a.return),r=a.return;while(r)}return a.tag===3?h:null}function l(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function c(r){if(o(r)!==r)throw Error(i(188))}function d(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(i(188));return a!==r?null:r}for(var h=r,m=a;;){var w=h.return;if(w===null)break;var S=w.alternate;if(S===null){if(m=w.return,m!==null){h=m;continue}break}if(w.child===S.child){for(S=w.child;S;){if(S===h)return c(w),r;if(S===m)return c(w),a;S=S.sibling}throw Error(i(188))}if(h.return!==m.return)h=w,m=S;else{for(var H=!1,ae=w.child;ae;){if(ae===h){H=!0,h=w,m=S;break}if(ae===m){H=!0,m=w,h=S;break}ae=ae.sibling}if(!H){for(ae=S.child;ae;){if(ae===h){H=!0,h=S,m=w;break}if(ae===m){H=!0,m=S,h=w;break}ae=ae.sibling}if(!H)throw Error(i(189))}}if(h.alternate!==m)throw Error(i(190))}if(h.tag!==3)throw Error(i(188));return h.stateNode.current===h?r:a}function f(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=f(r),a!==null)return a;r=r.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),ee=Symbol.for("react.consumer"),G=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),de=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),E=Symbol.iterator;function O(r){return r===null||typeof r!="object"?null:(r=E&&r[E]||r["@@iterator"],typeof r=="function"?r:null)}var M=Symbol.for("react.client.reference");function Y(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===M?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case T:return"Fragment";case A:return"Profiler";case C:return"StrictMode";case de:return"Suspense";case le:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case b:return"Portal";case G:return(r.displayName||"Context")+".Provider";case ee:return(r._context.displayName||"Context")+".Consumer";case K:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case z:return a=r.displayName||null,a!==null?a:Y(r.type)||"Memo";case R:a=r._payload,r=r._init;try{return Y(r(a))}catch{}}return null}var ie=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},se=[],W=-1;function te(r){return{current:r}}function j(r){0>W||(r.current=se[W],se[W]=null,W--)}function U(r,a){W++,se[W]=r.current,r.current=a}var $=te(null),X=te(null),Q=te(null),ye=te(null);function Ae(r,a){switch(U(Q,a),U(X,r),U($,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?f_(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=f_(a),r=m_(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}j($),U($,r)}function De(){j($),j(X),j(Q)}function Be(r){r.memoizedState!==null&&U(ye,r);var a=$.current,h=m_(a,r.type);a!==h&&(U(X,r),U($,h))}function Fe(r){X.current===r&&(j($),j(X)),ye.current===r&&(j(ye),Df._currentValue=V)}var Ct=Object.prototype.hasOwnProperty,at=n.unstable_scheduleCallback,Ce=n.unstable_cancelCallback,ce=n.unstable_shouldYield,_t=n.unstable_requestPaint,Ne=n.unstable_now,Ve=n.unstable_getCurrentPriorityLevel,We=n.unstable_ImmediatePriority,tt=n.unstable_UserBlockingPriority,lt=n.unstable_NormalPriority,$e=n.unstable_LowPriority,pe=n.unstable_IdlePriority,be=n.log,Se=n.unstable_setDisableYieldValue,Ee=null,Ye=null;function qe(r){if(typeof be=="function"&&Se(r),Ye&&typeof Ye.setStrictMode=="function")try{Ye.setStrictMode(Ee,r)}catch{}}var Ue=Math.clz32?Math.clz32:qt,Xe=Math.log,bt=Math.LN2;function qt(r){return r>>>=0,r===0?32:31-(Xe(r)/bt|0)|0}var fe=256,Ze=4194304;function Je(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function mt(r,a,h){var m=r.pendingLanes;if(m===0)return 0;var w=0,S=r.suspendedLanes,H=r.pingedLanes;r=r.warmLanes;var ae=m&134217727;return ae!==0?(m=ae&~S,m!==0?w=Je(m):(H&=ae,H!==0?w=Je(H):h||(h=ae&~r,h!==0&&(w=Je(h))))):(ae=m&~S,ae!==0?w=Je(ae):H!==0?w=Je(H):h||(h=m&~r,h!==0&&(w=Je(h)))),w===0?0:a!==0&&a!==w&&(a&S)===0&&(S=w&-w,h=a&-a,S>=h||S===32&&(h&4194048)!==0)?a:w}function Tt(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function It(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gt(){var r=fe;return fe<<=1,(fe&4194048)===0&&(fe=256),r}function tn(){var r=Ze;return Ze<<=1,(Ze&62914560)===0&&(Ze=4194304),r}function Zt(r){for(var a=[],h=0;31>h;h++)a.push(r);return a}function Dt(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Ut(r,a,h,m,w,S){var H=r.pendingLanes;r.pendingLanes=h,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=h,r.entangledLanes&=h,r.errorRecoveryDisabledLanes&=h,r.shellSuspendCounter=0;var ae=r.entanglements,Oe=r.expirationTimes,ft=r.hiddenUpdates;for(h=H&~h;0<h;){var Rt=31-Ue(h),Bt=1<<Rt;ae[Rt]=0,Oe[Rt]=-1;var vt=ft[Rt];if(vt!==null)for(ft[Rt]=null,Rt=0;Rt<vt.length;Rt++){var wt=vt[Rt];wt!==null&&(wt.lane&=-536870913)}h&=~Bt}m!==0&&Qt(r,m,0),S!==0&&w===0&&r.tag!==0&&(r.suspendedLanes|=S&~(H&~a))}function Qt(r,a,h){r.pendingLanes|=a,r.suspendedLanes&=~a;var m=31-Ue(a);r.entangledLanes|=a,r.entanglements[m]=r.entanglements[m]|1073741824|h&4194090}function an(r,a){var h=r.entangledLanes|=a;for(r=r.entanglements;h;){var m=31-Ue(h),w=1<<m;w&a|r[m]&a&&(r[m]|=a),h&=~w}}function on(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function dn(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Sn(){var r=re.p;return r!==0?r:(r=window.event,r===void 0?32:j_(r.type))}function Te(r,a){var h=re.p;try{return re.p=r,a()}finally{re.p=h}}var Qe=Math.random().toString(36).slice(2),dt="__reactFiber$"+Qe,ve="__reactProps$"+Qe,He="__reactContainer$"+Qe,Le="__reactEvents$"+Qe,Re="__reactListeners$"+Qe,Pe="__reactHandles$"+Qe,At="__reactResources$"+Qe,rt="__reactMarker$"+Qe;function Nt(r){delete r[dt],delete r[ve],delete r[Le],delete r[Re],delete r[Pe]}function xt(r){var a=r[dt];if(a)return a;for(var h=r.parentNode;h;){if(a=h[He]||h[dt]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(r=v_(r);r!==null;){if(h=r[dt])return h;r=v_(r)}return a}r=h,h=r.parentNode}return null}function st(r){if(r=r[dt]||r[He]){var a=r.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return r}return null}function St(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(i(33))}function yt(r){var a=r[At];return a||(a=r[At]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function ke(r){r[rt]=!0}var pt=new Set,Lt={};function Yt(r,a){Vt(r,a),Vt(r+"Capture",a)}function Vt(r,a){for(Lt[r]=a,r=0;r<a.length;r++)pt.add(a[r])}var nn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yn={},en={};function wn(r){return Ct.call(en,r)?!0:Ct.call(yn,r)?!1:nn.test(r)?en[r]=!0:(yn[r]=!0,!1)}function In(r,a,h){if(wn(a))if(h===null)r.removeAttribute(a);else{switch(typeof h){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var m=a.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+h)}}function Tn(r,a,h){if(h===null)r.removeAttribute(a);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+h)}}function Vn(r,a,h,m){if(m===null)r.removeAttribute(h);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(h);return}r.setAttributeNS(a,h,""+m)}}var Ei,ts;function fs(r){if(Ei===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);Ei=a&&a[1]||"",ts=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ei+r+ts}var Mo=!1;function Lr(r,a){if(!r||Mo)return"";Mo=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(a){var Bt=function(){throw Error()};if(Object.defineProperty(Bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Bt,[])}catch(wt){var vt=wt}Reflect.construct(r,[],Bt)}else{try{Bt.call()}catch(wt){vt=wt}r.call(Bt.prototype)}}else{try{throw Error()}catch(wt){vt=wt}(Bt=r())&&typeof Bt.catch=="function"&&Bt.catch(function(){})}}catch(wt){if(wt&&vt&&typeof wt.stack=="string")return[wt.stack,vt.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=m.DetermineComponentFrameRoot(),H=S[0],ae=S[1];if(H&&ae){var Oe=H.split(`
`),ft=ae.split(`
`);for(w=m=0;m<Oe.length&&!Oe[m].includes("DetermineComponentFrameRoot");)m++;for(;w<ft.length&&!ft[w].includes("DetermineComponentFrameRoot");)w++;if(m===Oe.length||w===ft.length)for(m=Oe.length-1,w=ft.length-1;1<=m&&0<=w&&Oe[m]!==ft[w];)w--;for(;1<=m&&0<=w;m--,w--)if(Oe[m]!==ft[w]){if(m!==1||w!==1)do if(m--,w--,0>w||Oe[m]!==ft[w]){var Rt=`
`+Oe[m].replace(" at new "," at ");return r.displayName&&Rt.includes("<anonymous>")&&(Rt=Rt.replace("<anonymous>",r.displayName)),Rt}while(1<=m&&0<=w);break}}}finally{Mo=!1,Error.prepareStackTrace=h}return(h=r?r.displayName||r.name:"")?fs(h):""}function Ar(r){switch(r.tag){case 26:case 27:case 5:return fs(r.type);case 16:return fs("Lazy");case 13:return fs("Suspense");case 19:return fs("SuspenseList");case 0:case 15:return Lr(r.type,!1);case 11:return Lr(r.type.render,!1);case 1:return Lr(r.type,!0);case 31:return fs("Activity");default:return""}}function Vs(r){try{var a="";do a+=Ar(r),r=r.return;while(r);return a}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function Yn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ai(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function tl(r){var a=ai(r)?"checked":"value",h=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),m=""+r[a];if(!r.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var w=h.get,S=h.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return w.call(this)},set:function(H){m=""+H,S.call(this,H)}}),Object.defineProperty(r,a,{enumerable:h.enumerable}),{getValue:function(){return m},setValue:function(H){m=""+H},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function no(r){r._valueTracker||(r._valueTracker=tl(r))}function Ro(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var h=a.getValue(),m="";return r&&(m=ai(r)?r.checked?"true":"false":r.value),r=m,r!==h?(a.setValue(r),!0):!1}function ns(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var dr=/[\n"\\]/g;function $n(r){return r.replace(dr,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function ks(r,a,h,m,w,S,H,ae){r.name="",H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?r.type=H:r.removeAttribute("type"),a!=null?H==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+Yn(a)):r.value!==""+Yn(a)&&(r.value=""+Yn(a)):H!=="submit"&&H!=="reset"||r.removeAttribute("value"),a!=null?Or(r,H,Yn(a)):h!=null?Or(r,H,Yn(h)):m!=null&&r.removeAttribute("value"),w==null&&S!=null&&(r.defaultChecked=!!S),w!=null&&(r.checked=w&&typeof w!="function"&&typeof w!="symbol"),ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"?r.name=""+Yn(ae):r.removeAttribute("name")}function Dr(r,a,h,m,w,S,H,ae){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.type=S),a!=null||h!=null){if(!(S!=="submit"&&S!=="reset"||a!=null))return;h=h!=null?""+Yn(h):"",a=a!=null?""+Yn(a):h,ae||a===r.value||(r.value=a),r.defaultValue=a}m=m??w,m=typeof m!="function"&&typeof m!="symbol"&&!!m,r.checked=ae?r.checked:!!m,r.defaultChecked=!!m,H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"&&(r.name=H)}function Or(r,a,h){a==="number"&&ns(r.ownerDocument)===r||r.defaultValue===""+h||(r.defaultValue=""+h)}function Qo(r,a,h,m){if(r=r.options,a){a={};for(var w=0;w<h.length;w++)a["$"+h[w]]=!0;for(h=0;h<r.length;h++)w=a.hasOwnProperty("$"+r[h].value),r[h].selected!==w&&(r[h].selected=w),w&&m&&(r[h].defaultSelected=!0)}else{for(h=""+Yn(h),a=null,w=0;w<r.length;w++){if(r[w].value===h){r[w].selected=!0,m&&(r[w].defaultSelected=!0);return}a!==null||r[w].disabled||(a=r[w])}a!==null&&(a.selected=!0)}}function zn(r,a,h){if(a!=null&&(a=""+Yn(a),a!==r.value&&(r.value=a),h==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=h!=null?""+Yn(h):""}function hr(r,a,h,m){if(a==null){if(m!=null){if(h!=null)throw Error(i(92));if(ie(m)){if(1<m.length)throw Error(i(93));m=m[0]}h=m}h==null&&(h=""),a=h}h=Yn(a),r.defaultValue=h,m=r.textContent,m===h&&m!==""&&m!==null&&(r.value=m)}function io(r,a){if(a){var h=r.firstChild;if(h&&h===r.lastChild&&h.nodeType===3){h.nodeValue=a;return}}r.textContent=a}var so=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ht(r,a,h){var m=a.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?m?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":m?r.setProperty(a,h):typeof h!="number"||h===0||so.has(a)?a==="float"?r.cssFloat=h:r[a]=(""+h).trim():r[a]=h+"px"}function _n(r,a,h){if(a!=null&&typeof a!="object")throw Error(i(62));if(r=r.style,h!=null){for(var m in h)!h.hasOwnProperty(m)||a!=null&&a.hasOwnProperty(m)||(m.indexOf("--")===0?r.setProperty(m,""):m==="float"?r.cssFloat="":r[m]="");for(var w in a)m=a[w],a.hasOwnProperty(w)&&h[w]!==m&&Ht(r,w,m)}else for(var S in a)a.hasOwnProperty(S)&&Ht(r,S,a[S])}function Ui(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var is=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ss(r){return qi.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var Vi=null;function Oi(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Fn=null,mi=null;function cn(r){var a=st(r);if(a&&(r=a.stateNode)){var h=r[ve]||null;e:switch(r=a.stateNode,a.type){case"input":if(ks(r,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),a=h.name,h.type==="radio"&&a!=null){for(h=r;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+$n(""+a)+'"][type="radio"]'),a=0;a<h.length;a++){var m=h[a];if(m!==r&&m.form===r.form){var w=m[ve]||null;if(!w)throw Error(i(90));ks(m,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(a=0;a<h.length;a++)m=h[a],m.form===r.form&&Ro(m)}break e;case"textarea":zn(r,h.value,h.defaultValue);break e;case"select":a=h.value,a!=null&&Qo(r,!!h.multiple,a,!1)}}}var Io=!1;function Po(r,a,h){if(Io)return r(a,h);Io=!0;try{var m=r(a);return m}finally{if(Io=!1,(Fn!==null||mi!==null)&&(Bp(),Fn&&(a=Fn,r=mi,mi=Fn=null,cn(a),r)))for(a=0;a<r.length;a++)cn(r[a])}}function bs(r,a){var h=r.stateNode;if(h===null)return null;var m=h[ve]||null;if(m===null)return null;h=m[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(r=r.type,m=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!m;break e;default:r=!1}if(r)return null;if(h&&typeof h!="function")throw Error(i(231,a,typeof h));return h}var bo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),os=!1;if(bo)try{var Ys={};Object.defineProperty(Ys,"passive",{get:function(){os=!0}}),window.addEventListener("test",Ys,Ys),window.removeEventListener("test",Ys,Ys)}catch{os=!1}var fr=null,Vr=null,Uo=null;function Ea(){if(Uo)return Uo;var r,a=Vr,h=a.length,m,w="value"in fr?fr.value:fr.textContent,S=w.length;for(r=0;r<h&&a[r]===w[r];r++);var H=h-r;for(m=1;m<=H&&a[h-m]===w[S-m];m++);return Uo=w.slice(r,1<m?1-m:void 0)}function oo(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function wo(){return!0}function Yr(){return!1}function ws(r){function a(h,m,w,S,H){this._reactName=h,this._targetInst=w,this.type=m,this.nativeEvent=S,this.target=H,this.currentTarget=null;for(var ae in r)r.hasOwnProperty(ae)&&(h=r[ae],this[ae]=h?h(S):S[ae]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?wo:Yr,this.isPropagationStopped=Yr,this}return p(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=wo)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=wo)},persist:function(){},isPersistent:wo}),a}var li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gr=ws(li),Zo=p({},li,{view:0,detail:0}),Kr=ws(Zo),Xr,jr,Fo,Jo=p({},Zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gn,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Fo&&(Fo&&r.type==="mousemove"?(Xr=r.screenX-Fo.screenX,jr=r.screenY-Fo.screenY):jr=Xr=0,Fo=r),Xr)},movementY:function(r){return"movementY"in r?r.movementY:jr}}),ro=ws(Jo),nl=p({},Jo,{dataTransfer:0}),_o=ws(nl),ao=p({},Zo,{relatedTarget:0}),N=ws(ao),Z=p({},li,{animationName:0,elapsedTime:0,pseudoElement:0}),_e=ws(Z),Ie=p({},li,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),et=ws(Ie),Mt=p({},li,{data:0}),Wt=ws(Mt),sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function An(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=xn[r])?!!a[r]:!1}function Gn(){return An}var ji=p({},Zo,{key:function(r){if(r.key){var a=sn[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=oo(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?fn[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gn,charCode:function(r){return r.type==="keypress"?oo(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?oo(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Fi=ws(ji),pi=p({},Jo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xi=ws(pi),Si=p({},Zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gn}),_s=ws(Si),mr=p({},li,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mr=ws(mr),gc=p({},Jo,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Gs=ws(gc),Qr=p({},li,{newState:0,oldState:0}),$o=ws(Qr),pr=[9,13,27,32],y=bo&&"CompositionEvent"in window,L=null;bo&&"documentMode"in document&&(L=document.documentMode);var B=bo&&"TextEvent"in window&&!L,he=bo&&(!y||L&&8<L&&11>=L),it=" ",Et=!1;function Gt(r,a){switch(r){case"keyup":return pr.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pn(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ti=!1;function Hn(r,a){switch(r){case"compositionend":return Pn(a);case"keypress":return a.which!==32?null:(Et=!0,it);case"textInput":return r=a.data,r===it&&Et?null:r;default:return null}}function ms(r,a){if(Ti)return r==="compositionend"||!y&&Gt(r,a)?(r=Ea(),Uo=Vr=fr=null,Ti=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return he&&a.locale!=="ko"?null:a.data;default:return null}}var Xn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xs(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!Xn[r.type]:a==="textarea"}function $s(r,a,h,m){Fn?mi?mi.push(m):mi=[m]:Fn=m,a=Yp(a,"onChange"),0<a.length&&(h=new Gr("onChange","change",null,h,m),r.push({event:h,listeners:a}))}var Bo=null,lo=null;function yc(r){l_(r,0)}function Ks(r){var a=St(r);if(Ro(a))return r}function xo(r,a){if(r==="change")return a}var il=!1;if(bo){var gr;if(bo){var Zr="oninput"in document;if(!Zr){var vc=document.createElement("div");vc.setAttribute("oninput","return;"),Zr=typeof vc.oninput=="function"}gr=Zr}else gr=!1;il=gr&&(!document.documentMode||9<document.documentMode)}function Ta(){Bo&&(Bo.detachEvent("onpropertychange",rs),lo=Bo=null)}function rs(r){if(r.propertyName==="value"&&Ks(lo)){var a=[];$s(a,lo,r,Oi(r)),Po(yc,a)}}function qh(r,a,h){r==="focusin"?(Ta(),Bo=a,lo=h,Bo.attachEvent("onpropertychange",rs)):r==="focusout"&&Ta()}function Jr(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Ks(lo)}function ea(r,a){if(r==="click")return Ks(a)}function bc(r,a){if(r==="input"||r==="change")return Ks(a)}function xu(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Bs=typeof Object.is=="function"?Object.is:xu;function ta(r,a){if(Bs(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var h=Object.keys(r),m=Object.keys(a);if(h.length!==m.length)return!1;for(m=0;m<h.length;m++){var w=h[m];if(!Ct.call(a,w)||!Bs(r[w],a[w]))return!1}return!0}function sl(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function ol(r,a){var h=sl(r);r=0;for(var m;h;){if(h.nodeType===3){if(m=r+h.textContent.length,r<=a&&m>=a)return{node:h,offset:a-r};r=m}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=sl(h)}}function na(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?na(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function wc(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=ns(r.document);a instanceof r.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)r=a.contentWindow;else break;a=ns(r.document)}return a}function So(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var ia=bo&&"documentMode"in document&&11>=document.documentMode,gi=null,Ni=null,$i=null,Qi=!1;function sa(r,a,h){var m=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Qi||gi==null||gi!==ns(m)||(m=gi,"selectionStart"in m&&So(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),$i&&ta($i,m)||($i=m,m=Yp(Ni,"onSelect"),0<m.length&&(a=new Gr("onSelect","select",null,a,h),r.push({event:a,listeners:m}),a.target=gi)))}function yr(r,a){var h={};return h[r.toLowerCase()]=a.toLowerCase(),h["Webkit"+r]="webkit"+a,h["Moz"+r]="moz"+a,h}var No={animationend:yr("Animation","AnimationEnd"),animationiteration:yr("Animation","AnimationIteration"),animationstart:yr("Animation","AnimationStart"),transitionrun:yr("Transition","TransitionRun"),transitionstart:yr("Transition","TransitionStart"),transitioncancel:yr("Transition","TransitionCancel"),transitionend:yr("Transition","TransitionEnd")},Ol={},Vh={};bo&&(Vh=document.createElement("div").style,"AnimationEvent"in window||(delete No.animationend.animation,delete No.animationiteration.animation,delete No.animationstart.animation),"TransitionEvent"in window||delete No.transitionend.transition);function rl(r){if(Ol[r])return Ol[r];if(!No[r])return r;var a=No[r],h;for(h in a)if(a.hasOwnProperty(h)&&h in Vh)return Ol[r]=a[h];return r}var Yh=rl("animationend"),Gh=rl("animationiteration"),Kh=rl("animationstart"),lp=rl("transitionrun"),cp=rl("transitionstart"),up=rl("transitioncancel"),Xh=rl("transitionend"),Qh=new Map,kd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");kd.push("scrollEnd");function vr(r,a){Qh.set(r,a),Yt(a,[r])}var _c=new WeakMap;function er(r,a){if(typeof r=="object"&&r!==null){var h=_c.get(r);return h!==void 0?h:(a={value:r,source:a,stack:Vs(a)},_c.set(r,a),a)}return{value:r,source:a,stack:Vs(a)}}var tr=[],jl=0,Ld=0;function Su(){for(var r=jl,a=Ld=jl=0;a<r;){var h=tr[a];tr[a++]=null;var m=tr[a];tr[a++]=null;var w=tr[a];tr[a++]=null;var S=tr[a];if(tr[a++]=null,m!==null&&w!==null){var H=m.pending;H===null?w.next=w:(w.next=H.next,H.next=w),m.pending=w}S!==0&&Dd(h,w,S)}}function Nu(r,a,h,m){tr[jl++]=r,tr[jl++]=a,tr[jl++]=h,tr[jl++]=m,Ld|=m,r.lanes|=m,r=r.alternate,r!==null&&(r.lanes|=m)}function Ad(r,a,h,m){return Nu(r,a,h,m),Rl(r)}function Ml(r,a){return Nu(r,null,null,a),Rl(r)}function Dd(r,a,h){r.lanes|=h;var m=r.alternate;m!==null&&(m.lanes|=h);for(var w=!1,S=r.return;S!==null;)S.childLanes|=h,m=S.alternate,m!==null&&(m.childLanes|=h),S.tag===22&&(r=S.stateNode,r===null||r._visibility&1||(w=!0)),r=S,S=S.return;return r.tag===3?(S=r.stateNode,w&&a!==null&&(w=31-Ue(h),r=S.hiddenUpdates,m=r[w],m===null?r[w]=[a]:m.push(a),a.lane=h|536870912),S):null}function Rl(r){if(50<Sf)throw Sf=0,U1=null,Error(i(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var Ws={};function br(r,a,h,m){this.tag=r,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function co(r,a,h,m){return new br(r,a,h,m)}function xc(r){return r=r.prototype,!(!r||!r.isReactComponent)}function oa(r,a){var h=r.alternate;return h===null?(h=co(r.tag,a,r.key,r.mode),h.elementType=r.elementType,h.type=r.type,h.stateNode=r.stateNode,h.alternate=r,r.alternate=h):(h.pendingProps=a,h.type=r.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=r.flags&65011712,h.childLanes=r.childLanes,h.lanes=r.lanes,h.child=r.child,h.memoizedProps=r.memoizedProps,h.memoizedState=r.memoizedState,h.updateQueue=r.updateQueue,a=r.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=r.sibling,h.index=r.index,h.ref=r.ref,h.refCleanup=r.refCleanup,h}function Eu(r,a){r.flags&=65011714;var h=r.alternate;return h===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=h.childLanes,r.lanes=h.lanes,r.child=h.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=h.memoizedProps,r.memoizedState=h.memoizedState,r.updateQueue=h.updateQueue,r.type=h.type,a=h.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function Il(r,a,h,m,w,S){var H=0;if(m=r,typeof r=="function")xc(r)&&(H=1);else if(typeof r=="string")H=qk(r,h,$.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case D:return r=co(31,h,a,w),r.elementType=D,r.lanes=S,r;case T:return Ca(h.children,w,S,a);case C:H=8,w|=24;break;case A:return r=co(12,h,a,w|2),r.elementType=A,r.lanes=S,r;case de:return r=co(13,h,a,w),r.elementType=de,r.lanes=S,r;case le:return r=co(19,h,a,w),r.elementType=le,r.lanes=S,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case I:case G:H=10;break e;case ee:H=9;break e;case K:H=11;break e;case z:H=14;break e;case R:H=16,m=null;break e}H=29,h=Error(i(130,r===null?"null":typeof r,"")),m=null}return a=co(H,h,a,w),a.elementType=r,a.type=m,a.lanes=S,a}function Ca(r,a,h,m){return r=co(7,r,m,a),r.lanes=h,r}function Od(r,a,h){return r=co(6,r,null,a),r.lanes=h,r}function Tu(r,a,h){return a=co(4,r.children!==null?r.children:[],r.key,a),a.lanes=h,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var al=[],ka=0,Sc=null,jd=0,wr=[],nr=0,Pl=null,La=1,Aa="";function Ul(r,a){al[ka++]=jd,al[ka++]=Sc,Sc=r,jd=a}function dp(r,a,h){wr[nr++]=La,wr[nr++]=Aa,wr[nr++]=Pl,Pl=r;var m=La;r=Aa;var w=32-Ue(m)-1;m&=~(1<<w),h+=1;var S=32-Ue(a)+w;if(30<S){var H=w-w%5;S=(m&(1<<H)-1).toString(32),m>>=H,w-=H,La=1<<32-Ue(a)+w|h<<w|m,Aa=S+r}else La=1<<S|h<<w|m,Aa=r}function Cu(r){r.return!==null&&(Ul(r,1),dp(r,1,0))}function ku(r){for(;r===Sc;)Sc=al[--ka],al[ka]=null,jd=al[--ka],al[ka]=null;for(;r===Pl;)Pl=wr[--nr],wr[nr]=null,Aa=wr[--nr],wr[nr]=null,La=wr[--nr],wr[nr]=null}var Ls=null,as=null,yi=!1,ll=null,ra=!1,Zh=Error(i(519));function Fl(r){var a=Error(i(418,""));throw Nc(er(a,r)),Zh}function hp(r){var a=r.stateNode,h=r.type,m=r.memoizedProps;switch(a[dt]=r,a[ve]=m,h){case"dialog":ni("cancel",a),ni("close",a);break;case"iframe":case"object":case"embed":ni("load",a);break;case"video":case"audio":for(h=0;h<Ef.length;h++)ni(Ef[h],a);break;case"source":ni("error",a);break;case"img":case"image":case"link":ni("error",a),ni("load",a);break;case"details":ni("toggle",a);break;case"input":ni("invalid",a),Dr(a,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),no(a);break;case"select":ni("invalid",a);break;case"textarea":ni("invalid",a),hr(a,m.value,m.defaultValue,m.children),no(a)}h=m.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||a.textContent===""+h||m.suppressHydrationWarning===!0||h_(a.textContent,h)?(m.popover!=null&&(ni("beforetoggle",a),ni("toggle",a)),m.onScroll!=null&&ni("scroll",a),m.onScrollEnd!=null&&ni("scrollend",a),m.onClick!=null&&(a.onclick=Gp),a=!0):a=!1,a||Fl(r)}function Da(r){for(Ls=r.return;Ls;)switch(Ls.tag){case 5:case 13:ra=!1;return;case 27:case 3:ra=!0;return;default:Ls=Ls.return}}function Eo(r){if(r!==Ls)return!1;if(!yi)return Da(r),yi=!0,!1;var a=r.tag,h;if((h=a!==3&&a!==27)&&((h=a===5)&&(h=r.type,h=!(h!=="form"&&h!=="button")||ey(r.type,r.memoizedProps)),h=!h),h&&as&&Fl(r),Da(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));e:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8)if(h=r.data,h==="/$"){if(a===0){as=Fa(r.nextSibling);break e}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++;r=r.nextSibling}as=null}}else a===27?(a=as,$c(r.type)?(r=sy,sy=null,as=r):as=a):as=Ls?Fa(r.stateNode.nextSibling):null;return!0}function ir(){as=Ls=null,yi=!1}function fp(){var r=ll;return r!==null&&(xr===null?xr=r:xr.push.apply(xr,r),ll=null),r}function Nc(r){ll===null?ll=[r]:ll.push(r)}var aa=te(null),zs=null,Oa=null;function cl(r,a,h){U(aa,a._currentValue),a._currentValue=h}function la(r){r._currentValue=aa.current,j(aa)}function Md(r,a,h){for(;r!==null;){var m=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,m!==null&&(m.childLanes|=a)):m!==null&&(m.childLanes&a)!==a&&(m.childLanes|=a),r===h)break;r=r.return}}function Rd(r,a,h,m){var w=r.child;for(w!==null&&(w.return=r);w!==null;){var S=w.dependencies;if(S!==null){var H=w.child;S=S.firstContext;e:for(;S!==null;){var ae=S;S=w;for(var Oe=0;Oe<a.length;Oe++)if(ae.context===a[Oe]){S.lanes|=h,ae=S.alternate,ae!==null&&(ae.lanes|=h),Md(S.return,h,r),m||(H=null);break e}S=ae.next}}else if(w.tag===18){if(H=w.return,H===null)throw Error(i(341));H.lanes|=h,S=H.alternate,S!==null&&(S.lanes|=h),Md(H,h,r),H=null}else H=w.child;if(H!==null)H.return=w;else for(H=w;H!==null;){if(H===r){H=null;break}if(w=H.sibling,w!==null){w.return=H.return,H=w;break}H=H.return}w=H}}function Ec(r,a,h,m){r=null;for(var w=a,S=!1;w!==null;){if(!S){if((w.flags&524288)!==0)S=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var H=w.alternate;if(H===null)throw Error(i(387));if(H=H.memoizedProps,H!==null){var ae=w.type;Bs(w.pendingProps.value,H.value)||(r!==null?r.push(ae):r=[ae])}}else if(w===ye.current){if(H=w.alternate,H===null)throw Error(i(387));H.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(r!==null?r.push(Df):r=[Df])}w=w.return}r!==null&&Rd(a,r,h,m),a.flags|=262144}function Id(r){for(r=r.firstContext;r!==null;){if(!Bs(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ca(r){zs=r,Oa=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function As(r){return Pd(zs,r)}function ul(r,a){return zs===null&&ca(r),Pd(r,a)}function Pd(r,a){var h=a._currentValue;if(a={context:a,memoizedValue:h,next:null},Oa===null){if(r===null)throw Error(i(308));Oa=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else Oa=Oa.next=a;return h}var c1=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(h,m){r.push(m)}};this.abort=function(){a.aborted=!0,r.forEach(function(h){return h()})}},mp=n.unstable_scheduleCallback,u1=n.unstable_NormalPriority,Ds={$$typeof:G,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jh(){return{controller:new c1,data:new Map,refCount:0}}function Lu(r){r.refCount--,r.refCount===0&&mp(u1,function(){r.controller.abort()})}var Au=null,ef=0,$l=0,ja=null;function d1(r,a){if(Au===null){var h=Au=[];ef=0,$l=q1(),ja={status:"pending",value:void 0,then:function(m){h.push(m)}}}return ef++,a.then(pp,pp),a}function pp(){if(--ef===0&&Au!==null){ja!==null&&(ja.status="fulfilled");var r=Au;Au=null,$l=0,ja=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function gp(r,a){var h=[],m={status:"pending",value:null,reason:null,then:function(w){h.push(w)}};return r.then(function(){m.status="fulfilled",m.value=a;for(var w=0;w<h.length;w++)(0,h[w])(a)},function(w){for(m.status="rejected",m.reason=w,w=0;w<h.length;w++)(0,h[w])(void 0)}),m}var g=q.S;q.S=function(r,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&d1(r,a),g!==null&&g(r,a)};var x=te(null);function k(){var r=x.current;return r!==null?r:Yi.pooledCache}function P(r,a){a===null?U(x,x.current):U(x,a.pool)}function J(){var r=k();return r===null?null:{parent:Ds._currentValue,pool:r}}var ne=Error(i(460)),oe=Error(i(474)),ue=Error(i(542)),ge={then:function(){}};function xe(r){return r=r.status,r==="fulfilled"||r==="rejected"}function ze(){}function ht(r,a,h){switch(h=r[h],h===void 0?r.push(a):h!==a&&(a.then(ze,ze),a=h),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,ot(r),r;default:if(typeof a.status=="string")a.then(ze,ze);else{if(r=Yi,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=a,r.status="pending",r.then(function(m){if(a.status==="pending"){var w=a;w.status="fulfilled",w.value=m}},function(m){if(a.status==="pending"){var w=a;w.status="rejected",w.reason=m}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,ot(r),r}throw we=a,ne}}var we=null;function Ke(){if(we===null)throw Error(i(459));var r=we;return we=null,r}function ot(r){if(r===ne||r===ue)throw Error(i(483))}var kt=!1;function ut(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jt(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ot(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function zt(r,a,h){var m=r.updateQueue;if(m===null)return null;if(m=m.shared,(ki&2)!==0){var w=m.pending;return w===null?a.next=a:(a.next=w.next,w.next=a),m.pending=a,a=Rl(r),Dd(r,null,h),a}return Nu(r,m,a,h),Rl(r)}function $t(r,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194048)!==0)){var m=a.lanes;m&=r.pendingLanes,h|=m,a.lanes=h,an(r,h)}}function gn(r,a){var h=r.updateQueue,m=r.alternate;if(m!==null&&(m=m.updateQueue,h===m)){var w=null,S=null;if(h=h.firstBaseUpdate,h!==null){do{var H={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};S===null?w=S=H:S=S.next=H,h=h.next}while(h!==null);S===null?w=S=a:S=S.next=a}else w=S=a;h={baseState:m.baseState,firstBaseUpdate:w,lastBaseUpdate:S,shared:m.shared,callbacks:m.callbacks},r.updateQueue=h;return}r=h.lastBaseUpdate,r===null?h.firstBaseUpdate=a:r.next=a,h.lastBaseUpdate=a}var rn=!1;function jn(){if(rn){var r=ja;if(r!==null)throw r}}function ln(r,a,h,m){rn=!1;var w=r.updateQueue;kt=!1;var S=w.firstBaseUpdate,H=w.lastBaseUpdate,ae=w.shared.pending;if(ae!==null){w.shared.pending=null;var Oe=ae,ft=Oe.next;Oe.next=null,H===null?S=ft:H.next=ft,H=Oe;var Rt=r.alternate;Rt!==null&&(Rt=Rt.updateQueue,ae=Rt.lastBaseUpdate,ae!==H&&(ae===null?Rt.firstBaseUpdate=ft:ae.next=ft,Rt.lastBaseUpdate=Oe))}if(S!==null){var Bt=w.baseState;H=0,Rt=ft=Oe=null,ae=S;do{var vt=ae.lane&-536870913,wt=vt!==ae.lane;if(wt?(ui&vt)===vt:(m&vt)===vt){vt!==0&&vt===$l&&(rn=!0),Rt!==null&&(Rt=Rt.next={lane:0,tag:ae.tag,payload:ae.payload,callback:null,next:null});e:{var On=r,En=ae;vt=a;var Ii=h;switch(En.tag){case 1:if(On=En.payload,typeof On=="function"){Bt=On.call(Ii,Bt,vt);break e}Bt=On;break e;case 3:On.flags=On.flags&-65537|128;case 0:if(On=En.payload,vt=typeof On=="function"?On.call(Ii,Bt,vt):On,vt==null)break e;Bt=p({},Bt,vt);break e;case 2:kt=!0}}vt=ae.callback,vt!==null&&(r.flags|=64,wt&&(r.flags|=8192),wt=w.callbacks,wt===null?w.callbacks=[vt]:wt.push(vt))}else wt={lane:vt,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},Rt===null?(ft=Rt=wt,Oe=Bt):Rt=Rt.next=wt,H|=vt;if(ae=ae.next,ae===null){if(ae=w.shared.pending,ae===null)break;wt=ae,ae=wt.next,wt.next=null,w.lastBaseUpdate=wt,w.shared.pending=null}}while(!0);Rt===null&&(Oe=Bt),w.baseState=Oe,w.firstBaseUpdate=ft,w.lastBaseUpdate=Rt,S===null&&(w.shared.lanes=0),Ic|=H,r.lanes=H,r.memoizedState=Bt}}function Qn(r,a){if(typeof r!="function")throw Error(i(191,r));r.call(a)}function Ss(r,a){var h=r.callbacks;if(h!==null)for(r.callbacks=null,r=0;r<h.length;r++)Qn(h[r],a)}var Dn=te(null),un=te(0);function Jt(r,a){r=Gl,U(un,r),U(Dn,a),Gl=r|a.baseLanes}function Zi(){U(un,Gl),U(Dn,Dn.current)}function Mn(){Gl=un.current,j(Dn),j(un)}var Wn=0,hn=null,Un=null,oi=null,Bi=!1,ps=!1,gs=!1,ls=0,Kn=0,ri=null,cs=0;function Nn(){throw Error(i(321))}function Os(r,a){if(a===null)return!1;for(var h=0;h<a.length&&h<r.length;h++)if(!Bs(r[h],a[h]))return!1;return!0}function sr(r,a,h,m,w,S){return Wn=S,hn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,q.H=r===null||r.memoizedState===null?Vb:Yb,gs=!1,S=h(m,w),gs=!1,ps&&(S=To(a,h,m,w)),us(r),S}function us(r){q.H=kp;var a=Un!==null&&Un.next!==null;if(Wn=0,oi=Un=hn=null,Bi=!1,Kn=0,ri=null,a)throw Error(i(300));r===null||ho||(r=r.dependencies,r!==null&&Id(r)&&(ho=!0))}function To(r,a,h,m){hn=r;var w=0;do{if(ps&&(ri=null),Kn=0,ps=!1,25<=w)throw Error(i(301));if(w+=1,oi=Un=null,r.updateQueue!=null){var S=r.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}q.H=nk,S=a(h,m)}while(ps);return S}function Ci(){var r=q.H,a=r.useState()[0];return a=typeof a.then=="function"?Qs(a):a,r=r.useState()[0],(Un!==null?Un.memoizedState:null)!==r&&(hn.flags|=1024),a}function ys(){var r=ls!==0;return ls=0,r}function Co(r,a,h){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~h}function Xs(r){if(Bi){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Bi=!1}Wn=0,oi=Un=hn=null,ps=!1,Kn=ls=0,ri=null}function Mi(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return oi===null?hn.memoizedState=oi=r:oi=oi.next=r,oi}function ci(){if(Un===null){var r=hn.alternate;r=r!==null?r.memoizedState:null}else r=Un.next;var a=oi===null?hn.memoizedState:oi.next;if(a!==null)oi=a,Un=r;else{if(r===null)throw hn.alternate===null?Error(i(467)):Error(i(310));Un=r,r={memoizedState:Un.memoizedState,baseState:Un.baseState,baseQueue:Un.baseQueue,queue:Un.queue,next:null},oi===null?hn.memoizedState=oi=r:oi=oi.next=r}return oi}function uo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Qs(r){var a=Kn;return Kn+=1,ri===null&&(ri=[]),r=ht(ri,r,a),a=hn,(oi===null?a.memoizedState:oi.next)===null&&(a=a.alternate,q.H=a===null||a.memoizedState===null?Vb:Yb),r}function _i(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Qs(r);if(r.$$typeof===G)return As(r)}throw Error(i(438,String(r)))}function ko(r){var a=null,h=hn.updateQueue;if(h!==null&&(a=h.memoCache),a==null){var m=hn.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(a={data:m.data.map(function(w){return w.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),h===null&&(h=uo(),hn.updateQueue=h),h.memoCache=a,h=a.data[a.index],h===void 0)for(h=a.data[a.index]=Array(r),m=0;m<r;m++)h[m]=F;return a.index++,h}function js(r,a){return typeof a=="function"?a(r):a}function ua(r){var a=ci();return Rr(a,Un,r)}function Rr(r,a,h){var m=r.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=h;var w=r.baseQueue,S=m.pending;if(S!==null){if(w!==null){var H=w.next;w.next=S.next,S.next=H}a.baseQueue=w=S,m.pending=null}if(S=r.baseState,w===null)r.memoizedState=S;else{a=w.next;var ae=H=null,Oe=null,ft=a,Rt=!1;do{var Bt=ft.lane&-536870913;if(Bt!==ft.lane?(ui&Bt)===Bt:(Wn&Bt)===Bt){var vt=ft.revertLane;if(vt===0)Oe!==null&&(Oe=Oe.next={lane:0,revertLane:0,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null}),Bt===$l&&(Rt=!0);else if((Wn&vt)===vt){ft=ft.next,vt===$l&&(Rt=!0);continue}else Bt={lane:0,revertLane:ft.revertLane,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},Oe===null?(ae=Oe=Bt,H=S):Oe=Oe.next=Bt,hn.lanes|=vt,Ic|=vt;Bt=ft.action,gs&&h(S,Bt),S=ft.hasEagerState?ft.eagerState:h(S,Bt)}else vt={lane:Bt,revertLane:ft.revertLane,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},Oe===null?(ae=Oe=vt,H=S):Oe=Oe.next=vt,hn.lanes|=Bt,Ic|=Bt;ft=ft.next}while(ft!==null&&ft!==a);if(Oe===null?H=S:Oe.next=ae,!Bs(S,r.memoizedState)&&(ho=!0,Rt&&(h=ja,h!==null)))throw h;r.memoizedState=S,r.baseState=H,r.baseQueue=Oe,m.lastRenderedState=S}return w===null&&(m.lanes=0),[r.memoizedState,m.dispatch]}function Ms(r){var a=ci(),h=a.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=r;var m=h.dispatch,w=h.pending,S=a.memoizedState;if(w!==null){h.pending=null;var H=w=w.next;do S=r(S,H.action),H=H.next;while(H!==w);Bs(S,a.memoizedState)||(ho=!0),a.memoizedState=S,a.baseQueue===null&&(a.baseState=S),h.lastRenderedState=S}return[S,m]}function Du(r,a,h){var m=hn,w=ci(),S=yi;if(S){if(h===void 0)throw Error(i(407));h=h()}else h=a();var H=!Bs((Un||w).memoizedState,h);H&&(w.memoizedState=h,ho=!0),w=w.queue;var ae=Tc.bind(null,m,w,r);if(Lc(2048,8,ae,[r]),w.getSnapshot!==a||H||oi!==null&&oi.memoizedState.tag&1){if(m.flags|=2048,Ra(9,Ru(),Ou.bind(null,m,w,h,a),null),Yi===null)throw Error(i(349));S||(Wn&124)!==0||Ud(m,a,h)}return h}function Ud(r,a,h){r.flags|=16384,r={getSnapshot:a,value:h},a=hn.updateQueue,a===null?(a=uo(),hn.updateQueue=a,a.stores=[r]):(h=a.stores,h===null?a.stores=[r]:h.push(r))}function Ou(r,a,h,m){a.value=h,a.getSnapshot=m,yp(a)&&vp(r)}function Tc(r,a,h){return h(function(){yp(a)&&vp(r)})}function yp(r){var a=r.getSnapshot;r=r.value;try{var h=a();return!Bs(r,h)}catch{return!0}}function vp(r){var a=Ml(r,2);a!==null&&Br(a,r,2)}function ju(r){var a=Mi();if(typeof r=="function"){var h=r;if(r=h(),gs){qe(!0);try{h()}finally{qe(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:js,lastRenderedState:r},a}function Ma(r,a,h,m){return r.baseState=h,Rr(r,Un,typeof m=="function"?m:js)}function h1(r,a,h,m,w){if(Cp(r))throw Error(i(485));if(r=a.action,r!==null){var S={payload:w,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(H){S.listeners.push(H)}};q.T!==null?h(!0):S.isTransition=!1,m(S),h=a.pending,h===null?(S.next=a.pending=S,bp(a,S)):(S.next=h.next,a.pending=h.next=S)}}function bp(r,a){var h=a.action,m=a.payload,w=r.state;if(a.isTransition){var S=q.T,H={};q.T=H;try{var ae=h(w,m),Oe=q.S;Oe!==null&&Oe(H,ae),wp(r,a,ae)}catch(ft){Cc(r,a,ft)}finally{q.T=S}}else try{S=h(w,m),wp(r,a,S)}catch(ft){Cc(r,a,ft)}}function wp(r,a,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(m){tf(r,a,m)},function(m){return Cc(r,a,m)}):tf(r,a,h)}function tf(r,a,h){a.status="fulfilled",a.value=h,nf(a),r.state=h,a=r.pending,a!==null&&(h=a.next,h===a?r.pending=null:(h=h.next,a.next=h,bp(r,h)))}function Cc(r,a,h){var m=r.pending;if(r.pending=null,m!==null){m=m.next;do a.status="rejected",a.reason=h,nf(a),a=a.next;while(a!==m)}r.action=null}function nf(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function sf(r,a){return a}function Mu(r,a){if(yi){var h=Yi.formState;if(h!==null){e:{var m=hn;if(yi){if(as){t:{for(var w=as,S=ra;w.nodeType!==8;){if(!S){w=null;break t}if(w=Fa(w.nextSibling),w===null){w=null;break t}}S=w.data,w=S==="F!"||S==="F"?w:null}if(w){as=Fa(w.nextSibling),m=w.data==="F!";break e}}Fl(m)}m=!1}m&&(a=h[0])}}return h=Mi(),h.memoizedState=h.baseState=a,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sf,lastRenderedState:a},h.queue=m,h=zb.bind(null,hn,m),m.dispatch=h,m=ju(!1),S=f1.bind(null,hn,!1,m.queue),m=Mi(),w={state:a,dispatch:null,action:r,pending:null},m.queue=w,h=h1.bind(null,hn,w,S,h),w.dispatch=h,m.memoizedState=r,[a,h,!1]}function Fd(r){var a=ci();return kc(a,Un,r)}function kc(r,a,h){if(a=Rr(r,a,sf)[0],r=ua(js)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var m=Qs(a)}catch(H){throw H===ne?ue:H}else m=a;a=ci();var w=a.queue,S=w.dispatch;return h!==a.memoizedState&&(hn.flags|=2048,Ra(9,Ru(),_p.bind(null,w,h),null)),[m,S,r]}function _p(r,a){r.action=a}function xp(r){var a=ci(),h=Un;if(h!==null)return kc(a,h,r);ci(),a=a.memoizedState,h=ci();var m=h.queue.dispatch;return h.memoizedState=r,[a,m,!1]}function Ra(r,a,h,m){return r={tag:r,create:h,deps:m,inst:a,next:null},a=hn.updateQueue,a===null&&(a=uo(),hn.updateQueue=a),h=a.lastEffect,h===null?a.lastEffect=r.next=r:(m=h.next,h.next=r,r.next=m,a.lastEffect=r),r}function Ru(){return{destroy:void 0,resource:void 0}}function $d(){return ci().memoizedState}function Ir(r,a,h,m){var w=Mi();m=m===void 0?null:m,hn.flags|=r,w.memoizedState=Ra(1|a,Ru(),h,m)}function Lc(r,a,h,m){var w=ci();m=m===void 0?null:m;var S=w.memoizedState.inst;Un!==null&&m!==null&&Os(m,Un.memoizedState.deps)?w.memoizedState=Ra(a,S,h,m):(hn.flags|=r,w.memoizedState=Ra(1|a,S,h,m))}function of(r,a){Ir(8390656,8,r,a)}function Sp(r,a){Lc(2048,8,r,a)}function rf(r,a){return Lc(4,2,r,a)}function Bl(r,a){return Lc(4,4,r,a)}function Np(r,a){if(typeof a=="function"){r=r();var h=a(r);return function(){typeof h=="function"?h():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function af(r,a,h){h=h!=null?h.concat([r]):null,Lc(4,4,Np.bind(null,a,r),h)}function lf(){}function cf(r,a){var h=ci();a=a===void 0?null:a;var m=h.memoizedState;return a!==null&&Os(a,m[1])?m[0]:(h.memoizedState=[r,a],r)}function Ep(r,a){var h=ci();a=a===void 0?null:a;var m=h.memoizedState;if(a!==null&&Os(a,m[1]))return m[0];if(m=r(),gs){qe(!0);try{r()}finally{qe(!1)}}return h.memoizedState=[m,a],m}function Wl(r,a,h){return h===void 0||(Wn&1073741824)!==0?r.memoizedState=a:(r.memoizedState=h,r=Fw(),hn.lanes|=r,Ic|=r,h)}function Bd(r,a,h,m){return Bs(h,a)?h:Dn.current!==null?(r=Wl(r,h,m),Bs(r,a)||(ho=!0),r):(Wn&42)===0?(ho=!0,r.memoizedState=h):(r=Fw(),hn.lanes|=r,Ic|=r,a)}function Iu(r,a,h,m,w){var S=re.p;re.p=S!==0&&8>S?S:8;var H=q.T,ae={};q.T=ae,f1(r,!1,a,h);try{var Oe=w(),ft=q.S;if(ft!==null&&ft(ae,Oe),Oe!==null&&typeof Oe=="object"&&typeof Oe.then=="function"){var Rt=gp(Oe,m);ff(r,a,Rt,$r(r))}else ff(r,a,m,$r(r))}catch(Bt){ff(r,a,{then:function(){},status:"rejected",reason:Bt},$r())}finally{re.p=S,q.T=H}}function Ia(){}function da(r,a,h,m){if(r.tag!==5)throw Error(i(476));var w=Pa(r).queue;Iu(r,w,a,V,h===null?Ia:function(){return Pu(r),h(m)})}function Pa(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:js,lastRenderedState:V},next:null};var h={};return a.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:js,lastRenderedState:h},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function Pu(r){var a=Pa(r).next.queue;ff(r,a,{},$r())}function Uu(){return As(Df)}function uf(){return ci().memoizedState}function Tp(){return ci().memoizedState}function df(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var h=$r();r=Ot(h);var m=zt(a,r,h);m!==null&&(Br(m,a,h),$t(m,a,h)),a={cache:Jh()},r.payload=a;return}a=a.return}}function hf(r,a,h){var m=$r();h={lane:m,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},Cp(r)?Hb(a,h):(h=Ad(r,a,h,m),h!==null&&(Br(h,r,m),qb(h,a,m)))}function zb(r,a,h){var m=$r();ff(r,a,h,m)}function ff(r,a,h,m){var w={lane:m,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(Cp(r))Hb(a,w);else{var S=r.alternate;if(r.lanes===0&&(S===null||S.lanes===0)&&(S=a.lastRenderedReducer,S!==null))try{var H=a.lastRenderedState,ae=S(H,h);if(w.hasEagerState=!0,w.eagerState=ae,Bs(ae,H))return Nu(r,a,w,0),Yi===null&&Su(),!1}catch{}finally{}if(h=Ad(r,a,w,m),h!==null)return Br(h,r,m),qb(h,a,m),!0}return!1}function f1(r,a,h,m){if(m={lane:2,revertLane:q1(),action:m,hasEagerState:!1,eagerState:null,next:null},Cp(r)){if(a)throw Error(i(479))}else a=Ad(r,h,m,2),a!==null&&Br(a,r,2)}function Cp(r){var a=r.alternate;return r===hn||a!==null&&a===hn}function Hb(r,a){ps=Bi=!0;var h=r.pending;h===null?a.next=a:(a.next=h.next,h.next=a),r.pending=a}function qb(r,a,h){if((h&4194048)!==0){var m=a.lanes;m&=r.pendingLanes,h|=m,a.lanes=h,an(r,h)}}var kp={readContext:As,use:_i,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useLayoutEffect:Nn,useInsertionEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useSyncExternalStore:Nn,useId:Nn,useHostTransitionStatus:Nn,useFormState:Nn,useActionState:Nn,useOptimistic:Nn,useMemoCache:Nn,useCacheRefresh:Nn},Vb={readContext:As,use:_i,useCallback:function(r,a){return Mi().memoizedState=[r,a===void 0?null:a],r},useContext:As,useEffect:of,useImperativeHandle:function(r,a,h){h=h!=null?h.concat([r]):null,Ir(4194308,4,Np.bind(null,a,r),h)},useLayoutEffect:function(r,a){return Ir(4194308,4,r,a)},useInsertionEffect:function(r,a){Ir(4,2,r,a)},useMemo:function(r,a){var h=Mi();a=a===void 0?null:a;var m=r();if(gs){qe(!0);try{r()}finally{qe(!1)}}return h.memoizedState=[m,a],m},useReducer:function(r,a,h){var m=Mi();if(h!==void 0){var w=h(a);if(gs){qe(!0);try{h(a)}finally{qe(!1)}}}else w=a;return m.memoizedState=m.baseState=w,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:w},m.queue=r,r=r.dispatch=hf.bind(null,hn,r),[m.memoizedState,r]},useRef:function(r){var a=Mi();return r={current:r},a.memoizedState=r},useState:function(r){r=ju(r);var a=r.queue,h=zb.bind(null,hn,a);return a.dispatch=h,[r.memoizedState,h]},useDebugValue:lf,useDeferredValue:function(r,a){var h=Mi();return Wl(h,r,a)},useTransition:function(){var r=ju(!1);return r=Iu.bind(null,hn,r.queue,!0,!1),Mi().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,h){var m=hn,w=Mi();if(yi){if(h===void 0)throw Error(i(407));h=h()}else{if(h=a(),Yi===null)throw Error(i(349));(ui&124)!==0||Ud(m,a,h)}w.memoizedState=h;var S={value:h,getSnapshot:a};return w.queue=S,of(Tc.bind(null,m,S,r),[r]),m.flags|=2048,Ra(9,Ru(),Ou.bind(null,m,S,h,a),null),h},useId:function(){var r=Mi(),a=Yi.identifierPrefix;if(yi){var h=Aa,m=La;h=(m&~(1<<32-Ue(m)-1)).toString(32)+h,a="«"+a+"R"+h,h=ls++,0<h&&(a+="H"+h.toString(32)),a+="»"}else h=cs++,a="«"+a+"r"+h.toString(32)+"»";return r.memoizedState=a},useHostTransitionStatus:Uu,useFormState:Mu,useActionState:Mu,useOptimistic:function(r){var a=Mi();a.memoizedState=a.baseState=r;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=h,a=f1.bind(null,hn,!0,h),h.dispatch=a,[r,a]},useMemoCache:ko,useCacheRefresh:function(){return Mi().memoizedState=df.bind(null,hn)}},Yb={readContext:As,use:_i,useCallback:cf,useContext:As,useEffect:Sp,useImperativeHandle:af,useInsertionEffect:rf,useLayoutEffect:Bl,useMemo:Ep,useReducer:ua,useRef:$d,useState:function(){return ua(js)},useDebugValue:lf,useDeferredValue:function(r,a){var h=ci();return Bd(h,Un.memoizedState,r,a)},useTransition:function(){var r=ua(js)[0],a=ci().memoizedState;return[typeof r=="boolean"?r:Qs(r),a]},useSyncExternalStore:Du,useId:uf,useHostTransitionStatus:Uu,useFormState:Fd,useActionState:Fd,useOptimistic:function(r,a){var h=ci();return Ma(h,Un,r,a)},useMemoCache:ko,useCacheRefresh:Tp},nk={readContext:As,use:_i,useCallback:cf,useContext:As,useEffect:Sp,useImperativeHandle:af,useInsertionEffect:rf,useLayoutEffect:Bl,useMemo:Ep,useReducer:Ms,useRef:$d,useState:function(){return Ms(js)},useDebugValue:lf,useDeferredValue:function(r,a){var h=ci();return Un===null?Wl(h,r,a):Bd(h,Un.memoizedState,r,a)},useTransition:function(){var r=Ms(js)[0],a=ci().memoizedState;return[typeof r=="boolean"?r:Qs(r),a]},useSyncExternalStore:Du,useId:uf,useHostTransitionStatus:Uu,useFormState:xp,useActionState:xp,useOptimistic:function(r,a){var h=ci();return Un!==null?Ma(h,Un,r,a):(h.baseState=r,[r,h.queue.dispatch])},useMemoCache:ko,useCacheRefresh:Tp},Wd=null,mf=0;function Lp(r){var a=mf;return mf+=1,Wd===null&&(Wd=[]),ht(Wd,r,a)}function pf(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function Ap(r,a){throw a.$$typeof===v?Error(i(525)):(r=Object.prototype.toString.call(a),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function Gb(r){var a=r._init;return a(r._payload)}function Kb(r){function a(nt,Ge){if(r){var ct=nt.deletions;ct===null?(nt.deletions=[Ge],nt.flags|=16):ct.push(Ge)}}function h(nt,Ge){if(!r)return null;for(;Ge!==null;)a(nt,Ge),Ge=Ge.sibling;return null}function m(nt){for(var Ge=new Map;nt!==null;)nt.key!==null?Ge.set(nt.key,nt):Ge.set(nt.index,nt),nt=nt.sibling;return Ge}function w(nt,Ge){return nt=oa(nt,Ge),nt.index=0,nt.sibling=null,nt}function S(nt,Ge,ct){return nt.index=ct,r?(ct=nt.alternate,ct!==null?(ct=ct.index,ct<Ge?(nt.flags|=67108866,Ge):ct):(nt.flags|=67108866,Ge)):(nt.flags|=1048576,Ge)}function H(nt){return r&&nt.alternate===null&&(nt.flags|=67108866),nt}function ae(nt,Ge,ct,Ft){return Ge===null||Ge.tag!==6?(Ge=Od(ct,nt.mode,Ft),Ge.return=nt,Ge):(Ge=w(Ge,ct),Ge.return=nt,Ge)}function Oe(nt,Ge,ct,Ft){var mn=ct.type;return mn===T?Rt(nt,Ge,ct.props.children,Ft,ct.key):Ge!==null&&(Ge.elementType===mn||typeof mn=="object"&&mn!==null&&mn.$$typeof===R&&Gb(mn)===Ge.type)?(Ge=w(Ge,ct.props),pf(Ge,ct),Ge.return=nt,Ge):(Ge=Il(ct.type,ct.key,ct.props,null,nt.mode,Ft),pf(Ge,ct),Ge.return=nt,Ge)}function ft(nt,Ge,ct,Ft){return Ge===null||Ge.tag!==4||Ge.stateNode.containerInfo!==ct.containerInfo||Ge.stateNode.implementation!==ct.implementation?(Ge=Tu(ct,nt.mode,Ft),Ge.return=nt,Ge):(Ge=w(Ge,ct.children||[]),Ge.return=nt,Ge)}function Rt(nt,Ge,ct,Ft,mn){return Ge===null||Ge.tag!==7?(Ge=Ca(ct,nt.mode,Ft,mn),Ge.return=nt,Ge):(Ge=w(Ge,ct),Ge.return=nt,Ge)}function Bt(nt,Ge,ct){if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint")return Ge=Od(""+Ge,nt.mode,ct),Ge.return=nt,Ge;if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case _:return ct=Il(Ge.type,Ge.key,Ge.props,null,nt.mode,ct),pf(ct,Ge),ct.return=nt,ct;case b:return Ge=Tu(Ge,nt.mode,ct),Ge.return=nt,Ge;case R:var Ft=Ge._init;return Ge=Ft(Ge._payload),Bt(nt,Ge,ct)}if(ie(Ge)||O(Ge))return Ge=Ca(Ge,nt.mode,ct,null),Ge.return=nt,Ge;if(typeof Ge.then=="function")return Bt(nt,Lp(Ge),ct);if(Ge.$$typeof===G)return Bt(nt,ul(nt,Ge),ct);Ap(nt,Ge)}return null}function vt(nt,Ge,ct,Ft){var mn=Ge!==null?Ge.key:null;if(typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint")return mn!==null?null:ae(nt,Ge,""+ct,Ft);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case _:return ct.key===mn?Oe(nt,Ge,ct,Ft):null;case b:return ct.key===mn?ft(nt,Ge,ct,Ft):null;case R:return mn=ct._init,ct=mn(ct._payload),vt(nt,Ge,ct,Ft)}if(ie(ct)||O(ct))return mn!==null?null:Rt(nt,Ge,ct,Ft,null);if(typeof ct.then=="function")return vt(nt,Ge,Lp(ct),Ft);if(ct.$$typeof===G)return vt(nt,Ge,ul(nt,ct),Ft);Ap(nt,ct)}return null}function wt(nt,Ge,ct,Ft,mn){if(typeof Ft=="string"&&Ft!==""||typeof Ft=="number"||typeof Ft=="bigint")return nt=nt.get(ct)||null,ae(Ge,nt,""+Ft,mn);if(typeof Ft=="object"&&Ft!==null){switch(Ft.$$typeof){case _:return nt=nt.get(Ft.key===null?ct:Ft.key)||null,Oe(Ge,nt,Ft,mn);case b:return nt=nt.get(Ft.key===null?ct:Ft.key)||null,ft(Ge,nt,Ft,mn);case R:var Zn=Ft._init;return Ft=Zn(Ft._payload),wt(nt,Ge,ct,Ft,mn)}if(ie(Ft)||O(Ft))return nt=nt.get(ct)||null,Rt(Ge,nt,Ft,mn,null);if(typeof Ft.then=="function")return wt(nt,Ge,ct,Lp(Ft),mn);if(Ft.$$typeof===G)return wt(nt,Ge,ct,ul(Ge,Ft),mn);Ap(Ge,Ft)}return null}function On(nt,Ge,ct,Ft){for(var mn=null,Zn=null,bn=Ge,Cn=Ge=0,mo=null;bn!==null&&Cn<ct.length;Cn++){bn.index>Cn?(mo=bn,bn=null):mo=bn.sibling;var vi=vt(nt,bn,ct[Cn],Ft);if(vi===null){bn===null&&(bn=mo);break}r&&bn&&vi.alternate===null&&a(nt,bn),Ge=S(vi,Ge,Cn),Zn===null?mn=vi:Zn.sibling=vi,Zn=vi,bn=mo}if(Cn===ct.length)return h(nt,bn),yi&&Ul(nt,Cn),mn;if(bn===null){for(;Cn<ct.length;Cn++)bn=Bt(nt,ct[Cn],Ft),bn!==null&&(Ge=S(bn,Ge,Cn),Zn===null?mn=bn:Zn.sibling=bn,Zn=bn);return yi&&Ul(nt,Cn),mn}for(bn=m(bn);Cn<ct.length;Cn++)mo=wt(bn,nt,Cn,ct[Cn],Ft),mo!==null&&(r&&mo.alternate!==null&&bn.delete(mo.key===null?Cn:mo.key),Ge=S(mo,Ge,Cn),Zn===null?mn=mo:Zn.sibling=mo,Zn=mo);return r&&bn.forEach(function(qc){return a(nt,qc)}),yi&&Ul(nt,Cn),mn}function En(nt,Ge,ct,Ft){if(ct==null)throw Error(i(151));for(var mn=null,Zn=null,bn=Ge,Cn=Ge=0,mo=null,vi=ct.next();bn!==null&&!vi.done;Cn++,vi=ct.next()){bn.index>Cn?(mo=bn,bn=null):mo=bn.sibling;var qc=vt(nt,bn,vi.value,Ft);if(qc===null){bn===null&&(bn=mo);break}r&&bn&&qc.alternate===null&&a(nt,bn),Ge=S(qc,Ge,Cn),Zn===null?mn=qc:Zn.sibling=qc,Zn=qc,bn=mo}if(vi.done)return h(nt,bn),yi&&Ul(nt,Cn),mn;if(bn===null){for(;!vi.done;Cn++,vi=ct.next())vi=Bt(nt,vi.value,Ft),vi!==null&&(Ge=S(vi,Ge,Cn),Zn===null?mn=vi:Zn.sibling=vi,Zn=vi);return yi&&Ul(nt,Cn),mn}for(bn=m(bn);!vi.done;Cn++,vi=ct.next())vi=wt(bn,nt,Cn,vi.value,Ft),vi!==null&&(r&&vi.alternate!==null&&bn.delete(vi.key===null?Cn:vi.key),Ge=S(vi,Ge,Cn),Zn===null?mn=vi:Zn.sibling=vi,Zn=vi);return r&&bn.forEach(function(iL){return a(nt,iL)}),yi&&Ul(nt,Cn),mn}function Ii(nt,Ge,ct,Ft){if(typeof ct=="object"&&ct!==null&&ct.type===T&&ct.key===null&&(ct=ct.props.children),typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case _:e:{for(var mn=ct.key;Ge!==null;){if(Ge.key===mn){if(mn=ct.type,mn===T){if(Ge.tag===7){h(nt,Ge.sibling),Ft=w(Ge,ct.props.children),Ft.return=nt,nt=Ft;break e}}else if(Ge.elementType===mn||typeof mn=="object"&&mn!==null&&mn.$$typeof===R&&Gb(mn)===Ge.type){h(nt,Ge.sibling),Ft=w(Ge,ct.props),pf(Ft,ct),Ft.return=nt,nt=Ft;break e}h(nt,Ge);break}else a(nt,Ge);Ge=Ge.sibling}ct.type===T?(Ft=Ca(ct.props.children,nt.mode,Ft,ct.key),Ft.return=nt,nt=Ft):(Ft=Il(ct.type,ct.key,ct.props,null,nt.mode,Ft),pf(Ft,ct),Ft.return=nt,nt=Ft)}return H(nt);case b:e:{for(mn=ct.key;Ge!==null;){if(Ge.key===mn)if(Ge.tag===4&&Ge.stateNode.containerInfo===ct.containerInfo&&Ge.stateNode.implementation===ct.implementation){h(nt,Ge.sibling),Ft=w(Ge,ct.children||[]),Ft.return=nt,nt=Ft;break e}else{h(nt,Ge);break}else a(nt,Ge);Ge=Ge.sibling}Ft=Tu(ct,nt.mode,Ft),Ft.return=nt,nt=Ft}return H(nt);case R:return mn=ct._init,ct=mn(ct._payload),Ii(nt,Ge,ct,Ft)}if(ie(ct))return On(nt,Ge,ct,Ft);if(O(ct)){if(mn=O(ct),typeof mn!="function")throw Error(i(150));return ct=mn.call(ct),En(nt,Ge,ct,Ft)}if(typeof ct.then=="function")return Ii(nt,Ge,Lp(ct),Ft);if(ct.$$typeof===G)return Ii(nt,Ge,ul(nt,ct),Ft);Ap(nt,ct)}return typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint"?(ct=""+ct,Ge!==null&&Ge.tag===6?(h(nt,Ge.sibling),Ft=w(Ge,ct),Ft.return=nt,nt=Ft):(h(nt,Ge),Ft=Od(ct,nt.mode,Ft),Ft.return=nt,nt=Ft),H(nt)):h(nt,Ge)}return function(nt,Ge,ct,Ft){try{mf=0;var mn=Ii(nt,Ge,ct,Ft);return Wd=null,mn}catch(bn){if(bn===ne||bn===ue)throw bn;var Zn=co(29,bn,null,nt.mode);return Zn.lanes=Ft,Zn.return=nt,Zn}finally{}}}var zd=Kb(!0),Xb=Kb(!1),ha=te(null),dl=null;function Ac(r){var a=r.alternate;U(Zs,Zs.current&1),U(ha,r),dl===null&&(a===null||Dn.current!==null||a.memoizedState!==null)&&(dl=r)}function Qb(r){if(r.tag===22){if(U(Zs,Zs.current),U(ha,r),dl===null){var a=r.alternate;a!==null&&a.memoizedState!==null&&(dl=r)}}else Dc()}function Dc(){U(Zs,Zs.current),U(ha,ha.current)}function zl(r){j(ha),dl===r&&(dl=null),j(Zs)}var Zs=te(0);function Dp(r){for(var a=r;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||iy(h)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function m1(r,a,h,m){a=r.memoizedState,h=h(m,a),h=h==null?a:p({},a,h),r.memoizedState=h,r.lanes===0&&(r.updateQueue.baseState=h)}var p1={enqueueSetState:function(r,a,h){r=r._reactInternals;var m=$r(),w=Ot(m);w.payload=a,h!=null&&(w.callback=h),a=zt(r,w,m),a!==null&&(Br(a,r,m),$t(a,r,m))},enqueueReplaceState:function(r,a,h){r=r._reactInternals;var m=$r(),w=Ot(m);w.tag=1,w.payload=a,h!=null&&(w.callback=h),a=zt(r,w,m),a!==null&&(Br(a,r,m),$t(a,r,m))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var h=$r(),m=Ot(h);m.tag=2,a!=null&&(m.callback=a),a=zt(r,m,h),a!==null&&(Br(a,r,h),$t(a,r,h))}};function Zb(r,a,h,m,w,S,H){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(m,S,H):a.prototype&&a.prototype.isPureReactComponent?!ta(h,m)||!ta(w,S):!0}function Jb(r,a,h,m){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,m),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,m),a.state!==r&&p1.enqueueReplaceState(a,a.state,null)}function Fu(r,a){var h=a;if("ref"in a){h={};for(var m in a)m!=="ref"&&(h[m]=a[m])}if(r=r.defaultProps){h===a&&(h=p({},h));for(var w in r)h[w]===void 0&&(h[w]=r[w])}return h}var Op=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function ew(r){Op(r)}function tw(r){console.error(r)}function nw(r){Op(r)}function jp(r,a){try{var h=r.onUncaughtError;h(a.value,{componentStack:a.stack})}catch(m){setTimeout(function(){throw m})}}function iw(r,a,h){try{var m=r.onCaughtError;m(h.value,{componentStack:h.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function g1(r,a,h){return h=Ot(h),h.tag=3,h.payload={element:null},h.callback=function(){jp(r,a)},h}function sw(r){return r=Ot(r),r.tag=3,r}function ow(r,a,h,m){var w=h.type.getDerivedStateFromError;if(typeof w=="function"){var S=m.value;r.payload=function(){return w(S)},r.callback=function(){iw(a,h,m)}}var H=h.stateNode;H!==null&&typeof H.componentDidCatch=="function"&&(r.callback=function(){iw(a,h,m),typeof w!="function"&&(Pc===null?Pc=new Set([this]):Pc.add(this));var ae=m.stack;this.componentDidCatch(m.value,{componentStack:ae!==null?ae:""})})}function ik(r,a,h,m,w){if(h.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(a=h.alternate,a!==null&&Ec(a,h,w,!0),h=ha.current,h!==null){switch(h.tag){case 13:return dl===null?$1():h.alternate===null&&Ns===0&&(Ns=3),h.flags&=-257,h.flags|=65536,h.lanes=w,m===ge?h.flags|=16384:(a=h.updateQueue,a===null?h.updateQueue=new Set([m]):a.add(m),W1(r,m,w)),!1;case 22:return h.flags|=65536,m===ge?h.flags|=16384:(a=h.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([m])},h.updateQueue=a):(h=a.retryQueue,h===null?a.retryQueue=new Set([m]):h.add(m)),W1(r,m,w)),!1}throw Error(i(435,h.tag))}return W1(r,m,w),$1(),!1}if(yi)return a=ha.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=w,m!==Zh&&(r=Error(i(422),{cause:m}),Nc(er(r,h)))):(m!==Zh&&(a=Error(i(423),{cause:m}),Nc(er(a,h))),r=r.current.alternate,r.flags|=65536,w&=-w,r.lanes|=w,m=er(m,h),w=g1(r.stateNode,m,w),gn(r,w),Ns!==4&&(Ns=2)),!1;var S=Error(i(520),{cause:m});if(S=er(S,h),xf===null?xf=[S]:xf.push(S),Ns!==4&&(Ns=2),a===null)return!0;m=er(m,h),h=a;do{switch(h.tag){case 3:return h.flags|=65536,r=w&-w,h.lanes|=r,r=g1(h.stateNode,m,r),gn(h,r),!1;case 1:if(a=h.type,S=h.stateNode,(h.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Pc===null||!Pc.has(S))))return h.flags|=65536,w&=-w,h.lanes|=w,w=sw(w),ow(w,r,h,m),gn(h,w),!1}h=h.return}while(h!==null);return!1}var rw=Error(i(461)),ho=!1;function Lo(r,a,h,m){a.child=r===null?Xb(a,null,h,m):zd(a,r.child,h,m)}function aw(r,a,h,m,w){h=h.render;var S=a.ref;if("ref"in m){var H={};for(var ae in m)ae!=="ref"&&(H[ae]=m[ae])}else H=m;return ca(a),m=sr(r,a,h,H,S,w),ae=ys(),r!==null&&!ho?(Co(r,a,w),Hl(r,a,w)):(yi&&ae&&Cu(a),a.flags|=1,Lo(r,a,m,w),a.child)}function lw(r,a,h,m,w){if(r===null){var S=h.type;return typeof S=="function"&&!xc(S)&&S.defaultProps===void 0&&h.compare===null?(a.tag=15,a.type=S,cw(r,a,S,m,w)):(r=Il(h.type,null,m,a,a.mode,w),r.ref=a.ref,r.return=a,a.child=r)}if(S=r.child,!N1(r,w)){var H=S.memoizedProps;if(h=h.compare,h=h!==null?h:ta,h(H,m)&&r.ref===a.ref)return Hl(r,a,w)}return a.flags|=1,r=oa(S,m),r.ref=a.ref,r.return=a,a.child=r}function cw(r,a,h,m,w){if(r!==null){var S=r.memoizedProps;if(ta(S,m)&&r.ref===a.ref)if(ho=!1,a.pendingProps=m=S,N1(r,w))(r.flags&131072)!==0&&(ho=!0);else return a.lanes=r.lanes,Hl(r,a,w)}return y1(r,a,h,m,w)}function uw(r,a,h){var m=a.pendingProps,w=m.children,S=r!==null?r.memoizedState:null;if(m.mode==="hidden"){if((a.flags&128)!==0){if(m=S!==null?S.baseLanes|h:h,r!==null){for(w=a.child=r.child,S=0;w!==null;)S=S|w.lanes|w.childLanes,w=w.sibling;a.childLanes=S&~m}else a.childLanes=0,a.child=null;return dw(r,a,m,h)}if((h&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&P(a,S!==null?S.cachePool:null),S!==null?Jt(a,S):Zi(),Qb(a);else return a.lanes=a.childLanes=536870912,dw(r,a,S!==null?S.baseLanes|h:h,h)}else S!==null?(P(a,S.cachePool),Jt(a,S),Dc(),a.memoizedState=null):(r!==null&&P(a,null),Zi(),Dc());return Lo(r,a,w,h),a.child}function dw(r,a,h,m){var w=k();return w=w===null?null:{parent:Ds._currentValue,pool:w},a.memoizedState={baseLanes:h,cachePool:w},r!==null&&P(a,null),Zi(),Qb(a),r!==null&&Ec(r,a,m,!0),null}function Mp(r,a){var h=a.ref;if(h===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(i(284));(r===null||r.ref!==h)&&(a.flags|=4194816)}}function y1(r,a,h,m,w){return ca(a),h=sr(r,a,h,m,void 0,w),m=ys(),r!==null&&!ho?(Co(r,a,w),Hl(r,a,w)):(yi&&m&&Cu(a),a.flags|=1,Lo(r,a,h,w),a.child)}function hw(r,a,h,m,w,S){return ca(a),a.updateQueue=null,h=To(a,m,h,w),us(r),m=ys(),r!==null&&!ho?(Co(r,a,S),Hl(r,a,S)):(yi&&m&&Cu(a),a.flags|=1,Lo(r,a,h,S),a.child)}function fw(r,a,h,m,w){if(ca(a),a.stateNode===null){var S=Ws,H=h.contextType;typeof H=="object"&&H!==null&&(S=As(H)),S=new h(m,S),a.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=p1,a.stateNode=S,S._reactInternals=a,S=a.stateNode,S.props=m,S.state=a.memoizedState,S.refs={},ut(a),H=h.contextType,S.context=typeof H=="object"&&H!==null?As(H):Ws,S.state=a.memoizedState,H=h.getDerivedStateFromProps,typeof H=="function"&&(m1(a,h,H,m),S.state=a.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(H=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),H!==S.state&&p1.enqueueReplaceState(S,S.state,null),ln(a,m,S,w),jn(),S.state=a.memoizedState),typeof S.componentDidMount=="function"&&(a.flags|=4194308),m=!0}else if(r===null){S=a.stateNode;var ae=a.memoizedProps,Oe=Fu(h,ae);S.props=Oe;var ft=S.context,Rt=h.contextType;H=Ws,typeof Rt=="object"&&Rt!==null&&(H=As(Rt));var Bt=h.getDerivedStateFromProps;Rt=typeof Bt=="function"||typeof S.getSnapshotBeforeUpdate=="function",ae=a.pendingProps!==ae,Rt||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(ae||ft!==H)&&Jb(a,S,m,H),kt=!1;var vt=a.memoizedState;S.state=vt,ln(a,m,S,w),jn(),ft=a.memoizedState,ae||vt!==ft||kt?(typeof Bt=="function"&&(m1(a,h,Bt,m),ft=a.memoizedState),(Oe=kt||Zb(a,h,Oe,m,vt,ft,H))?(Rt||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=m,a.memoizedState=ft),S.props=m,S.state=ft,S.context=H,m=Oe):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),m=!1)}else{S=a.stateNode,jt(r,a),H=a.memoizedProps,Rt=Fu(h,H),S.props=Rt,Bt=a.pendingProps,vt=S.context,ft=h.contextType,Oe=Ws,typeof ft=="object"&&ft!==null&&(Oe=As(ft)),ae=h.getDerivedStateFromProps,(ft=typeof ae=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(H!==Bt||vt!==Oe)&&Jb(a,S,m,Oe),kt=!1,vt=a.memoizedState,S.state=vt,ln(a,m,S,w),jn();var wt=a.memoizedState;H!==Bt||vt!==wt||kt||r!==null&&r.dependencies!==null&&Id(r.dependencies)?(typeof ae=="function"&&(m1(a,h,ae,m),wt=a.memoizedState),(Rt=kt||Zb(a,h,Rt,m,vt,wt,Oe)||r!==null&&r.dependencies!==null&&Id(r.dependencies))?(ft||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(m,wt,Oe),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(m,wt,Oe)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||H===r.memoizedProps&&vt===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||H===r.memoizedProps&&vt===r.memoizedState||(a.flags|=1024),a.memoizedProps=m,a.memoizedState=wt),S.props=m,S.state=wt,S.context=Oe,m=Rt):(typeof S.componentDidUpdate!="function"||H===r.memoizedProps&&vt===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||H===r.memoizedProps&&vt===r.memoizedState||(a.flags|=1024),m=!1)}return S=m,Mp(r,a),m=(a.flags&128)!==0,S||m?(S=a.stateNode,h=m&&typeof h.getDerivedStateFromError!="function"?null:S.render(),a.flags|=1,r!==null&&m?(a.child=zd(a,r.child,null,w),a.child=zd(a,null,h,w)):Lo(r,a,h,w),a.memoizedState=S.state,r=a.child):r=Hl(r,a,w),r}function mw(r,a,h,m){return ir(),a.flags|=256,Lo(r,a,h,m),a.child}var v1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function b1(r){return{baseLanes:r,cachePool:J()}}function w1(r,a,h){return r=r!==null?r.childLanes&~h:0,a&&(r|=fa),r}function pw(r,a,h){var m=a.pendingProps,w=!1,S=(a.flags&128)!==0,H;if((H=S)||(H=r!==null&&r.memoizedState===null?!1:(Zs.current&2)!==0),H&&(w=!0,a.flags&=-129),H=(a.flags&32)!==0,a.flags&=-33,r===null){if(yi){if(w?Ac(a):Dc(),yi){var ae=as,Oe;if(Oe=ae){e:{for(Oe=ae,ae=ra;Oe.nodeType!==8;){if(!ae){ae=null;break e}if(Oe=Fa(Oe.nextSibling),Oe===null){ae=null;break e}}ae=Oe}ae!==null?(a.memoizedState={dehydrated:ae,treeContext:Pl!==null?{id:La,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},Oe=co(18,null,null,0),Oe.stateNode=ae,Oe.return=a,a.child=Oe,Ls=a,as=null,Oe=!0):Oe=!1}Oe||Fl(a)}if(ae=a.memoizedState,ae!==null&&(ae=ae.dehydrated,ae!==null))return iy(ae)?a.lanes=32:a.lanes=536870912,null;zl(a)}return ae=m.children,m=m.fallback,w?(Dc(),w=a.mode,ae=Rp({mode:"hidden",children:ae},w),m=Ca(m,w,h,null),ae.return=a,m.return=a,ae.sibling=m,a.child=ae,w=a.child,w.memoizedState=b1(h),w.childLanes=w1(r,H,h),a.memoizedState=v1,m):(Ac(a),_1(a,ae))}if(Oe=r.memoizedState,Oe!==null&&(ae=Oe.dehydrated,ae!==null)){if(S)a.flags&256?(Ac(a),a.flags&=-257,a=x1(r,a,h)):a.memoizedState!==null?(Dc(),a.child=r.child,a.flags|=128,a=null):(Dc(),w=m.fallback,ae=a.mode,m=Rp({mode:"visible",children:m.children},ae),w=Ca(w,ae,h,null),w.flags|=2,m.return=a,w.return=a,m.sibling=w,a.child=m,zd(a,r.child,null,h),m=a.child,m.memoizedState=b1(h),m.childLanes=w1(r,H,h),a.memoizedState=v1,a=w);else if(Ac(a),iy(ae)){if(H=ae.nextSibling&&ae.nextSibling.dataset,H)var ft=H.dgst;H=ft,m=Error(i(419)),m.stack="",m.digest=H,Nc({value:m,source:null,stack:null}),a=x1(r,a,h)}else if(ho||Ec(r,a,h,!1),H=(h&r.childLanes)!==0,ho||H){if(H=Yi,H!==null&&(m=h&-h,m=(m&42)!==0?1:on(m),m=(m&(H.suspendedLanes|h))!==0?0:m,m!==0&&m!==Oe.retryLane))throw Oe.retryLane=m,Ml(r,m),Br(H,r,m),rw;ae.data==="$?"||$1(),a=x1(r,a,h)}else ae.data==="$?"?(a.flags|=192,a.child=r.child,a=null):(r=Oe.treeContext,as=Fa(ae.nextSibling),Ls=a,yi=!0,ll=null,ra=!1,r!==null&&(wr[nr++]=La,wr[nr++]=Aa,wr[nr++]=Pl,La=r.id,Aa=r.overflow,Pl=a),a=_1(a,m.children),a.flags|=4096);return a}return w?(Dc(),w=m.fallback,ae=a.mode,Oe=r.child,ft=Oe.sibling,m=oa(Oe,{mode:"hidden",children:m.children}),m.subtreeFlags=Oe.subtreeFlags&65011712,ft!==null?w=oa(ft,w):(w=Ca(w,ae,h,null),w.flags|=2),w.return=a,m.return=a,m.sibling=w,a.child=m,m=w,w=a.child,ae=r.child.memoizedState,ae===null?ae=b1(h):(Oe=ae.cachePool,Oe!==null?(ft=Ds._currentValue,Oe=Oe.parent!==ft?{parent:ft,pool:ft}:Oe):Oe=J(),ae={baseLanes:ae.baseLanes|h,cachePool:Oe}),w.memoizedState=ae,w.childLanes=w1(r,H,h),a.memoizedState=v1,m):(Ac(a),h=r.child,r=h.sibling,h=oa(h,{mode:"visible",children:m.children}),h.return=a,h.sibling=null,r!==null&&(H=a.deletions,H===null?(a.deletions=[r],a.flags|=16):H.push(r)),a.child=h,a.memoizedState=null,h)}function _1(r,a){return a=Rp({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function Rp(r,a){return r=co(22,r,null,a),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function x1(r,a,h){return zd(a,r.child,null,h),r=_1(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function gw(r,a,h){r.lanes|=a;var m=r.alternate;m!==null&&(m.lanes|=a),Md(r.return,a,h)}function S1(r,a,h,m,w){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:m,tail:h,tailMode:w}:(S.isBackwards=a,S.rendering=null,S.renderingStartTime=0,S.last=m,S.tail=h,S.tailMode=w)}function yw(r,a,h){var m=a.pendingProps,w=m.revealOrder,S=m.tail;if(Lo(r,a,m.children,h),m=Zs.current,(m&2)!==0)m=m&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&gw(r,h,a);else if(r.tag===19)gw(r,h,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}m&=1}switch(U(Zs,m),w){case"forwards":for(h=a.child,w=null;h!==null;)r=h.alternate,r!==null&&Dp(r)===null&&(w=h),h=h.sibling;h=w,h===null?(w=a.child,a.child=null):(w=h.sibling,h.sibling=null),S1(a,!1,w,h,S);break;case"backwards":for(h=null,w=a.child,a.child=null;w!==null;){if(r=w.alternate,r!==null&&Dp(r)===null){a.child=w;break}r=w.sibling,w.sibling=h,h=w,w=r}S1(a,!0,h,null,S);break;case"together":S1(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Hl(r,a,h){if(r!==null&&(a.dependencies=r.dependencies),Ic|=a.lanes,(h&a.childLanes)===0)if(r!==null){if(Ec(r,a,h,!1),(h&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(i(153));if(a.child!==null){for(r=a.child,h=oa(r,r.pendingProps),a.child=h,h.return=a;r.sibling!==null;)r=r.sibling,h=h.sibling=oa(r,r.pendingProps),h.return=a;h.sibling=null}return a.child}function N1(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&Id(r)))}function sk(r,a,h){switch(a.tag){case 3:Ae(a,a.stateNode.containerInfo),cl(a,Ds,r.memoizedState.cache),ir();break;case 27:case 5:Be(a);break;case 4:Ae(a,a.stateNode.containerInfo);break;case 10:cl(a,a.type,a.memoizedProps.value);break;case 13:var m=a.memoizedState;if(m!==null)return m.dehydrated!==null?(Ac(a),a.flags|=128,null):(h&a.child.childLanes)!==0?pw(r,a,h):(Ac(a),r=Hl(r,a,h),r!==null?r.sibling:null);Ac(a);break;case 19:var w=(r.flags&128)!==0;if(m=(h&a.childLanes)!==0,m||(Ec(r,a,h,!1),m=(h&a.childLanes)!==0),w){if(m)return yw(r,a,h);a.flags|=128}if(w=a.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),U(Zs,Zs.current),m)break;return null;case 22:case 23:return a.lanes=0,uw(r,a,h);case 24:cl(a,Ds,r.memoizedState.cache)}return Hl(r,a,h)}function vw(r,a,h){if(r!==null)if(r.memoizedProps!==a.pendingProps)ho=!0;else{if(!N1(r,h)&&(a.flags&128)===0)return ho=!1,sk(r,a,h);ho=(r.flags&131072)!==0}else ho=!1,yi&&(a.flags&1048576)!==0&&dp(a,jd,a.index);switch(a.lanes=0,a.tag){case 16:e:{r=a.pendingProps;var m=a.elementType,w=m._init;if(m=w(m._payload),a.type=m,typeof m=="function")xc(m)?(r=Fu(m,r),a.tag=1,a=fw(null,a,m,r,h)):(a.tag=0,a=y1(null,a,m,r,h));else{if(m!=null){if(w=m.$$typeof,w===K){a.tag=11,a=aw(null,a,m,r,h);break e}else if(w===z){a.tag=14,a=lw(null,a,m,r,h);break e}}throw a=Y(m)||m,Error(i(306,a,""))}}return a;case 0:return y1(r,a,a.type,a.pendingProps,h);case 1:return m=a.type,w=Fu(m,a.pendingProps),fw(r,a,m,w,h);case 3:e:{if(Ae(a,a.stateNode.containerInfo),r===null)throw Error(i(387));m=a.pendingProps;var S=a.memoizedState;w=S.element,jt(r,a),ln(a,m,null,h);var H=a.memoizedState;if(m=H.cache,cl(a,Ds,m),m!==S.cache&&Rd(a,[Ds],h,!0),jn(),m=H.element,S.isDehydrated)if(S={element:m,isDehydrated:!1,cache:H.cache},a.updateQueue.baseState=S,a.memoizedState=S,a.flags&256){a=mw(r,a,m,h);break e}else if(m!==w){w=er(Error(i(424)),a),Nc(w),a=mw(r,a,m,h);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(as=Fa(r.firstChild),Ls=a,yi=!0,ll=null,ra=!0,h=Xb(a,null,m,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(ir(),m===w){a=Hl(r,a,h);break e}Lo(r,a,m,h)}a=a.child}return a;case 26:return Mp(r,a),r===null?(h=x_(a.type,null,a.pendingProps,null))?a.memoizedState=h:yi||(h=a.type,r=a.pendingProps,m=Kp(Q.current).createElement(h),m[dt]=a,m[ve]=r,Do(m,h,r),ke(m),a.stateNode=m):a.memoizedState=x_(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return Be(a),r===null&&yi&&(m=a.stateNode=b_(a.type,a.pendingProps,Q.current),Ls=a,ra=!0,w=as,$c(a.type)?(sy=w,as=Fa(m.firstChild)):as=w),Lo(r,a,a.pendingProps.children,h),Mp(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&yi&&((w=m=as)&&(m=Ok(m,a.type,a.pendingProps,ra),m!==null?(a.stateNode=m,Ls=a,as=Fa(m.firstChild),ra=!1,w=!0):w=!1),w||Fl(a)),Be(a),w=a.type,S=a.pendingProps,H=r!==null?r.memoizedProps:null,m=S.children,ey(w,S)?m=null:H!==null&&ey(w,H)&&(a.flags|=32),a.memoizedState!==null&&(w=sr(r,a,Ci,null,null,h),Df._currentValue=w),Mp(r,a),Lo(r,a,m,h),a.child;case 6:return r===null&&yi&&((r=h=as)&&(h=jk(h,a.pendingProps,ra),h!==null?(a.stateNode=h,Ls=a,as=null,r=!0):r=!1),r||Fl(a)),null;case 13:return pw(r,a,h);case 4:return Ae(a,a.stateNode.containerInfo),m=a.pendingProps,r===null?a.child=zd(a,null,m,h):Lo(r,a,m,h),a.child;case 11:return aw(r,a,a.type,a.pendingProps,h);case 7:return Lo(r,a,a.pendingProps,h),a.child;case 8:return Lo(r,a,a.pendingProps.children,h),a.child;case 12:return Lo(r,a,a.pendingProps.children,h),a.child;case 10:return m=a.pendingProps,cl(a,a.type,m.value),Lo(r,a,m.children,h),a.child;case 9:return w=a.type._context,m=a.pendingProps.children,ca(a),w=As(w),m=m(w),a.flags|=1,Lo(r,a,m,h),a.child;case 14:return lw(r,a,a.type,a.pendingProps,h);case 15:return cw(r,a,a.type,a.pendingProps,h);case 19:return yw(r,a,h);case 31:return m=a.pendingProps,h=a.mode,m={mode:m.mode,children:m.children},r===null?(h=Rp(m,h),h.ref=a.ref,a.child=h,h.return=a,a=h):(h=oa(r.child,m),h.ref=a.ref,a.child=h,h.return=a,a=h),a;case 22:return uw(r,a,h);case 24:return ca(a),m=As(Ds),r===null?(w=k(),w===null&&(w=Yi,S=Jh(),w.pooledCache=S,S.refCount++,S!==null&&(w.pooledCacheLanes|=h),w=S),a.memoizedState={parent:m,cache:w},ut(a),cl(a,Ds,w)):((r.lanes&h)!==0&&(jt(r,a),ln(a,null,null,h),jn()),w=r.memoizedState,S=a.memoizedState,w.parent!==m?(w={parent:m,cache:m},a.memoizedState=w,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=w),cl(a,Ds,m)):(m=S.cache,cl(a,Ds,m),m!==w.cache&&Rd(a,[Ds],h,!0))),Lo(r,a,a.pendingProps.children,h),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function ql(r){r.flags|=4}function bw(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!C_(a)){if(a=ha.current,a!==null&&((ui&4194048)===ui?dl!==null:(ui&62914560)!==ui&&(ui&536870912)===0||a!==dl))throw we=ge,oe;r.flags|=8192}}function Ip(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?tn():536870912,r.lanes|=a,Yd|=a)}function gf(r,a){if(!yi)switch(r.tailMode){case"hidden":a=r.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?r.tail=null:h.sibling=null;break;case"collapsed":h=r.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:m.sibling=null}}function vs(r){var a=r.alternate!==null&&r.alternate.child===r.child,h=0,m=0;if(a)for(var w=r.child;w!==null;)h|=w.lanes|w.childLanes,m|=w.subtreeFlags&65011712,m|=w.flags&65011712,w.return=r,w=w.sibling;else for(w=r.child;w!==null;)h|=w.lanes|w.childLanes,m|=w.subtreeFlags,m|=w.flags,w.return=r,w=w.sibling;return r.subtreeFlags|=m,r.childLanes=h,a}function ok(r,a,h){var m=a.pendingProps;switch(ku(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vs(a),null;case 1:return vs(a),null;case 3:return h=a.stateNode,m=null,r!==null&&(m=r.memoizedState.cache),a.memoizedState.cache!==m&&(a.flags|=2048),la(Ds),De(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Eo(a)?ql(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,fp())),vs(a),null;case 26:return h=a.memoizedState,r===null?(ql(a),h!==null?(vs(a),bw(a,h)):(vs(a),a.flags&=-16777217)):h?h!==r.memoizedState?(ql(a),vs(a),bw(a,h)):(vs(a),a.flags&=-16777217):(r.memoizedProps!==m&&ql(a),vs(a),a.flags&=-16777217),null;case 27:Fe(a),h=Q.current;var w=a.type;if(r!==null&&a.stateNode!=null)r.memoizedProps!==m&&ql(a);else{if(!m){if(a.stateNode===null)throw Error(i(166));return vs(a),null}r=$.current,Eo(a)?hp(a):(r=b_(w,m,h),a.stateNode=r,ql(a))}return vs(a),null;case 5:if(Fe(a),h=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==m&&ql(a);else{if(!m){if(a.stateNode===null)throw Error(i(166));return vs(a),null}if(r=$.current,Eo(a))hp(a);else{switch(w=Kp(Q.current),r){case 1:r=w.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:r=w.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":r=w.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":r=w.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":r=w.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof m.is=="string"?w.createElement("select",{is:m.is}):w.createElement("select"),m.multiple?r.multiple=!0:m.size&&(r.size=m.size);break;default:r=typeof m.is=="string"?w.createElement(h,{is:m.is}):w.createElement(h)}}r[dt]=a,r[ve]=m;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)r.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=r;e:switch(Do(r,h,m),h){case"button":case"input":case"select":case"textarea":r=!!m.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&ql(a)}}return vs(a),a.flags&=-16777217,null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==m&&ql(a);else{if(typeof m!="string"&&a.stateNode===null)throw Error(i(166));if(r=Q.current,Eo(a)){if(r=a.stateNode,h=a.memoizedProps,m=null,w=Ls,w!==null)switch(w.tag){case 27:case 5:m=w.memoizedProps}r[dt]=a,r=!!(r.nodeValue===h||m!==null&&m.suppressHydrationWarning===!0||h_(r.nodeValue,h)),r||Fl(a)}else r=Kp(r).createTextNode(m),r[dt]=a,a.stateNode=r}return vs(a),null;case 13:if(m=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(w=Eo(a),m!==null&&m.dehydrated!==null){if(r===null){if(!w)throw Error(i(318));if(w=a.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(i(317));w[dt]=a}else ir(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;vs(a),w=!1}else w=fp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=w),w=!0;if(!w)return a.flags&256?(zl(a),a):(zl(a),null)}if(zl(a),(a.flags&128)!==0)return a.lanes=h,a;if(h=m!==null,r=r!==null&&r.memoizedState!==null,h){m=a.child,w=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(w=m.alternate.memoizedState.cachePool.pool);var S=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(S=m.memoizedState.cachePool.pool),S!==w&&(m.flags|=2048)}return h!==r&&h&&(a.child.flags|=8192),Ip(a,a.updateQueue),vs(a),null;case 4:return De(),r===null&&K1(a.stateNode.containerInfo),vs(a),null;case 10:return la(a.type),vs(a),null;case 19:if(j(Zs),w=a.memoizedState,w===null)return vs(a),null;if(m=(a.flags&128)!==0,S=w.rendering,S===null)if(m)gf(w,!1);else{if(Ns!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(S=Dp(r),S!==null){for(a.flags|=128,gf(w,!1),r=S.updateQueue,a.updateQueue=r,Ip(a,r),a.subtreeFlags=0,r=h,h=a.child;h!==null;)Eu(h,r),h=h.sibling;return U(Zs,Zs.current&1|2),a.child}r=r.sibling}w.tail!==null&&Ne()>Fp&&(a.flags|=128,m=!0,gf(w,!1),a.lanes=4194304)}else{if(!m)if(r=Dp(S),r!==null){if(a.flags|=128,m=!0,r=r.updateQueue,a.updateQueue=r,Ip(a,r),gf(w,!0),w.tail===null&&w.tailMode==="hidden"&&!S.alternate&&!yi)return vs(a),null}else 2*Ne()-w.renderingStartTime>Fp&&h!==536870912&&(a.flags|=128,m=!0,gf(w,!1),a.lanes=4194304);w.isBackwards?(S.sibling=a.child,a.child=S):(r=w.last,r!==null?r.sibling=S:a.child=S,w.last=S)}return w.tail!==null?(a=w.tail,w.rendering=a,w.tail=a.sibling,w.renderingStartTime=Ne(),a.sibling=null,r=Zs.current,U(Zs,m?r&1|2:r&1),a):(vs(a),null);case 22:case 23:return zl(a),Mn(),m=a.memoizedState!==null,r!==null?r.memoizedState!==null!==m&&(a.flags|=8192):m&&(a.flags|=8192),m?(h&536870912)!==0&&(a.flags&128)===0&&(vs(a),a.subtreeFlags&6&&(a.flags|=8192)):vs(a),h=a.updateQueue,h!==null&&Ip(a,h.retryQueue),h=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),m=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(m=a.memoizedState.cachePool.pool),m!==h&&(a.flags|=2048),r!==null&&j(x),null;case 24:return h=null,r!==null&&(h=r.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),la(Ds),vs(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function rk(r,a){switch(ku(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return la(Ds),De(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return Fe(a),null;case 13:if(zl(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(i(340));ir()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return j(Zs),null;case 4:return De(),null;case 10:return la(a.type),null;case 22:case 23:return zl(a),Mn(),r!==null&&j(x),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return la(Ds),null;case 25:return null;default:return null}}function ww(r,a){switch(ku(a),a.tag){case 3:la(Ds),De();break;case 26:case 27:case 5:Fe(a);break;case 4:De();break;case 13:zl(a);break;case 19:j(Zs);break;case 10:la(a.type);break;case 22:case 23:zl(a),Mn(),r!==null&&j(x);break;case 24:la(Ds)}}function yf(r,a){try{var h=a.updateQueue,m=h!==null?h.lastEffect:null;if(m!==null){var w=m.next;h=w;do{if((h.tag&r)===r){m=void 0;var S=h.create,H=h.inst;m=S(),H.destroy=m}h=h.next}while(h!==w)}}catch(ae){Wi(a,a.return,ae)}}function Oc(r,a,h){try{var m=a.updateQueue,w=m!==null?m.lastEffect:null;if(w!==null){var S=w.next;m=S;do{if((m.tag&r)===r){var H=m.inst,ae=H.destroy;if(ae!==void 0){H.destroy=void 0,w=a;var Oe=h,ft=ae;try{ft()}catch(Rt){Wi(w,Oe,Rt)}}}m=m.next}while(m!==S)}}catch(Rt){Wi(a,a.return,Rt)}}function _w(r){var a=r.updateQueue;if(a!==null){var h=r.stateNode;try{Ss(a,h)}catch(m){Wi(r,r.return,m)}}}function xw(r,a,h){h.props=Fu(r.type,r.memoizedProps),h.state=r.memoizedState;try{h.componentWillUnmount()}catch(m){Wi(r,a,m)}}function vf(r,a){try{var h=r.ref;if(h!==null){switch(r.tag){case 26:case 27:case 5:var m=r.stateNode;break;case 30:m=r.stateNode;break;default:m=r.stateNode}typeof h=="function"?r.refCleanup=h(m):h.current=m}}catch(w){Wi(r,a,w)}}function hl(r,a){var h=r.ref,m=r.refCleanup;if(h!==null)if(typeof m=="function")try{m()}catch(w){Wi(r,a,w)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(w){Wi(r,a,w)}else h.current=null}function Sw(r){var a=r.type,h=r.memoizedProps,m=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":h.autoFocus&&m.focus();break e;case"img":h.src?m.src=h.src:h.srcSet&&(m.srcset=h.srcSet)}}catch(w){Wi(r,r.return,w)}}function E1(r,a,h){try{var m=r.stateNode;Ck(m,r.type,h,a),m[ve]=a}catch(w){Wi(r,r.return,w)}}function Nw(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&$c(r.type)||r.tag===4}function T1(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Nw(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&$c(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function C1(r,a,h){var m=r.tag;if(m===5||m===6)r=r.stateNode,a?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(r,a):(a=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,a.appendChild(r),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Gp));else if(m!==4&&(m===27&&$c(r.type)&&(h=r.stateNode,a=null),r=r.child,r!==null))for(C1(r,a,h),r=r.sibling;r!==null;)C1(r,a,h),r=r.sibling}function Pp(r,a,h){var m=r.tag;if(m===5||m===6)r=r.stateNode,a?h.insertBefore(r,a):h.appendChild(r);else if(m!==4&&(m===27&&$c(r.type)&&(h=r.stateNode),r=r.child,r!==null))for(Pp(r,a,h),r=r.sibling;r!==null;)Pp(r,a,h),r=r.sibling}function Ew(r){var a=r.stateNode,h=r.memoizedProps;try{for(var m=r.type,w=a.attributes;w.length;)a.removeAttributeNode(w[0]);Do(a,m,h),a[dt]=r,a[ve]=h}catch(S){Wi(r,r.return,S)}}var Vl=!1,Rs=!1,k1=!1,Tw=typeof WeakSet=="function"?WeakSet:Set,fo=null;function ak(r,a){if(r=r.containerInfo,Z1=tg,r=wc(r),So(r)){if("selectionStart"in r)var h={start:r.selectionStart,end:r.selectionEnd};else e:{h=(h=r.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&m.rangeCount!==0){h=m.anchorNode;var w=m.anchorOffset,S=m.focusNode;m=m.focusOffset;try{h.nodeType,S.nodeType}catch{h=null;break e}var H=0,ae=-1,Oe=-1,ft=0,Rt=0,Bt=r,vt=null;t:for(;;){for(var wt;Bt!==h||w!==0&&Bt.nodeType!==3||(ae=H+w),Bt!==S||m!==0&&Bt.nodeType!==3||(Oe=H+m),Bt.nodeType===3&&(H+=Bt.nodeValue.length),(wt=Bt.firstChild)!==null;)vt=Bt,Bt=wt;for(;;){if(Bt===r)break t;if(vt===h&&++ft===w&&(ae=H),vt===S&&++Rt===m&&(Oe=H),(wt=Bt.nextSibling)!==null)break;Bt=vt,vt=Bt.parentNode}Bt=wt}h=ae===-1||Oe===-1?null:{start:ae,end:Oe}}else h=null}h=h||{start:0,end:0}}else h=null;for(J1={focusedElem:r,selectionRange:h},tg=!1,fo=a;fo!==null;)if(a=fo,r=a.child,(a.subtreeFlags&1024)!==0&&r!==null)r.return=a,fo=r;else for(;fo!==null;){switch(a=fo,S=a.alternate,r=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&S!==null){r=void 0,h=a,w=S.memoizedProps,S=S.memoizedState,m=h.stateNode;try{var On=Fu(h.type,w,h.elementType===h.type);r=m.getSnapshotBeforeUpdate(On,S),m.__reactInternalSnapshotBeforeUpdate=r}catch(En){Wi(h,h.return,En)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,h=r.nodeType,h===9)ny(r);else if(h===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":ny(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=a.sibling,r!==null){r.return=a.return,fo=r;break}fo=a.return}}function Cw(r,a,h){var m=h.flags;switch(h.tag){case 0:case 11:case 15:jc(r,h),m&4&&yf(5,h);break;case 1:if(jc(r,h),m&4)if(r=h.stateNode,a===null)try{r.componentDidMount()}catch(H){Wi(h,h.return,H)}else{var w=Fu(h.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(w,a,r.__reactInternalSnapshotBeforeUpdate)}catch(H){Wi(h,h.return,H)}}m&64&&_w(h),m&512&&vf(h,h.return);break;case 3:if(jc(r,h),m&64&&(r=h.updateQueue,r!==null)){if(a=null,h.child!==null)switch(h.child.tag){case 27:case 5:a=h.child.stateNode;break;case 1:a=h.child.stateNode}try{Ss(r,a)}catch(H){Wi(h,h.return,H)}}break;case 27:a===null&&m&4&&Ew(h);case 26:case 5:jc(r,h),a===null&&m&4&&Sw(h),m&512&&vf(h,h.return);break;case 12:jc(r,h);break;case 13:jc(r,h),m&4&&Aw(r,h),m&64&&(r=h.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(h=gk.bind(null,h),Mk(r,h))));break;case 22:if(m=h.memoizedState!==null||Vl,!m){a=a!==null&&a.memoizedState!==null||Rs,w=Vl;var S=Rs;Vl=m,(Rs=a)&&!S?Mc(r,h,(h.subtreeFlags&8772)!==0):jc(r,h),Vl=w,Rs=S}break;case 30:break;default:jc(r,h)}}function kw(r){var a=r.alternate;a!==null&&(r.alternate=null,kw(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&Nt(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var ds=null,_r=!1;function Yl(r,a,h){for(h=h.child;h!==null;)Lw(r,a,h),h=h.sibling}function Lw(r,a,h){if(Ye&&typeof Ye.onCommitFiberUnmount=="function")try{Ye.onCommitFiberUnmount(Ee,h)}catch{}switch(h.tag){case 26:Rs||hl(h,a),Yl(r,a,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Rs||hl(h,a);var m=ds,w=_r;$c(h.type)&&(ds=h.stateNode,_r=!1),Yl(r,a,h),Cf(h.stateNode),ds=m,_r=w;break;case 5:Rs||hl(h,a);case 6:if(m=ds,w=_r,ds=null,Yl(r,a,h),ds=m,_r=w,ds!==null)if(_r)try{(ds.nodeType===9?ds.body:ds.nodeName==="HTML"?ds.ownerDocument.body:ds).removeChild(h.stateNode)}catch(S){Wi(h,a,S)}else try{ds.removeChild(h.stateNode)}catch(S){Wi(h,a,S)}break;case 18:ds!==null&&(_r?(r=ds,y_(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,h.stateNode),Rf(r)):y_(ds,h.stateNode));break;case 4:m=ds,w=_r,ds=h.stateNode.containerInfo,_r=!0,Yl(r,a,h),ds=m,_r=w;break;case 0:case 11:case 14:case 15:Rs||Oc(2,h,a),Rs||Oc(4,h,a),Yl(r,a,h);break;case 1:Rs||(hl(h,a),m=h.stateNode,typeof m.componentWillUnmount=="function"&&xw(h,a,m)),Yl(r,a,h);break;case 21:Yl(r,a,h);break;case 22:Rs=(m=Rs)||h.memoizedState!==null,Yl(r,a,h),Rs=m;break;default:Yl(r,a,h)}}function Aw(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Rf(r)}catch(h){Wi(a,a.return,h)}}function lk(r){switch(r.tag){case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new Tw),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new Tw),a;default:throw Error(i(435,r.tag))}}function L1(r,a){var h=lk(r);a.forEach(function(m){var w=yk.bind(null,r,m);h.has(m)||(h.add(m),m.then(w,w))})}function Pr(r,a){var h=a.deletions;if(h!==null)for(var m=0;m<h.length;m++){var w=h[m],S=r,H=a,ae=H;e:for(;ae!==null;){switch(ae.tag){case 27:if($c(ae.type)){ds=ae.stateNode,_r=!1;break e}break;case 5:ds=ae.stateNode,_r=!1;break e;case 3:case 4:ds=ae.stateNode.containerInfo,_r=!0;break e}ae=ae.return}if(ds===null)throw Error(i(160));Lw(S,H,w),ds=null,_r=!1,S=w.alternate,S!==null&&(S.return=null),w.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)Dw(a,r),a=a.sibling}var Ua=null;function Dw(r,a){var h=r.alternate,m=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Pr(a,r),Ur(r),m&4&&(Oc(3,r,r.return),yf(3,r),Oc(5,r,r.return));break;case 1:Pr(a,r),Ur(r),m&512&&(Rs||h===null||hl(h,h.return)),m&64&&Vl&&(r=r.updateQueue,r!==null&&(m=r.callbacks,m!==null&&(h=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=h===null?m:h.concat(m))));break;case 26:var w=Ua;if(Pr(a,r),Ur(r),m&512&&(Rs||h===null||hl(h,h.return)),m&4){var S=h!==null?h.memoizedState:null;if(m=r.memoizedState,h===null)if(m===null)if(r.stateNode===null){e:{m=r.type,h=r.memoizedProps,w=w.ownerDocument||w;t:switch(m){case"title":S=w.getElementsByTagName("title")[0],(!S||S[rt]||S[dt]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=w.createElement(m),w.head.insertBefore(S,w.querySelector("head > title"))),Do(S,m,h),S[dt]=r,ke(S),m=S;break e;case"link":var H=E_("link","href",w).get(m+(h.href||""));if(H){for(var ae=0;ae<H.length;ae++)if(S=H[ae],S.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&S.getAttribute("rel")===(h.rel==null?null:h.rel)&&S.getAttribute("title")===(h.title==null?null:h.title)&&S.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){H.splice(ae,1);break t}}S=w.createElement(m),Do(S,m,h),w.head.appendChild(S);break;case"meta":if(H=E_("meta","content",w).get(m+(h.content||""))){for(ae=0;ae<H.length;ae++)if(S=H[ae],S.getAttribute("content")===(h.content==null?null:""+h.content)&&S.getAttribute("name")===(h.name==null?null:h.name)&&S.getAttribute("property")===(h.property==null?null:h.property)&&S.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&S.getAttribute("charset")===(h.charSet==null?null:h.charSet)){H.splice(ae,1);break t}}S=w.createElement(m),Do(S,m,h),w.head.appendChild(S);break;default:throw Error(i(468,m))}S[dt]=r,ke(S),m=S}r.stateNode=m}else T_(w,r.type,r.stateNode);else r.stateNode=N_(w,m,r.memoizedProps);else S!==m?(S===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):S.count--,m===null?T_(w,r.type,r.stateNode):N_(w,m,r.memoizedProps)):m===null&&r.stateNode!==null&&E1(r,r.memoizedProps,h.memoizedProps)}break;case 27:Pr(a,r),Ur(r),m&512&&(Rs||h===null||hl(h,h.return)),h!==null&&m&4&&E1(r,r.memoizedProps,h.memoizedProps);break;case 5:if(Pr(a,r),Ur(r),m&512&&(Rs||h===null||hl(h,h.return)),r.flags&32){w=r.stateNode;try{io(w,"")}catch(wt){Wi(r,r.return,wt)}}m&4&&r.stateNode!=null&&(w=r.memoizedProps,E1(r,w,h!==null?h.memoizedProps:w)),m&1024&&(k1=!0);break;case 6:if(Pr(a,r),Ur(r),m&4){if(r.stateNode===null)throw Error(i(162));m=r.memoizedProps,h=r.stateNode;try{h.nodeValue=m}catch(wt){Wi(r,r.return,wt)}}break;case 3:if(Zp=null,w=Ua,Ua=Xp(a.containerInfo),Pr(a,r),Ua=w,Ur(r),m&4&&h!==null&&h.memoizedState.isDehydrated)try{Rf(a.containerInfo)}catch(wt){Wi(r,r.return,wt)}k1&&(k1=!1,Ow(r));break;case 4:m=Ua,Ua=Xp(r.stateNode.containerInfo),Pr(a,r),Ur(r),Ua=m;break;case 12:Pr(a,r),Ur(r);break;case 13:Pr(a,r),Ur(r),r.child.flags&8192&&r.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(R1=Ne()),m&4&&(m=r.updateQueue,m!==null&&(r.updateQueue=null,L1(r,m)));break;case 22:w=r.memoizedState!==null;var Oe=h!==null&&h.memoizedState!==null,ft=Vl,Rt=Rs;if(Vl=ft||w,Rs=Rt||Oe,Pr(a,r),Rs=Rt,Vl=ft,Ur(r),m&8192)e:for(a=r.stateNode,a._visibility=w?a._visibility&-2:a._visibility|1,w&&(h===null||Oe||Vl||Rs||$u(r)),h=null,a=r;;){if(a.tag===5||a.tag===26){if(h===null){Oe=h=a;try{if(S=Oe.stateNode,w)H=S.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none";else{ae=Oe.stateNode;var Bt=Oe.memoizedProps.style,vt=Bt!=null&&Bt.hasOwnProperty("display")?Bt.display:null;ae.style.display=vt==null||typeof vt=="boolean"?"":(""+vt).trim()}}catch(wt){Wi(Oe,Oe.return,wt)}}}else if(a.tag===6){if(h===null){Oe=a;try{Oe.stateNode.nodeValue=w?"":Oe.memoizedProps}catch(wt){Wi(Oe,Oe.return,wt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;h===a&&(h=null),a=a.return}h===a&&(h=null),a.sibling.return=a.return,a=a.sibling}m&4&&(m=r.updateQueue,m!==null&&(h=m.retryQueue,h!==null&&(m.retryQueue=null,L1(r,h))));break;case 19:Pr(a,r),Ur(r),m&4&&(m=r.updateQueue,m!==null&&(r.updateQueue=null,L1(r,m)));break;case 30:break;case 21:break;default:Pr(a,r),Ur(r)}}function Ur(r){var a=r.flags;if(a&2){try{for(var h,m=r.return;m!==null;){if(Nw(m)){h=m;break}m=m.return}if(h==null)throw Error(i(160));switch(h.tag){case 27:var w=h.stateNode,S=T1(r);Pp(r,S,w);break;case 5:var H=h.stateNode;h.flags&32&&(io(H,""),h.flags&=-33);var ae=T1(r);Pp(r,ae,H);break;case 3:case 4:var Oe=h.stateNode.containerInfo,ft=T1(r);C1(r,ft,Oe);break;default:throw Error(i(161))}}catch(Rt){Wi(r,r.return,Rt)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function Ow(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;Ow(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function jc(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Cw(r,a.alternate,a),a=a.sibling}function $u(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:Oc(4,a,a.return),$u(a);break;case 1:hl(a,a.return);var h=a.stateNode;typeof h.componentWillUnmount=="function"&&xw(a,a.return,h),$u(a);break;case 27:Cf(a.stateNode);case 26:case 5:hl(a,a.return),$u(a);break;case 22:a.memoizedState===null&&$u(a);break;case 30:$u(a);break;default:$u(a)}r=r.sibling}}function Mc(r,a,h){for(h=h&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var m=a.alternate,w=r,S=a,H=S.flags;switch(S.tag){case 0:case 11:case 15:Mc(w,S,h),yf(4,S);break;case 1:if(Mc(w,S,h),m=S,w=m.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(ft){Wi(m,m.return,ft)}if(m=S,w=m.updateQueue,w!==null){var ae=m.stateNode;try{var Oe=w.shared.hiddenCallbacks;if(Oe!==null)for(w.shared.hiddenCallbacks=null,w=0;w<Oe.length;w++)Qn(Oe[w],ae)}catch(ft){Wi(m,m.return,ft)}}h&&H&64&&_w(S),vf(S,S.return);break;case 27:Ew(S);case 26:case 5:Mc(w,S,h),h&&m===null&&H&4&&Sw(S),vf(S,S.return);break;case 12:Mc(w,S,h);break;case 13:Mc(w,S,h),h&&H&4&&Aw(w,S);break;case 22:S.memoizedState===null&&Mc(w,S,h),vf(S,S.return);break;case 30:break;default:Mc(w,S,h)}a=a.sibling}}function A1(r,a){var h=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==h&&(r!=null&&r.refCount++,h!=null&&Lu(h))}function D1(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Lu(r))}function fl(r,a,h,m){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)jw(r,a,h,m),a=a.sibling}function jw(r,a,h,m){var w=a.flags;switch(a.tag){case 0:case 11:case 15:fl(r,a,h,m),w&2048&&yf(9,a);break;case 1:fl(r,a,h,m);break;case 3:fl(r,a,h,m),w&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Lu(r)));break;case 12:if(w&2048){fl(r,a,h,m),r=a.stateNode;try{var S=a.memoizedProps,H=S.id,ae=S.onPostCommit;typeof ae=="function"&&ae(H,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(Oe){Wi(a,a.return,Oe)}}else fl(r,a,h,m);break;case 13:fl(r,a,h,m);break;case 23:break;case 22:S=a.stateNode,H=a.alternate,a.memoizedState!==null?S._visibility&2?fl(r,a,h,m):bf(r,a):S._visibility&2?fl(r,a,h,m):(S._visibility|=2,Hd(r,a,h,m,(a.subtreeFlags&10256)!==0)),w&2048&&A1(H,a);break;case 24:fl(r,a,h,m),w&2048&&D1(a.alternate,a);break;default:fl(r,a,h,m)}}function Hd(r,a,h,m,w){for(w=w&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var S=r,H=a,ae=h,Oe=m,ft=H.flags;switch(H.tag){case 0:case 11:case 15:Hd(S,H,ae,Oe,w),yf(8,H);break;case 23:break;case 22:var Rt=H.stateNode;H.memoizedState!==null?Rt._visibility&2?Hd(S,H,ae,Oe,w):bf(S,H):(Rt._visibility|=2,Hd(S,H,ae,Oe,w)),w&&ft&2048&&A1(H.alternate,H);break;case 24:Hd(S,H,ae,Oe,w),w&&ft&2048&&D1(H.alternate,H);break;default:Hd(S,H,ae,Oe,w)}a=a.sibling}}function bf(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var h=r,m=a,w=m.flags;switch(m.tag){case 22:bf(h,m),w&2048&&A1(m.alternate,m);break;case 24:bf(h,m),w&2048&&D1(m.alternate,m);break;default:bf(h,m)}a=a.sibling}}var wf=8192;function qd(r){if(r.subtreeFlags&wf)for(r=r.child;r!==null;)Mw(r),r=r.sibling}function Mw(r){switch(r.tag){case 26:qd(r),r.flags&wf&&r.memoizedState!==null&&Yk(Ua,r.memoizedState,r.memoizedProps);break;case 5:qd(r);break;case 3:case 4:var a=Ua;Ua=Xp(r.stateNode.containerInfo),qd(r),Ua=a;break;case 22:r.memoizedState===null&&(a=r.alternate,a!==null&&a.memoizedState!==null?(a=wf,wf=16777216,qd(r),wf=a):qd(r));break;default:qd(r)}}function Rw(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function _f(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var h=0;h<a.length;h++){var m=a[h];fo=m,Pw(m,r)}Rw(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Iw(r),r=r.sibling}function Iw(r){switch(r.tag){case 0:case 11:case 15:_f(r),r.flags&2048&&Oc(9,r,r.return);break;case 3:_f(r);break;case 12:_f(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,Up(r)):_f(r);break;default:_f(r)}}function Up(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var h=0;h<a.length;h++){var m=a[h];fo=m,Pw(m,r)}Rw(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:Oc(8,a,a.return),Up(a);break;case 22:h=a.stateNode,h._visibility&2&&(h._visibility&=-3,Up(a));break;default:Up(a)}r=r.sibling}}function Pw(r,a){for(;fo!==null;){var h=fo;switch(h.tag){case 0:case 11:case 15:Oc(8,h,a);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var m=h.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Lu(h.memoizedState.cache)}if(m=h.child,m!==null)m.return=h,fo=m;else e:for(h=r;fo!==null;){m=fo;var w=m.sibling,S=m.return;if(kw(m),m===h){fo=null;break e}if(w!==null){w.return=S,fo=w;break e}fo=S}}}var ck={getCacheForType:function(r){var a=As(Ds),h=a.data.get(r);return h===void 0&&(h=r(),a.data.set(r,h)),h}},uk=typeof WeakMap=="function"?WeakMap:Map,ki=0,Yi=null,ti=null,ui=0,Li=0,Fr=null,Rc=!1,Vd=!1,O1=!1,Gl=0,Ns=0,Ic=0,Bu=0,j1=0,fa=0,Yd=0,xf=null,xr=null,M1=!1,R1=0,Fp=1/0,$p=null,Pc=null,Ao=0,Uc=null,Gd=null,Kd=0,I1=0,P1=null,Uw=null,Sf=0,U1=null;function $r(){if((ki&2)!==0&&ui!==0)return ui&-ui;if(q.T!==null){var r=$l;return r!==0?r:q1()}return Sn()}function Fw(){fa===0&&(fa=(ui&536870912)===0||yi?gt():536870912);var r=ha.current;return r!==null&&(r.flags|=32),fa}function Br(r,a,h){(r===Yi&&(Li===2||Li===9)||r.cancelPendingCommit!==null)&&(Xd(r,0),Fc(r,ui,fa,!1)),Dt(r,h),((ki&2)===0||r!==Yi)&&(r===Yi&&((ki&2)===0&&(Bu|=h),Ns===4&&Fc(r,ui,fa,!1)),ml(r))}function $w(r,a,h){if((ki&6)!==0)throw Error(i(327));var m=!h&&(a&124)===0&&(a&r.expiredLanes)===0||Tt(r,a),w=m?fk(r,a):B1(r,a,!0),S=m;do{if(w===0){Vd&&!m&&Fc(r,a,0,!1);break}else{if(h=r.current.alternate,S&&!dk(h)){w=B1(r,a,!1),S=!1;continue}if(w===2){if(S=a,r.errorRecoveryDisabledLanes&S)var H=0;else H=r.pendingLanes&-536870913,H=H!==0?H:H&536870912?536870912:0;if(H!==0){a=H;e:{var ae=r;w=xf;var Oe=ae.current.memoizedState.isDehydrated;if(Oe&&(Xd(ae,H).flags|=256),H=B1(ae,H,!1),H!==2){if(O1&&!Oe){ae.errorRecoveryDisabledLanes|=S,Bu|=S,w=4;break e}S=xr,xr=w,S!==null&&(xr===null?xr=S:xr.push.apply(xr,S))}w=H}if(S=!1,w!==2)continue}}if(w===1){Xd(r,0),Fc(r,a,0,!0);break}e:{switch(m=r,S=w,S){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Fc(m,a,fa,!Rc);break e;case 2:xr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(w=R1+300-Ne(),10<w)){if(Fc(m,a,fa,!Rc),mt(m,0,!0)!==0)break e;m.timeoutHandle=p_(Bw.bind(null,m,h,xr,$p,M1,a,fa,Bu,Yd,Rc,S,2,-0,0),w);break e}Bw(m,h,xr,$p,M1,a,fa,Bu,Yd,Rc,S,0,-0,0)}}break}while(!0);ml(r)}function Bw(r,a,h,m,w,S,H,ae,Oe,ft,Rt,Bt,vt,wt){if(r.timeoutHandle=-1,Bt=a.subtreeFlags,(Bt&8192||(Bt&16785408)===16785408)&&(Af={stylesheets:null,count:0,unsuspend:Vk},Mw(a),Bt=Gk(),Bt!==null)){r.cancelPendingCommit=Bt(Gw.bind(null,r,a,S,h,m,w,H,ae,Oe,Rt,1,vt,wt)),Fc(r,S,H,!ft);return}Gw(r,a,S,h,m,w,H,ae,Oe)}function dk(r){for(var a=r;;){var h=a.tag;if((h===0||h===11||h===15)&&a.flags&16384&&(h=a.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var m=0;m<h.length;m++){var w=h[m],S=w.getSnapshot;w=w.value;try{if(!Bs(S(),w))return!1}catch{return!1}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Fc(r,a,h,m){a&=~j1,a&=~Bu,r.suspendedLanes|=a,r.pingedLanes&=~a,m&&(r.warmLanes|=a),m=r.expirationTimes;for(var w=a;0<w;){var S=31-Ue(w),H=1<<S;m[S]=-1,w&=~H}h!==0&&Qt(r,h,a)}function Bp(){return(ki&6)===0?(Nf(0),!1):!0}function F1(){if(ti!==null){if(Li===0)var r=ti.return;else r=ti,Oa=zs=null,Xs(r),Wd=null,mf=0,r=ti;for(;r!==null;)ww(r.alternate,r),r=r.return;ti=null}}function Xd(r,a){var h=r.timeoutHandle;h!==-1&&(r.timeoutHandle=-1,Lk(h)),h=r.cancelPendingCommit,h!==null&&(r.cancelPendingCommit=null,h()),F1(),Yi=r,ti=h=oa(r.current,null),ui=a,Li=0,Fr=null,Rc=!1,Vd=Tt(r,a),O1=!1,Yd=fa=j1=Bu=Ic=Ns=0,xr=xf=null,M1=!1,(a&8)!==0&&(a|=a&32);var m=r.entangledLanes;if(m!==0)for(r=r.entanglements,m&=a;0<m;){var w=31-Ue(m),S=1<<w;a|=r[w],m&=~S}return Gl=a,Su(),h}function Ww(r,a){hn=null,q.H=kp,a===ne||a===ue?(a=Ke(),Li=3):a===oe?(a=Ke(),Li=4):Li=a===rw?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Fr=a,ti===null&&(Ns=1,jp(r,er(a,r.current)))}function zw(){var r=q.H;return q.H=kp,r===null?kp:r}function Hw(){var r=q.A;return q.A=ck,r}function $1(){Ns=4,Rc||(ui&4194048)!==ui&&ha.current!==null||(Vd=!0),(Ic&134217727)===0&&(Bu&134217727)===0||Yi===null||Fc(Yi,ui,fa,!1)}function B1(r,a,h){var m=ki;ki|=2;var w=zw(),S=Hw();(Yi!==r||ui!==a)&&($p=null,Xd(r,a)),a=!1;var H=Ns;e:do try{if(Li!==0&&ti!==null){var ae=ti,Oe=Fr;switch(Li){case 8:F1(),H=6;break e;case 3:case 2:case 9:case 6:ha.current===null&&(a=!0);var ft=Li;if(Li=0,Fr=null,Qd(r,ae,Oe,ft),h&&Vd){H=0;break e}break;default:ft=Li,Li=0,Fr=null,Qd(r,ae,Oe,ft)}}hk(),H=Ns;break}catch(Rt){Ww(r,Rt)}while(!0);return a&&r.shellSuspendCounter++,Oa=zs=null,ki=m,q.H=w,q.A=S,ti===null&&(Yi=null,ui=0,Su()),H}function hk(){for(;ti!==null;)qw(ti)}function fk(r,a){var h=ki;ki|=2;var m=zw(),w=Hw();Yi!==r||ui!==a?($p=null,Fp=Ne()+500,Xd(r,a)):Vd=Tt(r,a);e:do try{if(Li!==0&&ti!==null){a=ti;var S=Fr;t:switch(Li){case 1:Li=0,Fr=null,Qd(r,a,S,1);break;case 2:case 9:if(xe(S)){Li=0,Fr=null,Vw(a);break}a=function(){Li!==2&&Li!==9||Yi!==r||(Li=7),ml(r)},S.then(a,a);break e;case 3:Li=7;break e;case 4:Li=5;break e;case 7:xe(S)?(Li=0,Fr=null,Vw(a)):(Li=0,Fr=null,Qd(r,a,S,7));break;case 5:var H=null;switch(ti.tag){case 26:H=ti.memoizedState;case 5:case 27:var ae=ti;if(!H||C_(H)){Li=0,Fr=null;var Oe=ae.sibling;if(Oe!==null)ti=Oe;else{var ft=ae.return;ft!==null?(ti=ft,Wp(ft)):ti=null}break t}}Li=0,Fr=null,Qd(r,a,S,5);break;case 6:Li=0,Fr=null,Qd(r,a,S,6);break;case 8:F1(),Ns=6;break e;default:throw Error(i(462))}}mk();break}catch(Rt){Ww(r,Rt)}while(!0);return Oa=zs=null,q.H=m,q.A=w,ki=h,ti!==null?0:(Yi=null,ui=0,Su(),Ns)}function mk(){for(;ti!==null&&!ce();)qw(ti)}function qw(r){var a=vw(r.alternate,r,Gl);r.memoizedProps=r.pendingProps,a===null?Wp(r):ti=a}function Vw(r){var a=r,h=a.alternate;switch(a.tag){case 15:case 0:a=hw(h,a,a.pendingProps,a.type,void 0,ui);break;case 11:a=hw(h,a,a.pendingProps,a.type.render,a.ref,ui);break;case 5:Xs(a);default:ww(h,a),a=ti=Eu(a,Gl),a=vw(h,a,Gl)}r.memoizedProps=r.pendingProps,a===null?Wp(r):ti=a}function Qd(r,a,h,m){Oa=zs=null,Xs(a),Wd=null,mf=0;var w=a.return;try{if(ik(r,w,a,h,ui)){Ns=1,jp(r,er(h,r.current)),ti=null;return}}catch(S){if(w!==null)throw ti=w,S;Ns=1,jp(r,er(h,r.current)),ti=null;return}a.flags&32768?(yi||m===1?r=!0:Vd||(ui&536870912)!==0?r=!1:(Rc=r=!0,(m===2||m===9||m===3||m===6)&&(m=ha.current,m!==null&&m.tag===13&&(m.flags|=16384))),Yw(a,r)):Wp(a)}function Wp(r){var a=r;do{if((a.flags&32768)!==0){Yw(a,Rc);return}r=a.return;var h=ok(a.alternate,a,Gl);if(h!==null){ti=h;return}if(a=a.sibling,a!==null){ti=a;return}ti=a=r}while(a!==null);Ns===0&&(Ns=5)}function Yw(r,a){do{var h=rk(r.alternate,r);if(h!==null){h.flags&=32767,ti=h;return}if(h=r.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!a&&(r=r.sibling,r!==null)){ti=r;return}ti=r=h}while(r!==null);Ns=6,ti=null}function Gw(r,a,h,m,w,S,H,ae,Oe){r.cancelPendingCommit=null;do zp();while(Ao!==0);if((ki&6)!==0)throw Error(i(327));if(a!==null){if(a===r.current)throw Error(i(177));if(S=a.lanes|a.childLanes,S|=Ld,Ut(r,h,S,H,ae,Oe),r===Yi&&(ti=Yi=null,ui=0),Gd=a,Uc=r,Kd=h,I1=S,P1=w,Uw=m,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,vk(lt,function(){return Jw(),null})):(r.callbackNode=null,r.callbackPriority=0),m=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||m){m=q.T,q.T=null,w=re.p,re.p=2,H=ki,ki|=4;try{ak(r,a,h)}finally{ki=H,re.p=w,q.T=m}}Ao=1,Kw(),Xw(),Qw()}}function Kw(){if(Ao===1){Ao=0;var r=Uc,a=Gd,h=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||h){h=q.T,q.T=null;var m=re.p;re.p=2;var w=ki;ki|=4;try{Dw(a,r);var S=J1,H=wc(r.containerInfo),ae=S.focusedElem,Oe=S.selectionRange;if(H!==ae&&ae&&ae.ownerDocument&&na(ae.ownerDocument.documentElement,ae)){if(Oe!==null&&So(ae)){var ft=Oe.start,Rt=Oe.end;if(Rt===void 0&&(Rt=ft),"selectionStart"in ae)ae.selectionStart=ft,ae.selectionEnd=Math.min(Rt,ae.value.length);else{var Bt=ae.ownerDocument||document,vt=Bt&&Bt.defaultView||window;if(vt.getSelection){var wt=vt.getSelection(),On=ae.textContent.length,En=Math.min(Oe.start,On),Ii=Oe.end===void 0?En:Math.min(Oe.end,On);!wt.extend&&En>Ii&&(H=Ii,Ii=En,En=H);var nt=ol(ae,En),Ge=ol(ae,Ii);if(nt&&Ge&&(wt.rangeCount!==1||wt.anchorNode!==nt.node||wt.anchorOffset!==nt.offset||wt.focusNode!==Ge.node||wt.focusOffset!==Ge.offset)){var ct=Bt.createRange();ct.setStart(nt.node,nt.offset),wt.removeAllRanges(),En>Ii?(wt.addRange(ct),wt.extend(Ge.node,Ge.offset)):(ct.setEnd(Ge.node,Ge.offset),wt.addRange(ct))}}}}for(Bt=[],wt=ae;wt=wt.parentNode;)wt.nodeType===1&&Bt.push({element:wt,left:wt.scrollLeft,top:wt.scrollTop});for(typeof ae.focus=="function"&&ae.focus(),ae=0;ae<Bt.length;ae++){var Ft=Bt[ae];Ft.element.scrollLeft=Ft.left,Ft.element.scrollTop=Ft.top}}tg=!!Z1,J1=Z1=null}finally{ki=w,re.p=m,q.T=h}}r.current=a,Ao=2}}function Xw(){if(Ao===2){Ao=0;var r=Uc,a=Gd,h=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||h){h=q.T,q.T=null;var m=re.p;re.p=2;var w=ki;ki|=4;try{Cw(r,a.alternate,a)}finally{ki=w,re.p=m,q.T=h}}Ao=3}}function Qw(){if(Ao===4||Ao===3){Ao=0,_t();var r=Uc,a=Gd,h=Kd,m=Uw;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Ao=5:(Ao=0,Gd=Uc=null,Zw(r,r.pendingLanes));var w=r.pendingLanes;if(w===0&&(Pc=null),dn(h),a=a.stateNode,Ye&&typeof Ye.onCommitFiberRoot=="function")try{Ye.onCommitFiberRoot(Ee,a,void 0,(a.current.flags&128)===128)}catch{}if(m!==null){a=q.T,w=re.p,re.p=2,q.T=null;try{for(var S=r.onRecoverableError,H=0;H<m.length;H++){var ae=m[H];S(ae.value,{componentStack:ae.stack})}}finally{q.T=a,re.p=w}}(Kd&3)!==0&&zp(),ml(r),w=r.pendingLanes,(h&4194090)!==0&&(w&42)!==0?r===U1?Sf++:(Sf=0,U1=r):Sf=0,Nf(0)}}function Zw(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,Lu(a)))}function zp(r){return Kw(),Xw(),Qw(),Jw()}function Jw(){if(Ao!==5)return!1;var r=Uc,a=I1;I1=0;var h=dn(Kd),m=q.T,w=re.p;try{re.p=32>h?32:h,q.T=null,h=P1,P1=null;var S=Uc,H=Kd;if(Ao=0,Gd=Uc=null,Kd=0,(ki&6)!==0)throw Error(i(331));var ae=ki;if(ki|=4,Iw(S.current),jw(S,S.current,H,h),ki=ae,Nf(0,!1),Ye&&typeof Ye.onPostCommitFiberRoot=="function")try{Ye.onPostCommitFiberRoot(Ee,S)}catch{}return!0}finally{re.p=w,q.T=m,Zw(r,a)}}function e_(r,a,h){a=er(h,a),a=g1(r.stateNode,a,2),r=zt(r,a,2),r!==null&&(Dt(r,2),ml(r))}function Wi(r,a,h){if(r.tag===3)e_(r,r,h);else for(;a!==null;){if(a.tag===3){e_(a,r,h);break}else if(a.tag===1){var m=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Pc===null||!Pc.has(m))){r=er(h,r),h=sw(2),m=zt(a,h,2),m!==null&&(ow(h,m,a,r),Dt(m,2),ml(m));break}}a=a.return}}function W1(r,a,h){var m=r.pingCache;if(m===null){m=r.pingCache=new uk;var w=new Set;m.set(a,w)}else w=m.get(a),w===void 0&&(w=new Set,m.set(a,w));w.has(h)||(O1=!0,w.add(h),r=pk.bind(null,r,a,h),a.then(r,r))}function pk(r,a,h){var m=r.pingCache;m!==null&&m.delete(a),r.pingedLanes|=r.suspendedLanes&h,r.warmLanes&=~h,Yi===r&&(ui&h)===h&&(Ns===4||Ns===3&&(ui&62914560)===ui&&300>Ne()-R1?(ki&2)===0&&Xd(r,0):j1|=h,Yd===ui&&(Yd=0)),ml(r)}function t_(r,a){a===0&&(a=tn()),r=Ml(r,a),r!==null&&(Dt(r,a),ml(r))}function gk(r){var a=r.memoizedState,h=0;a!==null&&(h=a.retryLane),t_(r,h)}function yk(r,a){var h=0;switch(r.tag){case 13:var m=r.stateNode,w=r.memoizedState;w!==null&&(h=w.retryLane);break;case 19:m=r.stateNode;break;case 22:m=r.stateNode._retryCache;break;default:throw Error(i(314))}m!==null&&m.delete(a),t_(r,h)}function vk(r,a){return at(r,a)}var Hp=null,Zd=null,z1=!1,qp=!1,H1=!1,Wu=0;function ml(r){r!==Zd&&r.next===null&&(Zd===null?Hp=Zd=r:Zd=Zd.next=r),qp=!0,z1||(z1=!0,wk())}function Nf(r,a){if(!H1&&qp){H1=!0;do for(var h=!1,m=Hp;m!==null;){if(r!==0){var w=m.pendingLanes;if(w===0)var S=0;else{var H=m.suspendedLanes,ae=m.pingedLanes;S=(1<<31-Ue(42|r)+1)-1,S&=w&~(H&~ae),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(h=!0,o_(m,S))}else S=ui,S=mt(m,m===Yi?S:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(S&3)===0||Tt(m,S)||(h=!0,o_(m,S));m=m.next}while(h);H1=!1}}function bk(){n_()}function n_(){qp=z1=!1;var r=0;Wu!==0&&(kk()&&(r=Wu),Wu=0);for(var a=Ne(),h=null,m=Hp;m!==null;){var w=m.next,S=i_(m,a);S===0?(m.next=null,h===null?Hp=w:h.next=w,w===null&&(Zd=h)):(h=m,(r!==0||(S&3)!==0)&&(qp=!0)),m=w}Nf(r)}function i_(r,a){for(var h=r.suspendedLanes,m=r.pingedLanes,w=r.expirationTimes,S=r.pendingLanes&-62914561;0<S;){var H=31-Ue(S),ae=1<<H,Oe=w[H];Oe===-1?((ae&h)===0||(ae&m)!==0)&&(w[H]=It(ae,a)):Oe<=a&&(r.expiredLanes|=ae),S&=~ae}if(a=Yi,h=ui,h=mt(r,r===a?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),m=r.callbackNode,h===0||r===a&&(Li===2||Li===9)||r.cancelPendingCommit!==null)return m!==null&&m!==null&&Ce(m),r.callbackNode=null,r.callbackPriority=0;if((h&3)===0||Tt(r,h)){if(a=h&-h,a===r.callbackPriority)return a;switch(m!==null&&Ce(m),dn(h)){case 2:case 8:h=tt;break;case 32:h=lt;break;case 268435456:h=pe;break;default:h=lt}return m=s_.bind(null,r),h=at(h,m),r.callbackPriority=a,r.callbackNode=h,a}return m!==null&&m!==null&&Ce(m),r.callbackPriority=2,r.callbackNode=null,2}function s_(r,a){if(Ao!==0&&Ao!==5)return r.callbackNode=null,r.callbackPriority=0,null;var h=r.callbackNode;if(zp()&&r.callbackNode!==h)return null;var m=ui;return m=mt(r,r===Yi?m:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),m===0?null:($w(r,m,a),i_(r,Ne()),r.callbackNode!=null&&r.callbackNode===h?s_.bind(null,r):null)}function o_(r,a){if(zp())return null;$w(r,a,!0)}function wk(){Ak(function(){(ki&6)!==0?at(We,bk):n_()})}function q1(){return Wu===0&&(Wu=gt()),Wu}function r_(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:ss(""+r)}function a_(r,a){var h=a.ownerDocument.createElement("input");return h.name=a.name,h.value=a.value,r.id&&h.setAttribute("form",r.id),a.parentNode.insertBefore(h,a),r=new FormData(r),h.parentNode.removeChild(h),r}function _k(r,a,h,m,w){if(a==="submit"&&h&&h.stateNode===w){var S=r_((w[ve]||null).action),H=m.submitter;H&&(a=(a=H[ve]||null)?r_(a.formAction):H.getAttribute("formAction"),a!==null&&(S=a,H=null));var ae=new Gr("action","action",null,m,w);r.push({event:ae,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Wu!==0){var Oe=H?a_(w,H):new FormData(w);da(h,{pending:!0,data:Oe,method:w.method,action:S},null,Oe)}}else typeof S=="function"&&(ae.preventDefault(),Oe=H?a_(w,H):new FormData(w),da(h,{pending:!0,data:Oe,method:w.method,action:S},S,Oe))},currentTarget:w}]})}}for(var V1=0;V1<kd.length;V1++){var Y1=kd[V1],xk=Y1.toLowerCase(),Sk=Y1[0].toUpperCase()+Y1.slice(1);vr(xk,"on"+Sk)}vr(Yh,"onAnimationEnd"),vr(Gh,"onAnimationIteration"),vr(Kh,"onAnimationStart"),vr("dblclick","onDoubleClick"),vr("focusin","onFocus"),vr("focusout","onBlur"),vr(lp,"onTransitionRun"),vr(cp,"onTransitionStart"),vr(up,"onTransitionCancel"),vr(Xh,"onTransitionEnd"),Vt("onMouseEnter",["mouseout","mouseover"]),Vt("onMouseLeave",["mouseout","mouseover"]),Vt("onPointerEnter",["pointerout","pointerover"]),Vt("onPointerLeave",["pointerout","pointerover"]),Yt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Yt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Yt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Yt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Yt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Yt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ef="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ef));function l_(r,a){a=(a&4)!==0;for(var h=0;h<r.length;h++){var m=r[h],w=m.event;m=m.listeners;e:{var S=void 0;if(a)for(var H=m.length-1;0<=H;H--){var ae=m[H],Oe=ae.instance,ft=ae.currentTarget;if(ae=ae.listener,Oe!==S&&w.isPropagationStopped())break e;S=ae,w.currentTarget=ft;try{S(w)}catch(Rt){Op(Rt)}w.currentTarget=null,S=Oe}else for(H=0;H<m.length;H++){if(ae=m[H],Oe=ae.instance,ft=ae.currentTarget,ae=ae.listener,Oe!==S&&w.isPropagationStopped())break e;S=ae,w.currentTarget=ft;try{S(w)}catch(Rt){Op(Rt)}w.currentTarget=null,S=Oe}}}}function ni(r,a){var h=a[Le];h===void 0&&(h=a[Le]=new Set);var m=r+"__bubble";h.has(m)||(c_(a,r,2,!1),h.add(m))}function G1(r,a,h){var m=0;a&&(m|=4),c_(h,r,m,a)}var Vp="_reactListening"+Math.random().toString(36).slice(2);function K1(r){if(!r[Vp]){r[Vp]=!0,pt.forEach(function(h){h!=="selectionchange"&&(Nk.has(h)||G1(h,!1,r),G1(h,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[Vp]||(a[Vp]=!0,G1("selectionchange",!1,a))}}function c_(r,a,h,m){switch(j_(a)){case 2:var w=Qk;break;case 8:w=Zk;break;default:w=cy}h=w.bind(null,a,h,r),w=void 0,!os||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(w=!0),m?w!==void 0?r.addEventListener(a,h,{capture:!0,passive:w}):r.addEventListener(a,h,!0):w!==void 0?r.addEventListener(a,h,{passive:w}):r.addEventListener(a,h,!1)}function X1(r,a,h,m,w){var S=m;if((a&1)===0&&(a&2)===0&&m!==null)e:for(;;){if(m===null)return;var H=m.tag;if(H===3||H===4){var ae=m.stateNode.containerInfo;if(ae===w)break;if(H===4)for(H=m.return;H!==null;){var Oe=H.tag;if((Oe===3||Oe===4)&&H.stateNode.containerInfo===w)return;H=H.return}for(;ae!==null;){if(H=xt(ae),H===null)return;if(Oe=H.tag,Oe===5||Oe===6||Oe===26||Oe===27){m=S=H;continue e}ae=ae.parentNode}}m=m.return}Po(function(){var ft=S,Rt=Oi(h),Bt=[];e:{var vt=Qh.get(r);if(vt!==void 0){var wt=Gr,On=r;switch(r){case"keypress":if(oo(h)===0)break e;case"keydown":case"keyup":wt=Fi;break;case"focusin":On="focus",wt=N;break;case"focusout":On="blur",wt=N;break;case"beforeblur":case"afterblur":wt=N;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":wt=ro;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":wt=_o;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":wt=_s;break;case Yh:case Gh:case Kh:wt=_e;break;case Xh:wt=Mr;break;case"scroll":case"scrollend":wt=Kr;break;case"wheel":wt=Gs;break;case"copy":case"cut":case"paste":wt=et;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":wt=Xi;break;case"toggle":case"beforetoggle":wt=$o}var En=(a&4)!==0,Ii=!En&&(r==="scroll"||r==="scrollend"),nt=En?vt!==null?vt+"Capture":null:vt;En=[];for(var Ge=ft,ct;Ge!==null;){var Ft=Ge;if(ct=Ft.stateNode,Ft=Ft.tag,Ft!==5&&Ft!==26&&Ft!==27||ct===null||nt===null||(Ft=bs(Ge,nt),Ft!=null&&En.push(Tf(Ge,Ft,ct))),Ii)break;Ge=Ge.return}0<En.length&&(vt=new wt(vt,On,null,h,Rt),Bt.push({event:vt,listeners:En}))}}if((a&7)===0){e:{if(vt=r==="mouseover"||r==="pointerover",wt=r==="mouseout"||r==="pointerout",vt&&h!==Vi&&(On=h.relatedTarget||h.fromElement)&&(xt(On)||On[He]))break e;if((wt||vt)&&(vt=Rt.window===Rt?Rt:(vt=Rt.ownerDocument)?vt.defaultView||vt.parentWindow:window,wt?(On=h.relatedTarget||h.toElement,wt=ft,On=On?xt(On):null,On!==null&&(Ii=o(On),En=On.tag,On!==Ii||En!==5&&En!==27&&En!==6)&&(On=null)):(wt=null,On=ft),wt!==On)){if(En=ro,Ft="onMouseLeave",nt="onMouseEnter",Ge="mouse",(r==="pointerout"||r==="pointerover")&&(En=Xi,Ft="onPointerLeave",nt="onPointerEnter",Ge="pointer"),Ii=wt==null?vt:St(wt),ct=On==null?vt:St(On),vt=new En(Ft,Ge+"leave",wt,h,Rt),vt.target=Ii,vt.relatedTarget=ct,Ft=null,xt(Rt)===ft&&(En=new En(nt,Ge+"enter",On,h,Rt),En.target=ct,En.relatedTarget=Ii,Ft=En),Ii=Ft,wt&&On)t:{for(En=wt,nt=On,Ge=0,ct=En;ct;ct=Jd(ct))Ge++;for(ct=0,Ft=nt;Ft;Ft=Jd(Ft))ct++;for(;0<Ge-ct;)En=Jd(En),Ge--;for(;0<ct-Ge;)nt=Jd(nt),ct--;for(;Ge--;){if(En===nt||nt!==null&&En===nt.alternate)break t;En=Jd(En),nt=Jd(nt)}En=null}else En=null;wt!==null&&u_(Bt,vt,wt,En,!1),On!==null&&Ii!==null&&u_(Bt,Ii,On,En,!0)}}e:{if(vt=ft?St(ft):window,wt=vt.nodeName&&vt.nodeName.toLowerCase(),wt==="select"||wt==="input"&&vt.type==="file")var mn=xo;else if(xs(vt))if(il)mn=bc;else{mn=Jr;var Zn=qh}else wt=vt.nodeName,!wt||wt.toLowerCase()!=="input"||vt.type!=="checkbox"&&vt.type!=="radio"?ft&&Ui(ft.elementType)&&(mn=xo):mn=ea;if(mn&&(mn=mn(r,ft))){$s(Bt,mn,h,Rt);break e}Zn&&Zn(r,vt,ft),r==="focusout"&&ft&&vt.type==="number"&&ft.memoizedProps.value!=null&&Or(vt,"number",vt.value)}switch(Zn=ft?St(ft):window,r){case"focusin":(xs(Zn)||Zn.contentEditable==="true")&&(gi=Zn,Ni=ft,$i=null);break;case"focusout":$i=Ni=gi=null;break;case"mousedown":Qi=!0;break;case"contextmenu":case"mouseup":case"dragend":Qi=!1,sa(Bt,h,Rt);break;case"selectionchange":if(ia)break;case"keydown":case"keyup":sa(Bt,h,Rt)}var bn;if(y)e:{switch(r){case"compositionstart":var Cn="onCompositionStart";break e;case"compositionend":Cn="onCompositionEnd";break e;case"compositionupdate":Cn="onCompositionUpdate";break e}Cn=void 0}else Ti?Gt(r,h)&&(Cn="onCompositionEnd"):r==="keydown"&&h.keyCode===229&&(Cn="onCompositionStart");Cn&&(he&&h.locale!=="ko"&&(Ti||Cn!=="onCompositionStart"?Cn==="onCompositionEnd"&&Ti&&(bn=Ea()):(fr=Rt,Vr="value"in fr?fr.value:fr.textContent,Ti=!0)),Zn=Yp(ft,Cn),0<Zn.length&&(Cn=new Wt(Cn,r,null,h,Rt),Bt.push({event:Cn,listeners:Zn}),bn?Cn.data=bn:(bn=Pn(h),bn!==null&&(Cn.data=bn)))),(bn=B?Hn(r,h):ms(r,h))&&(Cn=Yp(ft,"onBeforeInput"),0<Cn.length&&(Zn=new Wt("onBeforeInput","beforeinput",null,h,Rt),Bt.push({event:Zn,listeners:Cn}),Zn.data=bn)),_k(Bt,r,ft,h,Rt)}l_(Bt,a)})}function Tf(r,a,h){return{instance:r,listener:a,currentTarget:h}}function Yp(r,a){for(var h=a+"Capture",m=[];r!==null;){var w=r,S=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||S===null||(w=bs(r,h),w!=null&&m.unshift(Tf(r,w,S)),w=bs(r,a),w!=null&&m.push(Tf(r,w,S))),r.tag===3)return m;r=r.return}return[]}function Jd(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function u_(r,a,h,m,w){for(var S=a._reactName,H=[];h!==null&&h!==m;){var ae=h,Oe=ae.alternate,ft=ae.stateNode;if(ae=ae.tag,Oe!==null&&Oe===m)break;ae!==5&&ae!==26&&ae!==27||ft===null||(Oe=ft,w?(ft=bs(h,S),ft!=null&&H.unshift(Tf(h,ft,Oe))):w||(ft=bs(h,S),ft!=null&&H.push(Tf(h,ft,Oe)))),h=h.return}H.length!==0&&r.push({event:a,listeners:H})}var Ek=/\r\n?/g,Tk=/\u0000|\uFFFD/g;function d_(r){return(typeof r=="string"?r:""+r).replace(Ek,`
`).replace(Tk,"")}function h_(r,a){return a=d_(a),d_(r)===a}function Gp(){}function Ri(r,a,h,m,w,S){switch(h){case"children":typeof m=="string"?a==="body"||a==="textarea"&&m===""||io(r,m):(typeof m=="number"||typeof m=="bigint")&&a!=="body"&&io(r,""+m);break;case"className":Tn(r,"class",m);break;case"tabIndex":Tn(r,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Tn(r,h,m);break;case"style":_n(r,m,S);break;case"data":if(a!=="object"){Tn(r,"data",m);break}case"src":case"href":if(m===""&&(a!=="a"||h!=="href")){r.removeAttribute(h);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){r.removeAttribute(h);break}m=ss(""+m),r.setAttribute(h,m);break;case"action":case"formAction":if(typeof m=="function"){r.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(h==="formAction"?(a!=="input"&&Ri(r,a,"name",w.name,w,null),Ri(r,a,"formEncType",w.formEncType,w,null),Ri(r,a,"formMethod",w.formMethod,w,null),Ri(r,a,"formTarget",w.formTarget,w,null)):(Ri(r,a,"encType",w.encType,w,null),Ri(r,a,"method",w.method,w,null),Ri(r,a,"target",w.target,w,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){r.removeAttribute(h);break}m=ss(""+m),r.setAttribute(h,m);break;case"onClick":m!=null&&(r.onclick=Gp);break;case"onScroll":m!=null&&ni("scroll",r);break;case"onScrollEnd":m!=null&&ni("scrollend",r);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(h=m.__html,h!=null){if(w.children!=null)throw Error(i(60));r.innerHTML=h}}break;case"multiple":r.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":r.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){r.removeAttribute("xlink:href");break}h=ss(""+m),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?r.setAttribute(h,""+m):r.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?r.setAttribute(h,""):r.removeAttribute(h);break;case"capture":case"download":m===!0?r.setAttribute(h,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?r.setAttribute(h,m):r.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?r.setAttribute(h,m):r.removeAttribute(h);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?r.removeAttribute(h):r.setAttribute(h,m);break;case"popover":ni("beforetoggle",r),ni("toggle",r),In(r,"popover",m);break;case"xlinkActuate":Vn(r,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Vn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Vn(r,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Vn(r,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Vn(r,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Vn(r,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Vn(r,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Vn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Vn(r,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":In(r,"is",m);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=is.get(h)||h,In(r,h,m))}}function Q1(r,a,h,m,w,S){switch(h){case"style":_n(r,m,S);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(h=m.__html,h!=null){if(w.children!=null)throw Error(i(60));r.innerHTML=h}}break;case"children":typeof m=="string"?io(r,m):(typeof m=="number"||typeof m=="bigint")&&io(r,""+m);break;case"onScroll":m!=null&&ni("scroll",r);break;case"onScrollEnd":m!=null&&ni("scrollend",r);break;case"onClick":m!=null&&(r.onclick=Gp);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lt.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(w=h.endsWith("Capture"),a=h.slice(2,w?h.length-7:void 0),S=r[ve]||null,S=S!=null?S[h]:null,typeof S=="function"&&r.removeEventListener(a,S,w),typeof m=="function")){typeof S!="function"&&S!==null&&(h in r?r[h]=null:r.hasAttribute(h)&&r.removeAttribute(h)),r.addEventListener(a,m,w);break e}h in r?r[h]=m:m===!0?r.setAttribute(h,""):In(r,h,m)}}}function Do(r,a,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ni("error",r),ni("load",r);var m=!1,w=!1,S;for(S in h)if(h.hasOwnProperty(S)){var H=h[S];if(H!=null)switch(S){case"src":m=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ri(r,a,S,H,h,null)}}w&&Ri(r,a,"srcSet",h.srcSet,h,null),m&&Ri(r,a,"src",h.src,h,null);return;case"input":ni("invalid",r);var ae=S=H=w=null,Oe=null,ft=null;for(m in h)if(h.hasOwnProperty(m)){var Rt=h[m];if(Rt!=null)switch(m){case"name":w=Rt;break;case"type":H=Rt;break;case"checked":Oe=Rt;break;case"defaultChecked":ft=Rt;break;case"value":S=Rt;break;case"defaultValue":ae=Rt;break;case"children":case"dangerouslySetInnerHTML":if(Rt!=null)throw Error(i(137,a));break;default:Ri(r,a,m,Rt,h,null)}}Dr(r,S,ae,Oe,ft,H,w,!1),no(r);return;case"select":ni("invalid",r),m=H=S=null;for(w in h)if(h.hasOwnProperty(w)&&(ae=h[w],ae!=null))switch(w){case"value":S=ae;break;case"defaultValue":H=ae;break;case"multiple":m=ae;default:Ri(r,a,w,ae,h,null)}a=S,h=H,r.multiple=!!m,a!=null?Qo(r,!!m,a,!1):h!=null&&Qo(r,!!m,h,!0);return;case"textarea":ni("invalid",r),S=w=m=null;for(H in h)if(h.hasOwnProperty(H)&&(ae=h[H],ae!=null))switch(H){case"value":m=ae;break;case"defaultValue":w=ae;break;case"children":S=ae;break;case"dangerouslySetInnerHTML":if(ae!=null)throw Error(i(91));break;default:Ri(r,a,H,ae,h,null)}hr(r,m,w,S),no(r);return;case"option":for(Oe in h)if(h.hasOwnProperty(Oe)&&(m=h[Oe],m!=null))switch(Oe){case"selected":r.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Ri(r,a,Oe,m,h,null)}return;case"dialog":ni("beforetoggle",r),ni("toggle",r),ni("cancel",r),ni("close",r);break;case"iframe":case"object":ni("load",r);break;case"video":case"audio":for(m=0;m<Ef.length;m++)ni(Ef[m],r);break;case"image":ni("error",r),ni("load",r);break;case"details":ni("toggle",r);break;case"embed":case"source":case"link":ni("error",r),ni("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ft in h)if(h.hasOwnProperty(ft)&&(m=h[ft],m!=null))switch(ft){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ri(r,a,ft,m,h,null)}return;default:if(Ui(a)){for(Rt in h)h.hasOwnProperty(Rt)&&(m=h[Rt],m!==void 0&&Q1(r,a,Rt,m,h,void 0));return}}for(ae in h)h.hasOwnProperty(ae)&&(m=h[ae],m!=null&&Ri(r,a,ae,m,h,null))}function Ck(r,a,h,m){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,S=null,H=null,ae=null,Oe=null,ft=null,Rt=null;for(wt in h){var Bt=h[wt];if(h.hasOwnProperty(wt)&&Bt!=null)switch(wt){case"checked":break;case"value":break;case"defaultValue":Oe=Bt;default:m.hasOwnProperty(wt)||Ri(r,a,wt,null,m,Bt)}}for(var vt in m){var wt=m[vt];if(Bt=h[vt],m.hasOwnProperty(vt)&&(wt!=null||Bt!=null))switch(vt){case"type":S=wt;break;case"name":w=wt;break;case"checked":ft=wt;break;case"defaultChecked":Rt=wt;break;case"value":H=wt;break;case"defaultValue":ae=wt;break;case"children":case"dangerouslySetInnerHTML":if(wt!=null)throw Error(i(137,a));break;default:wt!==Bt&&Ri(r,a,vt,wt,m,Bt)}}ks(r,H,ae,Oe,ft,Rt,S,w);return;case"select":wt=H=ae=vt=null;for(S in h)if(Oe=h[S],h.hasOwnProperty(S)&&Oe!=null)switch(S){case"value":break;case"multiple":wt=Oe;default:m.hasOwnProperty(S)||Ri(r,a,S,null,m,Oe)}for(w in m)if(S=m[w],Oe=h[w],m.hasOwnProperty(w)&&(S!=null||Oe!=null))switch(w){case"value":vt=S;break;case"defaultValue":ae=S;break;case"multiple":H=S;default:S!==Oe&&Ri(r,a,w,S,m,Oe)}a=ae,h=H,m=wt,vt!=null?Qo(r,!!h,vt,!1):!!m!=!!h&&(a!=null?Qo(r,!!h,a,!0):Qo(r,!!h,h?[]:"",!1));return;case"textarea":wt=vt=null;for(ae in h)if(w=h[ae],h.hasOwnProperty(ae)&&w!=null&&!m.hasOwnProperty(ae))switch(ae){case"value":break;case"children":break;default:Ri(r,a,ae,null,m,w)}for(H in m)if(w=m[H],S=h[H],m.hasOwnProperty(H)&&(w!=null||S!=null))switch(H){case"value":vt=w;break;case"defaultValue":wt=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(i(91));break;default:w!==S&&Ri(r,a,H,w,m,S)}zn(r,vt,wt);return;case"option":for(var On in h)if(vt=h[On],h.hasOwnProperty(On)&&vt!=null&&!m.hasOwnProperty(On))switch(On){case"selected":r.selected=!1;break;default:Ri(r,a,On,null,m,vt)}for(Oe in m)if(vt=m[Oe],wt=h[Oe],m.hasOwnProperty(Oe)&&vt!==wt&&(vt!=null||wt!=null))switch(Oe){case"selected":r.selected=vt&&typeof vt!="function"&&typeof vt!="symbol";break;default:Ri(r,a,Oe,vt,m,wt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var En in h)vt=h[En],h.hasOwnProperty(En)&&vt!=null&&!m.hasOwnProperty(En)&&Ri(r,a,En,null,m,vt);for(ft in m)if(vt=m[ft],wt=h[ft],m.hasOwnProperty(ft)&&vt!==wt&&(vt!=null||wt!=null))switch(ft){case"children":case"dangerouslySetInnerHTML":if(vt!=null)throw Error(i(137,a));break;default:Ri(r,a,ft,vt,m,wt)}return;default:if(Ui(a)){for(var Ii in h)vt=h[Ii],h.hasOwnProperty(Ii)&&vt!==void 0&&!m.hasOwnProperty(Ii)&&Q1(r,a,Ii,void 0,m,vt);for(Rt in m)vt=m[Rt],wt=h[Rt],!m.hasOwnProperty(Rt)||vt===wt||vt===void 0&&wt===void 0||Q1(r,a,Rt,vt,m,wt);return}}for(var nt in h)vt=h[nt],h.hasOwnProperty(nt)&&vt!=null&&!m.hasOwnProperty(nt)&&Ri(r,a,nt,null,m,vt);for(Bt in m)vt=m[Bt],wt=h[Bt],!m.hasOwnProperty(Bt)||vt===wt||vt==null&&wt==null||Ri(r,a,Bt,vt,m,wt)}var Z1=null,J1=null;function Kp(r){return r.nodeType===9?r:r.ownerDocument}function f_(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function m_(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function ey(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var ty=null;function kk(){var r=window.event;return r&&r.type==="popstate"?r===ty?!1:(ty=r,!0):(ty=null,!1)}var p_=typeof setTimeout=="function"?setTimeout:void 0,Lk=typeof clearTimeout=="function"?clearTimeout:void 0,g_=typeof Promise=="function"?Promise:void 0,Ak=typeof queueMicrotask=="function"?queueMicrotask:typeof g_<"u"?function(r){return g_.resolve(null).then(r).catch(Dk)}:p_;function Dk(r){setTimeout(function(){throw r})}function $c(r){return r==="head"}function y_(r,a){var h=a,m=0,w=0;do{var S=h.nextSibling;if(r.removeChild(h),S&&S.nodeType===8)if(h=S.data,h==="/$"){if(0<m&&8>m){h=m;var H=r.ownerDocument;if(h&1&&Cf(H.documentElement),h&2&&Cf(H.body),h&4)for(h=H.head,Cf(h),H=h.firstChild;H;){var ae=H.nextSibling,Oe=H.nodeName;H[rt]||Oe==="SCRIPT"||Oe==="STYLE"||Oe==="LINK"&&H.rel.toLowerCase()==="stylesheet"||h.removeChild(H),H=ae}}if(w===0){r.removeChild(S),Rf(a);return}w--}else h==="$"||h==="$?"||h==="$!"?w++:m=h.charCodeAt(0)-48;else m=0;h=S}while(h);Rf(a)}function ny(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var h=a;switch(a=a.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":ny(h),Nt(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}r.removeChild(h)}}function Ok(r,a,h,m){for(;r.nodeType===1;){var w=h;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!m&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(m){if(!r[rt])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(S=r.getAttribute("rel"),S==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(S!==w.rel||r.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||r.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||r.getAttribute("title")!==(w.title==null?null:w.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(S=r.getAttribute("src"),(S!==(w.src==null?null:w.src)||r.getAttribute("type")!==(w.type==null?null:w.type)||r.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&S&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var S=w.name==null?null:""+w.name;if(w.type==="hidden"&&r.getAttribute("name")===S)return r}else return r;if(r=Fa(r.nextSibling),r===null)break}return null}function jk(r,a,h){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!h||(r=Fa(r.nextSibling),r===null))return null;return r}function iy(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function Mk(r,a){var h=r.ownerDocument;if(r.data!=="$?"||h.readyState==="complete")a();else{var m=function(){a(),h.removeEventListener("DOMContentLoaded",m)};h.addEventListener("DOMContentLoaded",m),r._reactRetry=m}}function Fa(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return r}var sy=null;function v_(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var h=r.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return r;a--}else h==="/$"&&a++}r=r.previousSibling}return null}function b_(r,a,h){switch(a=Kp(h),r){case"html":if(r=a.documentElement,!r)throw Error(i(452));return r;case"head":if(r=a.head,!r)throw Error(i(453));return r;case"body":if(r=a.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Cf(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);Nt(r)}var ma=new Map,w_=new Set;function Xp(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Kl=re.d;re.d={f:Rk,r:Ik,D:Pk,C:Uk,L:Fk,m:$k,X:Wk,S:Bk,M:zk};function Rk(){var r=Kl.f(),a=Bp();return r||a}function Ik(r){var a=st(r);a!==null&&a.tag===5&&a.type==="form"?Pu(a):Kl.r(r)}var eh=typeof document>"u"?null:document;function __(r,a,h){var m=eh;if(m&&typeof a=="string"&&a){var w=$n(a);w='link[rel="'+r+'"][href="'+w+'"]',typeof h=="string"&&(w+='[crossorigin="'+h+'"]'),w_.has(w)||(w_.add(w),r={rel:r,crossOrigin:h,href:a},m.querySelector(w)===null&&(a=m.createElement("link"),Do(a,"link",r),ke(a),m.head.appendChild(a)))}}function Pk(r){Kl.D(r),__("dns-prefetch",r,null)}function Uk(r,a){Kl.C(r,a),__("preconnect",r,a)}function Fk(r,a,h){Kl.L(r,a,h);var m=eh;if(m&&r&&a){var w='link[rel="preload"][as="'+$n(a)+'"]';a==="image"&&h&&h.imageSrcSet?(w+='[imagesrcset="'+$n(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(w+='[imagesizes="'+$n(h.imageSizes)+'"]')):w+='[href="'+$n(r)+'"]';var S=w;switch(a){case"style":S=th(r);break;case"script":S=nh(r)}ma.has(S)||(r=p({rel:"preload",href:a==="image"&&h&&h.imageSrcSet?void 0:r,as:a},h),ma.set(S,r),m.querySelector(w)!==null||a==="style"&&m.querySelector(kf(S))||a==="script"&&m.querySelector(Lf(S))||(a=m.createElement("link"),Do(a,"link",r),ke(a),m.head.appendChild(a)))}}function $k(r,a){Kl.m(r,a);var h=eh;if(h&&r){var m=a&&typeof a.as=="string"?a.as:"script",w='link[rel="modulepreload"][as="'+$n(m)+'"][href="'+$n(r)+'"]',S=w;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=nh(r)}if(!ma.has(S)&&(r=p({rel:"modulepreload",href:r},a),ma.set(S,r),h.querySelector(w)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Lf(S)))return}m=h.createElement("link"),Do(m,"link",r),ke(m),h.head.appendChild(m)}}}function Bk(r,a,h){Kl.S(r,a,h);var m=eh;if(m&&r){var w=yt(m).hoistableStyles,S=th(r);a=a||"default";var H=w.get(S);if(!H){var ae={loading:0,preload:null};if(H=m.querySelector(kf(S)))ae.loading=5;else{r=p({rel:"stylesheet",href:r,"data-precedence":a},h),(h=ma.get(S))&&oy(r,h);var Oe=H=m.createElement("link");ke(Oe),Do(Oe,"link",r),Oe._p=new Promise(function(ft,Rt){Oe.onload=ft,Oe.onerror=Rt}),Oe.addEventListener("load",function(){ae.loading|=1}),Oe.addEventListener("error",function(){ae.loading|=2}),ae.loading|=4,Qp(H,a,m)}H={type:"stylesheet",instance:H,count:1,state:ae},w.set(S,H)}}}function Wk(r,a){Kl.X(r,a);var h=eh;if(h&&r){var m=yt(h).hoistableScripts,w=nh(r),S=m.get(w);S||(S=h.querySelector(Lf(w)),S||(r=p({src:r,async:!0},a),(a=ma.get(w))&&ry(r,a),S=h.createElement("script"),ke(S),Do(S,"link",r),h.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},m.set(w,S))}}function zk(r,a){Kl.M(r,a);var h=eh;if(h&&r){var m=yt(h).hoistableScripts,w=nh(r),S=m.get(w);S||(S=h.querySelector(Lf(w)),S||(r=p({src:r,async:!0,type:"module"},a),(a=ma.get(w))&&ry(r,a),S=h.createElement("script"),ke(S),Do(S,"link",r),h.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},m.set(w,S))}}function x_(r,a,h,m){var w=(w=Q.current)?Xp(w):null;if(!w)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(a=th(h.href),h=yt(w).hoistableStyles,m=h.get(a),m||(m={type:"style",instance:null,count:0,state:null},h.set(a,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){r=th(h.href);var S=yt(w).hoistableStyles,H=S.get(r);if(H||(w=w.ownerDocument||w,H={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(r,H),(S=w.querySelector(kf(r)))&&!S._p&&(H.instance=S,H.state.loading=5),ma.has(r)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},ma.set(r,h),S||Hk(w,r,h,H.state))),a&&m===null)throw Error(i(528,""));return H}if(a&&m!==null)throw Error(i(529,""));return null;case"script":return a=h.async,h=h.src,typeof h=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=nh(h),h=yt(w).hoistableScripts,m=h.get(a),m||(m={type:"script",instance:null,count:0,state:null},h.set(a,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function th(r){return'href="'+$n(r)+'"'}function kf(r){return'link[rel="stylesheet"]['+r+"]"}function S_(r){return p({},r,{"data-precedence":r.precedence,precedence:null})}function Hk(r,a,h,m){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?m.loading=1:(a=r.createElement("link"),m.preload=a,a.addEventListener("load",function(){return m.loading|=1}),a.addEventListener("error",function(){return m.loading|=2}),Do(a,"link",h),ke(a),r.head.appendChild(a))}function nh(r){return'[src="'+$n(r)+'"]'}function Lf(r){return"script[async]"+r}function N_(r,a,h){if(a.count++,a.instance===null)switch(a.type){case"style":var m=r.querySelector('style[data-href~="'+$n(h.href)+'"]');if(m)return a.instance=m,ke(m),m;var w=p({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return m=(r.ownerDocument||r).createElement("style"),ke(m),Do(m,"style",w),Qp(m,h.precedence,r),a.instance=m;case"stylesheet":w=th(h.href);var S=r.querySelector(kf(w));if(S)return a.state.loading|=4,a.instance=S,ke(S),S;m=S_(h),(w=ma.get(w))&&oy(m,w),S=(r.ownerDocument||r).createElement("link"),ke(S);var H=S;return H._p=new Promise(function(ae,Oe){H.onload=ae,H.onerror=Oe}),Do(S,"link",m),a.state.loading|=4,Qp(S,h.precedence,r),a.instance=S;case"script":return S=nh(h.src),(w=r.querySelector(Lf(S)))?(a.instance=w,ke(w),w):(m=h,(w=ma.get(S))&&(m=p({},h),ry(m,w)),r=r.ownerDocument||r,w=r.createElement("script"),ke(w),Do(w,"link",m),r.head.appendChild(w),a.instance=w);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(m=a.instance,a.state.loading|=4,Qp(m,h.precedence,r));return a.instance}function Qp(r,a,h){for(var m=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=m.length?m[m.length-1]:null,S=w,H=0;H<m.length;H++){var ae=m[H];if(ae.dataset.precedence===a)S=ae;else if(S!==w)break}S?S.parentNode.insertBefore(r,S.nextSibling):(a=h.nodeType===9?h.head:h,a.insertBefore(r,a.firstChild))}function oy(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function ry(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var Zp=null;function E_(r,a,h){if(Zp===null){var m=new Map,w=Zp=new Map;w.set(h,m)}else w=Zp,m=w.get(h),m||(m=new Map,w.set(h,m));if(m.has(r))return m;for(m.set(r,null),h=h.getElementsByTagName(r),w=0;w<h.length;w++){var S=h[w];if(!(S[rt]||S[dt]||r==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var H=S.getAttribute(a)||"";H=r+H;var ae=m.get(H);ae?ae.push(S):m.set(H,[S])}}return m}function T_(r,a,h){r=r.ownerDocument||r,r.head.insertBefore(h,a==="title"?r.querySelector("head > title"):null)}function qk(r,a,h){if(h===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function C_(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var Af=null;function Vk(){}function Yk(r,a,h){if(Af===null)throw Error(i(475));var m=Af;if(a.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var w=th(h.href),S=r.querySelector(kf(w));if(S){r=S._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(m.count++,m=Jp.bind(m),r.then(m,m)),a.state.loading|=4,a.instance=S,ke(S);return}S=r.ownerDocument||r,h=S_(h),(w=ma.get(w))&&oy(h,w),S=S.createElement("link"),ke(S);var H=S;H._p=new Promise(function(ae,Oe){H.onload=ae,H.onerror=Oe}),Do(S,"link",h),a.instance=S}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(m.count++,a=Jp.bind(m),r.addEventListener("load",a),r.addEventListener("error",a))}}function Gk(){if(Af===null)throw Error(i(475));var r=Af;return r.stylesheets&&r.count===0&&ay(r,r.stylesheets),0<r.count?function(a){var h=setTimeout(function(){if(r.stylesheets&&ay(r,r.stylesheets),r.unsuspend){var m=r.unsuspend;r.unsuspend=null,m()}},6e4);return r.unsuspend=a,function(){r.unsuspend=null,clearTimeout(h)}}:null}function Jp(){if(this.count--,this.count===0){if(this.stylesheets)ay(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var eg=null;function ay(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,eg=new Map,a.forEach(Kk,r),eg=null,Jp.call(r))}function Kk(r,a){if(!(a.state.loading&4)){var h=eg.get(r);if(h)var m=h.get(null);else{h=new Map,eg.set(r,h);for(var w=r.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<w.length;S++){var H=w[S];(H.nodeName==="LINK"||H.getAttribute("media")!=="not all")&&(h.set(H.dataset.precedence,H),m=H)}m&&h.set(null,m)}w=a.instance,H=w.getAttribute("data-precedence"),S=h.get(H)||m,S===m&&h.set(null,w),h.set(H,w),this.count++,m=Jp.bind(this),w.addEventListener("load",m),w.addEventListener("error",m),S?S.parentNode.insertBefore(w,S.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(w,r.firstChild)),a.state.loading|=4}}var Df={$$typeof:G,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function Xk(r,a,h,m,w,S,H,ae){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Zt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zt(0),this.hiddenUpdates=Zt(null),this.identifierPrefix=m,this.onUncaughtError=w,this.onCaughtError=S,this.onRecoverableError=H,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ae,this.incompleteTransitions=new Map}function k_(r,a,h,m,w,S,H,ae,Oe,ft,Rt,Bt){return r=new Xk(r,a,h,H,ae,Oe,ft,Bt),a=1,S===!0&&(a|=24),S=co(3,null,null,a),r.current=S,S.stateNode=r,a=Jh(),a.refCount++,r.pooledCache=a,a.refCount++,S.memoizedState={element:m,isDehydrated:h,cache:a},ut(S),r}function L_(r){return r?(r=Ws,r):Ws}function A_(r,a,h,m,w,S){w=L_(w),m.context===null?m.context=w:m.pendingContext=w,m=Ot(a),m.payload={element:h},S=S===void 0?null:S,S!==null&&(m.callback=S),h=zt(r,m,a),h!==null&&(Br(h,r,a),$t(h,r,a))}function D_(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var h=r.retryLane;r.retryLane=h!==0&&h<a?h:a}}function ly(r,a){D_(r,a),(r=r.alternate)&&D_(r,a)}function O_(r){if(r.tag===13){var a=Ml(r,67108864);a!==null&&Br(a,r,67108864),ly(r,67108864)}}var tg=!0;function Qk(r,a,h,m){var w=q.T;q.T=null;var S=re.p;try{re.p=2,cy(r,a,h,m)}finally{re.p=S,q.T=w}}function Zk(r,a,h,m){var w=q.T;q.T=null;var S=re.p;try{re.p=8,cy(r,a,h,m)}finally{re.p=S,q.T=w}}function cy(r,a,h,m){if(tg){var w=uy(m);if(w===null)X1(r,a,m,ng,h),M_(r,m);else if(eL(w,r,a,h,m))m.stopPropagation();else if(M_(r,m),a&4&&-1<Jk.indexOf(r)){for(;w!==null;){var S=st(w);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var H=Je(S.pendingLanes);if(H!==0){var ae=S;for(ae.pendingLanes|=2,ae.entangledLanes|=2;H;){var Oe=1<<31-Ue(H);ae.entanglements[1]|=Oe,H&=~Oe}ml(S),(ki&6)===0&&(Fp=Ne()+500,Nf(0))}}break;case 13:ae=Ml(S,2),ae!==null&&Br(ae,S,2),Bp(),ly(S,2)}if(S=uy(m),S===null&&X1(r,a,m,ng,h),S===w)break;w=S}w!==null&&m.stopPropagation()}else X1(r,a,m,null,h)}}function uy(r){return r=Oi(r),dy(r)}var ng=null;function dy(r){if(ng=null,r=xt(r),r!==null){var a=o(r);if(a===null)r=null;else{var h=a.tag;if(h===13){if(r=l(a),r!==null)return r;r=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return ng=r,null}function j_(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ve()){case We:return 2;case tt:return 8;case lt:case $e:return 32;case pe:return 268435456;default:return 32}default:return 32}}var hy=!1,Bc=null,Wc=null,zc=null,Of=new Map,jf=new Map,Hc=[],Jk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function M_(r,a){switch(r){case"focusin":case"focusout":Bc=null;break;case"dragenter":case"dragleave":Wc=null;break;case"mouseover":case"mouseout":zc=null;break;case"pointerover":case"pointerout":Of.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":jf.delete(a.pointerId)}}function Mf(r,a,h,m,w,S){return r===null||r.nativeEvent!==S?(r={blockedOn:a,domEventName:h,eventSystemFlags:m,nativeEvent:S,targetContainers:[w]},a!==null&&(a=st(a),a!==null&&O_(a)),r):(r.eventSystemFlags|=m,a=r.targetContainers,w!==null&&a.indexOf(w)===-1&&a.push(w),r)}function eL(r,a,h,m,w){switch(a){case"focusin":return Bc=Mf(Bc,r,a,h,m,w),!0;case"dragenter":return Wc=Mf(Wc,r,a,h,m,w),!0;case"mouseover":return zc=Mf(zc,r,a,h,m,w),!0;case"pointerover":var S=w.pointerId;return Of.set(S,Mf(Of.get(S)||null,r,a,h,m,w)),!0;case"gotpointercapture":return S=w.pointerId,jf.set(S,Mf(jf.get(S)||null,r,a,h,m,w)),!0}return!1}function R_(r){var a=xt(r.target);if(a!==null){var h=o(a);if(h!==null){if(a=h.tag,a===13){if(a=l(h),a!==null){r.blockedOn=a,Te(r.priority,function(){if(h.tag===13){var m=$r();m=on(m);var w=Ml(h,m);w!==null&&Br(w,h,m),ly(h,m)}});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){r.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}r.blockedOn=null}function ig(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var h=uy(r.nativeEvent);if(h===null){h=r.nativeEvent;var m=new h.constructor(h.type,h);Vi=m,h.target.dispatchEvent(m),Vi=null}else return a=st(h),a!==null&&O_(a),r.blockedOn=h,!1;a.shift()}return!0}function I_(r,a,h){ig(r)&&h.delete(a)}function tL(){hy=!1,Bc!==null&&ig(Bc)&&(Bc=null),Wc!==null&&ig(Wc)&&(Wc=null),zc!==null&&ig(zc)&&(zc=null),Of.forEach(I_),jf.forEach(I_)}function sg(r,a){r.blockedOn===a&&(r.blockedOn=null,hy||(hy=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,tL)))}var og=null;function P_(r){og!==r&&(og=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){og===r&&(og=null);for(var a=0;a<r.length;a+=3){var h=r[a],m=r[a+1],w=r[a+2];if(typeof m!="function"){if(dy(m||h)===null)continue;break}var S=st(h);S!==null&&(r.splice(a,3),a-=3,da(S,{pending:!0,data:w,method:h.method,action:m},m,w))}}))}function Rf(r){function a(Oe){return sg(Oe,r)}Bc!==null&&sg(Bc,r),Wc!==null&&sg(Wc,r),zc!==null&&sg(zc,r),Of.forEach(a),jf.forEach(a);for(var h=0;h<Hc.length;h++){var m=Hc[h];m.blockedOn===r&&(m.blockedOn=null)}for(;0<Hc.length&&(h=Hc[0],h.blockedOn===null);)R_(h),h.blockedOn===null&&Hc.shift();if(h=(r.ownerDocument||r).$$reactFormReplay,h!=null)for(m=0;m<h.length;m+=3){var w=h[m],S=h[m+1],H=w[ve]||null;if(typeof S=="function")H||P_(h);else if(H){var ae=null;if(S&&S.hasAttribute("formAction")){if(w=S,H=S[ve]||null)ae=H.formAction;else if(dy(w)!==null)continue}else ae=H.action;typeof ae=="function"?h[m+1]=ae:(h.splice(m,3),m-=3),P_(h)}}}function fy(r){this._internalRoot=r}rg.prototype.render=fy.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(i(409));var h=a.current,m=$r();A_(h,m,r,a,null,null)},rg.prototype.unmount=fy.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;A_(r.current,2,null,r,null,null),Bp(),a[He]=null}};function rg(r){this._internalRoot=r}rg.prototype.unstable_scheduleHydration=function(r){if(r){var a=Sn();r={blockedOn:null,target:r,priority:a};for(var h=0;h<Hc.length&&a!==0&&a<Hc[h].priority;h++);Hc.splice(h,0,r),h===0&&R_(r)}};var U_=e.version;if(U_!=="19.1.1")throw Error(i(527,U_,"19.1.1"));re.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=d(a),r=r!==null?f(r):null,r=r===null?null:r.stateNode,r};var nL={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ag=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ag.isDisabled&&ag.supportsFiber)try{Ee=ag.inject(nL),Ye=ag}catch{}}return Pf.createRoot=function(r,a){if(!s(r))throw Error(i(299));var h=!1,m="",w=ew,S=tw,H=nw,ae=null;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onUncaughtError!==void 0&&(w=a.onUncaughtError),a.onCaughtError!==void 0&&(S=a.onCaughtError),a.onRecoverableError!==void 0&&(H=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(ae=a.unstable_transitionCallbacks)),a=k_(r,1,!1,null,null,h,m,w,S,H,ae,null),r[He]=a.current,K1(r),new fy(a)},Pf.hydrateRoot=function(r,a,h){if(!s(r))throw Error(i(299));var m=!1,w="",S=ew,H=tw,ae=nw,Oe=null,ft=null;return h!=null&&(h.unstable_strictMode===!0&&(m=!0),h.identifierPrefix!==void 0&&(w=h.identifierPrefix),h.onUncaughtError!==void 0&&(S=h.onUncaughtError),h.onCaughtError!==void 0&&(H=h.onCaughtError),h.onRecoverableError!==void 0&&(ae=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(Oe=h.unstable_transitionCallbacks),h.formState!==void 0&&(ft=h.formState)),a=k_(r,1,!0,a,h??null,m,w,S,H,ae,Oe,ft),a.context=L_(null),h=a.current,m=$r(),m=on(m),w=Ot(m),w.callback=null,zt(h,w,m),h=m,a.current.lanes=h,Dt(a,h),ml(a),r[He]=a.current,K1(r),new rg(a)},Pf.version="19.1.1",Pf}var G_;function fL(){if(G_)return gy.exports;G_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),gy.exports=hL(),gy.exports}var mL=fL();const pL=()=>{};var K_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt=function(n,e){if(!n)throw Ih(e)},Ih=function(n){return new Error("Firebase Database ("+_4.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},gL=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],l=n[t++],c=n[t++],d=((s&7)<<18|(o&63)<<12|(l&63)<<6|c&63)-65536;e[i++]=String.fromCharCode(55296+(d>>10)),e[i++]=String.fromCharCode(56320+(d&1023))}else{const o=n[t++],l=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return e.join("")},gv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],l=s+1<n.length,c=l?n[s+1]:0,d=s+2<n.length,f=d?n[s+2]:0,p=o>>2,v=(o&3)<<4|c>>4;let _=(c&15)<<2|f>>6,b=f&63;d||(b=64,l||(_=64)),i.push(t[p],t[v],t[_],t[b])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(x4(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):gL(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const f=s<n.length?t[n.charAt(s)]:64;++s;const v=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||c==null||f==null||v==null)throw new yL;const _=o<<2|c>>4;if(i.push(_),f!==64){const b=c<<4&240|f>>2;if(i.push(b),v!==64){const T=f<<6&192|v;i.push(T)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class yL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const S4=function(n){const e=x4(n);return gv.encodeByteArray(e,!0)},Qg=function(n){return S4(n).replace(/\./g,"")},Zg=function(n){try{return gv.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vL(n){return N4(void 0,n)}function N4(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!bL(t)||(n[t]=N4(n[t],e[t]));return n}function bL(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L=()=>wL().__FIREBASE_DEFAULTS__,xL=()=>{if(typeof process>"u"||typeof K_>"u")return;const n=K_.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},SL=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Zg(n[1]);return e&&JSON.parse(e)},yv=()=>{try{return pL()||_L()||xL()||SL()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},E4=n=>yv()?.emulatorHosts?.[n],vv=n=>{const e=E4(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},T4=()=>yv()?.config,C4=n=>yv()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function U0(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Qg(JSON.stringify(t)),Qg(JSON.stringify(l)),""].join(".")}const em={};function NL(){const n={prod:[],emulator:[]};for(const e of Object.keys(em))em[e]?n.emulator.push(e):n.prod.push(e);return n}function EL(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let X_=!1;function F0(n,e){if(typeof window>"u"||typeof document>"u"||!yu(window.location.host)||em[n]===e||em[n]||X_)return;em[n]=e;function t(_){return`__firebase__banner__${_}`}const i="__firebase__banner",o=NL().prod.length>0;function l(){const _=document.getElementById(i);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function d(_,b){_.setAttribute("width","24"),_.setAttribute("id",b),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function f(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{X_=!0,l()},_}function p(_,b){_.setAttribute("id",b),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function v(){const _=EL(i),b=t("text"),T=document.getElementById(b)||document.createElement("span"),C=t("learnmore"),A=document.getElementById(C)||document.createElement("a"),I=t("preprendIcon"),ee=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const G=_.element;c(G),p(A,C);const K=f();d(ee,I),G.append(ee,T,A,K),document.body.appendChild(G)}o?(T.innerText="Preview backend disconnected.",ee.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ee.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wv(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ur())}function TL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function k4(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function L4(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function CL(){const n=ur();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function kL(){return _4.NODE_ADMIN===!0}function A4(){try{return typeof indexedDB=="object"}catch{return!1}}function D4(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}function LL(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AL="FirebaseError";class Na extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=AL,Object.setPrototypeOf(this,Na.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xd.prototype.create)}}class xd{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],l=o?DL(o,i):"Error",c=`${this.serviceName}: ${l} (${s}).`;return new Na(s,c,i)}}function DL(n,e){return n.replace(OL,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const OL=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vm(n){return JSON.parse(n)}function eo(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=vm(Zg(o[0])||""),t=vm(Zg(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},jL=function(n){const e=O4(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},ML=function(n){const e=O4(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ll(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Eh(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function x2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Jg(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function cc(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],l=e[s];if(Q_(o)&&Q_(l)){if(!cc(o,l))return!1}else if(o!==l)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function Q_(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Kf(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,o]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function Xf(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let v=0;v<16;v++)i[v]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let v=0;v<16;v++)i[v]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let v=16;v<80;v++){const _=i[v-3]^i[v-8]^i[v-14]^i[v-16];i[v]=(_<<1|_>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],l=this.chain_[2],c=this.chain_[3],d=this.chain_[4],f,p;for(let v=0;v<80;v++){v<40?v<20?(f=c^o&(l^c),p=1518500249):(f=o^l^c,p=1859775393):v<60?(f=o&l|c&(o|l),p=2400959708):(f=o^l^c,p=3395469782);const _=(s<<5|s>>>27)+f+d+p+i[v]&4294967295;d=c,c=l,l=(o<<30|o>>>2)&4294967295,o=s,s=_}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let l=this.inbuf_;for(;s<t;){if(l===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[l]=e.charCodeAt(s),++l,++s,l===this.blockSize){this.compress_(o),l=0;break}}else for(;s<t;)if(o[l]=e[s],++l,++s,l===this.blockSize){this.compress_(o),l=0;break}}this.inbuf_=l,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function IL(n,e){const t=new PL(n,e);return t.subscribe.bind(t)}class PL{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");UL(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=wy),s.error===void 0&&(s.error=wy),s.complete===void 0&&(s.complete=wy);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function UL(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function wy(){}function $0(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,Xt(i<n.length,"Surrogate pair missing trail surrogate.");const l=n.charCodeAt(i)-56320;s=65536+(o<<10)+l}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},B0=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $L=1e3,BL=2,WL=14400*1e3,zL=.5;function Z_(n,e=$L,t=BL){const i=e*Math.pow(t,n),s=Math.round(zL*i*(Math.random()-.5)*2);return Math.min(WL,i+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(n){return n&&n._delegate?n._delegate:n}class qr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Bm;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(VL(e))try{this.getOrInitializeService({instanceIdentifier:Yu})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=Yu){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yu){return this.instances.has(e)}getOptions(e=Yu){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);i===c&&l.resolve(s)}return s}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(i)??new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:qL(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Yu){return this.component?this.component.multipleInstances?e:Yu:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qL(n){return n===Yu?void 0:n}function VL(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new HL(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xi;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(xi||(xi={}));const GL={debug:xi.DEBUG,verbose:xi.VERBOSE,info:xi.INFO,warn:xi.WARN,error:xi.ERROR,silent:xi.SILENT},KL=xi.INFO,XL={[xi.DEBUG]:"log",[xi.VERBOSE]:"log",[xi.INFO]:"info",[xi.WARN]:"warn",[xi.ERROR]:"error"},QL=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=XL[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wm{constructor(e){this.name=e,this._logLevel=KL,this._logHandler=QL,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xi))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xi.DEBUG,...e),this._logHandler(this,xi.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xi.VERBOSE,...e),this._logHandler(this,xi.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xi.INFO,...e),this._logHandler(this,xi.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xi.WARN,...e),this._logHandler(this,xi.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xi.ERROR,...e),this._logHandler(this,xi.ERROR,...e)}}const ZL=(n,e)=>e.some(t=>n instanceof t);let J_,e5;function JL(){return J_||(J_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eA(){return e5||(e5=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const j4=new WeakMap,S2=new WeakMap,M4=new WeakMap,_y=new WeakMap,_v=new WeakMap;function tA(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",l)},o=()=>{t(ru(n.result)),s()},l=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&j4.set(t,n)}).catch(()=>{}),_v.set(e,n),e}function nA(n){if(S2.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",l),n.removeEventListener("abort",l)},o=()=>{t(),s()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",l),n.addEventListener("abort",l)});S2.set(n,e)}let N2={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return S2.get(n);if(e==="objectStoreNames")return n.objectStoreNames||M4.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ru(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function iA(n){N2=n(N2)}function sA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(xy(this),e,...t);return M4.set(i,e.sort?e.sort():[e]),ru(i)}:eA().includes(n)?function(...e){return n.apply(xy(this),e),ru(j4.get(this))}:function(...e){return ru(n.apply(xy(this),e))}}function oA(n){return typeof n=="function"?sA(n):(n instanceof IDBTransaction&&nA(n),ZL(n,JL())?new Proxy(n,N2):n)}function ru(n){if(n instanceof IDBRequest)return tA(n);if(_y.has(n))return _y.get(n);const e=oA(n);return e!==n&&(_y.set(n,e),_v.set(e,n)),e}const xy=n=>_v.get(n);function R4(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const l=indexedDB.open(n,e),c=ru(l);return i&&l.addEventListener("upgradeneeded",d=>{i(ru(l.result),d.oldVersion,d.newVersion,ru(l.transaction),d)}),t&&l.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),c.then(d=>{o&&d.addEventListener("close",()=>o()),s&&d.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),c}const rA=["get","getKey","getAll","getAllKeys","count"],aA=["put","add","delete","clear"],Sy=new Map;function t5(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Sy.get(e))return Sy.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=aA.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||rA.includes(t)))return;const o=async function(l,...c){const d=this.transaction(l,s?"readwrite":"readonly");let f=d.store;return i&&(f=f.index(c.shift())),(await Promise.all([f[t](...c),s&&d.done]))[0]};return Sy.set(e,o),o}iA(n=>({...n,get:(e,t,i)=>t5(e,t)||n.get(e,t,i),has:(e,t)=>!!t5(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(cA(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function cA(n){return n.getComponent()?.type==="VERSION"}const E2="@firebase/app",n5="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uc=new Wm("@firebase/app"),uA="@firebase/app-compat",dA="@firebase/analytics-compat",hA="@firebase/analytics",fA="@firebase/app-check-compat",mA="@firebase/app-check",pA="@firebase/auth",gA="@firebase/auth-compat",yA="@firebase/database",vA="@firebase/data-connect",bA="@firebase/database-compat",wA="@firebase/functions",_A="@firebase/functions-compat",xA="@firebase/installations",SA="@firebase/installations-compat",NA="@firebase/messaging",EA="@firebase/messaging-compat",TA="@firebase/performance",CA="@firebase/performance-compat",kA="@firebase/remote-config",LA="@firebase/remote-config-compat",AA="@firebase/storage",DA="@firebase/storage-compat",OA="@firebase/firestore",jA="@firebase/ai",MA="@firebase/firestore-compat",RA="firebase",IA="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T2="[DEFAULT]",PA={[E2]:"fire-core",[uA]:"fire-core-compat",[hA]:"fire-analytics",[dA]:"fire-analytics-compat",[mA]:"fire-app-check",[fA]:"fire-app-check-compat",[pA]:"fire-auth",[gA]:"fire-auth-compat",[yA]:"fire-rtdb",[vA]:"fire-data-connect",[bA]:"fire-rtdb-compat",[wA]:"fire-fn",[_A]:"fire-fn-compat",[xA]:"fire-iid",[SA]:"fire-iid-compat",[NA]:"fire-fcm",[EA]:"fire-fcm-compat",[TA]:"fire-perf",[CA]:"fire-perf-compat",[kA]:"fire-rc",[LA]:"fire-rc-compat",[AA]:"fire-gcs",[DA]:"fire-gcs-compat",[OA]:"fire-fst",[MA]:"fire-fst-compat",[jA]:"fire-vertex","fire-js":"fire-js",[RA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0=new Map,UA=new Map,C2=new Map;function i5(n,e){try{n.container.addComponent(e)}catch(t){uc.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function va(n){const e=n.name;if(C2.has(e))return uc.debug(`There were multiple attempts to register component ${e}.`),!1;C2.set(e,n);for(const t of e0.values())i5(t,n);for(const t of UA.values())i5(t,n);return!0}function fc(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function rr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},au=new xd("app","Firebase",FA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new qr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw au.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vu=IA;function I4(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:T2,automaticDataCollectionEnabled:!0,...e},s=i.name;if(typeof s!="string"||!s)throw au.create("bad-app-name",{appName:String(s)});if(t||(t=T4()),!t)throw au.create("no-options");const o=e0.get(s);if(o){if(cc(t,o.options)&&cc(i,o.config))return o;throw au.create("duplicate-app",{appName:s})}const l=new YL(s);for(const d of C2.values())l.addComponent(d);const c=new $A(t,i,l);return e0.set(s,c),c}function zm(n=T2){const e=e0.get(n);if(!e&&n===T2&&T4())return I4();if(!e)throw au.create("no-app",{appName:n});return e}function Xo(n,e,t){let i=PA[n]??n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),uc.warn(l.join(" "));return}va(new qr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BA="firebase-heartbeat-database",WA=1,bm="firebase-heartbeat-store";let Ny=null;function P4(){return Ny||(Ny=R4(BA,WA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(bm)}catch(t){console.warn(t)}}}}).catch(n=>{throw au.create("idb-open",{originalErrorMessage:n.message})})),Ny}async function zA(n){try{const t=(await P4()).transaction(bm),i=await t.objectStore(bm).get(U4(n));return await t.done,i}catch(e){if(e instanceof Na)uc.warn(e.message);else{const t=au.create("idb-get",{originalErrorMessage:e?.message});uc.warn(t.message)}}}async function s5(n,e){try{const i=(await P4()).transaction(bm,"readwrite");await i.objectStore(bm).put(e,U4(n)),await i.done}catch(t){if(t instanceof Na)uc.warn(t.message);else{const i=au.create("idb-set",{originalErrorMessage:t?.message});uc.warn(i.message)}}}function U4(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HA=1024,qA=30;class VA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new GA(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=o5();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(s=>s.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>qA){const s=KA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){uc.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=o5(),{heartbeatsToSend:t,unsentEntries:i}=YA(this._heartbeatsCache.heartbeats),s=Qg(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return uc.warn(e),""}}}function o5(){return new Date().toISOString().substring(0,10)}function YA(n,e=HA){const t=[];let i=n.slice();for(const s of n){const o=t.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),r5(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),r5(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class GA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return A4()?D4().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zA(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return s5(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return s5(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function r5(n){return Qg(JSON.stringify({version:2,heartbeats:n})).length}function KA(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XA(n){va(new qr("platform-logger",e=>new lA(e),"PRIVATE")),va(new qr("heartbeat",e=>new VA(e),"PRIVATE")),Xo(E2,n5,n),Xo(E2,n5,"esm2020"),Xo("fire-js","")}XA("");function F4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QA=F4,$4=new xd("auth","Firebase",F4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0=new Wm("@firebase/auth");function ZA(n,...e){t0.logLevel<=xi.WARN&&t0.warn(`Auth (${vu}): ${n}`,...e)}function Pg(n,...e){t0.logLevel<=xi.ERROR&&t0.error(`Auth (${vu}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ba(n,...e){throw Sv(n,...e)}function Xa(n,...e){return Sv(n,...e)}function xv(n,e,t){const i={...QA(),[e]:t};return new xd("auth","Firebase",i).create(e,{appName:n.name})}function ac(n){return xv(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function JA(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ba(n,"argument-error"),xv(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Sv(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return $4.create(n,...e)}function kn(n,e,...t){if(!n)throw Sv(e,...t)}function sc(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Pg(e),new Error(e)}function dc(n,e){n||sc(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k2(){return typeof self<"u"&&self.location?.href||""}function e6(){return a5()==="http:"||a5()==="https:"}function a5(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(e6()||k4()||"connection"in navigator)?navigator.onLine:!0}function n6(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e,t){this.shortDelay=e,this.longDelay=t,dc(t>e,"Short delay should be less than long delay!"),this.isMobile=wv()||L4()}get(){return t6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(n,e){dc(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;sc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;sc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;sc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],o6=new Hm(3e4,6e4);function bu(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function mc(n,e,t,i,s={}){return W4(n,s,async()=>{let o={},l={};i&&(e==="GET"?l=i:o={body:JSON.stringify(i)});const c=Ph({key:n.config.apiKey,...l}).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const f={method:e,headers:d,...o};return TL()||(f.referrerPolicy="no-referrer"),n.emulatorConfig&&yu(n.emulatorConfig.host)&&(f.credentials="include"),B4.fetch()(await z4(n,n.config.apiHost,t,c),f)})}async function W4(n,e,t){n._canInitEmulator=!1;const i={...i6,...e};try{const s=new a6(n),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw lg(n,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const c=o.ok?l.errorMessage:l.error.message,[d,f]=c.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw lg(n,"credential-already-in-use",l);if(d==="EMAIL_EXISTS")throw lg(n,"email-already-in-use",l);if(d==="USER_DISABLED")throw lg(n,"user-disabled",l);const p=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw xv(n,p,f);ba(n,p)}}catch(s){if(s instanceof Na)throw s;ba(n,"network-request-failed",{message:String(s)})}}async function qm(n,e,t,i,s={}){const o=await mc(n,e,t,i,s);return"mfaPendingCredential"in o&&ba(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function z4(n,e,t,i){const s=`${e}${t}?${i}`,o=n,l=o.config.emulator?Nv(n.config,s):`${n.config.apiScheme}://${s}`;return s6.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function r6(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class a6{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Xa(this.auth,"network-request-failed")),o6.get())})}}function lg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=Xa(n,e,i);return s.customData._tokenResponse=t,s}function l5(n){return n!==void 0&&n.enterprise!==void 0}class l6{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return r6(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function c6(n,e){return mc(n,"GET","/v2/recaptchaConfig",bu(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u6(n,e){return mc(n,"POST","/v1/accounts:delete",e)}async function n0(n,e){return mc(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function d6(n,e=!1){const t=qs(n),i=await t.getIdToken(e),s=Ev(i);kn(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,l=o?.sign_in_provider;return{claims:s,token:i,authTime:tm(Ey(s.auth_time)),issuedAtTime:tm(Ey(s.iat)),expirationTime:tm(Ey(s.exp)),signInProvider:l||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Ey(n){return Number(n)*1e3}function Ev(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Pg("JWT malformed, contained fewer than 3 sections"),null;try{const s=Zg(t);return s?JSON.parse(s):(Pg("Failed to decode base64 JWT payload"),null)}catch(s){return Pg("Caught error parsing JWT payload as JSON",s?.toString()),null}}function c5(n){const e=Ev(n);return kn(e,"internal-error"),kn(typeof e.exp<"u","internal-error"),kn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Th(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Na&&h6(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function h6({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=tm(this.lastLoginAt),this.creationTime=tm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i0(n){const e=n.auth,t=await n.getIdToken(),i=await Th(n,n0(e,{idToken:t}));kn(i?.users.length,e,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=s.providerUserInfo?.length?H4(s.providerUserInfo):[],l=p6(n.providerData,o),c=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!l?.length,f=c?d:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new L2(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(n,p)}async function m6(n){const e=qs(n);await i0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function p6(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function H4(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g6(n,e){const t=await W4(n,{},async()=>{const i=Ph({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,l=await z4(n,s,"/v1/token",`key=${o}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:c,body:i};return n.emulatorConfig&&yu(n.emulatorConfig.host)&&(d.credentials="include"),B4.fetch()(l,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function y6(n,e){return mc(n,"POST","/v2/accounts:revokeToken",bu(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){kn(e.idToken,"internal-error"),kn(typeof e.idToken<"u","internal-error"),kn(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):c5(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){kn(e.length!==0,"internal-error");const t=c5(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(kn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:o}=await g6(e,t);this.updateTokensAndExpiration(i,s,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:o}=t,l=new fh;return i&&(kn(typeof i=="string","internal-error",{appName:e}),l.refreshToken=i),s&&(kn(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),o&&(kn(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fh,this.toJSON())}_performRefresh(){return sc("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(n,e){kn(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class za{constructor({uid:e,auth:t,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new f6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new L2(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Th(this,this.stsTokenManager.getToken(this.auth,e));return kn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return d6(this,e)}reload(){return m6(this)}_assign(e){this!==e&&(kn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new za({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){kn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await i0(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rr(this.auth.app))return Promise.reject(ac(this.auth));const e=await this.getIdToken();return await Th(this,u6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,s=t.email??void 0,o=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,d=t._redirectEventId??void 0,f=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:v,emailVerified:_,isAnonymous:b,providerData:T,stsTokenManager:C}=t;kn(v&&C,e,"internal-error");const A=fh.fromJSON(this.name,C);kn(typeof v=="string",e,"internal-error"),Vc(i,e.name),Vc(s,e.name),kn(typeof _=="boolean",e,"internal-error"),kn(typeof b=="boolean",e,"internal-error"),Vc(o,e.name),Vc(l,e.name),Vc(c,e.name),Vc(d,e.name),Vc(f,e.name),Vc(p,e.name);const I=new za({uid:v,auth:e,email:s,emailVerified:_,displayName:i,isAnonymous:b,photoURL:l,phoneNumber:o,tenantId:c,stsTokenManager:A,createdAt:f,lastLoginAt:p});return T&&Array.isArray(T)&&(I.providerData=T.map(ee=>({...ee}))),d&&(I._redirectEventId=d),I}static async _fromIdTokenResponse(e,t,i=!1){const s=new fh;s.updateFromServerResponse(t);const o=new za({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await i0(o),o}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];kn(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?H4(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!o?.length,c=new fh;c.updateFromIdToken(i);const d=new za({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:l}),f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new L2(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!o?.length};return Object.assign(d,f),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u5=new Map;function oc(n){dc(n instanceof Function,"Expected a class definition");let e=u5.get(n);return e?(dc(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,u5.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}q4.type="NONE";const d5=q4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(n,e,t){return`firebase:${n}:${e}:${t}`}class mh{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:o}=this.auth;this.fullUserKey=Ug(this.userKey,s.apiKey,o),this.fullPersistenceKey=Ug("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await n0(this.auth,{idToken:e}).catch(()=>{});return t?za._fromGetAccountInfoResponse(this.auth,t,e):null}return za._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new mh(oc(d5),e,i);const s=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let o=s[0]||oc(d5);const l=Ug(i,e.config.apiKey,e.name);let c=null;for(const f of t)try{const p=await f._get(l);if(p){let v;if(typeof p=="string"){const _=await n0(e,{idToken:p}).catch(()=>{});if(!_)break;v=await za._fromGetAccountInfoResponse(e,_,p)}else v=za._fromJSON(e,p);f!==o&&(c=v),o=f;break}}catch{}const d=s.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new mh(o,e,i):(o=d[0],c&&await o._set(l,c.toJSON()),await Promise.all(t.map(async f=>{if(f!==o)try{await f._remove(l)}catch{}})),new mh(o,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h5(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(K4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(V4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Q4(e))return"Blackberry";if(Z4(e))return"Webos";if(Y4(e))return"Safari";if((e.includes("chrome/")||G4(e))&&!e.includes("edge/"))return"Chrome";if(X4(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function V4(n=ur()){return/firefox\//i.test(n)}function Y4(n=ur()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function G4(n=ur()){return/crios\//i.test(n)}function K4(n=ur()){return/iemobile/i.test(n)}function X4(n=ur()){return/android/i.test(n)}function Q4(n=ur()){return/blackberry/i.test(n)}function Z4(n=ur()){return/webos/i.test(n)}function Tv(n=ur()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function v6(n=ur()){return Tv(n)&&!!window.navigator?.standalone}function b6(){return CL()&&document.documentMode===10}function J4(n=ur()){return Tv(n)||X4(n)||Z4(n)||Q4(n)||/windows phone/i.test(n)||K4(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e3(n,e=[]){let t;switch(n){case"Browser":t=h5(ur());break;case"Worker":t=`${h5(ur())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${vu}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=o=>new Promise((l,c)=>{try{const d=e(o);l(d)}catch(d){c(d)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _6(n,e={}){return mc(n,"GET","/v2/passwordPolicy",bu(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x6=6;class S6{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??x6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new f5(this),this.idTokenSubscription=new f5(this),this.beforeStateQueue=new w6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=oc(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await mh.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await n0(this,{idToken:e}),i=await za._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(rr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,l=i?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return kn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await i0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=n6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rr(this.app))return Promise.reject(ac(this));const t=e?qs(e):null;return t&&kn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&kn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rr(this.app)?Promise.reject(ac(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rr(this.app)?Promise.reject(ac(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(oc(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _6(this),t=new S6(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xd("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await y6(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&oc(e)||this._popupRedirectResolver;kn(t,this,"argument-error"),this.redirectPersistenceManager=await mh.create(this,[oc(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(kn(c,this,"internal-error"),c.then(()=>{l||o(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,i,s);return()=>{l=!0,d()}}else{const d=e.addObserver(t);return()=>{l=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return kn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=e3(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(rr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ZA(`Error while retrieving App Check token: ${e.error}`),e?.token}}function wu(n){return qs(n)}class f5{constructor(e){this.auth=e,this.observer=null,this.addObserver=IL(t=>this.observer=t)}get next(){return kn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let W0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function E6(n){W0=n}function t3(n){return W0.loadJS(n)}function T6(){return W0.recaptchaEnterpriseScript}function C6(){return W0.gapiScript}function k6(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class L6{constructor(){this.enterprise=new A6}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class A6{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const D6="recaptcha-enterprise",n3="NO_RECAPTCHA";class O6{constructor(e){this.type=D6,this.auth=wu(e)}async verify(e="verify",t=!1){async function i(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,c)=>{c6(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const f=new l6(d);return o.tenantId==null?o._agentRecaptchaConfig=f:o._tenantRecaptchaConfigs[o.tenantId]=f,l(f.siteKey)}}).catch(d=>{c(d)})})}function s(o,l,c){const d=window.grecaptcha;l5(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(f=>{l(f)}).catch(()=>{l(n3)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new L6().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{i(this.auth).then(c=>{if(!t&&l5(window.grecaptcha))s(c,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let d=T6();d.length!==0&&(d+=c),t3(d).then(()=>{s(c,o,l)}).catch(f=>{l(f)})}}).catch(c=>{l(c)})})}}async function m5(n,e,t,i=!1,s=!1){const o=new O6(n);let l;if(s)l=n3;else try{l=await o.verify(t)}catch{l=await o.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const d=c.phoneEnrollmentInfo.phoneNumber,f=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const d=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return i?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function A2(n,e,t,i,s){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await m5(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await m5(n,e,t,t==="getOobCode");return i(n,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j6(n,e){const t=fc(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(cc(o,e??{}))return s;ba(s,"already-initialized")}return t.initialize({options:e})}function M6(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(oc);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function R6(n,e,t){const i=wu(n);kn(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!1,o=i3(e),{host:l,port:c}=I6(e),d=c===null?"":`:${c}`,f={url:`${o}//${l}${d}/`},p=Object.freeze({host:l,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){kn(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),kn(cc(f,i.config.emulator)&&cc(p,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=f,i.emulatorConfig=p,i.settings.appVerificationDisabledForTesting=!0,yu(l)?(U0(`${o}//${l}${d}`),F0("Auth",!0)):P6()}function i3(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function I6(n){const e=i3(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const o=s[1];return{host:o,port:p5(i.substr(o.length+1))}}else{const[o,l]=i.split(":");return{host:o,port:p5(l)}}}function p5(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function P6(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return sc("not implemented")}_getIdTokenResponse(e){return sc("not implemented")}_linkToIdToken(e,t){return sc("not implemented")}_getReauthenticationResolver(e){return sc("not implemented")}}async function U6(n,e){return mc(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F6(n,e){return qm(n,"POST","/v1/accounts:signInWithPassword",bu(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $6(n,e){return qm(n,"POST","/v1/accounts:signInWithEmailLink",bu(n,e))}async function B6(n,e){return qm(n,"POST","/v1/accounts:signInWithEmailLink",bu(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm extends Cv{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new wm(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new wm(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return A2(e,t,"signInWithPassword",F6);case"emailLink":return $6(e,{email:this._email,oobCode:this._password});default:ba(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return A2(e,i,"signUpPassword",U6);case"emailLink":return B6(e,{idToken:t,email:this._email,oobCode:this._password});default:ba(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ph(n,e){return qm(n,"POST","/v1/accounts:signInWithIdp",bu(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W6="http://localhost";class dd extends Cv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new dd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ba("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,...o}=t;if(!i||!s)return null;const l=new dd(i,s);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return ph(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ph(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ph(e,t)}buildRequest(){const e={requestUri:W6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ph(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function H6(n){const e=Kf(Xf(n)).link,t=e?Kf(Xf(e)).deep_link_id:null,i=Kf(Xf(n)).deep_link_id;return(i?Kf(Xf(i)).link:null)||i||t||e||n}class kv{constructor(e){const t=Kf(Xf(e)),i=t.apiKey??null,s=t.oobCode??null,o=z6(t.mode??null);kn(i&&s&&o,"argument-error"),this.apiKey=i,this.operation=o,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=H6(e);try{return new kv(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(){this.providerId=Uh.PROVIDER_ID}static credential(e,t){return wm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=kv.parseLink(t);return kn(i,"argument-error"),wm._fromEmailAndCode(e,i.code,i.tenantId)}}Uh.PROVIDER_ID="password";Uh.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Uh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm extends Lv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc extends Vm{constructor(){super("facebook.com")}static credential(e){return dd._fromParams({providerId:Xc.PROVIDER_ID,signInMethod:Xc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xc.credentialFromTaggedObject(e)}static credentialFromError(e){return Xc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xc.credential(e.oauthAccessToken)}catch{return null}}}Xc.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xc.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl extends Vm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return dd._fromParams({providerId:xl.PROVIDER_ID,signInMethod:xl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xl.credentialFromTaggedObject(e)}static credentialFromError(e){return xl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return xl.credential(t,i)}catch{return null}}}xl.GOOGLE_SIGN_IN_METHOD="google.com";xl.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc extends Vm{constructor(){super("github.com")}static credential(e){return dd._fromParams({providerId:Qc.PROVIDER_ID,signInMethod:Qc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qc.credentialFromTaggedObject(e)}static credentialFromError(e){return Qc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qc.credential(e.oauthAccessToken)}catch{return null}}}Qc.GITHUB_SIGN_IN_METHOD="github.com";Qc.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc extends Vm{constructor(){super("twitter.com")}static credential(e,t){return dd._fromParams({providerId:Zc.PROVIDER_ID,signInMethod:Zc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Zc.credentialFromTaggedObject(e)}static credentialFromError(e){return Zc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Zc.credential(t,i)}catch{return null}}}Zc.TWITTER_SIGN_IN_METHOD="twitter.com";Zc.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q6(n,e){return qm(n,"POST","/v1/accounts:signUp",bu(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const o=await za._fromIdTokenResponse(e,i,s),l=g5(i);return new hd({user:o,providerId:l,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=g5(i);return new hd({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function g5(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0 extends Na{constructor(e,t,i,s){super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,s0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new s0(e,t,i,s)}}function s3(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?s0._fromErrorAndOperation(n,o,e,i):o})}async function V6(n,e,t=!1){const i=await Th(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return hd._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y6(n,e,t=!1){const{auth:i}=n;if(rr(i.app))return Promise.reject(ac(i));const s="reauthenticate";try{const o=await Th(n,s3(i,s,e,n),t);kn(o.idToken,i,"internal-error");const l=Ev(o.idToken);kn(l,i,"internal-error");const{sub:c}=l;return kn(n.uid===c,i,"user-mismatch"),hd._forOperation(n,s,o)}catch(o){throw o?.code==="auth/user-not-found"&&ba(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o3(n,e,t=!1){if(rr(n.app))return Promise.reject(ac(n));const i="signIn",s=await s3(n,i,e),o=await hd._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(o.user),o}async function G6(n,e){return o3(wu(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r3(n){const e=wu(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function K6(n,e,t){if(rr(n.app))return Promise.reject(ac(n));const i=wu(n),l=await A2(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",q6).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&r3(n),d}),c=await hd._fromIdTokenResponse(i,"signIn",l);return await i._updateCurrentUser(c.user),c}function X6(n,e,t){return rr(n.app)?Promise.reject(ac(n)):G6(qs(n),Uh.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&r3(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q6(n,e){return mc(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z6(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=qs(n),o={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await Th(i,Q6(i.auth,o));i.displayName=l.displayName||null,i.photoURL=l.photoUrl||null;const c=i.providerData.find(({providerId:d})=>d==="password");c&&(c.displayName=i.displayName,c.photoURL=i.photoURL),await i._updateTokensIfNecessary(l)}function J6(n,e,t,i){return qs(n).onIdTokenChanged(e,t,i)}function eD(n,e,t){return qs(n).beforeAuthStateChanged(e,t)}function tD(n,e,t,i){return qs(n).onAuthStateChanged(e,t,i)}function nD(n){return qs(n).signOut()}const o0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(o0,"1"),this.storage.removeItem(o0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD=1e3,sD=10;class l3 extends a3{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=J4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,d)=>{this.notifyListeners(l,d)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(i);!t&&this.localCache[i]===l||this.notifyListeners(i,l)},o=this.storage.getItem(i);b6()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,sD):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},iD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}l3.type="LOCAL";const oD=l3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3 extends a3{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}c3.type="SESSION";const u3=c3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new z0(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:o}=t.data,l=this.handlersMap[s];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const c=Array.from(l).map(async f=>f(t.origin,o)),d=await rD(c);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}z0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,l;return new Promise((c,d)=>{const f=Av("",20);s.port1.start();const p=setTimeout(()=>{d(new Error("unsupported_event"))},i);l={messageChannel:s,onMessage(v){const _=v;if(_.data.eventId===f)switch(_.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(_.data.response);break;default:clearTimeout(p),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function El(){return window}function lD(n){El().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d3(){return typeof El().WorkerGlobalScope<"u"&&typeof El().importScripts=="function"}async function cD(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function uD(){return navigator?.serviceWorker?.controller||null}function dD(){return d3()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3="firebaseLocalStorageDb",hD=1,r0="firebaseLocalStorage",f3="fbase_key";class Ym{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function H0(n,e){return n.transaction([r0],e?"readwrite":"readonly").objectStore(r0)}function fD(){const n=indexedDB.deleteDatabase(h3);return new Ym(n).toPromise()}function D2(){const n=indexedDB.open(h3,hD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(r0,{keyPath:f3})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(r0)?e(i):(i.close(),await fD(),e(await D2()))})})}async function y5(n,e,t){const i=H0(n,!0).put({[f3]:e,value:t});return new Ym(i).toPromise()}async function mD(n,e){const t=H0(n,!1).get(e),i=await new Ym(t).toPromise();return i===void 0?null:i.value}function v5(n,e){const t=H0(n,!0).delete(e);return new Ym(t).toPromise()}const pD=800,gD=3;class m3{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await D2(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>gD)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return d3()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=z0._getInstance(dD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await cD(),!this.activeServiceWorker)return;this.sender=new aD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||uD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await D2();return await y5(e,o0,"1"),await v5(e,o0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>y5(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>mD(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>v5(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=H0(s,!1).getAll();return new Ym(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),pD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}m3.type="LOCAL";const yD=m3;new Hm(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p3(n,e){return e?oc(e):(kn(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv extends Cv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ph(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ph(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ph(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function vD(n){return o3(n.auth,new Dv(n),n.bypassAuthState)}function bD(n){const{auth:e,user:t}=n;return kn(t,e,"internal-error"),Y6(t,new Dv(n),n.bypassAuthState)}async function wD(n){const{auth:e,user:t}=n;return kn(t,e,"internal-error"),V6(t,new Dv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{constructor(e,t,i,s,o=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:o,error:l,type:c}=e;if(l){this.reject(l);return}const d={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(d))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vD;case"linkViaPopup":case"linkViaRedirect":return wD;case"reauthViaPopup":case"reauthViaRedirect":return bD;default:ba(this.auth,"internal-error")}}resolve(e){dc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){dc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _D=new Hm(2e3,1e4);async function y3(n,e,t){if(rr(n.app))return Promise.reject(Xa(n,"operation-not-supported-in-this-environment"));const i=wu(n);JA(n,e,Lv);const s=p3(i,t);return new ed(i,"signInViaPopup",e,s).executeNotNull()}class ed extends g3{constructor(e,t,i,s,o){super(e,t,s,o),this.provider=i,this.authWindow=null,this.pollId=null,ed.currentPopupAction&&ed.currentPopupAction.cancel(),ed.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return kn(e,this.auth,"internal-error"),e}async onExecution(){dc(this.filter.length===1,"Popup operations only handle one event");const e=Av();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Xa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Xa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ed.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,_D.get())};e()}}ed.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD="pendingRedirect",Fg=new Map;class SD extends g3{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Fg.get(this.auth._key());if(!e){try{const i=await ND(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Fg.set(this.auth._key(),e)}return this.bypassAuthState||Fg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ND(n,e){const t=CD(e),i=TD(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}function ED(n,e){Fg.set(n._key(),e)}function TD(n){return oc(n._redirectPersistence)}function CD(n){return Ug(xD,n.config.apiKey,n.name)}async function kD(n,e,t=!1){if(rr(n.app))return Promise.reject(ac(n));const i=wu(n),s=p3(i,e),l=await new SD(i,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await i._persistUserIfCurrent(l.user),await i._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LD=600*1e3;class AD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!DD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!v3(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Xa(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=LD&&this.cachedEventUids.clear(),this.cachedEventUids.has(b5(e))}saveEventToCache(e){this.cachedEventUids.add(b5(e)),this.lastProcessedEventTime=Date.now()}}function b5(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function v3({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function DD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return v3(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OD(n,e={}){return mc(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,MD=/^https?/;async function RD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await OD(n);for(const t of e)try{if(ID(t))return}catch{}ba(n,"unauthorized-domain")}function ID(n){const e=k2(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===i}if(!MD.test(t))return!1;if(jD.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=new Hm(3e4,6e4);function w5(){const n=El().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function UD(n){return new Promise((e,t)=>{function i(){w5(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{w5(),t(Xa(n,"network-request-failed"))},timeout:PD.get()})}if(El().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(El().gapi?.load)i();else{const s=k6("iframefcb");return El()[s]=()=>{gapi.load?i():t(Xa(n,"network-request-failed"))},t3(`${C6()}?onload=${s}`).catch(o=>t(o))}}).catch(e=>{throw $g=null,e})}let $g=null;function FD(n){return $g=$g||UD(n),$g}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D=new Hm(5e3,15e3),BD="__/auth/iframe",WD="emulator/auth/iframe",zD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},HD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function qD(n){const e=n.config;kn(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Nv(e,WD):`https://${n.config.authDomain}/${BD}`,i={apiKey:e.apiKey,appName:n.name,v:vu},s=HD.get(n.config.apiHost);s&&(i.eid=s);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Ph(i).slice(1)}`}async function VD(n){const e=await FD(n),t=El().gapi;return kn(t,n,"internal-error"),e.open({where:document.body,url:qD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zD,dontclear:!0},i=>new Promise(async(s,o)=>{await i.restyle({setHideOnLeave:!1});const l=Xa(n,"network-request-failed"),c=El().setTimeout(()=>{o(l)},$D.get());function d(){El().clearTimeout(c),s(i)}i.ping(d).then(d,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},GD=500,KD=600,XD="_blank",QD="http://localhost";class _5{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ZD(n,e,t,i=GD,s=KD){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const d={...YD,width:i.toString(),height:s.toString(),top:o,left:l},f=ur().toLowerCase();t&&(c=G4(f)?XD:t),V4(f)&&(e=e||QD,d.scrollbars="yes");const p=Object.entries(d).reduce((_,[b,T])=>`${_}${b}=${T},`,"");if(v6(f)&&c!=="_self")return JD(e||"",c),new _5(null);const v=window.open(e||"",c,p);kn(v,n,"popup-blocked");try{v.focus()}catch{}return new _5(v)}function JD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eO="__/auth/handler",tO="emulator/auth/handler",nO=encodeURIComponent("fac");async function x5(n,e,t,i,s,o){kn(n.config.authDomain,n,"auth-domain-config-required"),kn(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:vu,eventId:s};if(e instanceof Lv){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",x2(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,v]of Object.entries({}))l[p]=v}if(e instanceof Vm){const p=e.getScopes().filter(v=>v!=="");p.length>0&&(l.scopes=p.join(","))}n.tenantId&&(l.tid=n.tenantId);const c=l;for(const p of Object.keys(c))c[p]===void 0&&delete c[p];const d=await n._getAppCheckToken(),f=d?`#${nO}=${encodeURIComponent(d)}`:"";return`${iO(n)}?${Ph(c).slice(1)}${f}`}function iO({config:n}){return n.emulator?Nv(n,tO):`https://${n.authDomain}/${eO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ty="webStorageSupport";class sO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=u3,this._completeRedirectFn=kD,this._overrideRedirectResult=ED}async _openPopup(e,t,i,s){dc(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await x5(e,t,i,k2(),s);return ZD(e,o,Av())}async _openRedirect(e,t,i,s){await this._originValidation(e);const o=await x5(e,t,i,k2(),s);return lD(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(dc(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await VD(e),i=new AD(e);return t.register("authEvent",s=>(kn(s?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ty,{type:Ty},s=>{const o=s?.[0]?.[Ty];o!==void 0&&t(!!o),ba(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=RD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return J4()||Y4()||Tv()}}const oO=sO;var S5="@firebase/auth",N5="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){kn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aO(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function lO(n){va(new qr("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=i.options;kn(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});const d={apiKey:l,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:e3(n)},f=new N6(i,s,o,d);return M6(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),va(new qr("auth-internal",e=>{const t=wu(e.getProvider("auth").getImmediate());return(i=>new rO(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xo(S5,N5,aO(n)),Xo(S5,N5,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cO=300,uO=C4("authIdTokenMaxAge")||cO;let E5=null;const dO=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>uO)return;const s=t?.token;E5!==s&&(E5=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function hO(n=zm()){const e=fc(n,"auth");if(e.isInitialized())return e.getImmediate();const t=j6(n,{popupRedirectResolver:oO,persistence:[yD,oD,u3]}),i=C4("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const l=dO(o.toString());eD(t,l,()=>l(t.currentUser)),J6(t,c=>l(c))}}const s=E4("auth");return s&&R6(t,`http://${s}`),t}function fO(){return document.getElementsByTagName("head")?.[0]??document}E6({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const o=Xa("internal-error");o.customData=s,t(o)},i.type="text/javascript",i.charset="UTF-8",fO().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});lO("Browser");var T5={};const C5="@firebase/database",k5="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let b3="";function mO(n){b3=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),eo(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:vm(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Ll(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new pO(e)}}catch{}return new gO},td=w3("localStorage"),yO=w3("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh=new Wm("@firebase/database"),vO=(function(){let n=1;return function(){return n++}})(),_3=function(n){const e=FL(n),t=new RL;t.update(e);const i=t.digest();return gv.encodeByteArray(i)},Gm=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Gm.apply(null,i):typeof i=="object"?e+=eo(i):e+=i,e+=" "}return e};let nm=null,L5=!0;const bO=function(n,e){Xt(!0,"Can't turn on custom loggers persistently."),gh.logLevel=xi.VERBOSE,nm=gh.log.bind(gh)},Oo=function(...n){if(L5===!0&&(L5=!1,nm===null&&yO.get("logging_enabled")===!0&&bO()),nm){const e=Gm.apply(null,n);nm(e)}},Km=function(n){return function(...e){Oo(n,...e)}},O2=function(...n){const e="FIREBASE INTERNAL ERROR: "+Gm(...n);gh.error(e)},hc=function(...n){const e=`FIREBASE FATAL ERROR: ${Gm(...n)}`;throw gh.error(e),new Error(e)},cr=function(...n){const e="FIREBASE WARNING: "+Gm(...n);gh.warn(e)},wO=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&cr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ov=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},_O=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ch="[MIN_NAME]",fd="[MAX_NAME]",Sd=function(n,e){if(n===e)return 0;if(n===Ch||e===fd)return-1;if(e===Ch||n===fd)return 1;{const t=A5(n),i=A5(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},xO=function(n,e){return n===e?0:n<e?-1:1},Uf=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+eo(e))},jv=function(n){if(typeof n!="object"||n===null)return eo(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=eo(e[i]),t+=":",t+=jv(n[e[i]]);return t+="}",t},x3=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function jo(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const S3=function(n){Xt(!Ov(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,l,c,d;n===0?(o=0,l=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(c=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=c+i,l=Math.round(n*Math.pow(2,t-c)-Math.pow(2,t))):(o=0,l=Math.round(n/Math.pow(2,1-i-t))));const f=[];for(d=t;d;d-=1)f.push(l%2?1:0),l=Math.floor(l/2);for(d=e;d;d-=1)f.push(o%2?1:0),o=Math.floor(o/2);f.push(s?1:0),f.reverse();const p=f.join("");let v="";for(d=0;d<64;d+=8){let _=parseInt(p.substr(d,8),2).toString(16);_.length===1&&(_="0"+_),v=v+_}return v.toLowerCase()},SO=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},NO=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function EO(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const TO=new RegExp("^-?(0*)\\d{1,10}$"),CO=-2147483648,kO=2147483647,A5=function(n){if(TO.test(n)){const e=Number(n);if(e>=CO&&e<=kO)return e}return null},Fh=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw cr("Exception was thrown by user callback.",t),e},Math.floor(0))}},LO=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},im=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,rr(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){cr(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Oo("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',cr(e)}}class Bg{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Bg.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv="5",N3="v",E3="s",T3="r",C3="f",k3=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,L3="ls",A3="p",j2="ac",D3="websocket",O3="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3{constructor(e,t,i,s,o=!1,l="",c=!1,d=!1,f=null){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=l,this.includeNamespaceInQueryParams=c,this.isUsingEmulator=d,this.emulatorOptions=f,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=td.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&td.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function OO(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function M3(n,e,t){Xt(typeof e=="string","typeof type must == string"),Xt(typeof t=="object","typeof params must == object");let i;if(e===D3)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===O3)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);OO(n)&&(t.ns=n.namespace);const s=[];return jo(t,(o,l)=>{s.push(o+"="+l)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jO{constructor(){this.counters_={}}incrementCounter(e,t=1){Ll(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return vL(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy={},ky={};function Rv(n){const e=n.toString();return Cy[e]||(Cy[e]=new jO),Cy[e]}function MO(n,e){const t=n.toString();return ky[t]||(ky[t]=e()),ky[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Fh(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D5="start",IO="close",PO="pLPCommand",UO="pRTLPCB",R3="id",I3="pw",P3="ser",FO="cb",$O="seg",BO="ts",WO="d",zO="dframe",U3=1870,F3=30,HO=U3-F3,qO=25e3,VO=3e4;class uh{constructor(e,t,i,s,o,l,c){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=l,this.lastSessionId=c,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Km(e),this.stats_=Rv(t),this.urlFn=d=>(this.appCheckToken&&(d[j2]=this.appCheckToken),M3(t,O3,d))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new RO(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(VO)),_O(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Iv((...o)=>{const[l,c,d,f,p]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,l===D5)this.id=c,this.password=d;else if(l===IO)c?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(c,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+l)},(...o)=>{const[l,c]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(l,c)},()=>{this.onClosed_()},this.urlFn);const i={};i[D5]="t",i[P3]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[FO]=this.scriptTagHolder.uniqueCallbackIdentifier),i[N3]=Mv,this.transportSessionId&&(i[E3]=this.transportSessionId),this.lastSessionId&&(i[L3]=this.lastSessionId),this.applicationId&&(i[A3]=this.applicationId),this.appCheckToken&&(i[j2]=this.appCheckToken),typeof location<"u"&&location.hostname&&k3.test(location.hostname)&&(i[T3]=C3);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){uh.forceAllow_=!0}static forceDisallow(){uh.forceDisallow_=!0}static isAvailable(){return uh.forceAllow_?!0:!uh.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!SO()&&!NO()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=eo(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=S4(t),s=x3(i,HO);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[zO]="t",i[R3]=e,i[I3]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=eo(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Iv{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=vO(),window[PO+this.uniqueCallbackIdentifier]=e,window[UO+this.uniqueCallbackIdentifier]=t,this.myIFrame=Iv.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(c){Oo("frame writing exception"),c.stack&&Oo(c.stack),Oo(c)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Oo("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[R3]=this.myID,e[I3]=this.myPW,e[P3]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+F3+i.length<=U3;){const l=this.pendingSegs.shift();i=i+"&"+$O+s+"="+l.seg+"&"+BO+s+"="+l.ts+"&"+WO+s+"="+l.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(qO)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Oo("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO=16384,GO=45e3;let a0=null;typeof MozWebSocket<"u"?a0=MozWebSocket:typeof WebSocket<"u"&&(a0=WebSocket);class Wa{constructor(e,t,i,s,o,l,c){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Km(this.connId),this.stats_=Rv(t),this.connURL=Wa.connectionURL_(t,l,c,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const l={};return l[N3]=Mv,typeof location<"u"&&location.hostname&&k3.test(location.hostname)&&(l[T3]=C3),t&&(l[E3]=t),i&&(l[L3]=i),s&&(l[j2]=s),o&&(l[A3]=o),M3(e,D3,l)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,td.set("previous_websocket_failure",!0);try{let i;kL(),this.mySock=new a0(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Wa.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&a0!==null&&!Wa.forceDisallow_}static previouslyFailed(){return td.isInMemoryStorage||td.get("previous_websocket_failure")===!0}markConnectionHealthy(){td.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=vm(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Xt(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=eo(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=x3(t,YO);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(GO))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Wa.responsesRequiredToBeHealthy=2;Wa.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{static get ALL_TRANSPORTS(){return[uh,Wa]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=Wa&&Wa.isAvailable();let i=t&&!Wa.previouslyFailed();if(e.webSocketOnly&&(t||cr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Wa];else{const s=this.transports_=[];for(const o of _m.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);_m.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}_m.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KO=6e4,XO=5e3,QO=10*1024,ZO=100*1024,Ly="t",O5="d",JO="s",j5="r",ej="e",M5="o",R5="a",I5="n",P5="p",tj="h";class nj{constructor(e,t,i,s,o,l,c,d,f,p){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=l,this.onReady_=c,this.onDisconnect_=d,this.onKill_=f,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Km("c:"+this.id+":"),this.transportManager_=new _m(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=im(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>ZO?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>QO?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ly in e){const t=e[Ly];t===R5?this.upgradeIfSecondaryHealthy_():t===j5?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===M5&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Uf("t",e),i=Uf("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:P5,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:R5,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:I5,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Uf("t",e),i=Uf("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Uf(Ly,e);if(O5 in e){const i=e[O5];if(t===tj){const s={...i};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===I5){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===JO?this.onConnectionShutdown_(i):t===j5?this.onReset_(i):t===ej?O2("Server Error: "+i):t===M5?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):O2("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Mv!==i&&cr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),im(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(KO))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):im(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(XO))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:P5,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(td.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $3{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B3{constructor(e){this.allowedEvents_=e,this.listeners_={},Xt(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){Xt(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0 extends B3{static getInstance(){return new l0}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!wv()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Xt(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U5=32,F5=768;class Pi{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function bi(){return new Pi("")}function Jn(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function du(n){return n.pieces_.length-n.pieceNum_}function Ki(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Pi(n.pieces_,e)}function Pv(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function ij(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function xm(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function W3(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Pi(e,0)}function Ts(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof Pi)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new Pi(t,0)}function ii(n){return n.pieceNum_>=n.pieces_.length}function ar(n,e){const t=Jn(n),i=Jn(e);if(t===null)return e;if(t===i)return ar(Ki(n),Ki(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function sj(n,e){const t=xm(n,0),i=xm(e,0);for(let s=0;s<t.length&&s<i.length;s++){const o=Sd(t[s],i[s]);if(o!==0)return o}return t.length===i.length?0:t.length<i.length?-1:1}function Uv(n,e){if(du(n)!==du(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function ga(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(du(n)>du(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class oj{constructor(e,t){this.errorPrefix_=t,this.parts_=xm(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=B0(this.parts_[i]);z3(this)}}function rj(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=B0(e),z3(n)}function aj(n){const e=n.parts_.pop();n.byteLength_-=B0(e),n.parts_.length>0&&(n.byteLength_-=1)}function z3(n){if(n.byteLength_>F5)throw new Error(n.errorPrefix_+"has a key path longer than "+F5+" bytes ("+n.byteLength_+").");if(n.parts_.length>U5)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+U5+") or object contains a cycle "+Gu(n))}function Gu(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv extends B3{static getInstance(){return new Fv}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(e){return Xt(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ff=1e3,lj=300*1e3,$5=30*1e3,cj=1.3,uj=3e4,dj="server_kill",B5=3;class lc extends $3{constructor(e,t,i,s,o,l,c,d){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=l,this.appCheckTokenProvider_=c,this.authOverride_=d,this.id=lc.nextPersistentConnectionId_++,this.log_=Km("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ff,this.maxReconnectDelay_=lj,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Fv.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&l0.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(eo(o)),Xt(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new Bm,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:l=>{const c=l.d;l.s==="ok"?t.resolve(c):t.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,l=e._path.toString();this.log_("Listen called for "+l+" "+o),this.listens.has(l)||this.listens.set(l,new Map),Xt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Xt(!this.listens.get(l).has(o),"listen() called twice for same path/queryId.");const c={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(l).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},l="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(l,o,c=>{const d=c.d,f=c.s;lc.warnOnListenWarnings_(d,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",c),f!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(f,d))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Ll(e,"w")){const i=Eh(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();cr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||ML(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=$5)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=jL(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,l=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),Xt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},l="n";s&&(o.q=i,o.t=s),this.sendRequest(l,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,l=>{s&&setTimeout(()=>{s(l.s,l.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const l={p:t,d:i};o!==void 0&&(l.h=o),this.outstandingPuts_.push({action:e,request:l,onComplete:s}),this.outstandingPutCount_++;const c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+eo(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):O2("Unrecognized action received from server: "+eo(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Xt(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ff,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ff,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>uj&&(this.reconnectDelay_=Ff),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*cj)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+lc.nextConnectionId_++,o=this.lastSessionId;let l=!1,c=null;const d=function(){c?c.close():(l=!0,i())},f=function(v){Xt(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(v)};this.realtime_={close:d,sendRequest:f};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[v,_]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);l?Oo("getToken() completed but was canceled"):(Oo("getToken() completed. Creating connection."),this.authToken_=v&&v.accessToken,this.appCheckToken_=_&&_.token,c=new nj(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,b=>{cr(b+" ("+this.repoInfo_.toString()+")"),this.interrupt(dj)},o))}catch(v){this.log_("Failed to get token: "+v),l||(this.repoInfo_.nodeAdmin&&cr(v),d())}}}interrupt(e){Oo("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Oo("Resuming connection for reason: "+e),delete this.interruptReasons_[e],x2(this.interruptReasons_)&&(this.reconnectDelay_=Ff,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>jv(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new Pi(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){Oo("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=B5&&(this.reconnectDelay_=$5,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Oo("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=B5&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+b3.replace(/\./g,"-")]=1,wv()?e["framework.cordova"]=1:L4()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=l0.getInstance().currentlyOnline();return x2(this.interruptReasons_)&&e}}lc.nextPersistentConnectionId_=0;lc.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ei(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new ei(Ch,e),s=new ei(Ch,t);return this.compare(i,s)!==0}minPost(){return ei.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cg;class H3 extends q0{static get __EMPTY_NODE(){return cg}static set __EMPTY_NODE(e){cg=e}compare(e,t){return Sd(e.name,t.name)}isDefinedOn(e){throw Ih("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ei.MIN}maxPost(){return new ei(fd,cg)}makePost(e,t){return Xt(typeof e=="string","KeyIndex indexValue must always be a string."),new ei(e,cg)}toString(){return".key"}}const yh=new H3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(e=e,l=t?i(e.key,t):1,s&&(l*=-1),l<0)this.isReverse_?e=e.left:e=e.right;else if(l===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class go{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??go.RED,this.left=s??Tr.EMPTY_NODE,this.right=o??Tr.EMPTY_NODE}copy(e,t,i,s,o){return new go(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Tr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return Tr.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,go.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,go.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}go.RED=!0;go.BLACK=!1;class hj{copy(e,t,i,s,o){return this}insert(e,t,i){return new go(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Tr{constructor(e,t=Tr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Tr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,go.BLACK,null,null))}remove(e){return new Tr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,go.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ug(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new ug(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new ug(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new ug(this.root_,null,this.comparator_,!0,e)}}Tr.EMPTY_NODE=new hj;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fj(n,e){return Sd(n.name,e.name)}function $v(n,e){return Sd(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let M2;function mj(n){M2=n}const q3=function(n){return typeof n=="number"?"number:"+S3(n):"string:"+n},V3=function(n){if(n.isLeafNode()){const e=n.val();Xt(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Ll(e,".sv"),"Priority must be a string or number.")}else Xt(n===M2||n.isEmpty(),"priority of unexpected type.");Xt(n===M2||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let W5;class po{static set __childrenNodeConstructor(e){W5=e}static get __childrenNodeConstructor(){return W5}constructor(e,t=po.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Xt(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),V3(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new po(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:po.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ii(e)?this:Jn(e)===".priority"?this.priorityNode_:po.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:po.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=Jn(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(Xt(i!==".priority"||du(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,po.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ki(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+q3(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=S3(this.value_):e+=this.value_,this.lazyHash_=_3(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===po.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof po.__childrenNodeConstructor?-1:(Xt(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=po.VALUE_TYPE_ORDER.indexOf(t),o=po.VALUE_TYPE_ORDER.indexOf(i);return Xt(s>=0,"Unknown leaf type: "+t),Xt(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}po.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Y3,G3;function pj(n){Y3=n}function gj(n){G3=n}class yj extends q0{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?Sd(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ei.MIN}maxPost(){return new ei(fd,new po("[PRIORITY-POST]",G3))}makePost(e,t){const i=Y3(e);return new ei(t,new po("[PRIORITY-POST]",i))}toString(){return".priority"}}const Cs=new yj;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=Math.log(2);class bj{constructor(e){const t=o=>parseInt(Math.log(o)/vj,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const c0=function(n,e,t,i){n.sort(e);const s=function(d,f){const p=f-d;let v,_;if(p===0)return null;if(p===1)return v=n[d],_=t?t(v):v,new go(_,v.node,go.BLACK,null,null);{const b=parseInt(p/2,10)+d,T=s(d,b),C=s(b+1,f);return v=n[b],_=t?t(v):v,new go(_,v.node,go.BLACK,T,C)}},o=function(d){let f=null,p=null,v=n.length;const _=function(T,C){const A=v-T,I=v;v-=T;const ee=s(A+1,I),G=n[A],K=t?t(G):G;b(new go(K,G.node,C,null,ee))},b=function(T){f?(f.left=T,f=T):(p=T,f=T)};for(let T=0;T<d.count;++T){const C=d.nextBitIsOne(),A=Math.pow(2,d.count-(T+1));C?_(A,go.BLACK):(_(A,go.BLACK),_(A,go.RED))}return p},l=new bj(n.length),c=o(l);return new Tr(i||e,c)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ay;const ih={};class rc{static get Default(){return Xt(ih&&Cs,"ChildrenNode.ts has not been loaded"),Ay=Ay||new rc({".priority":ih},{".priority":Cs}),Ay}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=Eh(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Tr?t:null}hasIndex(e){return Ll(this.indexSet_,e.toString())}addIndex(e,t){Xt(e!==yh,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(ei.Wrap);let l=o.getNext();for(;l;)s=s||e.isDefinedOn(l.node),i.push(l),l=o.getNext();let c;s?c=c0(i,e.getCompare()):c=ih;const d=e.toString(),f={...this.indexSet_};f[d]=e;const p={...this.indexes_};return p[d]=c,new rc(p,f)}addToIndexes(e,t){const i=Jg(this.indexes_,(s,o)=>{const l=Eh(this.indexSet_,o);if(Xt(l,"Missing index implementation for "+o),s===ih)if(l.isDefinedOn(e.node)){const c=[],d=t.getIterator(ei.Wrap);let f=d.getNext();for(;f;)f.name!==e.name&&c.push(f),f=d.getNext();return c.push(e),c0(c,l.getCompare())}else return ih;else{const c=t.get(e.name);let d=s;return c&&(d=d.remove(new ei(e.name,c))),d.insert(e,e.node)}});return new rc(i,this.indexSet_)}removeFromIndexes(e,t){const i=Jg(this.indexes_,s=>{if(s===ih)return s;{const o=t.get(e.name);return o?s.remove(new ei(e.name,o)):s}});return new rc(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $f;class Ln{static get EMPTY_NODE(){return $f||($f=new Ln(new Tr($v),null,rc.Default))}constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&V3(this.priorityNode_),this.children_.isEmpty()&&Xt(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||$f}updatePriority(e){return this.children_.isEmpty()?this:new Ln(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?$f:t}}getChild(e){const t=Jn(e);return t===null?this:this.getImmediateChild(t).getChild(Ki(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(Xt(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new ei(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const l=s.isEmpty()?$f:this.priorityNode_;return new Ln(s,l,o)}}updateChild(e,t){const i=Jn(e);if(i===null)return t;{Xt(Jn(e)!==".priority"||du(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Ki(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(Cs,(l,c)=>{t[l]=c.val(e),i++,o&&Ln.INTEGER_REGEXP_.test(l)?s=Math.max(s,Number(l)):o=!1}),!e&&o&&s<2*i){const l=[];for(const c in t)l[c]=t[c];return l}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+q3(this.getPriority().val())+":"),this.forEachChild(Cs,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":_3(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new ei(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new ei(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new ei(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,ei.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,ei.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xm?-1:0}withIndex(e){if(e===yh||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Ln(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===yh||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(Cs),s=t.getIterator(Cs);let o=i.getNext(),l=s.getNext();for(;o&&l;){if(o.name!==l.name||!o.node.equals(l.node))return!1;o=i.getNext(),l=s.getNext()}return o===null&&l===null}else return!1;else return!1}}resolveIndex_(e){return e===yh?null:this.indexMap_.get(e.toString())}}Ln.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class wj extends Ln{constructor(){super(new Tr($v),Ln.EMPTY_NODE,rc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ln.EMPTY_NODE}isEmpty(){return!1}}const Xm=new wj;Object.defineProperties(ei,{MIN:{value:new ei(Ch,Ln.EMPTY_NODE)},MAX:{value:new ei(fd,Xm)}});H3.__EMPTY_NODE=Ln.EMPTY_NODE;po.__childrenNodeConstructor=Ln;mj(Xm);gj(Xm);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j=!0;function Js(n,e=null){if(n===null)return Ln.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),Xt(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new po(t,Js(e))}if(!(n instanceof Array)&&_j){const t=[];let i=!1;if(jo(n,(l,c)=>{if(l.substring(0,1)!=="."){const d=Js(c);d.isEmpty()||(i=i||!d.getPriority().isEmpty(),t.push(new ei(l,d)))}}),t.length===0)return Ln.EMPTY_NODE;const o=c0(t,fj,l=>l.name,$v);if(i){const l=c0(t,Cs.getCompare());return new Ln(o,Js(e),new rc({".priority":l},{".priority":Cs}))}else return new Ln(o,Js(e),rc.Default)}else{let t=Ln.EMPTY_NODE;return jo(n,(i,s)=>{if(Ll(n,i)&&i.substring(0,1)!=="."){const o=Js(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(Js(e))}}pj(Js);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj extends q0{constructor(e){super(),this.indexPath_=e,Xt(!ii(e)&&Jn(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?Sd(e.name,t.name):o}makePost(e,t){const i=Js(e),s=Ln.EMPTY_NODE.updateChild(this.indexPath_,i);return new ei(t,s)}maxPost(){const e=Ln.EMPTY_NODE.updateChild(this.indexPath_,Xm);return new ei(fd,e)}toString(){return xm(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj extends q0{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Sd(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ei.MIN}maxPost(){return ei.MAX}makePost(e,t){const i=Js(e);return new ei(t,i)}toString(){return".value"}}const Nj=new Sj;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K3(n){return{type:"value",snapshotNode:n}}function kh(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Sm(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Nm(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Ej(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e){this.index_=e}updateChild(e,t,i,s,o,l){Xt(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const c=e.getImmediateChild(t);return c.getChild(s).equals(i.getChild(s))&&c.isEmpty()===i.isEmpty()||(l!=null&&(i.isEmpty()?e.hasChild(t)?l.trackChildChange(Sm(t,c)):Xt(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):c.isEmpty()?l.trackChildChange(kh(t,i)):l.trackChildChange(Nm(t,i,c))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(Cs,(s,o)=>{t.hasChild(s)||i.trackChildChange(Sm(s,o))}),t.isLeafNode()||t.forEachChild(Cs,(s,o)=>{if(e.hasChild(s)){const l=e.getImmediateChild(s);l.equals(o)||i.trackChildChange(Nm(s,o,l))}else i.trackChildChange(kh(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ln.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(e){this.indexedFilter_=new Bv(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Em.getStartPost_(e),this.endPost_=Em.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,l){return this.matches(new ei(t,i))||(i=Ln.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,l)}updateFullNode(e,t,i){t.isLeafNode()&&(t=Ln.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(Ln.EMPTY_NODE);const o=this;return t.forEachChild(Cs,(l,c)=>{o.matches(new ei(l,c))||(s=s.updateImmediateChild(l,Ln.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Em(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,l){return this.rangedFilter_.matches(new ei(t,i))||(i=Ln.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,l):this.fullLimitUpdateChild_(e,t,i,o,l)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=Ln.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=Ln.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;o.hasNext()&&l<this.limit_;){const c=o.getNext();if(this.withinDirectionalStart(c))if(this.withinDirectionalEnd(c))s=s.updateImmediateChild(c.name,c.node),l++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(Ln.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let l=0;for(;o.hasNext();){const c=o.getNext();l<this.limit_&&this.withinDirectionalStart(c)&&this.withinDirectionalEnd(c)?l++:s=s.updateImmediateChild(c.name,Ln.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let l;if(this.reverse_){const v=this.index_.getCompare();l=(_,b)=>v(b,_)}else l=this.index_.getCompare();const c=e;Xt(c.numChildren()===this.limit_,"");const d=new ei(t,i),f=this.reverse_?c.getFirstChild(this.index_):c.getLastChild(this.index_),p=this.rangedFilter_.matches(d);if(c.hasChild(t)){const v=c.getImmediateChild(t);let _=s.getChildAfterChild(this.index_,f,this.reverse_);for(;_!=null&&(_.name===t||c.hasChild(_.name));)_=s.getChildAfterChild(this.index_,_,this.reverse_);const b=_==null?1:l(_,d);if(p&&!i.isEmpty()&&b>=0)return o?.trackChildChange(Nm(t,i,v)),c.updateImmediateChild(t,i);{o?.trackChildChange(Sm(t,v));const C=c.updateImmediateChild(t,Ln.EMPTY_NODE);return _!=null&&this.rangedFilter_.matches(_)?(o?.trackChildChange(kh(_.name,_.node)),C.updateImmediateChild(_.name,_.node)):C}}else return i.isEmpty()?e:p&&l(f,d)>=0?(o!=null&&(o.trackChildChange(Sm(f.name,f.node)),o.trackChildChange(kh(t,i))),c.updateImmediateChild(t,i).updateImmediateChild(f.name,Ln.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Cs}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Xt(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Xt(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ch}hasEnd(){return this.endSet_}getIndexEndValue(){return Xt(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Xt(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:fd}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Xt(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Cs}copy(){const e=new Wv;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Cj(n){return n.loadsAllData()?new Bv(n.getIndex()):n.hasLimit()?new Tj(n):new Em(n)}function z5(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Cs?t="$priority":n.index_===Nj?t="$value":n.index_===yh?t="$key":(Xt(n.index_ instanceof xj,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=eo(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=eo(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+eo(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=eo(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+eo(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function H5(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Cs&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0 extends $3{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(Xt(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=Km("p:rest:"),this.listens_={}}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const l=u0.getListenId_(e,i),c={};this.listens_[l]=c;const d=z5(e._queryParams);this.restRequest_(o+".json",d,(f,p)=>{let v=p;if(f===404&&(v=null,f=null),f===null&&this.onDataUpdate_(o,v,!1,i),Eh(this.listens_,l)===c){let _;f?f===401?_="permission_denied":_="rest_error:"+f:_="ok",s(_,null)}})}unlisten(e,t){const i=u0.getListenId_(e,t);delete this.listens_[i]}get(e){const t=z5(e._queryParams),i=e._path.toString(),s=new Bm;return this.restRequest_(i+".json",t,(o,l)=>{let c=l;o===404&&(c=null,o=null),o===null?(this.onDataUpdate_(i,c,!1,null),s.resolve(c)):s.reject(new Error(c))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ph(t);this.log_("Sending REST request for "+l);const c=new XMLHttpRequest;c.onreadystatechange=()=>{if(i&&c.readyState===4){this.log_("REST Response for "+l+" received. status:",c.status,"response:",c.responseText);let d=null;if(c.status>=200&&c.status<300){try{d=vm(c.responseText)}catch{cr("Failed to parse JSON response for "+l+": "+c.responseText)}i(null,d)}else c.status!==401&&c.status!==404&&cr("Got unsuccessful REST response for "+l+" Status: "+c.status),i(c.status);i=null}},c.open("GET",l,!0),c.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(){this.rootNode_=Ln.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(){return{value:null,children:new Map}}function X3(n,e,t){if(ii(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=Jn(e);n.children.has(i)||n.children.set(i,d0());const s=n.children.get(i);e=Ki(e),X3(s,e,t)}}function R2(n,e,t){n.value!==null?t(e,n.value):Lj(n,(i,s)=>{const o=new Pi(e.toString()+"/"+i);R2(s,o,t)})}function Lj(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&jo(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q5=10*1e3,Dj=30*1e3,Oj=300*1e3;class jj{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Aj(e);const i=q5+(Dj-q5)*Math.random();im(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;jo(e,(s,o)=>{o>0&&Ll(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),im(this.reportStats_.bind(this),Math.floor(Math.random()*2*Oj))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ha;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ha||(Ha={}));function zv(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Hv(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function qv(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=Ha.ACK_USER_WRITE,this.source=zv()}operationForChild(e){if(ii(this.path)){if(this.affectedTree.value!=null)return Xt(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Pi(e));return new h0(bi(),t,this.revert)}}else return Xt(Jn(this.path)===e,"operationForChild called for unrelated child."),new h0(Ki(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e,t){this.source=e,this.path=t,this.type=Ha.LISTEN_COMPLETE}operationForChild(e){return ii(this.path)?new Tm(this.source,bi()):new Tm(this.source,Ki(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=Ha.OVERWRITE}operationForChild(e){return ii(this.path)?new md(this.source,bi(),this.snap.getImmediateChild(e)):new md(this.source,Ki(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=Ha.MERGE}operationForChild(e){if(ii(this.path)){const t=this.children.subtree(new Pi(e));return t.isEmpty()?null:t.value?new md(this.source,bi(),t.value):new Lh(this.source,bi(),t)}else return Xt(Jn(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Lh(this.source,Ki(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ii(e))return this.isFullyInitialized()&&!this.filtered_;const t=Jn(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mj{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Rj(n,e,t,i){const s=[],o=[];return e.forEach(l=>{l.type==="child_changed"&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&o.push(Ej(l.childName,l.snapshotNode))}),Bf(n,s,"child_removed",e,i,t),Bf(n,s,"child_added",e,i,t),Bf(n,s,"child_moved",o,i,t),Bf(n,s,"child_changed",e,i,t),Bf(n,s,"value",e,i,t),s}function Bf(n,e,t,i,s,o){const l=i.filter(c=>c.type===t);l.sort((c,d)=>Pj(n,c,d)),l.forEach(c=>{const d=Ij(n,c,o);s.forEach(f=>{f.respondsTo(c.type)&&e.push(f.createEvent(d,n.query_))})})}function Ij(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Pj(n,e,t){if(e.childName==null||t.childName==null)throw Ih("Should only compare child_ events.");const i=new ei(e.childName,e.snapshotNode),s=new ei(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(n,e){return{eventCache:n,serverCache:e}}function sm(n,e,t,i){return V0(new hu(e,t,i),n.serverCache)}function Q3(n,e,t,i){return V0(n.eventCache,new hu(e,t,i))}function f0(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function pd(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dy;const Uj=()=>(Dy||(Dy=new Tr(xO)),Dy);class Gi{static fromObject(e){let t=new Gi(null);return jo(e,(i,s)=>{t=t.set(new Pi(i),s)}),t}constructor(e,t=Uj()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:bi(),value:this.value};if(ii(e))return null;{const i=Jn(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(Ki(e),t);return o!=null?{path:Ts(new Pi(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ii(e))return this;{const t=Jn(e),i=this.children.get(t);return i!==null?i.subtree(Ki(e)):new Gi(null)}}set(e,t){if(ii(e))return new Gi(t,this.children);{const i=Jn(e),o=(this.children.get(i)||new Gi(null)).set(Ki(e),t),l=this.children.insert(i,o);return new Gi(this.value,l)}}remove(e){if(ii(e))return this.children.isEmpty()?new Gi(null):new Gi(null,this.children);{const t=Jn(e),i=this.children.get(t);if(i){const s=i.remove(Ki(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new Gi(null):new Gi(this.value,o)}else return this}}get(e){if(ii(e))return this.value;{const t=Jn(e),i=this.children.get(t);return i?i.get(Ki(e)):null}}setTree(e,t){if(ii(e))return t;{const i=Jn(e),o=(this.children.get(i)||new Gi(null)).setTree(Ki(e),t);let l;return o.isEmpty()?l=this.children.remove(i):l=this.children.insert(i,o),new Gi(this.value,l)}}fold(e){return this.fold_(bi(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(Ts(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,bi(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(ii(e))return null;{const o=Jn(e),l=this.children.get(o);return l?l.findOnPath_(Ki(e),Ts(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,bi(),t)}foreachOnPath_(e,t,i){if(ii(e))return this;{this.value&&i(t,this.value);const s=Jn(e),o=this.children.get(s);return o?o.foreachOnPath_(Ki(e),Ts(t,s),i):new Gi(null)}}foreach(e){this.foreach_(bi(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(Ts(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e){this.writeTree_=e}static empty(){return new Qa(new Gi(null))}}function om(n,e,t){if(ii(e))return new Qa(new Gi(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const l=ar(s,e);return o=o.updateChild(l,t),new Qa(n.writeTree_.set(s,o))}else{const s=new Gi(t),o=n.writeTree_.setTree(e,s);return new Qa(o)}}}function I2(n,e,t){let i=n;return jo(t,(s,o)=>{i=om(i,Ts(e,s),o)}),i}function V5(n,e){if(ii(e))return Qa.empty();{const t=n.writeTree_.setTree(e,new Gi(null));return new Qa(t)}}function P2(n,e){return Nd(n,e)!=null}function Nd(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(ar(t.path,e)):null}function Y5(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Cs,(i,s)=>{e.push(new ei(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new ei(i,s.value))}),e}function lu(n,e){if(ii(e))return n;{const t=Nd(n,e);return t!=null?new Qa(new Gi(t)):new Qa(n.writeTree_.subtree(e))}}function U2(n){return n.writeTree_.isEmpty()}function Ah(n,e){return Z3(bi(),n.writeTree_,e)}function Z3(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(Xt(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=Z3(Ts(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(Ts(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y0(n,e){return nE(e,n)}function Fj(n,e,t,i,s){Xt(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=om(n.visibleWrites,e,t)),n.lastWriteId=i}function $j(n,e,t,i){Xt(i>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:i,visible:!0}),n.visibleWrites=I2(n.visibleWrites,e,t),n.lastWriteId=i}function Bj(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function Wj(n,e){const t=n.allWrites.findIndex(c=>c.writeId===e);Xt(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,l=n.allWrites.length-1;for(;s&&l>=0;){const c=n.allWrites[l];c.visible&&(l>=t&&zj(c,i.path)?s=!1:ga(i.path,c.path)&&(o=!0)),l--}if(s){if(o)return Hj(n),!0;if(i.snap)n.visibleWrites=V5(n.visibleWrites,i.path);else{const c=i.children;jo(c,d=>{n.visibleWrites=V5(n.visibleWrites,Ts(i.path,d))})}return!0}else return!1}function zj(n,e){if(n.snap)return ga(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&ga(Ts(n.path,t),e))return!0;return!1}function Hj(n){n.visibleWrites=J3(n.allWrites,qj,bi()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function qj(n){return n.visible}function J3(n,e,t){let i=Qa.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const l=o.path;let c;if(o.snap)ga(t,l)?(c=ar(t,l),i=om(i,c,o.snap)):ga(l,t)&&(c=ar(l,t),i=om(i,bi(),o.snap.getChild(c)));else if(o.children){if(ga(t,l))c=ar(t,l),i=I2(i,c,o.children);else if(ga(l,t))if(c=ar(l,t),ii(c))i=I2(i,bi(),o.children);else{const d=Eh(o.children,Jn(c));if(d){const f=d.getChild(Ki(c));i=om(i,bi(),f)}}}else throw Ih("WriteRecord should have .snap or .children")}}return i}function eE(n,e,t,i,s){if(!i&&!s){const o=Nd(n.visibleWrites,e);if(o!=null)return o;{const l=lu(n.visibleWrites,e);if(U2(l))return t;if(t==null&&!P2(l,bi()))return null;{const c=t||Ln.EMPTY_NODE;return Ah(l,c)}}}else{const o=lu(n.visibleWrites,e);if(!s&&U2(o))return t;if(!s&&t==null&&!P2(o,bi()))return null;{const l=function(f){return(f.visible||s)&&(!i||!~i.indexOf(f.writeId))&&(ga(f.path,e)||ga(e,f.path))},c=J3(n.allWrites,l,e),d=t||Ln.EMPTY_NODE;return Ah(c,d)}}}function Vj(n,e,t){let i=Ln.EMPTY_NODE;const s=Nd(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Cs,(o,l)=>{i=i.updateImmediateChild(o,l)}),i;if(t){const o=lu(n.visibleWrites,e);return t.forEachChild(Cs,(l,c)=>{const d=Ah(lu(o,new Pi(l)),c);i=i.updateImmediateChild(l,d)}),Y5(o).forEach(l=>{i=i.updateImmediateChild(l.name,l.node)}),i}else{const o=lu(n.visibleWrites,e);return Y5(o).forEach(l=>{i=i.updateImmediateChild(l.name,l.node)}),i}}function Yj(n,e,t,i,s){Xt(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=Ts(e,t);if(P2(n.visibleWrites,o))return null;{const l=lu(n.visibleWrites,o);return U2(l)?s.getChild(t):Ah(l,s.getChild(t))}}function Gj(n,e,t,i){const s=Ts(e,t),o=Nd(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const l=lu(n.visibleWrites,s);return Ah(l,i.getNode().getImmediateChild(t))}else return null}function Kj(n,e){return Nd(n.visibleWrites,e)}function Xj(n,e,t,i,s,o,l){let c;const d=lu(n.visibleWrites,e),f=Nd(d,bi());if(f!=null)c=f;else if(t!=null)c=Ah(d,t);else return[];if(c=c.withIndex(l),!c.isEmpty()&&!c.isLeafNode()){const p=[],v=l.getCompare(),_=o?c.getReverseIteratorFrom(i,l):c.getIteratorFrom(i,l);let b=_.getNext();for(;b&&p.length<s;)v(b,i)!==0&&p.push(b),b=_.getNext();return p}else return[]}function Qj(){return{visibleWrites:Qa.empty(),allWrites:[],lastWriteId:-1}}function m0(n,e,t,i){return eE(n.writeTree,n.treePath,e,t,i)}function Vv(n,e){return Vj(n.writeTree,n.treePath,e)}function G5(n,e,t,i){return Yj(n.writeTree,n.treePath,e,t,i)}function p0(n,e){return Kj(n.writeTree,Ts(n.treePath,e))}function Zj(n,e,t,i,s,o){return Xj(n.writeTree,n.treePath,e,t,i,s,o)}function Yv(n,e,t){return Gj(n.writeTree,n.treePath,e,t)}function tE(n,e){return nE(Ts(n.treePath,e),n.writeTree)}function nE(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;Xt(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),Xt(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,Nm(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,Sm(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,kh(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,Nm(i,e.snapshotNode,s.oldSnap));else throw Ih("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const iE=new eM;class Gv{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new hu(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Yv(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:pd(this.viewCache_),o=Zj(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tM(n){return{filter:n}}function nM(n,e){Xt(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),Xt(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function iM(n,e,t,i,s){const o=new Jj;let l,c;if(t.type===Ha.OVERWRITE){const f=t;f.source.fromUser?l=F2(n,e,f.path,f.snap,i,s,o):(Xt(f.source.fromServer,"Unknown source."),c=f.source.tagged||e.serverCache.isFiltered()&&!ii(f.path),l=g0(n,e,f.path,f.snap,i,s,c,o))}else if(t.type===Ha.MERGE){const f=t;f.source.fromUser?l=oM(n,e,f.path,f.children,i,s,o):(Xt(f.source.fromServer,"Unknown source."),c=f.source.tagged||e.serverCache.isFiltered(),l=$2(n,e,f.path,f.children,i,s,c,o))}else if(t.type===Ha.ACK_USER_WRITE){const f=t;f.revert?l=lM(n,e,f.path,i,s,o):l=rM(n,e,f.path,f.affectedTree,i,s,o)}else if(t.type===Ha.LISTEN_COMPLETE)l=aM(n,e,t.path,i,o);else throw Ih("Unknown operation type: "+t.type);const d=o.getChanges();return sM(e,l,d),{viewCache:l,changes:d}}function sM(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=f0(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(K3(f0(e)))}}function sE(n,e,t,i,s,o){const l=e.eventCache;if(p0(i,t)!=null)return e;{let c,d;if(ii(t))if(Xt(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const f=pd(e),p=f instanceof Ln?f:Ln.EMPTY_NODE,v=Vv(i,p);c=n.filter.updateFullNode(e.eventCache.getNode(),v,o)}else{const f=m0(i,pd(e));c=n.filter.updateFullNode(e.eventCache.getNode(),f,o)}else{const f=Jn(t);if(f===".priority"){Xt(du(t)===1,"Can't have a priority with additional path components");const p=l.getNode();d=e.serverCache.getNode();const v=G5(i,t,p,d);v!=null?c=n.filter.updatePriority(p,v):c=l.getNode()}else{const p=Ki(t);let v;if(l.isCompleteForChild(f)){d=e.serverCache.getNode();const _=G5(i,t,l.getNode(),d);_!=null?v=l.getNode().getImmediateChild(f).updateChild(p,_):v=l.getNode().getImmediateChild(f)}else v=Yv(i,f,e.serverCache);v!=null?c=n.filter.updateChild(l.getNode(),f,v,p,s,o):c=l.getNode()}}return sm(e,c,l.isFullyInitialized()||ii(t),n.filter.filtersNodes())}}function g0(n,e,t,i,s,o,l,c){const d=e.serverCache;let f;const p=l?n.filter:n.filter.getIndexedFilter();if(ii(t))f=p.updateFullNode(d.getNode(),i,null);else if(p.filtersNodes()&&!d.isFiltered()){const b=d.getNode().updateChild(t,i);f=p.updateFullNode(d.getNode(),b,null)}else{const b=Jn(t);if(!d.isCompleteForPath(t)&&du(t)>1)return e;const T=Ki(t),A=d.getNode().getImmediateChild(b).updateChild(T,i);b===".priority"?f=p.updatePriority(d.getNode(),A):f=p.updateChild(d.getNode(),b,A,T,iE,null)}const v=Q3(e,f,d.isFullyInitialized()||ii(t),p.filtersNodes()),_=new Gv(s,v,o);return sE(n,v,t,s,_,c)}function F2(n,e,t,i,s,o,l){const c=e.eventCache;let d,f;const p=new Gv(s,e,o);if(ii(t))f=n.filter.updateFullNode(e.eventCache.getNode(),i,l),d=sm(e,f,!0,n.filter.filtersNodes());else{const v=Jn(t);if(v===".priority")f=n.filter.updatePriority(e.eventCache.getNode(),i),d=sm(e,f,c.isFullyInitialized(),c.isFiltered());else{const _=Ki(t),b=c.getNode().getImmediateChild(v);let T;if(ii(_))T=i;else{const C=p.getCompleteChild(v);C!=null?Pv(_)===".priority"&&C.getChild(W3(_)).isEmpty()?T=C:T=C.updateChild(_,i):T=Ln.EMPTY_NODE}if(b.equals(T))d=e;else{const C=n.filter.updateChild(c.getNode(),v,T,_,p,l);d=sm(e,C,c.isFullyInitialized(),n.filter.filtersNodes())}}}return d}function K5(n,e){return n.eventCache.isCompleteForChild(e)}function oM(n,e,t,i,s,o,l){let c=e;return i.foreach((d,f)=>{const p=Ts(t,d);K5(e,Jn(p))&&(c=F2(n,c,p,f,s,o,l))}),i.foreach((d,f)=>{const p=Ts(t,d);K5(e,Jn(p))||(c=F2(n,c,p,f,s,o,l))}),c}function X5(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function $2(n,e,t,i,s,o,l,c){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let d=e,f;ii(t)?f=i:f=new Gi(null).setTree(t,i);const p=e.serverCache.getNode();return f.children.inorderTraversal((v,_)=>{if(p.hasChild(v)){const b=e.serverCache.getNode().getImmediateChild(v),T=X5(n,b,_);d=g0(n,d,new Pi(v),T,s,o,l,c)}}),f.children.inorderTraversal((v,_)=>{const b=!e.serverCache.isCompleteForChild(v)&&_.value===null;if(!p.hasChild(v)&&!b){const T=e.serverCache.getNode().getImmediateChild(v),C=X5(n,T,_);d=g0(n,d,new Pi(v),C,s,o,l,c)}}),d}function rM(n,e,t,i,s,o,l){if(p0(s,t)!=null)return e;const c=e.serverCache.isFiltered(),d=e.serverCache;if(i.value!=null){if(ii(t)&&d.isFullyInitialized()||d.isCompleteForPath(t))return g0(n,e,t,d.getNode().getChild(t),s,o,c,l);if(ii(t)){let f=new Gi(null);return d.getNode().forEachChild(yh,(p,v)=>{f=f.set(new Pi(p),v)}),$2(n,e,t,f,s,o,c,l)}else return e}else{let f=new Gi(null);return i.foreach((p,v)=>{const _=Ts(t,p);d.isCompleteForPath(_)&&(f=f.set(p,d.getNode().getChild(_)))}),$2(n,e,t,f,s,o,c,l)}}function aM(n,e,t,i,s){const o=e.serverCache,l=Q3(e,o.getNode(),o.isFullyInitialized()||ii(t),o.isFiltered());return sE(n,l,t,i,iE,s)}function lM(n,e,t,i,s,o){let l;if(p0(i,t)!=null)return e;{const c=new Gv(i,e,s),d=e.eventCache.getNode();let f;if(ii(t)||Jn(t)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=m0(i,pd(e));else{const v=e.serverCache.getNode();Xt(v instanceof Ln,"serverChildren would be complete if leaf node"),p=Vv(i,v)}p=p,f=n.filter.updateFullNode(d,p,o)}else{const p=Jn(t);let v=Yv(i,p,e.serverCache);v==null&&e.serverCache.isCompleteForChild(p)&&(v=d.getImmediateChild(p)),v!=null?f=n.filter.updateChild(d,p,v,Ki(t),c,o):e.eventCache.getNode().hasChild(p)?f=n.filter.updateChild(d,p,Ln.EMPTY_NODE,Ki(t),c,o):f=d,f.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=m0(i,pd(e)),l.isLeafNode()&&(f=n.filter.updateFullNode(f,l,o)))}return l=e.serverCache.isFullyInitialized()||p0(i,bi())!=null,sm(e,f,l,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new Bv(i.getIndex()),o=Cj(i);this.processor_=tM(o);const l=t.serverCache,c=t.eventCache,d=s.updateFullNode(Ln.EMPTY_NODE,l.getNode(),null),f=o.updateFullNode(Ln.EMPTY_NODE,c.getNode(),null),p=new hu(d,l.isFullyInitialized(),s.filtersNodes()),v=new hu(f,c.isFullyInitialized(),o.filtersNodes());this.viewCache_=V0(v,p),this.eventGenerator_=new Mj(this.query_)}get query(){return this.query_}}function uM(n){return n.viewCache_.serverCache.getNode()}function dM(n){return f0(n.viewCache_)}function hM(n,e){const t=pd(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ii(e)&&!t.getImmediateChild(Jn(e)).isEmpty())?t.getChild(e):null}function Q5(n){return n.eventRegistrations_.length===0}function fM(n,e){n.eventRegistrations_.push(e)}function Z5(n,e,t){const i=[];if(t){Xt(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const l=o.createCancelEvent(t,s);l&&i.push(l)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const l=n.eventRegistrations_[o];if(!l.matches(e))s.push(l);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function J5(n,e,t,i){e.type===Ha.MERGE&&e.source.queryId!==null&&(Xt(pd(n.viewCache_),"We should always have a full cache before handling merges"),Xt(f0(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=iM(n.processor_,s,e,t,i);return nM(n.processor_,o.viewCache),Xt(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,oE(n,o.changes,o.viewCache.eventCache.getNode(),null)}function mM(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Cs,(o,l)=>{i.push(kh(o,l))}),t.isFullyInitialized()&&i.push(K3(t.getNode())),oE(n,i,t.getNode(),e)}function oE(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return Rj(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let y0;class rE{constructor(){this.views=new Map}}function pM(n){Xt(!y0,"__referenceConstructor has already been defined"),y0=n}function gM(){return Xt(y0,"Reference.ts has not been loaded"),y0}function yM(n){return n.views.size===0}function Kv(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return Xt(o!=null,"SyncTree gave us an op for an invalid query."),J5(o,e,t,i)}else{let o=[];for(const l of n.views.values())o=o.concat(J5(l,e,t,i));return o}}function aE(n,e,t,i,s){const o=e._queryIdentifier,l=n.views.get(o);if(!l){let c=m0(t,s?i:null),d=!1;c?d=!0:i instanceof Ln?(c=Vv(t,i),d=!1):(c=Ln.EMPTY_NODE,d=!1);const f=V0(new hu(c,d,!1),new hu(i,s,!1));return new cM(e,f)}return l}function vM(n,e,t,i,s,o){const l=aE(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,l),fM(l,t),mM(l,t)}function bM(n,e,t,i){const s=e._queryIdentifier,o=[];let l=[];const c=fu(n);if(s==="default")for(const[d,f]of n.views.entries())l=l.concat(Z5(f,t,i)),Q5(f)&&(n.views.delete(d),f.query._queryParams.loadsAllData()||o.push(f.query));else{const d=n.views.get(s);d&&(l=l.concat(Z5(d,t,i)),Q5(d)&&(n.views.delete(s),d.query._queryParams.loadsAllData()||o.push(d.query)))}return c&&!fu(n)&&o.push(new(gM())(e._repo,e._path)),{removed:o,events:l}}function lE(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function cu(n,e){let t=null;for(const i of n.views.values())t=t||hM(i,e);return t}function cE(n,e){if(e._queryParams.loadsAllData())return G0(n);{const i=e._queryIdentifier;return n.views.get(i)}}function uE(n,e){return cE(n,e)!=null}function fu(n){return G0(n)!=null}function G0(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let v0;function wM(n){Xt(!v0,"__referenceConstructor has already been defined"),v0=n}function _M(){return Xt(v0,"Reference.ts has not been loaded"),v0}let xM=1;class ex{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Gi(null),this.pendingWriteTree_=Qj(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function dE(n,e,t,i,s){return Fj(n.pendingWriteTree_,e,t,i,s),s?$h(n,new md(zv(),e,t)):[]}function SM(n,e,t,i){$j(n.pendingWriteTree_,e,t,i);const s=Gi.fromObject(t);return $h(n,new Lh(zv(),e,s))}function Jc(n,e,t=!1){const i=Bj(n.pendingWriteTree_,e);if(Wj(n.pendingWriteTree_,e)){let o=new Gi(null);return i.snap!=null?o=o.set(bi(),!0):jo(i.children,l=>{o=o.set(new Pi(l),!0)}),$h(n,new h0(i.path,o,t))}else return[]}function Qm(n,e,t){return $h(n,new md(Hv(),e,t))}function NM(n,e,t){const i=Gi.fromObject(t);return $h(n,new Lh(Hv(),e,i))}function EM(n,e){return $h(n,new Tm(Hv(),e))}function TM(n,e,t){const i=Qv(n,t);if(i){const s=Zv(i),o=s.path,l=s.queryId,c=ar(o,e),d=new Tm(qv(l),c);return Jv(n,o,d)}else return[]}function b0(n,e,t,i,s=!1){const o=e._path,l=n.syncPointTree_.get(o);let c=[];if(l&&(e._queryIdentifier==="default"||uE(l,e))){const d=bM(l,e,t,i);yM(l)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const f=d.removed;if(c=d.events,!s){const p=f.findIndex(_=>_._queryParams.loadsAllData())!==-1,v=n.syncPointTree_.findOnPath(o,(_,b)=>fu(b));if(p&&!v){const _=n.syncPointTree_.subtree(o);if(!_.isEmpty()){const b=LM(_);for(let T=0;T<b.length;++T){const C=b[T],A=C.query,I=pE(n,C);n.listenProvider_.startListening(rm(A),Cm(n,A),I.hashFn,I.onComplete)}}}!v&&f.length>0&&!i&&(p?n.listenProvider_.stopListening(rm(e),null):f.forEach(_=>{const b=n.queryToTagMap.get(K0(_));n.listenProvider_.stopListening(rm(_),b)}))}AM(n,f)}return c}function hE(n,e,t,i){const s=Qv(n,i);if(s!=null){const o=Zv(s),l=o.path,c=o.queryId,d=ar(l,e),f=new md(qv(c),d,t);return Jv(n,l,f)}else return[]}function CM(n,e,t,i){const s=Qv(n,i);if(s){const o=Zv(s),l=o.path,c=o.queryId,d=ar(l,e),f=Gi.fromObject(t),p=new Lh(qv(c),d,f);return Jv(n,l,p)}else return[]}function B2(n,e,t,i=!1){const s=e._path;let o=null,l=!1;n.syncPointTree_.foreachOnPath(s,(_,b)=>{const T=ar(_,s);o=o||cu(b,T),l=l||fu(b)});let c=n.syncPointTree_.get(s);c?(l=l||fu(c),o=o||cu(c,bi())):(c=new rE,n.syncPointTree_=n.syncPointTree_.set(s,c));let d;o!=null?d=!0:(d=!1,o=Ln.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((b,T)=>{const C=cu(T,bi());C&&(o=o.updateImmediateChild(b,C))}));const f=uE(c,e);if(!f&&!e._queryParams.loadsAllData()){const _=K0(e);Xt(!n.queryToTagMap.has(_),"View does not exist, but we have a tag");const b=DM();n.queryToTagMap.set(_,b),n.tagToQueryMap.set(b,_)}const p=Y0(n.pendingWriteTree_,s);let v=vM(c,e,t,p,o,d);if(!f&&!l&&!i){const _=cE(c,e);v=v.concat(OM(n,e,_))}return v}function Xv(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(l,c)=>{const d=ar(l,e),f=cu(c,d);if(f)return f});return eE(s,e,o,t,!0)}function kM(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(f,p)=>{const v=ar(f,t);i=i||cu(p,v)});let s=n.syncPointTree_.get(t);s?i=i||cu(s,bi()):(s=new rE,n.syncPointTree_=n.syncPointTree_.set(t,s));const o=i!=null,l=o?new hu(i,!0,!1):null,c=Y0(n.pendingWriteTree_,e._path),d=aE(s,e,c,o?l.getNode():Ln.EMPTY_NODE,o);return dM(d)}function $h(n,e){return fE(e,n.syncPointTree_,null,Y0(n.pendingWriteTree_,bi()))}function fE(n,e,t,i){if(ii(n.path))return mE(n,e,t,i);{const s=e.get(bi());t==null&&s!=null&&(t=cu(s,bi()));let o=[];const l=Jn(n.path),c=n.operationForChild(l),d=e.children.get(l);if(d&&c){const f=t?t.getImmediateChild(l):null,p=tE(i,l);o=o.concat(fE(c,d,f,p))}return s&&(o=o.concat(Kv(s,n,i,t))),o}}function mE(n,e,t,i){const s=e.get(bi());t==null&&s!=null&&(t=cu(s,bi()));let o=[];return e.children.inorderTraversal((l,c)=>{const d=t?t.getImmediateChild(l):null,f=tE(i,l),p=n.operationForChild(l);p&&(o=o.concat(mE(p,c,d,f)))}),s&&(o=o.concat(Kv(s,n,i,t))),o}function pE(n,e){const t=e.query,i=Cm(n,t);return{hashFn:()=>(uM(e)||Ln.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?TM(n,t._path,i):EM(n,t._path);{const o=EO(s,t);return b0(n,t,null,o)}}}}function Cm(n,e){const t=K0(e);return n.queryToTagMap.get(t)}function K0(n){return n._path.toString()+"$"+n._queryIdentifier}function Qv(n,e){return n.tagToQueryMap.get(e)}function Zv(n){const e=n.indexOf("$");return Xt(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Pi(n.substr(0,e))}}function Jv(n,e,t){const i=n.syncPointTree_.get(e);Xt(i,"Missing sync point for query tag that we're tracking");const s=Y0(n.pendingWriteTree_,e);return Kv(i,t,s,null)}function LM(n){return n.fold((e,t,i)=>{if(t&&fu(t))return[G0(t)];{let s=[];return t&&(s=lE(t)),jo(i,(o,l)=>{s=s.concat(l)}),s}})}function rm(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(_M())(n._repo,n._path):n}function AM(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=K0(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function DM(){return xM++}function OM(n,e,t){const i=e._path,s=Cm(n,e),o=pE(n,t),l=n.listenProvider_.startListening(rm(e),s,o.hashFn,o.onComplete),c=n.syncPointTree_.subtree(i);if(s)Xt(!fu(c.value),"If we're adding a query, it shouldn't be shadowed");else{const d=c.fold((f,p,v)=>{if(!ii(f)&&p&&fu(p))return[G0(p).query];{let _=[];return p&&(_=_.concat(lE(p).map(b=>b.query))),jo(v,(b,T)=>{_=_.concat(T)}),_}});for(let f=0;f<d.length;++f){const p=d[f];n.listenProvider_.stopListening(rm(p),Cm(n,p))}}return l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new eb(t)}node(){return this.node_}}class tb{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Ts(this.path_,e);return new tb(this.syncTree_,t)}node(){return Xv(this.syncTree_,this.path_)}}const jM=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},tx=function(n,e,t){if(!n||typeof n!="object")return n;if(Xt(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return MM(n[".sv"],e,t);if(typeof n[".sv"]=="object")return RM(n[".sv"],e);Xt(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},MM=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:Xt(!1,"Unexpected server value: "+n)}},RM=function(n,e,t){n.hasOwnProperty("increment")||Xt(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&Xt(!1,"Unexpected increment value: "+i);const s=e.node();if(Xt(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const l=s.getValue();return typeof l!="number"?i:l+i},gE=function(n,e,t,i){return nb(e,new tb(t,n),i)},yE=function(n,e,t){return nb(n,new eb(e),t)};function nb(n,e,t){const i=n.getPriority().val(),s=tx(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const l=n,c=tx(l.getValue(),e,t);return c!==l.getValue()||s!==l.getPriority().val()?new po(c,Js(s)):n}else{const l=n;return o=l,s!==l.getPriority().val()&&(o=o.updatePriority(new po(s))),l.forEachChild(Cs,(c,d)=>{const f=nb(d,e.getImmediateChild(c),t);f!==d&&(o=o.updateImmediateChild(c,f))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function sb(n,e){let t=e instanceof Pi?e:new Pi(e),i=n,s=Jn(t);for(;s!==null;){const o=Eh(i.node.children,s)||{children:{},childCount:0};i=new ib(s,i,o),t=Ki(t),s=Jn(t)}return i}function Bh(n){return n.node.value}function vE(n,e){n.node.value=e,W2(n)}function bE(n){return n.node.childCount>0}function IM(n){return Bh(n)===void 0&&!bE(n)}function X0(n,e){jo(n.node.children,(t,i)=>{e(new ib(t,n,i))})}function wE(n,e,t,i){t&&e(n),X0(n,s=>{wE(s,e,!0)})}function PM(n,e,t){let i=n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Zm(n){return new Pi(n.parent===null?n.name:Zm(n.parent)+"/"+n.name)}function W2(n){n.parent!==null&&UM(n.parent,n.name,n)}function UM(n,e,t){const i=IM(t),s=Ll(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,W2(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,W2(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FM=/[\[\].#$\/\u0000-\u001F\u007F]/,$M=/[\[\].#$\u0000-\u001F\u007F]/,Oy=10*1024*1024,ob=function(n){return typeof n=="string"&&n.length!==0&&!FM.test(n)},_E=function(n){return typeof n=="string"&&n.length!==0&&!$M.test(n)},BM=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),_E(n)},WM=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Ov(n)||n&&typeof n=="object"&&Ll(n,".sv")},xE=function(n,e,t,i){i&&e===void 0||Q0($0(n,"value"),e,t)},Q0=function(n,e,t){const i=t instanceof Pi?new oj(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Gu(i));if(typeof e=="function")throw new Error(n+"contains a function "+Gu(i)+" with contents = "+e.toString());if(Ov(e))throw new Error(n+"contains "+e.toString()+" "+Gu(i));if(typeof e=="string"&&e.length>Oy/3&&B0(e)>Oy)throw new Error(n+"contains a string greater than "+Oy+" utf8 bytes "+Gu(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(jo(e,(l,c)=>{if(l===".value")s=!0;else if(l!==".priority"&&l!==".sv"&&(o=!0,!ob(l)))throw new Error(n+" contains an invalid key ("+l+") "+Gu(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);rj(i,l),Q0(n,c,i),aj(i)}),s&&o)throw new Error(n+' contains ".value" child '+Gu(i)+" in addition to actual children.")}},zM=function(n,e){let t,i;for(t=0;t<e.length;t++){i=e[t];const o=xm(i);for(let l=0;l<o.length;l++)if(!(o[l]===".priority"&&l===o.length-1)){if(!ob(o[l]))throw new Error(n+"contains an invalid key ("+o[l]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(sj);let s=null;for(t=0;t<e.length;t++){if(i=e[t],s!==null&&ga(s,i))throw new Error(n+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}},HM=function(n,e,t,i){const s=$0(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const o=[];jo(e,(l,c)=>{const d=new Pi(l);if(Q0(s,c,Ts(t,d)),Pv(d)===".priority"&&!WM(c))throw new Error(s+"contains an invalid value for '"+d.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(d)}),zM(s,o)},SE=function(n,e,t,i){if(!_E(t))throw new Error($0(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},qM=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),SE(n,e,t)},rb=function(n,e){if(Jn(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},VM=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!ob(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!BM(t))throw new Error($0(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Z0(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!Uv(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function NE(n,e,t){Z0(n,t),EE(n,i=>Uv(i,e))}function wa(n,e,t){Z0(n,t),EE(n,i=>ga(i,e)||ga(e,i))}function EE(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(GM(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function GM(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();nm&&Oo("event: "+t.toString()),Fh(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM="repo_interrupt",XM=25;class QM{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new YM,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=d0(),this.transactionQueueTree_=new ib,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ZM(n,e,t){if(n.stats_=Rv(n.repoInfo_),n.forceRestClient_||LO())n.server_=new u0(n.repoInfo_,(i,s,o,l)=>{nx(n,i,s,o,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>ix(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{eo(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new lc(n.repoInfo_,e,(i,s,o,l)=>{nx(n,i,s,o,l)},i=>{ix(n,i)},i=>{JM(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=MO(n.repoInfo_,()=>new jj(n.stats_,n.server_)),n.infoData_=new kj,n.infoSyncTree_=new ex({startListening:(i,s,o,l)=>{let c=[];const d=n.infoData_.getNode(i._path);return d.isEmpty()||(c=Qm(n.infoSyncTree_,i._path,d),setTimeout(()=>{l("ok")},0)),c},stopListening:()=>{}}),ab(n,"connected",!1),n.serverSyncTree_=new ex({startListening:(i,s,o,l)=>(n.server_.listen(i,o,s,(c,d)=>{const f=l(c,d);wa(n.eventQueue_,i._path,f)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function TE(n){const t=n.infoData_.getNode(new Pi(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function J0(n){return jM({timestamp:TE(n)})}function nx(n,e,t,i,s){n.dataUpdateCount++;const o=new Pi(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(s)if(i){const d=Jg(t,f=>Js(f));l=CM(n.serverSyncTree_,o,d,s)}else{const d=Js(t);l=hE(n.serverSyncTree_,o,d,s)}else if(i){const d=Jg(t,f=>Js(f));l=NM(n.serverSyncTree_,o,d)}else{const d=Js(t);l=Qm(n.serverSyncTree_,o,d)}let c=o;l.length>0&&(c=Dh(n,o)),wa(n.eventQueue_,c,l)}function ix(n,e){ab(n,"connected",e),e===!1&&iR(n)}function JM(n,e){jo(e,(t,i)=>{ab(n,t,i)})}function ab(n,e,t){const i=new Pi("/.info/"+e),s=Js(t);n.infoData_.updateSnapshot(i,s);const o=Qm(n.infoSyncTree_,i,s);wa(n.eventQueue_,i,o)}function lb(n){return n.nextWriteId_++}function eR(n,e,t){const i=kM(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const o=Js(s).withIndex(e._queryParams.getIndex());B2(n.serverSyncTree_,e,t,!0);let l;if(e._queryParams.loadsAllData())l=Qm(n.serverSyncTree_,e._path,o);else{const c=Cm(n.serverSyncTree_,e);l=hE(n.serverSyncTree_,e._path,o,c)}return wa(n.eventQueue_,e._path,l),b0(n.serverSyncTree_,e,t,null,!0),o},s=>(Jm(n,"get for query "+eo(e)+" failed: "+s),Promise.reject(new Error(s))))}function tR(n,e,t,i,s){Jm(n,"set",{path:e.toString(),value:t,priority:i});const o=J0(n),l=Js(t,i),c=Xv(n.serverSyncTree_,e),d=yE(l,c,o),f=lb(n),p=dE(n.serverSyncTree_,e,d,f,!0);Z0(n.eventQueue_,p),n.server_.put(e.toString(),l.val(!0),(_,b)=>{const T=_==="ok";T||cr("set at "+e+" failed: "+_);const C=Jc(n.serverSyncTree_,f,!T);wa(n.eventQueue_,e,C),H2(n,s,_,b)});const v=ub(n,e);Dh(n,v),wa(n.eventQueue_,v,[])}function nR(n,e,t,i){Jm(n,"update",{path:e.toString(),value:t});let s=!0;const o=J0(n),l={};if(jo(t,(c,d)=>{s=!1,l[c]=gE(Ts(e,c),Js(d),n.serverSyncTree_,o)}),s)Oo("update() called with empty data.  Don't do anything."),H2(n,i,"ok",void 0);else{const c=lb(n),d=SM(n.serverSyncTree_,e,l,c);Z0(n.eventQueue_,d),n.server_.merge(e.toString(),t,(f,p)=>{const v=f==="ok";v||cr("update at "+e+" failed: "+f);const _=Jc(n.serverSyncTree_,c,!v),b=_.length>0?Dh(n,e):e;wa(n.eventQueue_,b,_),H2(n,i,f,p)}),jo(t,f=>{const p=ub(n,Ts(e,f));Dh(n,p)}),wa(n.eventQueue_,e,[])}}function iR(n){Jm(n,"onDisconnectEvents");const e=J0(n),t=d0();R2(n.onDisconnect_,bi(),(s,o)=>{const l=gE(s,o,n.serverSyncTree_,e);X3(t,s,l)});let i=[];R2(t,bi(),(s,o)=>{i=i.concat(Qm(n.serverSyncTree_,s,o));const l=ub(n,s);Dh(n,l)}),n.onDisconnect_=d0(),wa(n.eventQueue_,bi(),i)}function sR(n,e,t){let i;Jn(e._path)===".info"?i=B2(n.infoSyncTree_,e,t):i=B2(n.serverSyncTree_,e,t),NE(n.eventQueue_,e._path,i)}function z2(n,e,t){let i;Jn(e._path)===".info"?i=b0(n.infoSyncTree_,e,t):i=b0(n.serverSyncTree_,e,t),NE(n.eventQueue_,e._path,i)}function oR(n){n.persistentConnection_&&n.persistentConnection_.interrupt(KM)}function Jm(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Oo(t,...e)}function H2(n,e,t,i){e&&Fh(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const l=new Error(o);l.code=s,e(l)}})}function CE(n,e,t){return Xv(n.serverSyncTree_,e,t)||Ln.EMPTY_NODE}function cb(n,e=n.transactionQueueTree_){if(e||e1(n,e),Bh(e)){const t=LE(n,e);Xt(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&rR(n,Zm(e),t)}else bE(e)&&X0(e,t=>{cb(n,t)})}function rR(n,e,t){const i=t.map(f=>f.currentWriteId),s=CE(n,e,i);let o=s;const l=s.hash();for(let f=0;f<t.length;f++){const p=t[f];Xt(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const v=ar(e,p.path);o=o.updateChild(v,p.currentOutputSnapshotRaw)}const c=o.val(!0),d=e;n.server_.put(d.toString(),c,f=>{Jm(n,"transaction put response",{path:d.toString(),status:f});let p=[];if(f==="ok"){const v=[];for(let _=0;_<t.length;_++)t[_].status=2,p=p.concat(Jc(n.serverSyncTree_,t[_].currentWriteId)),t[_].onComplete&&v.push(()=>t[_].onComplete(null,!0,t[_].currentOutputSnapshotResolved)),t[_].unwatcher();e1(n,sb(n.transactionQueueTree_,e)),cb(n,n.transactionQueueTree_),wa(n.eventQueue_,e,p);for(let _=0;_<v.length;_++)Fh(v[_])}else{if(f==="datastale")for(let v=0;v<t.length;v++)t[v].status===3?t[v].status=4:t[v].status=0;else{cr("transaction at "+d.toString()+" failed: "+f);for(let v=0;v<t.length;v++)t[v].status=4,t[v].abortReason=f}Dh(n,e)}},l)}function Dh(n,e){const t=kE(n,e),i=Zm(t),s=LE(n,t);return aR(n,s,i),i}function aR(n,e,t){if(e.length===0)return;const i=[];let s=[];const l=e.filter(c=>c.status===0).map(c=>c.currentWriteId);for(let c=0;c<e.length;c++){const d=e[c],f=ar(t,d.path);let p=!1,v;if(Xt(f!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),d.status===4)p=!0,v=d.abortReason,s=s.concat(Jc(n.serverSyncTree_,d.currentWriteId,!0));else if(d.status===0)if(d.retryCount>=XM)p=!0,v="maxretry",s=s.concat(Jc(n.serverSyncTree_,d.currentWriteId,!0));else{const _=CE(n,d.path,l);d.currentInputSnapshot=_;const b=e[c].update(_.val());if(b!==void 0){Q0("transaction failed: Data returned ",b,d.path);let T=Js(b);typeof b=="object"&&b!=null&&Ll(b,".priority")||(T=T.updatePriority(_.getPriority()));const A=d.currentWriteId,I=J0(n),ee=yE(T,_,I);d.currentOutputSnapshotRaw=T,d.currentOutputSnapshotResolved=ee,d.currentWriteId=lb(n),l.splice(l.indexOf(A),1),s=s.concat(dE(n.serverSyncTree_,d.path,ee,d.currentWriteId,d.applyLocally)),s=s.concat(Jc(n.serverSyncTree_,A,!0))}else p=!0,v="nodata",s=s.concat(Jc(n.serverSyncTree_,d.currentWriteId,!0))}wa(n.eventQueue_,t,s),s=[],p&&(e[c].status=2,(function(_){setTimeout(_,Math.floor(0))})(e[c].unwatcher),e[c].onComplete&&(v==="nodata"?i.push(()=>e[c].onComplete(null,!1,e[c].currentInputSnapshot)):i.push(()=>e[c].onComplete(new Error(v),!1,null))))}e1(n,n.transactionQueueTree_);for(let c=0;c<i.length;c++)Fh(i[c]);cb(n,n.transactionQueueTree_)}function kE(n,e){let t,i=n.transactionQueueTree_;for(t=Jn(e);t!==null&&Bh(i)===void 0;)i=sb(i,t),e=Ki(e),t=Jn(e);return i}function LE(n,e){const t=[];return AE(n,e,t),t.sort((i,s)=>i.order-s.order),t}function AE(n,e,t){const i=Bh(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);X0(e,s=>{AE(n,s,t)})}function e1(n,e){const t=Bh(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,vE(e,t.length>0?t:void 0)}X0(e,i=>{e1(n,i)})}function ub(n,e){const t=Zm(kE(n,e)),i=sb(n.transactionQueueTree_,e);return PM(i,s=>{jy(n,s)}),jy(n,i),wE(i,s=>{jy(n,s)}),t}function jy(n,e){const t=Bh(e);if(t){const i=[];let s=[],o=-1;for(let l=0;l<t.length;l++)t[l].status===3||(t[l].status===1?(Xt(o===l-1,"All SENT items should be at beginning of queue."),o=l,t[l].status=3,t[l].abortReason="set"):(Xt(t[l].status===0,"Unexpected transaction status in abort"),t[l].unwatcher(),s=s.concat(Jc(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&i.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));o===-1?vE(e,void 0):t.length=o+1,wa(n.eventQueue_,Zm(e),s);for(let l=0;l<i.length;l++)Fh(i[l])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function cR(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):cr(`Invalid query segment '${t}' in query '${n}'`)}return e}const sx=function(n,e){const t=uR(n),i=t.namespace;t.domain==="firebase.com"&&hc(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&hc("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||wO();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new j3(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new Pi(t.pathString)}},uR=function(n){let e="",t="",i="",s="",o="",l=!0,c="https",d=443;if(typeof n=="string"){let f=n.indexOf("//");f>=0&&(c=n.substring(0,f-1),n=n.substring(f+2));let p=n.indexOf("/");p===-1&&(p=n.length);let v=n.indexOf("?");v===-1&&(v=n.length),e=n.substring(0,Math.min(p,v)),p<v&&(s=lR(n.substring(p,v)));const _=cR(n.substring(Math.min(n.length,v)));f=e.indexOf(":"),f>=0?(l=c==="https"||c==="wss",d=parseInt(e.substring(f+1),10)):f=e.length;const b=e.slice(0,f);if(b.toLowerCase()==="localhost")t="localhost";else if(b.split(".").length<=2)t=b;else{const T=e.indexOf(".");i=e.substring(0,T).toLowerCase(),t=e.substring(T+1),o=i}"ns"in _&&(o=_.ns)}return{host:e,port:d,domain:t,subdomain:i,secure:l,scheme:c,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ox="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",dR=(function(){let n=0;const e=[];return function(t){const i=t===n;n=t;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=ox.charAt(t%64),t=Math.floor(t/64);Xt(t===0,"Cannot push at time == 0");let l=o.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)l+=ox.charAt(e[s]);return Xt(l.length===20,"nextPushId: Length should be 20."),l}})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+eo(this.snapshot.exportVal())}}class fR{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Xt(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return ii(this._path)?null:Pv(this._path)}get ref(){return new pc(this._repo,this._path)}get _queryIdentifier(){const e=H5(this._queryParams),t=jv(e);return t==="{}"?"default":t}get _queryObject(){return H5(this._queryParams)}isEqual(e){if(e=qs(e),!(e instanceof hb))return!1;const t=this._repo===e._repo,i=Uv(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+ij(this._path)}}class pc extends hb{constructor(e,t){super(e,t,new Wv,!1)}get parent(){const e=W3(this._path);return e===null?null:new pc(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class km{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Pi(e),i=Lm(this.ref,e);return new km(this._node.getChild(t),i,Cs)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new km(s,Lm(this.ref,i),Cs)))}hasChild(e){const t=new Pi(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Me(n,e){return n=qs(n),n._checkNotDeleted("ref"),e!==void 0?Lm(n._root,e):n._root}function Lm(n,e){return n=qs(n),Jn(n._path)===null?qM("child","path",e):SE("child","path",e),new pc(n._repo,Ts(n._path,e))}function w0(n,e){n=qs(n),rb("push",n._path),xE("push",e,n._path,!0);const t=TE(n._repo),i=dR(t),s=Lm(n,i),o=Lm(n,i);let l;return e!=null?l=qa(o,e).then(()=>o):l=Promise.resolve(o),s.then=l.then.bind(l),s.catch=l.then.bind(l,void 0),s}function dh(n){return rb("remove",n._path),qa(n,null)}function qa(n,e){n=qs(n),rb("set",n._path),xE("set",e,n._path,!1);const t=new Bm;return tR(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Kt(n,e){HM("update",e,n._path);const t=new Bm;return nR(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function Pt(n){n=qs(n);const e=new db(()=>{}),t=new ep(e);return eR(n._repo,n,t).then(i=>new km(i,new pc(n._repo,n._path),n._queryParams.getIndex()))}class ep{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new hR("value",this,new km(e.snapshotNode,new pc(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new fR(this,e,t):null}matches(e){return e instanceof ep?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function mR(n,e,t,i,s){let o;if(typeof i=="object"&&(o=void 0,s=i),typeof i=="function"&&(o=i),s&&s.onlyOnce){const d=t,f=(p,v)=>{z2(n._repo,n,c),d(p,v)};f.userCallback=t.userCallback,f.context=t.context,t=f}const l=new db(t,o||void 0),c=new ep(l);return sR(n._repo,n,c),()=>z2(n._repo,n,c)}function Go(n,e,t,i){return mR(n,"value",e,t,i)}function lr(n,e,t){let i=null;const s=t?new db(t):null;i=new ep(s),z2(n._repo,n,i)}pM(pc);wM(pc);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pR="FIREBASE_DATABASE_EMULATOR_HOST",q2={};let gR=!1;function yR(n,e,t,i){const s=e.lastIndexOf(":"),o=e.substring(0,s),l=yu(o);n.repoInfo_=new j3(e,l,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),i&&(n.authTokenProvider_=i)}function vR(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||hc("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Oo("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let l=sx(o,s),c=l.repoInfo,d;typeof process<"u"&&T5&&(d=T5[pR]),d?(o=`http://${d}?ns=${c.namespace}`,l=sx(o,s),c=l.repoInfo):l.repoInfo.secure;const f=new DO(n.name,n.options,e);VM("Invalid Firebase Database URL",l),ii(l.path)||hc("Database URL must point to the root of a Firebase Database (not including a child path).");const p=wR(c,n,f,new AO(n,t));return new _R(p,n)}function bR(n,e){const t=q2[e];(!t||t[n.key]!==n)&&hc(`Database ${e}(${n.repoInfo_}) has already been deleted.`),oR(n),delete t[n.key]}function wR(n,e,t,i){let s=q2[e.name];s||(s={},q2[e.name]=s);let o=s[n.toURLString()];return o&&hc("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new QM(n,gR,t,i),s[n.toURLString()]=o,o}class _R{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ZM(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new pc(this._repo,bi())),this._rootInternal}_delete(){return this._rootInternal!==null&&(bR(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&hc("Cannot call "+e+" on a deleted database.")}}function xR(n=zm(),e){const t=fc(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=vv("database");i&&SR(t,...i)}return t}function SR(n,e,t,i={}){n=qs(n),n._checkNotDeleted("useEmulator");const s=`${e}:${t}`,o=n._repoInternal;if(n._instanceStarted){if(s===n._repoInternal.repoInfo_.host&&cc(i,o.repoInfo_.emulatorOptions))return;hc("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let l;if(o.repoInfo_.nodeAdmin)i.mockUserToken&&hc('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),l=new Bg(Bg.OWNER);else if(i.mockUserToken){const c=typeof i.mockUserToken=="string"?i.mockUserToken:bv(i.mockUserToken,n.app.options.projectId);l=new Bg(c)}yu(e)&&(U0(e),F0("Database",!0)),yR(o,s,i,l)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(n){mO(vu),va(new qr("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return vR(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),Xo(C5,k5,n),Xo(C5,k5,"esm2020")}lc.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};lc.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};NR();var ER="firebase",TR="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xo(ER,TR,"app");const DE="@firebase/installations",fb="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OE=1e4,jE=`w:${fb}`,ME="FIS_v2",CR="https://firebaseinstallations.googleapis.com/v1",kR=3600*1e3,LR="installations",AR="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},gd=new xd(LR,AR,DR);function RE(n){return n instanceof Na&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE({projectId:n}){return`${CR}/projects/${n}/installations`}function PE(n){return{token:n.token,requestStatus:2,expiresIn:jR(n.expiresIn),creationTime:Date.now()}}async function UE(n,e){const i=(await e.json()).error;return gd.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function FE({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function OR(n,{refreshToken:e}){const t=FE(n);return t.append("Authorization",MR(e)),t}async function $E(n){const e=await n();return e.status>=500&&e.status<600?n():e}function jR(n){return Number(n.replace("s","000"))}function MR(n){return`${ME} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RR({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=IE(n),s=FE(n),o=e.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&s.append("x-firebase-client",f)}const l={fid:t,authVersion:ME,appId:n.appId,sdkVersion:jE},c={method:"POST",headers:s,body:JSON.stringify(l)},d=await $E(()=>fetch(i,c));if(d.ok){const f=await d.json();return{fid:f.fid||t,registrationStatus:2,refreshToken:f.refreshToken,authToken:PE(f.authToken)}}else throw await UE("Create Installation",d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IR(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR=/^[cdef][\w-]{21}$/,V2="";function UR(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=FR(n);return PR.test(t)?t:V2}catch{return V2}}function FR(n){return IR(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE=new Map;function zE(n,e){const t=t1(n);HE(t,e),$R(t,e)}function HE(n,e){const t=WE.get(n);if(t)for(const i of t)i(e)}function $R(n,e){const t=BR();t&&t.postMessage({key:n,fid:e}),WR()}let nd=null;function BR(){return!nd&&"BroadcastChannel"in self&&(nd=new BroadcastChannel("[Firebase] FID Change"),nd.onmessage=n=>{HE(n.data.key,n.data.fid)}),nd}function WR(){WE.size===0&&nd&&(nd.close(),nd=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR="firebase-installations-database",HR=1,yd="firebase-installations-store";let My=null;function mb(){return My||(My=R4(zR,HR,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(yd)}}})),My}async function _0(n,e){const t=t1(n),s=(await mb()).transaction(yd,"readwrite"),o=s.objectStore(yd),l=await o.get(t);return await o.put(e,t),await s.done,(!l||l.fid!==e.fid)&&zE(n,e.fid),e}async function qE(n){const e=t1(n),i=(await mb()).transaction(yd,"readwrite");await i.objectStore(yd).delete(e),await i.done}async function n1(n,e){const t=t1(n),s=(await mb()).transaction(yd,"readwrite"),o=s.objectStore(yd),l=await o.get(t),c=e(l);return c===void 0?await o.delete(t):await o.put(c,t),await s.done,c&&(!l||l.fid!==c.fid)&&zE(n,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pb(n){let e;const t=await n1(n.appConfig,i=>{const s=qR(i),o=VR(n,s);return e=o.registrationPromise,o.installationEntry});return t.fid===V2?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function qR(n){const e=n||{fid:UR(),registrationStatus:0};return VE(e)}function VR(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(gd.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=YR(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:GR(n)}:{installationEntry:e}}async function YR(n,e){try{const t=await RR(n,e);return _0(n.appConfig,t)}catch(t){throw RE(t)&&t.customData.serverCode===409?await qE(n.appConfig):await _0(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function GR(n){let e=await rx(n.appConfig);for(;e.registrationStatus===1;)await BE(100),e=await rx(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await pb(n);return i||t}return e}function rx(n){return n1(n,e=>{if(!e)throw gd.create("installation-not-found");return VE(e)})}function VE(n){return KR(n)?{fid:n.fid,registrationStatus:0}:n}function KR(n){return n.registrationStatus===1&&n.registrationTime+OE<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XR({appConfig:n,heartbeatServiceProvider:e},t){const i=QR(n,t),s=OR(n,t),o=e.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&s.append("x-firebase-client",f)}const l={installation:{sdkVersion:jE,appId:n.appId}},c={method:"POST",headers:s,body:JSON.stringify(l)},d=await $E(()=>fetch(i,c));if(d.ok){const f=await d.json();return PE(f)}else throw await UE("Generate Auth Token",d)}function QR(n,{fid:e}){return`${IE(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gb(n,e=!1){let t;const i=await n1(n.appConfig,o=>{if(!YE(o))throw gd.create("not-registered");const l=o.authToken;if(!e&&eI(l))return o;if(l.requestStatus===1)return t=ZR(n,e),o;{if(!navigator.onLine)throw gd.create("app-offline");const c=nI(o);return t=JR(n,c),c}});return t?await t:i.authToken}async function ZR(n,e){let t=await ax(n.appConfig);for(;t.authToken.requestStatus===1;)await BE(100),t=await ax(n.appConfig);const i=t.authToken;return i.requestStatus===0?gb(n,e):i}function ax(n){return n1(n,e=>{if(!YE(e))throw gd.create("not-registered");const t=e.authToken;return iI(t)?{...e,authToken:{requestStatus:0}}:e})}async function JR(n,e){try{const t=await XR(n,e),i={...e,authToken:t};return await _0(n.appConfig,i),t}catch(t){if(RE(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await qE(n.appConfig);else{const i={...e,authToken:{requestStatus:0}};await _0(n.appConfig,i)}throw t}}function YE(n){return n!==void 0&&n.registrationStatus===2}function eI(n){return n.requestStatus===2&&!tI(n)}function tI(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+kR}function nI(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function iI(n){return n.requestStatus===1&&n.requestTime+OE<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sI(n){const e=n,{installationEntry:t,registrationPromise:i}=await pb(e);return i?i.catch(console.error):gb(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oI(n,e=!1){const t=n;return await rI(t),(await gb(t,e)).token}async function rI(n){const{registrationPromise:e}=await pb(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(n){if(!n||!n.options)throw Ry("App Configuration");if(!n.name)throw Ry("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Ry(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Ry(n){return gd.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GE="installations",lI="installations-internal",cI=n=>{const e=n.getProvider("app").getImmediate(),t=aI(e),i=fc(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},uI=n=>{const e=n.getProvider("app").getImmediate(),t=fc(e,GE).getImmediate();return{getId:()=>sI(t),getToken:s=>oI(t,s)}};function dI(){va(new qr(GE,cI,"PUBLIC")),va(new qr(lI,uI,"PRIVATE"))}dI();Xo(DE,fb);Xo(DE,fb,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0="analytics",hI="firebase_id",fI="origin",mI=60*1e3,pI="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",yb="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr=new Wm("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Hr=new xd("analytics","Analytics",gI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yI(n){if(!n.startsWith(yb)){const e=Hr.create("invalid-gtag-resource",{gtagURL:n});return Cr.warn(e.message),""}return n}function KE(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function vI(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function bI(n,e){const t=vI("firebase-js-sdk-policy",{createScriptURL:yI}),i=document.createElement("script"),s=`${yb}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}function wI(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function _I(n,e,t,i,s,o){const l=i[s];try{if(l)await e[l];else{const d=(await KE(t)).find(f=>f.measurementId===s);d&&await e[d.appId]}}catch(c){Cr.error(c)}n("config",s,o)}async function xI(n,e,t,i,s){try{let o=[];if(s&&s.send_to){let l=s.send_to;Array.isArray(l)||(l=[l]);const c=await KE(t);for(const d of l){const f=c.find(v=>v.measurementId===d),p=f&&e[f.appId];if(p)o.push(p);else{o=[];break}}}o.length===0&&(o=Object.values(e)),await Promise.all(o),n("event",i,s||{})}catch(o){Cr.error(o)}}function SI(n,e,t,i){async function s(o,...l){try{if(o==="event"){const[c,d]=l;await xI(n,e,t,c,d)}else if(o==="config"){const[c,d]=l;await _I(n,e,t,i,c,d)}else if(o==="consent"){const[c,d]=l;n("consent",c,d)}else if(o==="get"){const[c,d,f]=l;n("get",c,d,f)}else if(o==="set"){const[c]=l;n("set",c)}else n(o,...l)}catch(c){Cr.error(c)}}return s}function NI(n,e,t,i,s){let o=function(...l){window[i].push(arguments)};return window[s]&&typeof window[s]=="function"&&(o=window[s]),window[s]=SI(o,n,e,t),{gtagCore:o,wrappedGtag:window[s]}}function EI(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(yb)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=30,CI=1e3;class kI{constructor(e={},t=CI){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const XE=new kI;function LI(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function AI(n){const{appId:e,apiKey:t}=n,i={method:"GET",headers:LI(t)},s=pI.replace("{app-id}",e),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let l="";try{const c=await o.json();c.error?.message&&(l=c.error.message)}catch{}throw Hr.create("config-fetch-failed",{httpStatus:o.status,responseMessage:l})}return o.json()}async function DI(n,e=XE,t){const{appId:i,apiKey:s,measurementId:o}=n.options;if(!i)throw Hr.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:i};throw Hr.create("no-api-key")}const l=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new MI;return setTimeout(async()=>{c.abort()},mI),QE({appId:i,apiKey:s,measurementId:o},l,c,e)}async function QE(n,{throttleEndTimeMillis:e,backoffCount:t},i,s=XE){const{appId:o,measurementId:l}=n;try{await OI(i,e)}catch(c){if(l)return Cr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:o,measurementId:l};throw c}try{const c=await AI(n);return s.deleteThrottleMetadata(o),c}catch(c){const d=c;if(!jI(d)){if(s.deleteThrottleMetadata(o),l)return Cr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${d?.message}]`),{appId:o,measurementId:l};throw c}const f=Number(d?.customData?.httpStatus)===503?Z_(t,s.intervalMillis,TI):Z_(t,s.intervalMillis),p={throttleEndTimeMillis:Date.now()+f,backoffCount:t+1};return s.setThrottleMetadata(o,p),Cr.debug(`Calling attemptFetch again in ${f} millis`),QE(n,p,i,s)}}function OI(n,e){return new Promise((t,i)=>{const s=Math.max(e-Date.now(),0),o=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(o),i(Hr.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function jI(n){if(!(n instanceof Na)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class MI{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function RI(n,e,t,i,s){if(s&&s.global){n("event",t,i);return}else{const o=await e,l={...i,send_to:o};n("event",t,l)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function II(){if(A4())try{await D4()}catch(n){return Cr.warn(Hr.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Cr.warn(Hr.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function PI(n,e,t,i,s,o,l){const c=DI(n);c.then(_=>{t[_.measurementId]=_.appId,n.options.measurementId&&_.measurementId!==n.options.measurementId&&Cr.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${_.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(_=>Cr.error(_)),e.push(c);const d=II().then(_=>{if(_)return i.getId()}),[f,p]=await Promise.all([c,d]);EI(o)||bI(o,f.measurementId),s("js",new Date);const v=l?.config??{};return v[fI]="firebase",v.update=!0,p!=null&&(v[hI]=p),s("config",f.measurementId,v),f.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e){this.app=e}_delete(){return delete am[this.app.options.appId],Promise.resolve()}}let am={},lx=[];const cx={};let Iy="dataLayer",FI="gtag",ux,ZE,dx=!1;function $I(){const n=[];if(k4()&&n.push("This is a browser extension environment."),LL()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,s)=>`(${s+1}) ${i}`).join(" "),t=Hr.create("invalid-analytics-context",{errorInfo:e});Cr.warn(t.message)}}function BI(n,e,t){$I();const i=n.options.appId;if(!i)throw Hr.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Cr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Hr.create("no-api-key");if(am[i]!=null)throw Hr.create("already-exists",{id:i});if(!dx){wI(Iy);const{wrappedGtag:o,gtagCore:l}=NI(am,lx,cx,Iy,FI);ZE=o,ux=l,dx=!0}return am[i]=PI(n,lx,cx,e,ux,Iy,t),new UI(n)}function WI(n=zm()){n=qs(n);const e=fc(n,x0);return e.isInitialized()?e.getImmediate():zI(n)}function zI(n,e={}){const t=fc(n,x0);if(t.isInitialized()){const s=t.getImmediate();if(cc(e,t.getOptions()))return s;throw Hr.create("already-initialized")}return t.initialize({options:e})}function HI(n,e,t,i){n=qs(n),RI(ZE,am[n.app.options.appId],e,t,i).catch(s=>Cr.error(s))}const hx="@firebase/analytics",fx="0.10.18";function qI(){va(new qr(x0,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return BI(i,s,t)},"PUBLIC")),va(new qr("analytics-internal",n,"PRIVATE")),Xo(hx,fx),Xo(hx,fx,"esm2020");function n(e){try{const t=e.getProvider(x0).getImmediate();return{logEvent:(i,s,o)=>HI(t,i,s,o)}}catch(t){throw Hr.create("interop-component-reg-failed",{reason:t})}}}qI();var mx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var vb;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(z,R){function D(){}D.prototype=R.prototype,z.D=R.prototype,z.prototype=new D,z.prototype.constructor=z,z.C=function(F,E,O){for(var M=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)M[Y-2]=arguments[Y];return R.prototype[E].apply(F,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(z,R,D){D||(D=0);var F=Array(16);if(typeof R=="string")for(var E=0;16>E;++E)F[E]=R.charCodeAt(D++)|R.charCodeAt(D++)<<8|R.charCodeAt(D++)<<16|R.charCodeAt(D++)<<24;else for(E=0;16>E;++E)F[E]=R[D++]|R[D++]<<8|R[D++]<<16|R[D++]<<24;R=z.g[0],D=z.g[1],E=z.g[2];var O=z.g[3],M=R+(O^D&(E^O))+F[0]+3614090360&4294967295;R=D+(M<<7&4294967295|M>>>25),M=O+(E^R&(D^E))+F[1]+3905402710&4294967295,O=R+(M<<12&4294967295|M>>>20),M=E+(D^O&(R^D))+F[2]+606105819&4294967295,E=O+(M<<17&4294967295|M>>>15),M=D+(R^E&(O^R))+F[3]+3250441966&4294967295,D=E+(M<<22&4294967295|M>>>10),M=R+(O^D&(E^O))+F[4]+4118548399&4294967295,R=D+(M<<7&4294967295|M>>>25),M=O+(E^R&(D^E))+F[5]+1200080426&4294967295,O=R+(M<<12&4294967295|M>>>20),M=E+(D^O&(R^D))+F[6]+2821735955&4294967295,E=O+(M<<17&4294967295|M>>>15),M=D+(R^E&(O^R))+F[7]+4249261313&4294967295,D=E+(M<<22&4294967295|M>>>10),M=R+(O^D&(E^O))+F[8]+1770035416&4294967295,R=D+(M<<7&4294967295|M>>>25),M=O+(E^R&(D^E))+F[9]+2336552879&4294967295,O=R+(M<<12&4294967295|M>>>20),M=E+(D^O&(R^D))+F[10]+4294925233&4294967295,E=O+(M<<17&4294967295|M>>>15),M=D+(R^E&(O^R))+F[11]+2304563134&4294967295,D=E+(M<<22&4294967295|M>>>10),M=R+(O^D&(E^O))+F[12]+1804603682&4294967295,R=D+(M<<7&4294967295|M>>>25),M=O+(E^R&(D^E))+F[13]+4254626195&4294967295,O=R+(M<<12&4294967295|M>>>20),M=E+(D^O&(R^D))+F[14]+2792965006&4294967295,E=O+(M<<17&4294967295|M>>>15),M=D+(R^E&(O^R))+F[15]+1236535329&4294967295,D=E+(M<<22&4294967295|M>>>10),M=R+(E^O&(D^E))+F[1]+4129170786&4294967295,R=D+(M<<5&4294967295|M>>>27),M=O+(D^E&(R^D))+F[6]+3225465664&4294967295,O=R+(M<<9&4294967295|M>>>23),M=E+(R^D&(O^R))+F[11]+643717713&4294967295,E=O+(M<<14&4294967295|M>>>18),M=D+(O^R&(E^O))+F[0]+3921069994&4294967295,D=E+(M<<20&4294967295|M>>>12),M=R+(E^O&(D^E))+F[5]+3593408605&4294967295,R=D+(M<<5&4294967295|M>>>27),M=O+(D^E&(R^D))+F[10]+38016083&4294967295,O=R+(M<<9&4294967295|M>>>23),M=E+(R^D&(O^R))+F[15]+3634488961&4294967295,E=O+(M<<14&4294967295|M>>>18),M=D+(O^R&(E^O))+F[4]+3889429448&4294967295,D=E+(M<<20&4294967295|M>>>12),M=R+(E^O&(D^E))+F[9]+568446438&4294967295,R=D+(M<<5&4294967295|M>>>27),M=O+(D^E&(R^D))+F[14]+3275163606&4294967295,O=R+(M<<9&4294967295|M>>>23),M=E+(R^D&(O^R))+F[3]+4107603335&4294967295,E=O+(M<<14&4294967295|M>>>18),M=D+(O^R&(E^O))+F[8]+1163531501&4294967295,D=E+(M<<20&4294967295|M>>>12),M=R+(E^O&(D^E))+F[13]+2850285829&4294967295,R=D+(M<<5&4294967295|M>>>27),M=O+(D^E&(R^D))+F[2]+4243563512&4294967295,O=R+(M<<9&4294967295|M>>>23),M=E+(R^D&(O^R))+F[7]+1735328473&4294967295,E=O+(M<<14&4294967295|M>>>18),M=D+(O^R&(E^O))+F[12]+2368359562&4294967295,D=E+(M<<20&4294967295|M>>>12),M=R+(D^E^O)+F[5]+4294588738&4294967295,R=D+(M<<4&4294967295|M>>>28),M=O+(R^D^E)+F[8]+2272392833&4294967295,O=R+(M<<11&4294967295|M>>>21),M=E+(O^R^D)+F[11]+1839030562&4294967295,E=O+(M<<16&4294967295|M>>>16),M=D+(E^O^R)+F[14]+4259657740&4294967295,D=E+(M<<23&4294967295|M>>>9),M=R+(D^E^O)+F[1]+2763975236&4294967295,R=D+(M<<4&4294967295|M>>>28),M=O+(R^D^E)+F[4]+1272893353&4294967295,O=R+(M<<11&4294967295|M>>>21),M=E+(O^R^D)+F[7]+4139469664&4294967295,E=O+(M<<16&4294967295|M>>>16),M=D+(E^O^R)+F[10]+3200236656&4294967295,D=E+(M<<23&4294967295|M>>>9),M=R+(D^E^O)+F[13]+681279174&4294967295,R=D+(M<<4&4294967295|M>>>28),M=O+(R^D^E)+F[0]+3936430074&4294967295,O=R+(M<<11&4294967295|M>>>21),M=E+(O^R^D)+F[3]+3572445317&4294967295,E=O+(M<<16&4294967295|M>>>16),M=D+(E^O^R)+F[6]+76029189&4294967295,D=E+(M<<23&4294967295|M>>>9),M=R+(D^E^O)+F[9]+3654602809&4294967295,R=D+(M<<4&4294967295|M>>>28),M=O+(R^D^E)+F[12]+3873151461&4294967295,O=R+(M<<11&4294967295|M>>>21),M=E+(O^R^D)+F[15]+530742520&4294967295,E=O+(M<<16&4294967295|M>>>16),M=D+(E^O^R)+F[2]+3299628645&4294967295,D=E+(M<<23&4294967295|M>>>9),M=R+(E^(D|~O))+F[0]+4096336452&4294967295,R=D+(M<<6&4294967295|M>>>26),M=O+(D^(R|~E))+F[7]+1126891415&4294967295,O=R+(M<<10&4294967295|M>>>22),M=E+(R^(O|~D))+F[14]+2878612391&4294967295,E=O+(M<<15&4294967295|M>>>17),M=D+(O^(E|~R))+F[5]+4237533241&4294967295,D=E+(M<<21&4294967295|M>>>11),M=R+(E^(D|~O))+F[12]+1700485571&4294967295,R=D+(M<<6&4294967295|M>>>26),M=O+(D^(R|~E))+F[3]+2399980690&4294967295,O=R+(M<<10&4294967295|M>>>22),M=E+(R^(O|~D))+F[10]+4293915773&4294967295,E=O+(M<<15&4294967295|M>>>17),M=D+(O^(E|~R))+F[1]+2240044497&4294967295,D=E+(M<<21&4294967295|M>>>11),M=R+(E^(D|~O))+F[8]+1873313359&4294967295,R=D+(M<<6&4294967295|M>>>26),M=O+(D^(R|~E))+F[15]+4264355552&4294967295,O=R+(M<<10&4294967295|M>>>22),M=E+(R^(O|~D))+F[6]+2734768916&4294967295,E=O+(M<<15&4294967295|M>>>17),M=D+(O^(E|~R))+F[13]+1309151649&4294967295,D=E+(M<<21&4294967295|M>>>11),M=R+(E^(D|~O))+F[4]+4149444226&4294967295,R=D+(M<<6&4294967295|M>>>26),M=O+(D^(R|~E))+F[11]+3174756917&4294967295,O=R+(M<<10&4294967295|M>>>22),M=E+(R^(O|~D))+F[2]+718787259&4294967295,E=O+(M<<15&4294967295|M>>>17),M=D+(O^(E|~R))+F[9]+3951481745&4294967295,z.g[0]=z.g[0]+R&4294967295,z.g[1]=z.g[1]+(E+(M<<21&4294967295|M>>>11))&4294967295,z.g[2]=z.g[2]+E&4294967295,z.g[3]=z.g[3]+O&4294967295}i.prototype.u=function(z,R){R===void 0&&(R=z.length);for(var D=R-this.blockSize,F=this.B,E=this.h,O=0;O<R;){if(E==0)for(;O<=D;)s(this,z,O),O+=this.blockSize;if(typeof z=="string"){for(;O<R;)if(F[E++]=z.charCodeAt(O++),E==this.blockSize){s(this,F),E=0;break}}else for(;O<R;)if(F[E++]=z[O++],E==this.blockSize){s(this,F),E=0;break}}this.h=E,this.o+=R},i.prototype.v=function(){var z=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);z[0]=128;for(var R=1;R<z.length-8;++R)z[R]=0;var D=8*this.o;for(R=z.length-8;R<z.length;++R)z[R]=D&255,D/=256;for(this.u(z),z=Array(16),R=D=0;4>R;++R)for(var F=0;32>F;F+=8)z[D++]=this.g[R]>>>F&255;return z};function o(z,R){var D=c;return Object.prototype.hasOwnProperty.call(D,z)?D[z]:D[z]=R(z)}function l(z,R){this.h=R;for(var D=[],F=!0,E=z.length-1;0<=E;E--){var O=z[E]|0;F&&O==R||(D[E]=O,F=!1)}this.g=D}var c={};function d(z){return-128<=z&&128>z?o(z,function(R){return new l([R|0],0>R?-1:0)}):new l([z|0],0>z?-1:0)}function f(z){if(isNaN(z)||!isFinite(z))return v;if(0>z)return A(f(-z));for(var R=[],D=1,F=0;z>=D;F++)R[F]=z/D|0,D*=4294967296;return new l(R,0)}function p(z,R){if(z.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(z.charAt(0)=="-")return A(p(z.substring(1),R));if(0<=z.indexOf("-"))throw Error('number format error: interior "-" character');for(var D=f(Math.pow(R,8)),F=v,E=0;E<z.length;E+=8){var O=Math.min(8,z.length-E),M=parseInt(z.substring(E,E+O),R);8>O?(O=f(Math.pow(R,O)),F=F.j(O).add(f(M))):(F=F.j(D),F=F.add(f(M)))}return F}var v=d(0),_=d(1),b=d(16777216);n=l.prototype,n.m=function(){if(C(this))return-A(this).m();for(var z=0,R=1,D=0;D<this.g.length;D++){var F=this.i(D);z+=(0<=F?F:4294967296+F)*R,R*=4294967296}return z},n.toString=function(z){if(z=z||10,2>z||36<z)throw Error("radix out of range: "+z);if(T(this))return"0";if(C(this))return"-"+A(this).toString(z);for(var R=f(Math.pow(z,6)),D=this,F="";;){var E=K(D,R).g;D=I(D,E.j(R));var O=((0<D.g.length?D.g[0]:D.h)>>>0).toString(z);if(D=E,T(D))return O+F;for(;6>O.length;)O="0"+O;F=O+F}},n.i=function(z){return 0>z?0:z<this.g.length?this.g[z]:this.h};function T(z){if(z.h!=0)return!1;for(var R=0;R<z.g.length;R++)if(z.g[R]!=0)return!1;return!0}function C(z){return z.h==-1}n.l=function(z){return z=I(this,z),C(z)?-1:T(z)?0:1};function A(z){for(var R=z.g.length,D=[],F=0;F<R;F++)D[F]=~z.g[F];return new l(D,~z.h).add(_)}n.abs=function(){return C(this)?A(this):this},n.add=function(z){for(var R=Math.max(this.g.length,z.g.length),D=[],F=0,E=0;E<=R;E++){var O=F+(this.i(E)&65535)+(z.i(E)&65535),M=(O>>>16)+(this.i(E)>>>16)+(z.i(E)>>>16);F=M>>>16,O&=65535,M&=65535,D[E]=M<<16|O}return new l(D,D[D.length-1]&-2147483648?-1:0)};function I(z,R){return z.add(A(R))}n.j=function(z){if(T(this)||T(z))return v;if(C(this))return C(z)?A(this).j(A(z)):A(A(this).j(z));if(C(z))return A(this.j(A(z)));if(0>this.l(b)&&0>z.l(b))return f(this.m()*z.m());for(var R=this.g.length+z.g.length,D=[],F=0;F<2*R;F++)D[F]=0;for(F=0;F<this.g.length;F++)for(var E=0;E<z.g.length;E++){var O=this.i(F)>>>16,M=this.i(F)&65535,Y=z.i(E)>>>16,ie=z.i(E)&65535;D[2*F+2*E]+=M*ie,ee(D,2*F+2*E),D[2*F+2*E+1]+=O*ie,ee(D,2*F+2*E+1),D[2*F+2*E+1]+=M*Y,ee(D,2*F+2*E+1),D[2*F+2*E+2]+=O*Y,ee(D,2*F+2*E+2)}for(F=0;F<R;F++)D[F]=D[2*F+1]<<16|D[2*F];for(F=R;F<2*R;F++)D[F]=0;return new l(D,0)};function ee(z,R){for(;(z[R]&65535)!=z[R];)z[R+1]+=z[R]>>>16,z[R]&=65535,R++}function G(z,R){this.g=z,this.h=R}function K(z,R){if(T(R))throw Error("division by zero");if(T(z))return new G(v,v);if(C(z))return R=K(A(z),R),new G(A(R.g),A(R.h));if(C(R))return R=K(z,A(R)),new G(A(R.g),R.h);if(30<z.g.length){if(C(z)||C(R))throw Error("slowDivide_ only works with positive integers.");for(var D=_,F=R;0>=F.l(z);)D=de(D),F=de(F);var E=le(D,1),O=le(F,1);for(F=le(F,2),D=le(D,2);!T(F);){var M=O.add(F);0>=M.l(z)&&(E=E.add(D),O=M),F=le(F,1),D=le(D,1)}return R=I(z,E.j(R)),new G(E,R)}for(E=v;0<=z.l(R);){for(D=Math.max(1,Math.floor(z.m()/R.m())),F=Math.ceil(Math.log(D)/Math.LN2),F=48>=F?1:Math.pow(2,F-48),O=f(D),M=O.j(R);C(M)||0<M.l(z);)D-=F,O=f(D),M=O.j(R);T(O)&&(O=_),E=E.add(O),z=I(z,M)}return new G(E,z)}n.A=function(z){return K(this,z).h},n.and=function(z){for(var R=Math.max(this.g.length,z.g.length),D=[],F=0;F<R;F++)D[F]=this.i(F)&z.i(F);return new l(D,this.h&z.h)},n.or=function(z){for(var R=Math.max(this.g.length,z.g.length),D=[],F=0;F<R;F++)D[F]=this.i(F)|z.i(F);return new l(D,this.h|z.h)},n.xor=function(z){for(var R=Math.max(this.g.length,z.g.length),D=[],F=0;F<R;F++)D[F]=this.i(F)^z.i(F);return new l(D,this.h^z.h)};function de(z){for(var R=z.g.length+1,D=[],F=0;F<R;F++)D[F]=z.i(F)<<1|z.i(F-1)>>>31;return new l(D,z.h)}function le(z,R){var D=R>>5;R%=32;for(var F=z.g.length-D,E=[],O=0;O<F;O++)E[O]=0<R?z.i(O+D)>>>R|z.i(O+D+1)<<32-R:z.i(O+D);return new l(E,z.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=f,l.fromString=p,vb=l}).apply(typeof mx<"u"?mx:typeof self<"u"?self:typeof window<"u"?window:{});var dg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,L,B){return y==Array.prototype||y==Object.prototype||(y[L]=B.value),y};function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof dg=="object"&&dg];for(var L=0;L<y.length;++L){var B=y[L];if(B&&B.Math==Math)return B}throw Error("Cannot find global object")}var i=t(this);function s(y,L){if(L)e:{var B=i;y=y.split(".");for(var he=0;he<y.length-1;he++){var it=y[he];if(!(it in B))break e;B=B[it]}y=y[y.length-1],he=B[y],L=L(he),L!=he&&L!=null&&e(B,y,{configurable:!0,writable:!0,value:L})}}function o(y,L){y instanceof String&&(y+="");var B=0,he=!1,it={next:function(){if(!he&&B<y.length){var Et=B++;return{value:L(Et,y[Et]),done:!1}}return he=!0,{done:!0,value:void 0}}};return it[Symbol.iterator]=function(){return it},it}s("Array.prototype.values",function(y){return y||function(){return o(this,function(L,B){return B})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function d(y){var L=typeof y;return L=L!="object"?L:y?Array.isArray(y)?"array":L:"null",L=="array"||L=="object"&&typeof y.length=="number"}function f(y){var L=typeof y;return L=="object"&&y!=null||L=="function"}function p(y,L,B){return y.call.apply(y.bind,arguments)}function v(y,L,B){if(!y)throw Error();if(2<arguments.length){var he=Array.prototype.slice.call(arguments,2);return function(){var it=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(it,he),y.apply(L,it)}}return function(){return y.apply(L,arguments)}}function _(y,L,B){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:v,_.apply(null,arguments)}function b(y,L){var B=Array.prototype.slice.call(arguments,1);return function(){var he=B.slice();return he.push.apply(he,arguments),y.apply(this,he)}}function T(y,L){function B(){}B.prototype=L.prototype,y.aa=L.prototype,y.prototype=new B,y.prototype.constructor=y,y.Qb=function(he,it,Et){for(var Gt=Array(arguments.length-2),Pn=2;Pn<arguments.length;Pn++)Gt[Pn-2]=arguments[Pn];return L.prototype[it].apply(he,Gt)}}function C(y){const L=y.length;if(0<L){const B=Array(L);for(let he=0;he<L;he++)B[he]=y[he];return B}return[]}function A(y,L){for(let B=1;B<arguments.length;B++){const he=arguments[B];if(d(he)){const it=y.length||0,Et=he.length||0;y.length=it+Et;for(let Gt=0;Gt<Et;Gt++)y[it+Gt]=he[Gt]}else y.push(he)}}class I{constructor(L,B){this.i=L,this.j=B,this.h=0,this.g=null}get(){let L;return 0<this.h?(this.h--,L=this.g,this.g=L.next,L.next=null):L=this.i(),L}}function ee(y){return/^[\s\xa0]*$/.test(y)}function G(){var y=c.navigator;return y&&(y=y.userAgent)?y:""}function K(y){return K[" "](y),y}K[" "]=function(){};var de=G().indexOf("Gecko")!=-1&&!(G().toLowerCase().indexOf("webkit")!=-1&&G().indexOf("Edge")==-1)&&!(G().indexOf("Trident")!=-1||G().indexOf("MSIE")!=-1)&&G().indexOf("Edge")==-1;function le(y,L,B){for(const he in y)L.call(B,y[he],he,y)}function z(y,L){for(const B in y)L.call(void 0,y[B],B,y)}function R(y){const L={};for(const B in y)L[B]=y[B];return L}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(y,L){let B,he;for(let it=1;it<arguments.length;it++){he=arguments[it];for(B in he)y[B]=he[B];for(let Et=0;Et<D.length;Et++)B=D[Et],Object.prototype.hasOwnProperty.call(he,B)&&(y[B]=he[B])}}function E(y){var L=1;y=y.split(":");const B=[];for(;0<L&&y.length;)B.push(y.shift()),L--;return y.length&&B.push(y.join(":")),B}function O(y){c.setTimeout(()=>{throw y},0)}function M(){var y=se;let L=null;return y.g&&(L=y.g,y.g=y.g.next,y.g||(y.h=null),L.next=null),L}class Y{constructor(){this.h=this.g=null}add(L,B){const he=ie.get();he.set(L,B),this.h?this.h.next=he:this.g=he,this.h=he}}var ie=new I(()=>new q,y=>y.reset());class q{constructor(){this.next=this.g=this.h=null}set(L,B){this.h=L,this.g=B,this.next=null}reset(){this.next=this.g=this.h=null}}let re,V=!1,se=new Y,W=()=>{const y=c.Promise.resolve(void 0);re=()=>{y.then(te)}};var te=()=>{for(var y;y=M();){try{y.h.call(y.g)}catch(B){O(B)}var L=ie;L.j(y),100>L.h&&(L.h++,y.next=L.g,L.g=y)}V=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function U(y,L){this.type=y,this.g=this.target=L,this.defaultPrevented=!1}U.prototype.h=function(){this.defaultPrevented=!0};var $=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var y=!1,L=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const B=()=>{};c.addEventListener("test",B,L),c.removeEventListener("test",B,L)}catch{}return y})();function X(y,L){if(U.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var B=this.type=y.type,he=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=L,L=y.relatedTarget){if(de){e:{try{K(L.nodeName);var it=!0;break e}catch{}it=!1}it||(L=null)}}else B=="mouseover"?L=y.fromElement:B=="mouseout"&&(L=y.toElement);this.relatedTarget=L,he?(this.clientX=he.clientX!==void 0?he.clientX:he.pageX,this.clientY=he.clientY!==void 0?he.clientY:he.pageY,this.screenX=he.screenX||0,this.screenY=he.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:Q[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&X.aa.h.call(this)}}T(X,U);var Q={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var ye="closure_listenable_"+(1e6*Math.random()|0),Ae=0;function De(y,L,B,he,it){this.listener=y,this.proxy=null,this.src=L,this.type=B,this.capture=!!he,this.ha=it,this.key=++Ae,this.da=this.fa=!1}function Be(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function Fe(y){this.src=y,this.g={},this.h=0}Fe.prototype.add=function(y,L,B,he,it){var Et=y.toString();y=this.g[Et],y||(y=this.g[Et]=[],this.h++);var Gt=at(y,L,he,it);return-1<Gt?(L=y[Gt],B||(L.fa=!1)):(L=new De(L,this.src,Et,!!he,it),L.fa=B,y.push(L)),L};function Ct(y,L){var B=L.type;if(B in y.g){var he=y.g[B],it=Array.prototype.indexOf.call(he,L,void 0),Et;(Et=0<=it)&&Array.prototype.splice.call(he,it,1),Et&&(Be(L),y.g[B].length==0&&(delete y.g[B],y.h--))}}function at(y,L,B,he){for(var it=0;it<y.length;++it){var Et=y[it];if(!Et.da&&Et.listener==L&&Et.capture==!!B&&Et.ha==he)return it}return-1}var Ce="closure_lm_"+(1e6*Math.random()|0),ce={};function _t(y,L,B,he,it){if(Array.isArray(L)){for(var Et=0;Et<L.length;Et++)_t(y,L[Et],B,he,it);return null}return B=Se(B),y&&y[ye]?y.K(L,B,f(he)?!!he.capture:!1,it):Ne(y,L,B,!1,he,it)}function Ne(y,L,B,he,it,Et){if(!L)throw Error("Invalid event type");var Gt=f(it)?!!it.capture:!!it,Pn=pe(y);if(Pn||(y[Ce]=Pn=new Fe(y)),B=Pn.add(L,B,he,Gt,Et),B.proxy)return B;if(he=Ve(),B.proxy=he,he.src=y,he.listener=B,y.addEventListener)$||(it=Gt),it===void 0&&(it=!1),y.addEventListener(L.toString(),he,it);else if(y.attachEvent)y.attachEvent(lt(L.toString()),he);else if(y.addListener&&y.removeListener)y.addListener(he);else throw Error("addEventListener and attachEvent are unavailable.");return B}function Ve(){function y(B){return L.call(y.src,y.listener,B)}const L=$e;return y}function We(y,L,B,he,it){if(Array.isArray(L))for(var Et=0;Et<L.length;Et++)We(y,L[Et],B,he,it);else he=f(he)?!!he.capture:!!he,B=Se(B),y&&y[ye]?(y=y.i,L=String(L).toString(),L in y.g&&(Et=y.g[L],B=at(Et,B,he,it),-1<B&&(Be(Et[B]),Array.prototype.splice.call(Et,B,1),Et.length==0&&(delete y.g[L],y.h--)))):y&&(y=pe(y))&&(L=y.g[L.toString()],y=-1,L&&(y=at(L,B,he,it)),(B=-1<y?L[y]:null)&&tt(B))}function tt(y){if(typeof y!="number"&&y&&!y.da){var L=y.src;if(L&&L[ye])Ct(L.i,y);else{var B=y.type,he=y.proxy;L.removeEventListener?L.removeEventListener(B,he,y.capture):L.detachEvent?L.detachEvent(lt(B),he):L.addListener&&L.removeListener&&L.removeListener(he),(B=pe(L))?(Ct(B,y),B.h==0&&(B.src=null,L[Ce]=null)):Be(y)}}}function lt(y){return y in ce?ce[y]:ce[y]="on"+y}function $e(y,L){if(y.da)y=!0;else{L=new X(L,this);var B=y.listener,he=y.ha||y.src;y.fa&&tt(y),y=B.call(he,L)}return y}function pe(y){return y=y[Ce],y instanceof Fe?y:null}var be="__closure_events_fn_"+(1e9*Math.random()>>>0);function Se(y){return typeof y=="function"?y:(y[be]||(y[be]=function(L){return y.handleEvent(L)}),y[be])}function Ee(){j.call(this),this.i=new Fe(this),this.M=this,this.F=null}T(Ee,j),Ee.prototype[ye]=!0,Ee.prototype.removeEventListener=function(y,L,B,he){We(this,y,L,B,he)};function Ye(y,L){var B,he=y.F;if(he)for(B=[];he;he=he.F)B.push(he);if(y=y.M,he=L.type||L,typeof L=="string")L=new U(L,y);else if(L instanceof U)L.target=L.target||y;else{var it=L;L=new U(he,y),F(L,it)}if(it=!0,B)for(var Et=B.length-1;0<=Et;Et--){var Gt=L.g=B[Et];it=qe(Gt,he,!0,L)&&it}if(Gt=L.g=y,it=qe(Gt,he,!0,L)&&it,it=qe(Gt,he,!1,L)&&it,B)for(Et=0;Et<B.length;Et++)Gt=L.g=B[Et],it=qe(Gt,he,!1,L)&&it}Ee.prototype.N=function(){if(Ee.aa.N.call(this),this.i){var y=this.i,L;for(L in y.g){for(var B=y.g[L],he=0;he<B.length;he++)Be(B[he]);delete y.g[L],y.h--}}this.F=null},Ee.prototype.K=function(y,L,B,he){return this.i.add(String(y),L,!1,B,he)},Ee.prototype.L=function(y,L,B,he){return this.i.add(String(y),L,!0,B,he)};function qe(y,L,B,he){if(L=y.i.g[String(L)],!L)return!0;L=L.concat();for(var it=!0,Et=0;Et<L.length;++Et){var Gt=L[Et];if(Gt&&!Gt.da&&Gt.capture==B){var Pn=Gt.listener,Ti=Gt.ha||Gt.src;Gt.fa&&Ct(y.i,Gt),it=Pn.call(Ti,he)!==!1&&it}}return it&&!he.defaultPrevented}function Ue(y,L,B){if(typeof y=="function")B&&(y=_(y,B));else if(y&&typeof y.handleEvent=="function")y=_(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(L)?-1:c.setTimeout(y,L||0)}function Xe(y){y.g=Ue(()=>{y.g=null,y.i&&(y.i=!1,Xe(y))},y.l);const L=y.h;y.h=null,y.m.apply(null,L)}class bt extends j{constructor(L,B){super(),this.m=L,this.l=B,this.h=null,this.i=!1,this.g=null}j(L){this.h=arguments,this.g?this.i=!0:Xe(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qt(y){j.call(this),this.h=y,this.g={}}T(qt,j);var fe=[];function Ze(y){le(y.g,function(L,B){this.g.hasOwnProperty(B)&&tt(L)},y),y.g={}}qt.prototype.N=function(){qt.aa.N.call(this),Ze(this)},qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Je=c.JSON.stringify,mt=c.JSON.parse,Tt=class{stringify(y){return c.JSON.stringify(y,void 0)}parse(y){return c.JSON.parse(y,void 0)}};function It(){}It.prototype.h=null;function gt(y){return y.h||(y.h=y.i())}function tn(){}var Zt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Dt(){U.call(this,"d")}T(Dt,U);function Ut(){U.call(this,"c")}T(Ut,U);var Qt={},an=null;function on(){return an=an||new Ee}Qt.La="serverreachability";function dn(y){U.call(this,Qt.La,y)}T(dn,U);function Sn(y){const L=on();Ye(L,new dn(L))}Qt.STAT_EVENT="statevent";function Te(y,L){U.call(this,Qt.STAT_EVENT,y),this.stat=L}T(Te,U);function Qe(y){const L=on();Ye(L,new Te(L,y))}Qt.Ma="timingevent";function dt(y,L){U.call(this,Qt.Ma,y),this.size=L}T(dt,U);function ve(y,L){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){y()},L)}function He(){this.g=!0}He.prototype.xa=function(){this.g=!1};function Le(y,L,B,he,it,Et){y.info(function(){if(y.g)if(Et)for(var Gt="",Pn=Et.split("&"),Ti=0;Ti<Pn.length;Ti++){var Hn=Pn[Ti].split("=");if(1<Hn.length){var ms=Hn[0];Hn=Hn[1];var Xn=ms.split("_");Gt=2<=Xn.length&&Xn[1]=="type"?Gt+(ms+"="+Hn+"&"):Gt+(ms+"=redacted&")}}else Gt=null;else Gt=Et;return"XMLHTTP REQ ("+he+") [attempt "+it+"]: "+L+`
`+B+`
`+Gt})}function Re(y,L,B,he,it,Et,Gt){y.info(function(){return"XMLHTTP RESP ("+he+") [ attempt "+it+"]: "+L+`
`+B+`
`+Et+" "+Gt})}function Pe(y,L,B,he){y.info(function(){return"XMLHTTP TEXT ("+L+"): "+rt(y,B)+(he?" "+he:"")})}function At(y,L){y.info(function(){return"TIMEOUT: "+L})}He.prototype.info=function(){};function rt(y,L){if(!y.g)return L;if(!L)return null;try{var B=JSON.parse(L);if(B){for(y=0;y<B.length;y++)if(Array.isArray(B[y])){var he=B[y];if(!(2>he.length)){var it=he[1];if(Array.isArray(it)&&!(1>it.length)){var Et=it[0];if(Et!="noop"&&Et!="stop"&&Et!="close")for(var Gt=1;Gt<it.length;Gt++)it[Gt]=""}}}}return Je(B)}catch{return L}}var Nt={NO_ERROR:0,TIMEOUT:8},xt={},st;function St(){}T(St,It),St.prototype.g=function(){return new XMLHttpRequest},St.prototype.i=function(){return{}},st=new St;function yt(y,L,B,he){this.j=y,this.i=L,this.l=B,this.R=he||1,this.U=new qt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ke}function ke(){this.i=null,this.g="",this.h=!1}var pt={},Lt={};function Yt(y,L,B){y.L=1,y.v=hr(ks(L)),y.m=B,y.P=!0,Vt(y,null)}function Vt(y,L){y.F=Date.now(),en(y),y.A=ks(y.v);var B=y.A,he=y.R;Array.isArray(he)||(he=[String(he)]),cn(B.i,"t",he),y.C=0,B=y.j.J,y.h=new ke,y.g=Mr(y.j,B?L:null,!y.m),0<y.O&&(y.M=new bt(_(y.Y,y,y.g),y.O)),L=y.U,B=y.g,he=y.ca;var it="readystatechange";Array.isArray(it)||(it&&(fe[0]=it.toString()),it=fe);for(var Et=0;Et<it.length;Et++){var Gt=_t(B,it[Et],he||L.handleEvent,!1,L.h||L);if(!Gt)break;L.g[Gt.key]=Gt}L=y.H?R(y.H):{},y.m?(y.u||(y.u="POST"),L["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,L)):(y.u="GET",y.g.ea(y.A,y.u,null,L)),Sn(),Le(y.i,y.u,y.A,y.l,y.R,y.m)}yt.prototype.ca=function(y){y=y.target;const L=this.M;L&&ro(y)==3?L.j():this.Y(y)},yt.prototype.Y=function(y){try{if(y==this.g)e:{const Xn=ro(this.g);var L=this.g.Ba();const xs=this.g.Z();if(!(3>Xn)&&(Xn!=3||this.g&&(this.h.h||this.g.oa()||nl(this.g)))){this.J||Xn!=4||L==7||(L==8||0>=xs?Sn(3):Sn(2)),In(this);var B=this.g.Z();this.X=B;t:if(nn(this)){var he=nl(this.g);y="";var it=he.length,Et=ro(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vn(this),Tn(this);var Gt="";break t}this.h.i=new c.TextDecoder}for(L=0;L<it;L++)this.h.h=!0,y+=this.h.i.decode(he[L],{stream:!(Et&&L==it-1)});he.length=0,this.h.g+=y,this.C=0,Gt=this.h.g}else Gt=this.g.oa();if(this.o=B==200,Re(this.i,this.u,this.A,this.l,this.R,Xn,B),this.o){if(this.T&&!this.K){t:{if(this.g){var Pn,Ti=this.g;if((Pn=Ti.g?Ti.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ee(Pn)){var Hn=Pn;break t}}Hn=null}if(B=Hn)Pe(this.i,this.l,B,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ei(this,B);else{this.o=!1,this.s=3,Qe(12),Vn(this),Tn(this);break e}}if(this.P){B=!0;let $s;for(;!this.J&&this.C<Gt.length;)if($s=yn(this,Gt),$s==Lt){Xn==4&&(this.s=4,Qe(14),B=!1),Pe(this.i,this.l,null,"[Incomplete Response]");break}else if($s==pt){this.s=4,Qe(15),Pe(this.i,this.l,Gt,"[Invalid Chunk]"),B=!1;break}else Pe(this.i,this.l,$s,null),Ei(this,$s);if(nn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xn!=4||Gt.length!=0||this.h.h||(this.s=1,Qe(16),B=!1),this.o=this.o&&B,!B)Pe(this.i,this.l,Gt,"[Invalid Chunked Response]"),Vn(this),Tn(this);else if(0<Gt.length&&!this.W){this.W=!0;var ms=this.j;ms.g==this&&ms.ba&&!ms.M&&(ms.j.info("Great, no buffering proxy detected. Bytes received: "+Gt.length),Gn(ms),ms.M=!0,Qe(11))}}else Pe(this.i,this.l,Gt,null),Ei(this,Gt);Xn==4&&Vn(this),this.o&&!this.J&&(Xn==4?pi(this.j,this):(this.o=!1,en(this)))}else _o(this.g),B==400&&0<Gt.indexOf("Unknown SID")?(this.s=3,Qe(12)):(this.s=0,Qe(13)),Vn(this),Tn(this)}}}catch{}finally{}};function nn(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function yn(y,L){var B=y.C,he=L.indexOf(`
`,B);return he==-1?Lt:(B=Number(L.substring(B,he)),isNaN(B)?pt:(he+=1,he+B>L.length?Lt:(L=L.slice(he,he+B),y.C=he+B,L)))}yt.prototype.cancel=function(){this.J=!0,Vn(this)};function en(y){y.S=Date.now()+y.I,wn(y,y.I)}function wn(y,L){if(y.B!=null)throw Error("WatchDog timer not null");y.B=ve(_(y.ba,y),L)}function In(y){y.B&&(c.clearTimeout(y.B),y.B=null)}yt.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(At(this.i,this.A),this.L!=2&&(Sn(),Qe(17)),Vn(this),this.s=2,Tn(this)):wn(this,this.S-y)};function Tn(y){y.j.G==0||y.J||pi(y.j,y)}function Vn(y){In(y);var L=y.M;L&&typeof L.ma=="function"&&L.ma(),y.M=null,Ze(y.U),y.g&&(L=y.g,y.g=null,L.abort(),L.ma())}function Ei(y,L){try{var B=y.j;if(B.G!=0&&(B.g==y||Ar(B.h,y))){if(!y.K&&Ar(B.h,y)&&B.G==3){try{var he=B.Da.g.parse(L)}catch{he=null}if(Array.isArray(he)&&he.length==3){var it=he;if(it[0]==0){e:if(!B.u){if(B.g)if(B.g.F+3e3<y.F)Fi(B),_e(B);else break e;An(B),Qe(18)}}else B.za=it[1],0<B.za-B.T&&37500>it[2]&&B.F&&B.v==0&&!B.C&&(B.C=ve(_(B.Za,B),6e3));if(1>=Lr(B.h)&&B.ca){try{B.ca()}catch{}B.ca=void 0}}else Si(B,11)}else if((y.K||B.g==y)&&Fi(B),!ee(L))for(it=B.Da.g.parse(L),L=0;L<it.length;L++){let Hn=it[L];if(B.T=Hn[0],Hn=Hn[1],B.G==2)if(Hn[0]=="c"){B.K=Hn[1],B.ia=Hn[2];const ms=Hn[3];ms!=null&&(B.la=ms,B.j.info("VER="+B.la));const Xn=Hn[4];Xn!=null&&(B.Aa=Xn,B.j.info("SVER="+B.Aa));const xs=Hn[5];xs!=null&&typeof xs=="number"&&0<xs&&(he=1.5*xs,B.L=he,B.j.info("backChannelRequestTimeoutMs_="+he)),he=B;const $s=y.g;if($s){const Bo=$s.g?$s.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bo){var Et=he.h;Et.g||Bo.indexOf("spdy")==-1&&Bo.indexOf("quic")==-1&&Bo.indexOf("h2")==-1||(Et.j=Et.l,Et.g=new Set,Et.h&&(Vs(Et,Et.h),Et.h=null))}if(he.D){const lo=$s.g?$s.g.getResponseHeader("X-HTTP-Session-Id"):null;lo&&(he.ya=lo,zn(he.I,he.D,lo))}}B.G=3,B.l&&B.l.ua(),B.ba&&(B.R=Date.now()-y.F,B.j.info("Handshake RTT: "+B.R+"ms")),he=B;var Gt=y;if(he.qa=mr(he,he.J?he.ia:null,he.W),Gt.K){Yn(he.h,Gt);var Pn=Gt,Ti=he.L;Ti&&(Pn.I=Ti),Pn.B&&(In(Pn),en(Pn)),he.g=Gt}else xn(he);0<B.i.length&&et(B)}else Hn[0]!="stop"&&Hn[0]!="close"||Si(B,7);else B.G==3&&(Hn[0]=="stop"||Hn[0]=="close"?Hn[0]=="stop"?Si(B,7):Z(B):Hn[0]!="noop"&&B.l&&B.l.ta(Hn),B.v=0)}}Sn(4)}catch{}}var ts=class{constructor(y,L){this.g=y,this.map=L}};function fs(y){this.l=y||10,c.PerformanceNavigationTiming?(y=c.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Mo(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Lr(y){return y.h?1:y.g?y.g.size:0}function Ar(y,L){return y.h?y.h==L:y.g?y.g.has(L):!1}function Vs(y,L){y.g?y.g.add(L):y.h=L}function Yn(y,L){y.h&&y.h==L?y.h=null:y.g&&y.g.has(L)&&y.g.delete(L)}fs.prototype.cancel=function(){if(this.i=ai(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function ai(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let L=y.i;for(const B of y.g.values())L=L.concat(B.D);return L}return C(y.i)}function tl(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(d(y)){for(var L=[],B=y.length,he=0;he<B;he++)L.push(y[he]);return L}L=[],B=0;for(he in y)L[B++]=y[he];return L}function no(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(d(y)||typeof y=="string"){var L=[];y=y.length;for(var B=0;B<y;B++)L.push(B);return L}L=[],B=0;for(const he in y)L[B++]=he;return L}}}function Ro(y,L){if(y.forEach&&typeof y.forEach=="function")y.forEach(L,void 0);else if(d(y)||typeof y=="string")Array.prototype.forEach.call(y,L,void 0);else for(var B=no(y),he=tl(y),it=he.length,Et=0;Et<it;Et++)L.call(void 0,he[Et],B&&B[Et],y)}var ns=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function dr(y,L){if(y){y=y.split("&");for(var B=0;B<y.length;B++){var he=y[B].indexOf("="),it=null;if(0<=he){var Et=y[B].substring(0,he);it=y[B].substring(he+1)}else Et=y[B];L(Et,it?decodeURIComponent(it.replace(/\+/g," ")):"")}}}function $n(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof $n){this.h=y.h,Dr(this,y.j),this.o=y.o,this.g=y.g,Or(this,y.s),this.l=y.l;var L=y.i,B=new Vi;B.i=L.i,L.g&&(B.g=new Map(L.g),B.h=L.h),Qo(this,B),this.m=y.m}else y&&(L=String(y).match(ns))?(this.h=!1,Dr(this,L[1]||"",!0),this.o=io(L[2]||""),this.g=io(L[3]||"",!0),Or(this,L[4]),this.l=io(L[5]||"",!0),Qo(this,L[6]||"",!0),this.m=io(L[7]||"")):(this.h=!1,this.i=new Vi(null,this.h))}$n.prototype.toString=function(){var y=[],L=this.j;L&&y.push(so(L,_n,!0),":");var B=this.g;return(B||L=="file")&&(y.push("//"),(L=this.o)&&y.push(so(L,_n,!0),"@"),y.push(encodeURIComponent(String(B)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),B=this.s,B!=null&&y.push(":",String(B))),(B=this.l)&&(this.g&&B.charAt(0)!="/"&&y.push("/"),y.push(so(B,B.charAt(0)=="/"?is:Ui,!0))),(B=this.i.toString())&&y.push("?",B),(B=this.m)&&y.push("#",so(B,ss)),y.join("")};function ks(y){return new $n(y)}function Dr(y,L,B){y.j=B?io(L,!0):L,y.j&&(y.j=y.j.replace(/:$/,""))}function Or(y,L){if(L){if(L=Number(L),isNaN(L)||0>L)throw Error("Bad port number "+L);y.s=L}else y.s=null}function Qo(y,L,B){L instanceof Vi?(y.i=L,Po(y.i,y.h)):(B||(L=so(L,qi)),y.i=new Vi(L,y.h))}function zn(y,L,B){y.i.set(L,B)}function hr(y){return zn(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function io(y,L){return y?L?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function so(y,L,B){return typeof y=="string"?(y=encodeURI(y).replace(L,Ht),B&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Ht(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var _n=/[#\/\?@]/g,Ui=/[#\?:]/g,is=/[#\?]/g,qi=/[#\?@]/g,ss=/#/g;function Vi(y,L){this.h=this.g=null,this.i=y||null,this.j=!!L}function Oi(y){y.g||(y.g=new Map,y.h=0,y.i&&dr(y.i,function(L,B){y.add(decodeURIComponent(L.replace(/\+/g," ")),B)}))}n=Vi.prototype,n.add=function(y,L){Oi(this),this.i=null,y=Io(this,y);var B=this.g.get(y);return B||this.g.set(y,B=[]),B.push(L),this.h+=1,this};function Fn(y,L){Oi(y),L=Io(y,L),y.g.has(L)&&(y.i=null,y.h-=y.g.get(L).length,y.g.delete(L))}function mi(y,L){return Oi(y),L=Io(y,L),y.g.has(L)}n.forEach=function(y,L){Oi(this),this.g.forEach(function(B,he){B.forEach(function(it){y.call(L,it,he,this)},this)},this)},n.na=function(){Oi(this);const y=Array.from(this.g.values()),L=Array.from(this.g.keys()),B=[];for(let he=0;he<L.length;he++){const it=y[he];for(let Et=0;Et<it.length;Et++)B.push(L[he])}return B},n.V=function(y){Oi(this);let L=[];if(typeof y=="string")mi(this,y)&&(L=L.concat(this.g.get(Io(this,y))));else{y=Array.from(this.g.values());for(let B=0;B<y.length;B++)L=L.concat(y[B])}return L},n.set=function(y,L){return Oi(this),this.i=null,y=Io(this,y),mi(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[L]),this.h+=1,this},n.get=function(y,L){return y?(y=this.V(y),0<y.length?String(y[0]):L):L};function cn(y,L,B){Fn(y,L),0<B.length&&(y.i=null,y.g.set(Io(y,L),C(B)),y.h+=B.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],L=Array.from(this.g.keys());for(var B=0;B<L.length;B++){var he=L[B];const Et=encodeURIComponent(String(he)),Gt=this.V(he);for(he=0;he<Gt.length;he++){var it=Et;Gt[he]!==""&&(it+="="+encodeURIComponent(String(Gt[he]))),y.push(it)}}return this.i=y.join("&")};function Io(y,L){return L=String(L),y.j&&(L=L.toLowerCase()),L}function Po(y,L){L&&!y.j&&(Oi(y),y.i=null,y.g.forEach(function(B,he){var it=he.toLowerCase();he!=it&&(Fn(this,he),cn(this,it,B))},y)),y.j=L}function bs(y,L){const B=new He;if(c.Image){const he=new Image;he.onload=b(os,B,"TestLoadImage: loaded",!0,L,he),he.onerror=b(os,B,"TestLoadImage: error",!1,L,he),he.onabort=b(os,B,"TestLoadImage: abort",!1,L,he),he.ontimeout=b(os,B,"TestLoadImage: timeout",!1,L,he),c.setTimeout(function(){he.ontimeout&&he.ontimeout()},1e4),he.src=y}else L(!1)}function bo(y,L){const B=new He,he=new AbortController,it=setTimeout(()=>{he.abort(),os(B,"TestPingServer: timeout",!1,L)},1e4);fetch(y,{signal:he.signal}).then(Et=>{clearTimeout(it),Et.ok?os(B,"TestPingServer: ok",!0,L):os(B,"TestPingServer: server error",!1,L)}).catch(()=>{clearTimeout(it),os(B,"TestPingServer: error",!1,L)})}function os(y,L,B,he,it){try{it&&(it.onload=null,it.onerror=null,it.onabort=null,it.ontimeout=null),he(B)}catch{}}function Ys(){this.g=new Tt}function fr(y,L,B){const he=B||"";try{Ro(y,function(it,Et){let Gt=it;f(it)&&(Gt=Je(it)),L.push(he+Et+"="+encodeURIComponent(Gt))})}catch(it){throw L.push(he+"type="+encodeURIComponent("_badmap")),it}}function Vr(y){this.l=y.Ub||null,this.j=y.eb||!1}T(Vr,It),Vr.prototype.g=function(){return new Uo(this.l,this.j)},Vr.prototype.i=(function(y){return function(){return y}})({});function Uo(y,L){Ee.call(this),this.D=y,this.o=L,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Uo,Ee),n=Uo.prototype,n.open=function(y,L){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=L,this.readyState=1,wo(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const L={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(L.body=y),(this.D||c).fetch(new Request(this.A,L)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,oo(this)),this.readyState=0},n.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,wo(this)),this.g&&(this.readyState=3,wo(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ea(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ea(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}n.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var L=y.value?y.value:new Uint8Array(0);(L=this.v.decode(L,{stream:!y.done}))&&(this.response=this.responseText+=L)}y.done?oo(this):wo(this),this.readyState==3&&Ea(this)}},n.Ra=function(y){this.g&&(this.response=this.responseText=y,oo(this))},n.Qa=function(y){this.g&&(this.response=y,oo(this))},n.ga=function(){this.g&&oo(this)};function oo(y){y.readyState=4,y.l=null,y.j=null,y.v=null,wo(y)}n.setRequestHeader=function(y,L){this.u.append(y,L)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],L=this.h.entries();for(var B=L.next();!B.done;)B=B.value,y.push(B[0]+": "+B[1]),B=L.next();return y.join(`\r
`)};function wo(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Uo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Yr(y){let L="";return le(y,function(B,he){L+=he,L+=":",L+=B,L+=`\r
`}),L}function ws(y,L,B){e:{for(he in B){var he=!1;break e}he=!0}he||(B=Yr(B),typeof y=="string"?B!=null&&encodeURIComponent(String(B)):zn(y,L,B))}function li(y){Ee.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(li,Ee);var Gr=/^https?$/i,Zo=["POST","PUT"];n=li.prototype,n.Ha=function(y){this.J=y},n.ea=function(y,L,B,he){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);L=L?L.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():st.g(),this.v=this.o?gt(this.o):gt(st),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(L,String(y),!0),this.B=!1}catch(Et){Kr(this,Et);return}if(y=B||"",B=new Map(this.headers),he)if(Object.getPrototypeOf(he)===Object.prototype)for(var it in he)B.set(it,he[it]);else if(typeof he.keys=="function"&&typeof he.get=="function")for(const Et of he.keys())B.set(Et,he.get(Et));else throw Error("Unknown input type for opt_headers: "+String(he));he=Array.from(B.keys()).find(Et=>Et.toLowerCase()=="content-type"),it=c.FormData&&y instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Zo,L,void 0))||he||it||B.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Et,Gt]of B)this.g.setRequestHeader(Et,Gt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Jo(this),this.u=!0,this.g.send(y),this.u=!1}catch(Et){Kr(this,Et)}};function Kr(y,L){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=L,y.m=5,Xr(y),Fo(y)}function Xr(y){y.A||(y.A=!0,Ye(y,"complete"),Ye(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,Ye(this,"complete"),Ye(this,"abort"),Fo(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Fo(this,!0)),li.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?jr(this):this.bb())},n.bb=function(){jr(this)};function jr(y){if(y.h&&typeof l<"u"&&(!y.v[1]||ro(y)!=4||y.Z()!=2)){if(y.u&&ro(y)==4)Ue(y.Ea,0,y);else if(Ye(y,"readystatechange"),ro(y)==4){y.h=!1;try{const Gt=y.Z();e:switch(Gt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var L=!0;break e;default:L=!1}var B;if(!(B=L)){var he;if(he=Gt===0){var it=String(y.D).match(ns)[1]||null;!it&&c.self&&c.self.location&&(it=c.self.location.protocol.slice(0,-1)),he=!Gr.test(it?it.toLowerCase():"")}B=he}if(B)Ye(y,"complete"),Ye(y,"success");else{y.m=6;try{var Et=2<ro(y)?y.g.statusText:""}catch{Et=""}y.l=Et+" ["+y.Z()+"]",Xr(y)}}finally{Fo(y)}}}}function Fo(y,L){if(y.g){Jo(y);const B=y.g,he=y.v[0]?()=>{}:null;y.g=null,y.v=null,L||Ye(y,"ready");try{B.onreadystatechange=he}catch{}}}function Jo(y){y.I&&(c.clearTimeout(y.I),y.I=null)}n.isActive=function(){return!!this.g};function ro(y){return y.g?y.g.readyState:0}n.Z=function(){try{return 2<ro(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(y){if(this.g){var L=this.g.responseText;return y&&L.indexOf(y)==0&&(L=L.substring(y.length)),mt(L)}};function nl(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function _o(y){const L={};y=(y.g&&2<=ro(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let he=0;he<y.length;he++){if(ee(y[he]))continue;var B=E(y[he]);const it=B[0];if(B=B[1],typeof B!="string")continue;B=B.trim();const Et=L[it]||[];L[it]=Et,Et.push(B)}z(L,function(he){return he.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ao(y,L,B){return B&&B.internalChannelParams&&B.internalChannelParams[y]||L}function N(y){this.Aa=0,this.i=[],this.j=new He,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ao("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ao("baseRetryDelayMs",5e3,y),this.cb=ao("retryDelaySeedMs",1e4,y),this.Wa=ao("forwardChannelMaxRetries",2,y),this.wa=ao("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new fs(y&&y.concurrentRequestLimit),this.Da=new Ys,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=N.prototype,n.la=8,n.G=1,n.connect=function(y,L,B,he){Qe(0),this.W=y,this.H=L||{},B&&he!==void 0&&(this.H.OSID=B,this.H.OAID=he),this.F=this.X,this.I=mr(this,null,this.W),et(this)};function Z(y){if(Ie(y),y.G==3){var L=y.U++,B=ks(y.I);if(zn(B,"SID",y.K),zn(B,"RID",L),zn(B,"TYPE","terminate"),sn(y,B),L=new yt(y,y.j,L),L.L=2,L.v=hr(ks(B)),B=!1,c.navigator&&c.navigator.sendBeacon)try{B=c.navigator.sendBeacon(L.v.toString(),"")}catch{}!B&&c.Image&&(new Image().src=L.v,B=!0),B||(L.g=Mr(L.j,null),L.g.ea(L.v)),L.F=Date.now(),en(L)}_s(y)}function _e(y){y.g&&(Gn(y),y.g.cancel(),y.g=null)}function Ie(y){_e(y),y.u&&(c.clearTimeout(y.u),y.u=null),Fi(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&c.clearTimeout(y.s),y.s=null)}function et(y){if(!Mo(y.h)&&!y.s){y.s=!0;var L=y.Ga;re||W(),V||(re(),V=!0),se.add(L,y),y.B=0}}function Mt(y,L){return Lr(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=L.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=ve(_(y.Ga,y,L),Xi(y,y.B)),y.B++,!0)}n.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const it=new yt(this,this.j,y);let Et=this.o;if(this.S&&(Et?(Et=R(Et),F(Et,this.S)):Et=this.S),this.m!==null||this.O||(it.H=Et,Et=null),this.P)e:{for(var L=0,B=0;B<this.i.length;B++){t:{var he=this.i[B];if("__data__"in he.map&&(he=he.map.__data__,typeof he=="string")){he=he.length;break t}he=void 0}if(he===void 0)break;if(L+=he,4096<L){L=B;break e}if(L===4096||B===this.i.length-1){L=B+1;break e}}L=1e3}else L=1e3;L=fn(this,it,L),B=ks(this.I),zn(B,"RID",y),zn(B,"CVER",22),this.D&&zn(B,"X-HTTP-Session-Id",this.D),sn(this,B),Et&&(this.O?L="headers="+encodeURIComponent(String(Yr(Et)))+"&"+L:this.m&&ws(B,this.m,Et)),Vs(this.h,it),this.Ua&&zn(B,"TYPE","init"),this.P?(zn(B,"$req",L),zn(B,"SID","null"),it.T=!0,Yt(it,B,null)):Yt(it,B,L),this.G=2}}else this.G==3&&(y?Wt(this,y):this.i.length==0||Mo(this.h)||Wt(this))};function Wt(y,L){var B;L?B=L.l:B=y.U++;const he=ks(y.I);zn(he,"SID",y.K),zn(he,"RID",B),zn(he,"AID",y.T),sn(y,he),y.m&&y.o&&ws(he,y.m,y.o),B=new yt(y,y.j,B,y.B+1),y.m===null&&(B.H=y.o),L&&(y.i=L.D.concat(y.i)),L=fn(y,B,1e3),B.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),Vs(y.h,B),Yt(B,he,L)}function sn(y,L){y.H&&le(y.H,function(B,he){zn(L,he,B)}),y.l&&Ro({},function(B,he){zn(L,he,B)})}function fn(y,L,B){B=Math.min(y.i.length,B);var he=y.l?_(y.l.Na,y.l,y):null;e:{var it=y.i;let Et=-1;for(;;){const Gt=["count="+B];Et==-1?0<B?(Et=it[0].g,Gt.push("ofs="+Et)):Et=0:Gt.push("ofs="+Et);let Pn=!0;for(let Ti=0;Ti<B;Ti++){let Hn=it[Ti].g;const ms=it[Ti].map;if(Hn-=Et,0>Hn)Et=Math.max(0,it[Ti].g-100),Pn=!1;else try{fr(ms,Gt,"req"+Hn+"_")}catch{he&&he(ms)}}if(Pn){he=Gt.join("&");break e}}}return y=y.i.splice(0,B),L.D=y,he}function xn(y){if(!y.g&&!y.u){y.Y=1;var L=y.Fa;re||W(),V||(re(),V=!0),se.add(L,y),y.v=0}}function An(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=ve(_(y.Fa,y),Xi(y,y.v)),y.v++,!0)}n.Fa=function(){if(this.u=null,ji(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=ve(_(this.ab,this),y)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Qe(10),_e(this),ji(this))};function Gn(y){y.A!=null&&(c.clearTimeout(y.A),y.A=null)}function ji(y){y.g=new yt(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var L=ks(y.qa);zn(L,"RID","rpc"),zn(L,"SID",y.K),zn(L,"AID",y.T),zn(L,"CI",y.F?"0":"1"),!y.F&&y.ja&&zn(L,"TO",y.ja),zn(L,"TYPE","xmlhttp"),sn(y,L),y.m&&y.o&&ws(L,y.m,y.o),y.L&&(y.g.I=y.L);var B=y.g;y=y.ia,B.L=1,B.v=hr(ks(L)),B.m=null,B.P=!0,Vt(B,y)}n.Za=function(){this.C!=null&&(this.C=null,_e(this),An(this),Qe(19))};function Fi(y){y.C!=null&&(c.clearTimeout(y.C),y.C=null)}function pi(y,L){var B=null;if(y.g==L){Fi(y),Gn(y),y.g=null;var he=2}else if(Ar(y.h,L))B=L.D,Yn(y.h,L),he=1;else return;if(y.G!=0){if(L.o)if(he==1){B=L.m?L.m.length:0,L=Date.now()-L.F;var it=y.B;he=on(),Ye(he,new dt(he,B)),et(y)}else xn(y);else if(it=L.s,it==3||it==0&&0<L.X||!(he==1&&Mt(y,L)||he==2&&An(y)))switch(B&&0<B.length&&(L=y.h,L.i=L.i.concat(B)),it){case 1:Si(y,5);break;case 4:Si(y,10);break;case 3:Si(y,6);break;default:Si(y,2)}}}function Xi(y,L){let B=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(B*=2),B*L}function Si(y,L){if(y.j.info("Error code "+L),L==2){var B=_(y.fb,y),he=y.Xa;const it=!he;he=new $n(he||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Dr(he,"https"),hr(he),it?bs(he.toString(),B):bo(he.toString(),B)}else Qe(2);y.G=0,y.l&&y.l.sa(L),_s(y),Ie(y)}n.fb=function(y){y?(this.j.info("Successfully pinged google.com"),Qe(2)):(this.j.info("Failed to ping google.com"),Qe(1))};function _s(y){if(y.G=0,y.ka=[],y.l){const L=ai(y.h);(L.length!=0||y.i.length!=0)&&(A(y.ka,L),A(y.ka,y.i),y.h.i.length=0,C(y.i),y.i.length=0),y.l.ra()}}function mr(y,L,B){var he=B instanceof $n?ks(B):new $n(B);if(he.g!="")L&&(he.g=L+"."+he.g),Or(he,he.s);else{var it=c.location;he=it.protocol,L=L?L+"."+it.hostname:it.hostname,it=+it.port;var Et=new $n(null);he&&Dr(Et,he),L&&(Et.g=L),it&&Or(Et,it),B&&(Et.l=B),he=Et}return B=y.D,L=y.ya,B&&L&&zn(he,B,L),zn(he,"VER",y.la),sn(y,he),he}function Mr(y,L,B){if(L&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return L=y.Ca&&!y.pa?new li(new Vr({eb:B})):new li(y.pa),L.Ha(y.J),L}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function gc(){}n=gc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Gs(y,L){Ee.call(this),this.g=new N(L),this.l=y,this.h=L&&L.messageUrlParams||null,y=L&&L.messageHeaders||null,L&&L.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=L&&L.initMessageHeaders||null,L&&L.messageContentType&&(y?y["X-WebChannel-Content-Type"]=L.messageContentType:y={"X-WebChannel-Content-Type":L.messageContentType}),L&&L.va&&(y?y["X-WebChannel-Client-Profile"]=L.va:y={"X-WebChannel-Client-Profile":L.va}),this.g.S=y,(y=L&&L.Sb)&&!ee(y)&&(this.g.m=y),this.v=L&&L.supportsCrossDomainXhr||!1,this.u=L&&L.sendRawJson||!1,(L=L&&L.httpSessionIdParam)&&!ee(L)&&(this.g.D=L,y=this.h,y!==null&&L in y&&(y=this.h,L in y&&delete y[L])),this.j=new pr(this)}T(Gs,Ee),Gs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Gs.prototype.close=function(){Z(this.g)},Gs.prototype.o=function(y){var L=this.g;if(typeof y=="string"){var B={};B.__data__=y,y=B}else this.u&&(B={},B.__data__=Je(y),y=B);L.i.push(new ts(L.Ya++,y)),L.G==3&&et(L)},Gs.prototype.N=function(){this.g.l=null,delete this.j,Z(this.g),delete this.g,Gs.aa.N.call(this)};function Qr(y){Dt.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var L=y.__sm__;if(L){e:{for(const B in L){y=B;break e}y=void 0}(this.i=y)&&(y=this.i,L=L!==null&&y in L?L[y]:void 0),this.data=L}else this.data=y}T(Qr,Dt);function $o(){Ut.call(this),this.status=1}T($o,Ut);function pr(y){this.g=y}T(pr,gc),pr.prototype.ua=function(){Ye(this.g,"a")},pr.prototype.ta=function(y){Ye(this.g,new Qr(y))},pr.prototype.sa=function(y){Ye(this.g,new $o)},pr.prototype.ra=function(){Ye(this.g,"b")},Gs.prototype.send=Gs.prototype.o,Gs.prototype.open=Gs.prototype.m,Gs.prototype.close=Gs.prototype.close,Nt.NO_ERROR=0,Nt.TIMEOUT=8,Nt.HTTP_ERROR=6,xt.COMPLETE="complete",tn.EventType=Zt,Zt.OPEN="a",Zt.CLOSE="b",Zt.ERROR="c",Zt.MESSAGE="d",Ee.prototype.listen=Ee.prototype.K,li.prototype.listenOnce=li.prototype.L,li.prototype.getLastError=li.prototype.Ka,li.prototype.getLastErrorCode=li.prototype.Ba,li.prototype.getStatus=li.prototype.Z,li.prototype.getResponseJson=li.prototype.Oa,li.prototype.getResponseText=li.prototype.oa,li.prototype.send=li.prototype.ea,li.prototype.setWithCredentials=li.prototype.Ha}).apply(typeof dg<"u"?dg:typeof self<"u"?self:typeof window<"u"?window:{});const px="@firebase/firestore",gx="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}or.UNAUTHENTICATED=new or(null),or.GOOGLE_CREDENTIALS=new or("google-credentials-uid"),or.FIRST_PARTY=new or("first-party-uid"),or.MOCK_USER=new or("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tp="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh=new Wm("@firebase/firestore");function Va(n,...e){if(Oh.logLevel<=xi.DEBUG){const t=e.map(bb);Oh.debug(`Firestore (${tp}): ${n}`,...t)}}function JE(n,...e){if(Oh.logLevel<=xi.ERROR){const t=e.map(bb);Oh.error(`Firestore (${tp}): ${n}`,...t)}}function VI(n,...e){if(Oh.logLevel<=xi.WARN){const t=e.map(bb);Oh.warn(`Firestore (${tp}): ${n}`,...t)}}function bb(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,eT(n,i,t)}function eT(n,e,t){let i=`FIRESTORE (${tp}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw JE(i),new Error(i)}function lm(n,e,t,i){let s="Unexpected state";typeof t=="string"?s=t:i=t,n||eT(e,s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi={CANCELLED:"cancelled",INVALID_ARGUMENT:"invalid-argument",FAILED_PRECONDITION:"failed-precondition"};class fi extends Na{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class YI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(or.UNAUTHENTICATED)))}shutdown(){}}class GI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class KI{constructor(e){this.t=e,this.currentUser=or.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){lm(this.o===void 0,42304);let i=this.i;const s=d=>this.i!==i?(i=this.i,t(d)):Promise.resolve();let o=new cm;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new cm,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const d=o;e.enqueueRetryable((async()=>{await d.promise,await s(this.currentUser)}))},c=d=>{Va("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((d=>c(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(Va("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new cm)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Va("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(lm(typeof i.accessToken=="string",31837,{l:i}),new tT(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return lm(e===null||typeof e=="string",2055,{h:e}),new or(e)}}class XI{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=or.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class QI{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new XI(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(or.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class yx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ZI{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,rr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){lm(this.o===void 0,3512);const i=o=>{o.error!=null&&Va("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,Va("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>i(o)))};const s=o=>{Va("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):Va("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new yx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(lm(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new yx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=JI(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<t&&(i+=e.charAt(s[o]%62))}return i}}function mu(n,e){return n<e?-1:n>e?1:0}function t8(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const s=n.charAt(i),o=e.charAt(i);if(s!==o)return Py(s)===Py(o)?mu(s,o):Py(s)?1:-1}return mu(n.length,e.length)}const n8=55296,i8=57343;function Py(n){const e=n.charCodeAt(0);return e>=n8&&e<=i8}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vx="__name__";class wl{constructor(e,t,i){t===void 0?t=0:t>e.length&&Am(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Am(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return wl.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof wl?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const o=wl.compareSegments(e.get(s),t.get(s));if(o!==0)return o}return mu(e.length,t.length)}static compareSegments(e,t){const i=wl.isNumericId(e),s=wl.isNumericId(t);return i&&!s?-1:!i&&s?1:i&&s?wl.extractNumericId(e).compare(wl.extractNumericId(t)):t8(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return vb.fromString(e.substring(4,e.length-2))}}class Ba extends wl{construct(e,t,i){return new Ba(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new fi(hi.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((s=>s.length>0)))}return new Ba(t)}static emptyPath(){return new Ba([])}}const s8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zu extends wl{construct(e,t,i){return new Zu(e,t,i)}static isValidIdentifier(e){return s8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zu.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===vx}static keyField(){return new Zu([vx])}static fromServerFormat(e){const t=[];let i="",s=0;const o=()=>{if(i.length===0)throw new fi(hi.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let l=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new fi(hi.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new fi(hi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,s+=2}else c==="`"?(l=!l,s++):c!=="."||l?(i+=c,s++):(o(),s++)}if(o(),l)throw new fi(hi.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Zu(t)}static emptyPath(){return new Zu([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e){this.path=e}static fromPath(e){return new id(Ba.fromString(e))}static fromName(e){return new id(Ba.fromString(e).popFirst(5))}static empty(){return new id(Ba.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ba.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ba.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new id(new Ba(e.slice()))}}function o8(n,e,t,i){if(e===!0&&i===!0)throw new fi(hi.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function r8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function a8(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Am(12329,{type:typeof n})}function l8(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new fi(hi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=a8(n);throw new fi(hi.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hs(n,e){const t={typeString:n};return e&&(t.value=e),t}function np(n,e){if(!r8(n))throw new fi(hi.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const s=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const l=n[i];if(s&&typeof l!==s){t=`JSON field '${i}' must be a ${s}.`;break}if(o!==void 0&&l!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new fi(hi.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=-62135596800,wx=1e6;class _l{static now(){return _l.fromMillis(Date.now())}static fromDate(e){return _l.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*wx);return new _l(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fi(hi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fi(hi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<bx)throw new fi(hi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fi(hi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wx}_compareTo(e){return this.seconds===e.seconds?mu(this.nanoseconds,e.nanoseconds):mu(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_l._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(np(e,_l._jsonSchema))return new _l(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-bx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_l._jsonSchemaVersion="firestore/timestamp/1.0",_l._jsonSchema={type:Hs("string",_l._jsonSchemaVersion),seconds:Hs("number"),nanoseconds:Hs("number")};function c8(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new u8("Invalid base64 string: "+o):o}})(e);return new vd(t)}static fromUint8Array(e){const t=(function(s){let o="";for(let l=0;l<s.length;++l)o+=String.fromCharCode(s[l]);return o})(e);return new vd(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mu(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vd.EMPTY_BYTE_STRING=new vd("");const Y2="(default)";class S0{constructor(e,t){this.projectId=e,this.database=t||Y2}static empty(){return new S0("","")}get isDefaultDatabase(){return this.database===Y2}isEqual(e){return e instanceof S0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d8{constructor(e,t=null,i=[],s=[],o=null,l="F",c=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=l,this.startAt=c,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function h8(n){return new d8(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _x,di;(di=_x||(_x={}))[di.OK=0]="OK",di[di.CANCELLED=1]="CANCELLED",di[di.UNKNOWN=2]="UNKNOWN",di[di.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",di[di.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",di[di.NOT_FOUND=5]="NOT_FOUND",di[di.ALREADY_EXISTS=6]="ALREADY_EXISTS",di[di.PERMISSION_DENIED=7]="PERMISSION_DENIED",di[di.UNAUTHENTICATED=16]="UNAUTHENTICATED",di[di.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",di[di.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",di[di.ABORTED=10]="ABORTED",di[di.OUT_OF_RANGE=11]="OUT_OF_RANGE",di[di.UNIMPLEMENTED=12]="UNIMPLEMENTED",di[di.INTERNAL=13]="INTERNAL",di[di.UNAVAILABLE=14]="UNAVAILABLE",di[di.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new vb([4294967295,4294967295],0);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f8=41943040;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m8=1048576;function Uy(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(e,t,i=1e3,s=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-i);s>0&&Va("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(e,t,i,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new cm,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,o){const l=Date.now()+i,c=new wb(e,t,l,s,o);return c.start(i),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fi(hi.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}var xx,Sx;(Sx=xx||(xx={})).Ma="default",Sx.Cache="cache";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g8(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT="firestore.googleapis.com",Ex=!0;class Tx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new fi(hi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nT,this.ssl=Ex}else this.host=e.host,this.ssl=e.ssl??Ex;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=f8;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<m8)throw new fi(hi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}o8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=g8(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new fi(hi.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new fi(hi.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new fi(hi.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class iT{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fi(hi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fi(hi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new YI;switch(i.type){case"firstParty":return new QI(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new fi(hi.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Nx.get(t);i&&(Va("ComponentProvider","Removing Datastore"),Nx.delete(t),i.terminate())})(this),Promise.resolve()}}function y8(n,e,t,i={}){n=l8(n,iT);const s=yu(e),o=n._getSettings(),l={...o,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(U0(`https://${c}`),F0("Firestore",!0)),o.host!==nT&&o.host!==c&&VI("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...o,host:c,ssl:s,emulatorOptions:i};if(!cc(d,l)&&(n._setSettings(d),i.mockUserToken)){let f,p;if(typeof i.mockUserToken=="string")f=i.mockUserToken,p=or.MOCK_USER;else{f=bv(i.mockUserToken,n._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new fi(hi.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new or(v)}n._authCredentials=new GI(new tT(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new _b(this.firestore,e,this._query)}}class Sl{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xb(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Sl(this.firestore,e,this._key)}toJSON(){return{type:Sl._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(np(t,Sl._jsonSchema))return new Sl(e,i||null,new id(Ba.fromString(t.referencePath)))}}Sl._jsonSchemaVersion="firestore/documentReference/1.0",Sl._jsonSchema={type:Hs("string",Sl._jsonSchemaVersion),referencePath:Hs("string")};class xb extends _b{constructor(e,t,i){super(e,t,h8(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Sl(this.firestore,null,new id(e))}withConverter(e){return new xb(this.firestore,e,this._path)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx="AsyncQueue";class kx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new p8(this,"async_queue_retry"),this._c=()=>{const i=Uy();i&&Va(Cx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Uy();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Uy();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new cm;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!c8(e))throw e;Va(Cx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,JE("INTERNAL UNHANDLED ERROR: ",Lx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=wb.createAndSchedule(this,e,t,i,(o=>this.hc(o)));return this.tc.push(s),s}uc(){this.nc&&Am(47125,{Pc:Lx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Lx(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class v8 extends iT{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new kx,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new kx(e),this._firestoreClient=void 0,await e}}}function b8(n,e){const t=typeof n=="object"?n:zm(),i=typeof n=="string"?n:Y2,s=fc(t,"firestore").getImmediate({identifier:i});if(!s._initialized){const o=vv("firestore");o&&y8(s,...o)}return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ic(vd.fromBase64String(e))}catch(t){throw new fi(hi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ic(vd.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ic._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(np(e,ic._jsonSchema))return ic.fromBase64String(e.bytes)}}ic._jsonSchemaVersion="firestore/bytes/1.0",ic._jsonSchema={type:Hs("string",ic._jsonSchemaVersion),bytes:Hs("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new fi(hi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zu(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fi(hi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fi(hi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mu(this._lat,e._lat)||mu(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ad._jsonSchemaVersion}}static fromJSON(e){if(np(e,ad._jsonSchema))return new ad(e.latitude,e.longitude)}}ad._jsonSchemaVersion="firestore/geoPoint/1.0",ad._jsonSchema={type:Hs("string",ad._jsonSchemaVersion),latitude:Hs("number"),longitude:Hs("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ld._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(np(e,ld._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ld(e.vectorValues);throw new fi(hi.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ld._jsonSchemaVersion="firestore/vectorValue/1.0",ld._jsonSchema={type:Hs("string",ld._jsonSchemaVersion),vectorValues:Hs("object")};const w8=new RegExp("[~\\*/\\[\\]]");function _8(n,e,t){if(e.search(w8)>=0)throw Ax(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new sT(...e.split("."))._internalPath}catch{throw Ax(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function Ax(n,e,t,i,s){let o=`Function ${e}() called with invalid data`;o+=". ";let l="";return new fi(hi.INVALID_ARGUMENT,o+n+l)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(e,t,i,s,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Sl(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new x8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class x8 extends oT{data(){return super.data()}}function rT(n,e){return typeof e=="string"?_8(n,e):e instanceof sT?e._internalPath:e._delegate._internalPath}class hg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vh extends oT{constructor(e,t,i,s,o,l){super(e,t,i,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Wg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(rT("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new fi(hi.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=vh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}vh._jsonSchemaVersion="firestore/documentSnapshot/1.0",vh._jsonSchema={type:Hs("string",vh._jsonSchemaVersion),bundleSource:Hs("string","DocumentSnapshot"),bundleName:Hs("string"),bundle:Hs("string")};class Wg extends vh{data(e={}){return super.data(e)}}class um{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new hg(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Wg(this._firestore,this._userDataWriter,i.key,i,new hg(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fi(hi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((c=>{const d=new Wg(s._firestore,s._userDataWriter,c.doc.key,c.doc,new hg(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>o||c.type!==3)).map((c=>{const d=new Wg(s._firestore,s._userDataWriter,c.doc.key,c.doc,new hg(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let f=-1,p=-1;return c.type!==0&&(f=l.indexOf(c.doc.key),l=l.delete(c.doc.key)),c.type!==1&&(l=l.add(c.doc),p=l.indexOf(c.doc.key)),{type:S8(c.type),doc:d,oldIndex:f,newIndex:p}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new fi(hi.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=um._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=e8.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],s=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function S8(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Am(61501,{type:n})}}um._jsonSchemaVersion="firestore/querySnapshot/1.0",um._jsonSchema={type:Hs("string",um._jsonSchemaVersion),bundleSource:Hs("string","QuerySnapshot"),bundleName:Hs("string"),bundle:Hs("string")};(function(e,t=!0){(function(s){tp=s})(vu),va(new qr("firestore",((i,{instanceIdentifier:s,options:o})=>{const l=i.getProvider("app").getImmediate(),c=new v8(new KI(i.getProvider("auth-internal")),new ZI(l,i.getProvider("app-check-internal")),(function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new fi(hi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new S0(f.options.projectId,p)})(l,s),l);return o={useFetchStreams:t,...o},c._setSettings(o),c}),"PUBLIC").setMultipleInstances(!0)),Xo(px,gx,e),Xo(px,gx,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT="firebasestorage.googleapis.com",N8="storageBucket",E8=120*1e3,T8=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al extends Na{constructor(e,t,i=0){super(Fy(e),`Firebase Storage: ${t} (${Fy(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Al.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Fy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var kl;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(kl||(kl={}));function Fy(n){return"storage/"+n}function C8(){const n="An unknown error occurred, please check the error payload for server response.";return new Al(kl.UNKNOWN,n)}function k8(){return new Al(kl.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function L8(){return new Al(kl.CANCELED,"User canceled the upload/download.")}function A8(n){return new Al(kl.INVALID_URL,"Invalid URL '"+n+"'.")}function D8(n){return new Al(kl.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Dx(n){return new Al(kl.INVALID_ARGUMENT,n)}function lT(){return new Al(kl.APP_DELETED,"The Firebase app was deleted.")}function O8(n){return new Al(kl.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Ya.makeFromUrl(e,t)}catch{return new Ya(e,"")}if(i.path==="")return i;throw D8(e)}static makeFromUrl(e,t){let i=null;const s="([A-Za-z0-9.\\-_]+)";function o(K){K.path.charAt(K.path.length-1)==="/"&&(K.path_=K.path_.slice(0,-1))}const l="(/(.*))?$",c=new RegExp("^gs://"+s+l,"i"),d={bucket:1,path:3};function f(K){K.path_=decodeURIComponent(K.path)}const p="v[A-Za-z0-9_]+",v=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",b=new RegExp(`^https?://${v}/${p}/b/${s}/o${_}`,"i"),T={bucket:1,path:3},C=t===aT?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",I=new RegExp(`^https?://${C}/${s}/${A}`,"i"),G=[{regex:c,indices:d,postModify:o},{regex:b,indices:T,postModify:f},{regex:I,indices:{bucket:1,path:2},postModify:f}];for(let K=0;K<G.length;K++){const de=G[K],le=de.regex.exec(e);if(le){const z=le[de.indices.bucket];let R=le[de.indices.path];R||(R=""),i=new Ya(z,R),de.postModify(i);break}}if(i==null)throw A8(e);return i}}class j8{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M8(n,e,t){let i=1,s=null,o=null,l=!1,c=0;function d(){return c===2}let f=!1;function p(...A){f||(f=!0,e.apply(null,A))}function v(A){s=setTimeout(()=>{s=null,n(b,d())},A)}function _(){o&&clearTimeout(o)}function b(A,...I){if(f){_();return}if(A){_(),p.call(null,A,...I);return}if(d()||l){_(),p.call(null,A,...I);return}i<64&&(i*=2);let G;c===1?(c=2,G=0):G=(i+Math.random())*1e3,v(G)}let T=!1;function C(A){T||(T=!0,_(),!f&&(s!==null?(A||(c=2),clearTimeout(s),v(0)):A||(c=1)))}return v(0),o=setTimeout(()=>{l=!0,C(!0)},t),C}function R8(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I8(n){return n!==void 0}function Ox(n,e,t,i){if(i<e)throw Dx(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Dx(`Invalid value for '${n}'. Expected ${t} or less.`)}function P8(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const s=e(i)+"="+e(n[i]);t=t+s+"&"}return t=t.slice(0,-1),t}var N0;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(N0||(N0={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U8(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||s||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F8{constructor(e,t,i,s,o,l,c,d,f,p,v,_=!0,b=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=s,this.successCodes_=o,this.additionalRetryCodes_=l,this.callback_=c,this.errorCallback_=d,this.timeout_=f,this.progressCallback_=p,this.connectionFactory_=v,this.retry=_,this.isUsingEmulator=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,C)=>{this.resolve_=T,this.reject_=C,this.start_()})}start_(){const e=(i,s)=>{if(s){i(!1,new fg(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const l=c=>{const d=c.loaded,f=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,f)};this.progressCallback_!==null&&o.addUploadProgressListener(l),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(l),this.pendingConnection_=null;const c=o.getErrorCode()===N0.NO_ERROR,d=o.getStatus();if(!c||U8(d,this.additionalRetryCodes_)&&this.retry){const p=o.getErrorCode()===N0.ABORT;i(!1,new fg(!1,null,p));return}const f=this.successCodes_.indexOf(d)!==-1;i(!0,new fg(f,o))})},t=(i,s)=>{const o=this.resolve_,l=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const d=this.callback_(c,c.getResponse());I8(d)?o(d):o()}catch(d){l(d)}else if(c!==null){const d=C8();d.serverResponse=c.getErrorText(),this.errorCallback_?l(this.errorCallback_(c,d)):l(d)}else if(s.canceled){const d=this.appDelete_?lT():L8();l(d)}else{const d=k8();l(d)}};this.canceled_?t(!1,new fg(!1,null,!0)):this.backoffId_=M8(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&R8(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class fg{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function $8(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function B8(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function W8(n,e){e&&(n["X-Firebase-GMPID"]=e)}function z8(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function H8(n,e,t,i,s,o,l=!0,c=!1){const d=P8(n.urlParams),f=n.url+d,p=Object.assign({},n.headers);return W8(p,e),$8(p,t),B8(p,o),z8(p,i),new F8(f,n.method,p,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,l,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q8(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function V8(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e,t){this._service=e,t instanceof Ya?this._location=t:this._location=Ya.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new E0(e,t)}get root(){const e=new Ya(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return V8(this._location.path)}get storage(){return this._service}get parent(){const e=q8(this._location.path);if(e===null)return null;const t=new Ya(this._location.bucket,e);return new E0(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw O8(e)}}function jx(n,e){const t=e?.[N8];return t==null?null:Ya.makeFromBucketSpec(t,n)}function Y8(n,e,t,i={}){n.host=`${e}:${t}`;const s=yu(e);s&&(U0(`https://${n.host}/b`),F0("Storage",!0)),n._isUsingEmulator=!0,n._protocol=s?"https":"http";const{mockUserToken:o}=i;o&&(n._overrideAuthToken=typeof o=="string"?o:bv(o,n.app.options.projectId))}class G8{constructor(e,t,i,s,o,l=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=s,this._firebaseVersion=o,this._isUsingEmulator=l,this._bucket=null,this._host=aT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=E8,this._maxUploadRetryTime=T8,this._requests=new Set,s!=null?this._bucket=Ya.makeFromBucketSpec(s,this._host):this._bucket=jx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ya.makeFromBucketSpec(this._url,e):this._bucket=jx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ox("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ox("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(rr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new E0(this,e)}_makeRequest(e,t,i,s,o=!0){if(this._deleted)return new j8(lT());{const l=H8(e,this._appId,i,s,t,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,t){const[i,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,s).getPromise()}}const Mx="@firebase/storage",Rx="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT="storage";function K8(n=zm(),e){n=qs(n);const i=fc(n,cT).getImmediate({identifier:e}),s=vv("storage");return s&&X8(i,...s),i}function X8(n,e,t,i={}){Y8(n,e,t,i)}function Q8(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new G8(t,i,s,e,vu)}function Z8(){va(new qr(cT,Q8,"PUBLIC").setMultipleInstances(!0)),Xo(Mx,Rx,""),Xo(Mx,Rx,"esm2020")}Z8();const J8={apiKey:"AIzaSyD4ijfjR1yCJ535_kJQD8xiSLtvaOgVHHE",authDomain:"smarthomeanalytics-a9de2.firebaseapp.com",projectId:"smarthomeanalytics-a9de2",storageBucket:"smarthomeanalytics-a9de2.firebasestorage.app",messagingSenderId:"725719111805",appId:"1:725719111805:web:ff863e9ebc96757bfdb914",measurementId:"G-SKD92GKHTR"},ip=I4(J8);WI(ip);const Nr=hO(ip);b8(ip);const je=xR(ip);K8(ip);const sd=async(n,e,t,i,s="System",o="system",l="system")=>{try{const c=Me(je,"user_logs"),d=w0(c),f={timestamp:new Date().toISOString(),outletName:e,action:n,details:t,type:i,user:s,userId:o,authProvider:l};return await qa(d,f),console.log("✅ User action logged to user_logs table:",f),!0}catch(c){return console.error("❌ Error logging user action to user_logs:",c),!1}},G2=async(n,e,t,i,s,o)=>{try{let l="",c="info";switch(n){case"login":l="User Login",c="success";break;case"logout":l="User Logout",c="info";break;case"timeout":l="Session Timeout",c="warning";break;case"google_login":l="Google Login",c="success";break;case"google_logout":l="Google Logout",c="info";break}const d=Me(je,"logs"),f=w0(d),p={timestamp:new Date().toISOString(),outletName:"System",action:l,details:n==="google_login"?`User ${e} logged in via Google from ${i||"unknown location"}${s?` - ${s}`:""}`:n==="google_logout"?`User ${e} logged out from Google account${s?` - ${s}`:""}`:n==="login"?`User ${e} logged in successfully from ${i||"unknown location"}${s?` - ${s}`:""}`:n==="logout"?`User ${e} logged out successfully${s?` - ${s}`:""}`:`User ${e} session expired due to inactivity${s?` - ${s}`:""}`,type:c,user:e,userId:t,authProvider:o||"email"};await qa(f,p);const v=Me(je,"auth_logs"),_=w0(v),b={timestamp:new Date().toISOString(),action:n,userName:e,userId:t,ipAddress:i||"unknown",authProvider:o||"email",additionalDetails:s||""};return await qa(_,b),await sd(l,"System",p.details,c,e,t,o||"email"),console.log("✅ Authentication event logged to database:",b),!0}catch(l){return console.error("❌ Error logging authentication event:",l),!1}},Ix=(n,e)=>{try{const t=new Date,i=t.getFullYear(),s=t.getMonth()+1,o=new Date(i,s,0).getDate();console.log("📊 Monthly energy calculation:",{currentYear:i,currentMonth:s,daysInMonth:o,selectedOutlets:[...new Set(e)],totalOutlets:e.length,uniqueOutlets:[...new Set(e)].length});const l=new Set;let c=0;return e.forEach((d,f)=>{if(l.has(d)){console.log(`⚠️ DUPLICATE SKIPPED: ${d} (already processed)`);return}l.add(d);const p=d.replace(" ","_"),v=n[p];if(console.log(`🔍 Processing outlet ${f+1}/${e.length}: ${d} -> ${p}`),v&&v.daily_logs){let _=0;for(let b=1;b<=o;b++){const T=`day_${i}_${String(s).padStart(2,"0")}_${String(b).padStart(2,"0")}`,C=v.daily_logs[T];C&&C.total_energy&&(_+=C.total_energy)}console.log(`📊 ${d}: ${_.toFixed(3)}kW for month ${s}/${i}`),c+=_}else console.log(`⚠️ ${d}: No data found or no daily_logs`)}),console.log(`📊 TOTAL MONTHLY ENERGY: ${c.toFixed(3)}kW (${(c*1e3).toFixed(3)}W)`),c*1e3}catch(t){return console.error("❌ Error calculating combined monthly energy:",t),0}};function e7({onSuccess:n,onNavigateToSignUp:e}){const[t,i]=me.useState(""),[s,o]=me.useState(""),[l,c]=me.useState(!1),[d,f]=me.useState(!1),[p,v]=me.useState(!1),[_,b]=me.useState("success"),[T,C]=me.useState(""),[A,I]=me.useState(""),[ee,G]=me.useState({enabled:!1,selectedOutlets:[],combinedLimit:0}),K=me.useRef(null),de=(E,O,M)=>{b(E),C(O),I(M),v(!0)},le=()=>{v(!1),K.current&&(window.clearTimeout(K.current),K.current=null)},z=(E,O)=>{if(n){const M=E||t?.trim()||"User",Y=O||"Coordinator";K.current=window.setTimeout(()=>{n(M,Y)},3e3)}},R=(E,O,M,Y)=>{if(!E||!E.timeRange&&!E.startTime)return O==="on";const ie=new Date,q=ie.getHours()*60+ie.getMinutes(),re=ie.getDay();let V,se;if(E.startTime&&E.endTime){const[U,$]=E.startTime.split(":").map(Number),[X,Q]=E.endTime.split(":").map(Number);V=U*60+$,se=X*60+Q}else if(E.timeRange){const U=E.timeRange,[$,X]=U.split(" - "),Q=ye=>{const[Ae,De]=ye.split(" ");let[Be,Fe]=Ae.split(":").map(Number);return Be===12&&(Be=0),De==="PM"&&(Be+=12),Be*60+Fe};V=Q($),se=Q(X)}else return O==="on";const W=q>=V&&q<se,te=E.frequency||"";let j=!1;if(te.toLowerCase()==="daily")j=!0;else if(te.toLowerCase()==="weekdays")j=re>=1&&re<=5;else if(te.toLowerCase()==="weekends")j=re===0||re===6;else if(te.includes(",")){const U={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6};j=te.split(",").map(X=>{const Q=X.trim().toLowerCase();return U[Q]}).filter(X=>X!==void 0).includes(re)}else if(te){const $={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6}[te.toLowerCase()];$!==void 0&&(j=$===re)}if(M&&!Y){const U=M.relay_control?.auto_cutoff?.power_limit||0,$=new Date,X=`day_${$.getFullYear()}_${String($.getMonth()+1).padStart(2,"0")}_${String($.getDate()).padStart(2,"0")}`,ye=M?.daily_logs?.[X]?.total_energy||0;if(U>0&&ye>=U)return console.log("LogIn: Schedule check - Device power limit exceeded:",{todayTotalEnergy:`${(ye*1e3).toFixed(3)}W`,powerLimit:`${U*1e3}W`,todayDateKey:X,scheduleResult:!1,reason:"Today's energy consumption exceeded power limit"}),!1}return W&&j};me.useEffect(()=>{(async()=>{try{const O=Me(je,"combined_limit_settings"),M=await Pt(O);if(M.exists()){const Y=M.val();G({enabled:Y.enabled||!1,selectedOutlets:Y.selected_outlets||[],combinedLimit:Y.combined_limit_watts||0})}else G({enabled:!1,selectedOutlets:[],combinedLimit:0})}catch(O){console.error("LogIn: Error fetching combined limit info:",O)}})()},[]),me.useEffect(()=>{const E=async()=>{try{const re=Me(je,"devices"),V=await Pt(re);if(V.exists()){const se=V.val(),W=new Date,te=W.getHours()*60+W.getMinutes(),j=W.getDay();console.log(`LogIn: Real-time scheduler check at ${W.toLocaleTimeString()}:`,{currentTime:`${Math.floor(te/60)}:${String(te%60).padStart(2,"0")}`,currentDay:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][j]});for(const[U,$]of Object.entries(se)){const X=$;if(console.log(`LogIn: Checking device ${U}:`,{hasSchedule:!!(X.schedule&&(X.schedule.timeRange||X.schedule.startTime)),enablePowerScheduling:X.office_info?.enable_power_scheduling,schedule:X.schedule}),X.schedule&&(X.schedule.timeRange||X.schedule.startTime)){const Q=X.control?.device||"off";if((X.relay_control?.main_status||"ON")==="ON"){console.log(`LogIn: Device ${U} has main_status = 'ON' - respecting bypass mode, skipping schedule check`);continue}const Ae=U.replace("_"," "),De=ee?.enabled&&ee?.selectedOutlets?.includes(Ae),Be=R(X.schedule,"on",X,De);let Fe=Be?"on":"off";if(!De&&Fe==="on"){const Ct=X.relay_control?.auto_cutoff?.power_limit||0;if(Ct>0){const at=new Date,Ce=`day_${at.getFullYear()}_${String(at.getMonth()+1).padStart(2,"0")}_${String(at.getDate()).padStart(2,"0")}`,_t=X?.daily_logs?.[Ce]?.total_energy||0;_t>=Ct&&(Fe="off",console.log(`🔒 LogIn: AUTOMATIC UPDATE - Forcing ${U} OFF due to individual daily limit exceeded (${(_t*1e3).toFixed(3)}W >= ${Ct*1e3}W)`))}}console.log(`LogIn: Schedule check for ${U}:`,{currentControlState:Q,shouldBeActive:Be,newControlState:Fe,needsUpdate:Q!==Fe,isInCombinedGroup:De}),Q!==Fe?(console.log(`LogIn: Real-time update: ${U} control state from ${Q} to ${Fe}`),await Kt(Me(je,`devices/${U}/control`),{device:Fe})):console.log(`LogIn: No update needed for ${U} - control state already ${Q}`)}}}}catch(re){console.error("LogIn: Error in real-time scheduler:",re)}},O=async()=>{try{const re=Me(je,"devices"),V=await Pt(re);if(V.exists()){const se=V.val();console.log(`LogIn: Power limit monitor running at ${new Date().toLocaleTimeString()}`);for(const[W,te]of Object.entries(se)){const j=te,U=j.control?.device||"off",$=j.relay_control?.main_status||"ON";if(U==="off")continue;if($==="ON"){console.log(`LogIn: Device ${W} main_status is ON - respecting bypass mode, skipping automatic power limit enforcement`);continue}const X=W.replace("_"," "),Q=ee?.enabled&&ee?.selectedOutlets?.includes(X);if(Q){if(console.log(`LogIn: Device ${W} is in combined group - checking combined group power limits`),ee?.enabled&&ee?.selectedOutlets?.length>0){const ye=Ix(se,ee.selectedOutlets),Ae=ee.combinedLimit/1e3;console.log(`LogIn: Combined group limit check for ${W}:`,{totalMonthlyEnergy:`${(ye*1e3).toFixed(0)}W`,combinedLimit:`${ee.combinedLimit}W`,exceedsLimit:ye>=Ae}),ye>=Ae&&(console.log(`LogIn: Combined monthly limit exceeded - turning off ${W}`),await Kt(Me(je,`devices/${W}/control`),{device:"off"}),await Kt(Me(je,`devices/${W}/relay_control`),{main_status:"OFF"}),console.log(`LogIn: Device ${W} turned OFF due to combined monthly limit exceeded`))}}else{console.log(`LogIn: Device ${W} main status is ${$} - checking individual power limits`);const ye=j.relay_control?.auto_cutoff?.power_limit||0;if(ye>0){const Ae=new Date,De=`day_${Ae.getFullYear()}_${String(Ae.getMonth()+1).padStart(2,"0")}_${String(Ae.getDate()).padStart(2,"0")}`,Fe=j?.daily_logs?.[De]?.total_energy||0;console.log(`LogIn: Power limit check for ${W}:`,{powerLimit:`${ye*1e3}W`,todayTotalEnergy:`${Fe*1e3}W`,todayDateKey:De,exceedsLimit:Fe>=ye,currentControlState:U,isInCombinedGroup:Q}),Fe>=ye&&(console.log(`LogIn: POWER LIMIT EXCEEDED - Turning OFF ${W} (${(Fe*1e3).toFixed(3)}W >= ${ye*1e3}W)`),await Kt(Me(je,`devices/${W}/control`),{device:"off"}),await Kt(Me(je,`devices/${W}/relay_control`),{main_status:"OFF"}),console.log(`LogIn: Device ${W} turned OFF due to power limit exceeded`))}}}}}catch(re){console.error("LogIn: Error in power limit monitor:",re)}},M=async()=>{try{if(!ee?.enabled||ee?.selectedOutlets?.length===0)return;const re=Me(je,"devices"),V=await Pt(re);if(V.exists()){const se=V.val(),W=Ix(se,ee.selectedOutlets),te=ee.combinedLimit,j=te/1e3;if(console.log(`LogIn: Monthly limit check - Total: ${(W*1e3).toFixed(0)}W / Limit: ${te}W`),W>=j){console.log("LogIn: Monthly limit exceeded! Turning off all devices in combined group.");for(const U of ee.selectedOutlets){const $=U.replace(" ","_");try{const X=Me(je,`devices/${$}/control`);await Kt(X,{device:"off"});const Q=Me(je,`devices/${$}/relay_control`);await Kt(Q,{main_status:"OFF"}),console.log(`✅ TURNED OFF: ${U} (${$}) due to monthly limit`)}catch(X){console.error(`❌ FAILED to turn off ${U}:`,X)}}}}}catch(re){console.error("LogIn: Error in monthly limit check:",re)}};E(),O(),M(),window.testLogInSchedule=E,window.testLogInPowerLimits=O,window.checkLogInCurrentTime=()=>{const re=new Date,V=re.getHours()*60+re.getMinutes(),se=re.getDay();console.log("LogIn current time debug:",{time:re.toLocaleTimeString(),minutes:V,day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][se],date:re.toLocaleDateString()})};const Y=setInterval(E,1e4),ie=setInterval(O,3e4),q=setInterval(M,6e4);return()=>{clearInterval(Y),clearInterval(ie),clearInterval(q)}},[]);const D=async E=>{if(E.preventDefault(),!t.trim()||!s){de("error","Validation Error","Please enter both email and password.");return}f(!0);try{const M=(await X6(Nr,t.trim(),s)).user;let Y=M.displayName||t.trim(),ie="Coordinator";try{const re=Me(je,`users/${M.uid}`),V=await Pt(re);if(V.exists()){const se=V.val();Y=se.displayName||se.firstName||se.email||Y,ie=se.role||"Coordinator",console.log("User role from database:",ie),await Pt(Me(je,`users/${M.uid}/lastLogin`))}else console.log("User not found in database, using default role")}catch(re){console.log("Could not fetch additional user data:",re)}await G2("login",Y,M.uid,"unknown",`User logged in with email: ${t.trim()}`,"email"),de("success","Sign-in Successful",`Welcome back, ${Y}! You have successfully signed in as ${ie==="admin"?"GSO":ie}.`),z(Y,ie)}catch(O){console.error("Sign-in error:",O);let M="Sign-in failed. Please try again.";O.code==="auth/user-not-found"?M="No account found with this email address. Please sign up instead.":O.code==="auth/wrong-password"?M="Incorrect password. Please try again.":O.code==="auth/invalid-email"?M="Please enter a valid email address.":O.code==="auth/user-disabled"?M="This account has been disabled. Please contact support.":O.code==="auth/too-many-requests"?M="Too many failed attempts. Please try again later.":O.code==="auth/network-request-failed"&&(M="Network error. Please check your connection and try again."),await sd("User Login","System",`Failed login attempt with email: ${t.trim()} - ${M}`,"error",t.trim(),"unknown","email"),de("error","Authentication Failed",M)}finally{f(!1)}},F=async()=>{f(!0);try{const E=new xl,M=(await y3(Nr,E)).user;let Y="Coordinator";try{const q=Me(je,`users/${M.uid}`),re=await Pt(q);re.exists()?(Y=re.val().role||"Coordinator",console.log("Google user role from database:",Y),await Pt(Me(je,`users/${M.uid}/lastLogin`))):console.log("New Google user - no database record yet, using default role")}catch(q){console.log("Could not fetch user data:",q)}await G2("google_login",M.displayName||"User",M.uid,"unknown",`User logged in with Google: ${M.email}`,"google");const ie=Y==="admin"?"GSO":Y;de("success","Signed in with Google",`Welcome back, ${M.displayName||"User"}! Your Google account has been authenticated as ${ie}.`),z(M.displayName||void 0,Y)}catch(E){console.error("Google sign-in error:",E),console.error("Error code:",E.code),console.error("Error message:",E.message);let O="Google sign-in failed. Please try again.";E.code==="auth/popup-closed-by-user"?O="Sign-in was cancelled. Please try again.":E.code==="auth/popup-blocked"?O="Pop-up was blocked. Please allow pop-ups and try again.":E.code==="auth/network-request-failed"?O="Network error. Please check your connection and try again.":E.code==="auth/unauthorized-domain"?O="This domain is not authorized for Google sign-in. Please contact support.":E.code==="auth/operation-not-allowed"&&(O="Google sign-in is not enabled. Please contact support."),await sd("Google Login","System",`Failed Google login attempt - ${O}`,"error","Unknown User","unknown","google"),de("error","Google Sign-in Failed",O)}finally{f(!1)}};return u.jsxs("div",{className:"login-page",children:[u.jsx("div",{className:"login-grid","aria-hidden":"true",children:u.jsx("div",{className:"dots-layer"})}),u.jsxs("main",{className:"login-card",role:"main",children:[u.jsxs("header",{className:"login-header",children:[u.jsxs("div",{className:"brand",children:[u.jsx("div",{className:"brand-logo","aria-hidden":"true",children:u.jsxs("svg",{viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",className:"brand-logo-svg",children:[u.jsx("defs",{children:u.jsxs("linearGradient",{id:"g1",x1:"0",y1:"0",x2:"1",y2:"1",children:[u.jsx("stop",{offset:"0%",stopColor:"#4f8cff"}),u.jsx("stop",{offset:"100%",stopColor:"#7b61ff"})]})}),u.jsx("circle",{cx:"24",cy:"24",r:"23",fill:"url(#g1)"}),u.jsx("path",{d:"M15 26l6-8 6 5 6-7",stroke:"#fff",strokeWidth:"3",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M14 32h20",stroke:"#fff",strokeWidth:"3",strokeLinecap:"round"})]})}),u.jsxs("div",{className:"brand-text",children:[u.jsx("span",{className:"brand-name",children:"SMART"}),u.jsx("span",{className:"brand-sub",children:"ANALYTICS"})]})]}),u.jsx("h1",{className:"welcome",children:"Welcome Back"}),u.jsx("p",{className:"subtitle",children:"Sign in to access your dashboard"})]}),u.jsxs("form",{className:"form",onSubmit:D,children:[u.jsxs("label",{className:"label",htmlFor:"email",children:[u.jsx("span",{className:"label-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M4 6h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M4 7l8 6 8-6",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("span",{children:"Email Address"})]}),u.jsxs("div",{className:"input-wrapper",children:[u.jsx("span",{className:"input-leading","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M4 6h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M4 7l8 6 8-6",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("input",{id:"email",name:"email",type:"text",autoComplete:"username",placeholder:"Enter your email",value:t,onChange:E=>i(E.target.value),required:!0})]}),u.jsxs("label",{className:"label",htmlFor:"password",children:[u.jsx("span",{className:"label-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"5",y:"11",width:"14",height:"9",rx:"2",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M8 11V8a4 4 0 118 0v3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}),u.jsx("span",{children:"Password"})]}),u.jsxs("div",{className:"input-wrapper",children:[u.jsx("span",{className:"input-leading","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"5",y:"11",width:"14",height:"9",rx:"2",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M8 11V8a4 4 0 118 0v3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}),u.jsx("input",{id:"password",name:"password",type:l?"text":"password",autoComplete:"current-password",placeholder:"Enter your password",value:s,onChange:E=>o(E.target.value),required:!0}),u.jsx("button",{type:"button",className:"input-trailing","aria-label":l?"Hide password":"Show password",onClick:()=>c(E=>!E),children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M2 12s4-7 10-7 10 7 10 7-4 7-10 7S2 12 2 12z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),l?u.jsx("path",{d:"M3 21L21 3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}):u.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"1.5"})]})})]}),u.jsx("div",{className:"form-aux",children:u.jsx("a",{className:"link",href:"#",children:"Forgot password?"})}),u.jsx("button",{type:"submit",className:"primary-btn",disabled:d,children:d?"Signing In...":"Sign In"}),u.jsx("div",{className:"divider",role:"separator","aria-label":"or continue with",children:u.jsx("span",{children:"or continue with"})}),u.jsxs("button",{type:"button",className:"oauth-btn",onClick:F,disabled:d,children:[u.jsx("span",{className:"google-icon","aria-hidden":"true",children:u.jsxs("svg",{viewBox:"0 0 48 48",width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{fill:"#FFC107",d:"M43.611 20.083H42V20H24v8h11.303C33.602 31.91 29.218 35 24 35c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.676 5.099 29.627 3 24 3 12.955 3 4 11.955 4 23s8.955 20 20 20 20-8.955 20-20c0-1.341-.138-2.651-.389-3.917z"}),u.jsx("path",{fill:"#FF3D00",d:"M6.306 14.691l6.571 4.814C14.297 16.108 18.789 13 24 13c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.676 5.099 29.627 3 24 3 16.318 3 9.656 7.337 6.306 14.691z"}),u.jsx("path",{fill:"#4CAF50",d:"M24 43c5.137 0 9.773-1.967 13.285-5.178l-6.657-5.177C29.153 34.091 26.687 35 24 35c-5.196 0-9.571-3.061-11.292-7.436l-6.54 5.037C9.474 39.556 16.229 43 24 43z"}),u.jsx("path",{fill:"#1976D2",d:"M43.611 20.083H42V20H24v8h11.303c-1.101 3.261-3.645 5.824-6.747 7.046l-6.129 5.177C36.293 41.466 44 36.5 44 23c0-1.341-.138-2.651-.389-3.917z"})]})}),u.jsx("span",{children:d?"Signing In...":"Continue with Google"})]})]}),u.jsxs("footer",{className:"login-footer",children:[u.jsx("span",{children:"Don't have an account?"}),u.jsx("button",{type:"button",className:"link",onClick:e,disabled:d,children:"Sign Up"})]})]}),p&&u.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",onClick:le,children:u.jsxs("div",{className:`modal-card ${_}`,onClick:E=>E.stopPropagation(),children:[_!=="success"&&u.jsx("button",{className:"modal-close",onClick:le,"aria-label":"Close",children:u.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),u.jsx("div",{className:"modal-icon","aria-hidden":"true",children:_==="success"?u.jsxs("svg",{width:"36",height:"36",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"11",fill:"url(#s)"}),u.jsx("path",{d:"M7 12.5l2.8 2.8L17 9",stroke:"#fff",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("defs",{children:u.jsxs("linearGradient",{id:"s",x1:"0",y1:"0",x2:"1",y2:"1",children:[u.jsx("stop",{offset:"0%",stopColor:"#22c55e"}),u.jsx("stop",{offset:"100%",stopColor:"#16a34a"})]})})]}):u.jsxs("svg",{width:"36",height:"36",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"11",fill:"url(#e)"}),u.jsx("path",{d:"M8 8l8 8M16 8l-8 8",stroke:"#fff",strokeWidth:"2.2",strokeLinecap:"round"}),u.jsx("defs",{children:u.jsxs("linearGradient",{id:"e",x1:"0",y1:"0",x2:"1",y2:"1",children:[u.jsx("stop",{offset:"0%",stopColor:"#ef4444"}),u.jsx("stop",{offset:"100%",stopColor:"#dc2626"})]})})]})}),u.jsx("h2",{className:"modal-title",children:T}),u.jsx("p",{className:"modal-message",children:A}),u.jsx("div",{className:"modal-actions"})]})})]})}const Px=(n,e)=>{try{const t=new Date,i=t.getFullYear(),s=t.getMonth()+1,o=new Date(i,s,0).getDate();console.log("📊 Monthly energy calculation:",{currentYear:i,currentMonth:s,daysInMonth:o,selectedOutlets:[...new Set(e)],totalOutlets:e.length,uniqueOutlets:[...new Set(e)].length});const l=new Set;let c=0;return e.forEach((d,f)=>{if(l.has(d)){console.log(`⚠️ DUPLICATE SKIPPED: ${d} (already processed)`);return}l.add(d);const p=d.replace(" ","_"),v=n[p];if(console.log(`🔍 Processing outlet ${f+1}/${e.length}: ${d} -> ${p}`),v&&v.daily_logs){let _=0;for(let b=1;b<=o;b++){const T=`day_${i}_${String(s).padStart(2,"0")}_${String(b).padStart(2,"0")}`,C=v.daily_logs[T];C&&C.total_energy&&(_+=C.total_energy)}console.log(`📊 ${d}: ${_.toFixed(3)}kW for month ${s}/${i}`),c+=_}else console.log(`⚠️ ${d}: No data found or no daily_logs`)}),console.log(`📊 TOTAL MONTHLY ENERGY: ${c.toFixed(3)}kW (${(c*1e3).toFixed(3)}W)`),c*1e3}catch(t){return console.error("❌ Error calculating combined monthly energy:",t),0}};function t7({onSuccess:n,onNavigateToLogin:e}){const[t,i]=me.useState(""),[s,o]=me.useState(""),[l,c]=me.useState(""),[d,f]=me.useState(""),[p,v]=me.useState(!1),[_,b]=me.useState(!1),[T,C]=me.useState("Coordinator"),[A,I]=me.useState(!1),[ee,G]=me.useState(!1),[K,de]=me.useState(!1),[le,z]=me.useState("success"),[R,D]=me.useState(""),[F,E]=me.useState(""),[O,M]=me.useState({enabled:!1,selectedOutlets:[],combinedLimit:0}),Y=me.useRef(null),ie=async()=>{try{const $=Me(je,"users"),X=await Pt($);if(X.exists()){const Q=X.val(),ye=Object.values(Q).some(Ae=>Ae.role==="admin");G(ye),console.log("Existing GSO check:",ye)}else G(!1)}catch($){console.error("Error checking for existing GSO:",$),G(!1)}},q=($,X,Q)=>{z($),D(X),E(Q),de(!0)},re=()=>{de(!1),Y.current&&(window.clearTimeout(Y.current),Y.current=null)},V=($,X,Q,ye)=>{if(!$||!$.timeRange&&!$.startTime)return X==="on";const Ae=new Date,De=Ae.getHours()*60+Ae.getMinutes(),Be=Ae.getDay();let Fe,Ct;if($.startTime&&$.endTime){const[_t,Ne]=$.startTime.split(":").map(Number),[Ve,We]=$.endTime.split(":").map(Number);Fe=_t*60+Ne,Ct=Ve*60+We}else if($.timeRange){const _t=$.timeRange,[Ne,Ve]=_t.split(" - "),We=tt=>{const[lt,$e]=tt.split(" ");let[pe,be]=lt.split(":").map(Number);return pe===12&&(pe=0),$e==="PM"&&(pe+=12),pe*60+be};Fe=We(Ne),Ct=We(Ve)}else return X==="on";const at=De>=Fe&&De<Ct,Ce=$.frequency||"";let ce=!1;if(Ce.toLowerCase()==="daily")ce=!0;else if(Ce.toLowerCase()==="weekdays")ce=Be>=1&&Be<=5;else if(Ce.toLowerCase()==="weekends")ce=Be===0||Be===6;else if(Ce.includes(",")){const _t={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6};ce=Ce.split(",").map(Ve=>{const We=Ve.trim().toLowerCase();return _t[We]}).filter(Ve=>Ve!==void 0).includes(Be)}else if(Ce){const Ne={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6}[Ce.toLowerCase()];Ne!==void 0&&(ce=Ne===Be)}if(Q&&!ye){const _t=Q.relay_control?.auto_cutoff?.power_limit||0,Ne=new Date,Ve=`day_${Ne.getFullYear()}_${String(Ne.getMonth()+1).padStart(2,"0")}_${String(Ne.getDate()).padStart(2,"0")}`,tt=Q?.daily_logs?.[Ve]?.total_energy||0;if(_t>0&&tt>=_t)return console.log("SignUp: Schedule check - Device power limit exceeded:",{todayTotalEnergy:`${(tt*1e3).toFixed(3)}W`,powerLimit:`${_t*1e3}W`,todayDateKey:Ve,scheduleResult:!1,reason:"Today's energy consumption exceeded power limit"}),!1}return at&&ce};me.useEffect(()=>{ie()},[]),me.useEffect(()=>{ee&&T==="admin"&&C("Coordinator")},[ee,T]),me.useEffect(()=>{(async()=>{try{const X=Me(je,"combined_limit_settings"),Q=await Pt(X);if(Q.exists()){const ye=Q.val();M({enabled:ye.enabled||!1,selectedOutlets:ye.selected_outlets||[],combinedLimit:ye.combined_limit_watts||0})}else M({enabled:!1,selectedOutlets:[],combinedLimit:0})}catch(X){console.error("SignUp: Error fetching combined limit info:",X)}})()},[]),me.useEffect(()=>{const $=async()=>{try{const Be=Me(je,"devices"),Fe=await Pt(Be);if(Fe.exists()){const Ct=Fe.val(),at=new Date,Ce=at.getHours()*60+at.getMinutes(),ce=at.getDay();console.log(`SignUp: Real-time scheduler check at ${at.toLocaleTimeString()}:`,{currentTime:`${Math.floor(Ce/60)}:${String(Ce%60).padStart(2,"0")}`,currentDay:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][ce]});for(const[_t,Ne]of Object.entries(Ct)){const Ve=Ne;if(console.log(`SignUp: Checking device ${_t}:`,{hasSchedule:!!(Ve.schedule&&(Ve.schedule.timeRange||Ve.schedule.startTime)),enablePowerScheduling:Ve.office_info?.enable_power_scheduling,schedule:Ve.schedule}),Ve.schedule&&(Ve.schedule.timeRange||Ve.schedule.startTime)){const We=Ve.control?.device||"off";if((Ve.relay_control?.main_status||"ON")==="ON"){console.log(`SignUp: Device ${_t} has main_status = 'ON' - respecting bypass mode, skipping schedule check`);continue}const lt=_t.replace("_"," "),$e=O?.enabled&&O?.selectedOutlets?.includes(lt),pe=V(Ve.schedule,"on",Ve,$e);let be=pe?"on":"off";if(!$e&&be==="on"){const Se=Ve.relay_control?.auto_cutoff?.power_limit||0;if(Se>0){const Ee=new Date,Ye=`day_${Ee.getFullYear()}_${String(Ee.getMonth()+1).padStart(2,"0")}_${String(Ee.getDate()).padStart(2,"0")}`,Ue=Ve?.daily_logs?.[Ye]?.total_energy||0;Ue>=Se&&(be="off",console.log(`🔒 SignUp: AUTOMATIC UPDATE - Forcing ${_t} OFF due to individual daily limit exceeded (${(Ue*1e3).toFixed(3)}W >= ${Se*1e3}W)`))}}console.log(`SignUp: Schedule check for ${_t}:`,{currentControlState:We,shouldBeActive:pe,newControlState:be,needsUpdate:We!==be,isInCombinedGroup:$e}),We!==be?(console.log(`SignUp: Real-time update: ${_t} control state from ${We} to ${be}`),await Kt(Me(je,`devices/${_t}/control`),{device:be})):console.log(`SignUp: No update needed for ${_t} - control state already ${We}`)}}}}catch(Be){console.error("SignUp: Error in real-time scheduler:",Be)}},X=async()=>{try{const Be=Me(je,"devices"),Fe=await Pt(Be);if(Fe.exists()){const Ct=Fe.val();console.log(`SignUp: Power limit monitor running at ${new Date().toLocaleTimeString()}`);for(const[at,Ce]of Object.entries(Ct)){const ce=Ce,_t=ce.control?.device||"off",Ne=ce.relay_control?.main_status||"ON";if(_t==="off")continue;if(Ne==="ON"){console.log(`SignUp: Device ${at} main_status is ON - respecting bypass mode, skipping automatic power limit enforcement`);continue}const Ve=at.replace("_"," "),We=O?.enabled&&O?.selectedOutlets?.includes(Ve);if(We){if(console.log(`SignUp: Device ${at} is in combined group - checking combined group power limits`),O?.enabled&&O?.selectedOutlets?.length>0){const tt=Px(Ct,O.selectedOutlets),lt=O.combinedLimit/1e3;console.log(`SignUp: Combined group limit check for ${at}:`,{totalMonthlyEnergy:`${(tt*1e3).toFixed(0)}W`,combinedLimit:`${O.combinedLimit}W`,exceedsLimit:tt>=lt}),tt>=lt&&(console.log(`SignUp: Combined monthly limit exceeded - turning off ${at}`),await Kt(Me(je,`devices/${at}/control`),{device:"off"}),await Kt(Me(je,`devices/${at}/relay_control`),{main_status:"OFF"}),console.log(`SignUp: Device ${at} turned OFF due to combined monthly limit exceeded`))}}else{console.log(`SignUp: Device ${at} main status is ${Ne} - checking individual power limits`);const tt=ce.relay_control?.auto_cutoff?.power_limit||0;if(tt>0){const lt=new Date,$e=`day_${lt.getFullYear()}_${String(lt.getMonth()+1).padStart(2,"0")}_${String(lt.getDate()).padStart(2,"0")}`,be=ce?.daily_logs?.[$e]?.total_energy||0;console.log(`SignUp: Power limit check for ${at}:`,{powerLimit:`${tt*1e3}W`,todayTotalEnergy:`${be*1e3}W`,todayDateKey:$e,exceedsLimit:be>=tt,currentControlState:_t,isInCombinedGroup:We}),be>=tt&&(console.log(`SignUp: POWER LIMIT EXCEEDED - Turning OFF ${at} (${(be*1e3).toFixed(3)}W >= ${tt*1e3}W)`),await Kt(Me(je,`devices/${at}/control`),{device:"off"}),await Kt(Me(je,`devices/${at}/relay_control`),{main_status:"OFF"}),console.log(`SignUp: Device ${at} turned OFF due to power limit exceeded`))}}}}}catch(Be){console.error("SignUp: Error in power limit monitor:",Be)}},Q=async()=>{try{if(!O?.enabled||O?.selectedOutlets?.length===0)return;const Be=Me(je,"devices"),Fe=await Pt(Be);if(Fe.exists()){const Ct=Fe.val(),at=Px(Ct,O.selectedOutlets),Ce=O.combinedLimit,ce=Ce/1e3;if(console.log(`SignUp: Monthly limit check - Total: ${(at*1e3).toFixed(0)}W / Limit: ${Ce}W`),at>=ce){console.log("SignUp: Monthly limit exceeded! Turning off all devices in combined group.");for(const _t of O.selectedOutlets){const Ne=_t.replace(" ","_");try{const Ve=Me(je,`devices/${Ne}/control`);await Kt(Ve,{device:"off"});const We=Me(je,`devices/${Ne}/relay_control`);await Kt(We,{main_status:"OFF"}),console.log(`✅ TURNED OFF: ${_t} (${Ne}) due to monthly limit`)}catch(Ve){console.error(`❌ FAILED to turn off ${_t}:`,Ve)}}}}}catch(Be){console.error("SignUp: Error in monthly limit check:",Be)}};$(),X(),Q(),window.testSignUpSchedule=$,window.testSignUpPowerLimits=X,window.checkSignUpCurrentTime=()=>{const Be=new Date,Fe=Be.getHours()*60+Be.getMinutes(),Ct=Be.getDay();console.log("SignUp current time debug:",{time:Be.toLocaleTimeString(),minutes:Fe,day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][Ct],date:Be.toLocaleDateString()})};const ye=setInterval($,1e4),Ae=setInterval(X,3e4),De=setInterval(Q,6e4);return()=>{clearInterval(ye),clearInterval(Ae),clearInterval(De)}},[]);const se=($,X)=>{if(n){const Q=$||`${t} ${s}`.trim()||"User",ye=X||T;Y.current=window.setTimeout(()=>{n(Q,ye)},3e3)}},W=()=>t.trim()?s.trim()?l.trim()?d?d.length<6?(q("error","Validation Error","Password must be at least 6 characters long."),!1):!0:(q("error","Validation Error","Password is required."),!1):(q("error","Validation Error","Email address is required."),!1):(q("error","Validation Error","Last name is required."),!1):(q("error","Validation Error","First name is required."),!1),te=async $=>{if($.preventDefault(),!!W()){if(T==="admin"&&ee){q("error","GSO Account Exists","A GSO account already exists. Only one GSO is allowed per system.");return}b(!0);try{const Q=(await K6(Nr,l,d)).user;await Z6(Q,{displayName:`${t} ${s}`.trim()});const ye={uid:Q.uid,email:Q.email,firstName:t.trim(),lastName:s.trim(),displayName:`${t} ${s}`.trim(),role:T,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()};console.log("Saving user data with role:",T,ye),await qa(Me(je,`users/${Q.uid}`),ye),await sd("User Signup","System",`New user account created with email: ${l} (Role: ${T})`,"success",`${t} ${s}`.trim(),Q.uid,"email"),q("success","Account Created Successfully",`Welcome ${t}! Your ${T} account has been created and you are now signed in.`),se()}catch(X){console.error("Signup error:",X);let Q="Failed to create account. Please try again.";X.code==="auth/email-already-in-use"?Q="An account with this email already exists. Please sign in instead.":X.code==="auth/invalid-email"?Q="Please enter a valid email address.":X.code==="auth/weak-password"?Q="Password is too weak. Please choose a stronger password.":X.code==="auth/network-request-failed"&&(Q="Network error. Please check your connection and try again."),await sd("User Signup","System",`Failed signup attempt with email: ${l} - ${Q}`,"error",`${t} ${s}`.trim(),"unknown","email"),q("error","Account Creation Failed",Q)}finally{b(!1)}}},j=async()=>{I(!0)},U=async $=>{if(I(!1),$==="admin"&&ee){q("error","GSO Account Exists","A GSO account already exists. Only one GSO is allowed per system.");return}b(!0);try{const X=new xl,ye=(await y3(Nr,X)).user,Ae={uid:ye.uid,email:ye.email,firstName:ye.displayName?.split(" ")[0]||"User",lastName:ye.displayName?.split(" ").slice(1).join(" ")||"",displayName:ye.displayName||"User",role:$,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),provider:"google"};console.log("Saving Google user data with role:",$,Ae),await qa(Me(je,`users/${ye.uid}`),Ae),await sd("Google Signup","System",`New user account created with Google: ${ye.email} (Role: ${$})`,"success",ye.displayName||"User",ye.uid,"google"),q("success","Signed up with Google",`Welcome ${ye.displayName||"User"}! Your ${$} account has been created with Google authentication.`),se(ye.displayName||void 0,$)}catch(X){console.error("Google signup error:",X);let Q="Google signup failed. Please try again.";X.code==="auth/popup-closed-by-user"?Q="Signup was cancelled. Please try again.":X.code==="auth/popup-blocked"?Q="Pop-up was blocked. Please allow pop-ups and try again.":X.code==="auth/network-request-failed"?Q="Network error. Please check your connection and try again.":X.code==="auth/unauthorized-domain"?Q="This domain is not authorized for Google signup. Please contact support.":X.code==="auth/operation-not-allowed"&&(Q="Google signup is not enabled. Please contact support."),await sd("Google Signup","System",`Failed Google signup attempt - ${Q}`,"error","Unknown User","unknown","google"),q("error","Google Signup Failed",Q)}finally{b(!1)}};return u.jsxs("div",{className:"signup-page",children:[u.jsx("div",{className:"signup-grid","aria-hidden":"true",children:u.jsx("div",{className:"dots-layer"})}),u.jsxs("main",{className:"signup-card",role:"main",children:[u.jsxs("header",{className:"signup-header",children:[u.jsxs("div",{className:"brand",children:[u.jsx("div",{className:"brand-logo","aria-hidden":"true",children:u.jsxs("svg",{viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",className:"brand-logo-svg",children:[u.jsx("defs",{children:u.jsxs("linearGradient",{id:"g1",x1:"0",y1:"0",x2:"1",y2:"1",children:[u.jsx("stop",{offset:"0%",stopColor:"#4f8cff"}),u.jsx("stop",{offset:"100%",stopColor:"#7b61ff"})]})}),u.jsx("circle",{cx:"24",cy:"24",r:"23",fill:"url(#g1)"}),u.jsx("path",{d:"M15 26l6-8 6 5 6-7",stroke:"#fff",strokeWidth:"3",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M14 32h20",stroke:"#fff",strokeWidth:"3",strokeLinecap:"round"})]})}),u.jsxs("div",{className:"brand-text",children:[u.jsx("span",{className:"brand-name",children:"SMART"}),u.jsx("span",{className:"brand-sub",children:"ANALYTICS"})]})]}),u.jsx("h1",{className:"welcome",children:"Create Account"}),u.jsx("p",{className:"subtitle",children:"Sign up to get started with your dashboard"})]}),u.jsxs("form",{className:"form",onSubmit:te,children:[u.jsxs("div",{className:"name-row",children:[u.jsxs("div",{className:"name-field",children:[u.jsxs("label",{className:"label",htmlFor:"firstName",children:[u.jsx("span",{className:"label-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor",strokeWidth:"1.5"})]})}),u.jsx("span",{children:"First Name"})]}),u.jsxs("div",{className:"input-wrapper",children:[u.jsx("span",{className:"input-leading","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor",strokeWidth:"1.5"})]})}),u.jsx("input",{id:"firstName",name:"firstName",type:"text",autoComplete:"given-name",placeholder:"Enter your first name",value:t,onChange:$=>i($.target.value),required:!0})]})]}),u.jsxs("div",{className:"name-field",children:[u.jsxs("label",{className:"label",htmlFor:"lastName",children:[u.jsx("span",{className:"label-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor",strokeWidth:"1.5"})]})}),u.jsx("span",{children:"Last Name"})]}),u.jsxs("div",{className:"input-wrapper",children:[u.jsx("span",{className:"input-leading","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor",strokeWidth:"1.5"})]})}),u.jsx("input",{id:"lastName",name:"lastName",type:"text",autoComplete:"family-name",placeholder:"Enter your last name",value:s,onChange:$=>o($.target.value),required:!0})]})]})]}),u.jsxs("label",{className:"label",htmlFor:"email",children:[u.jsx("span",{className:"label-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M4 6h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M4 7l8 6 8-6",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("span",{children:"Email Address"})]}),u.jsxs("div",{className:"input-wrapper",children:[u.jsx("span",{className:"input-leading","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M4 6h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M4 7l8 6 8-6",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",placeholder:"Enter your email",value:l,onChange:$=>c($.target.value),required:!0})]}),u.jsxs("label",{className:"label",htmlFor:"password",children:[u.jsx("span",{className:"label-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"5",y:"11",width:"14",height:"9",rx:"2",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M8 11V8a4 4 0 118 0v3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}),u.jsx("span",{children:"Password"})]}),u.jsxs("div",{className:"input-wrapper",children:[u.jsx("span",{className:"input-leading","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"5",y:"11",width:"14",height:"9",rx:"2",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M8 11V8a4 4 0 118 0v3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}),u.jsx("input",{id:"password",name:"password",type:p?"text":"password",autoComplete:"new-password",placeholder:"Create a password",value:d,onChange:$=>f($.target.value),required:!0}),u.jsx("button",{type:"button",className:"input-trailing","aria-label":p?"Hide password":"Show password",onClick:()=>v($=>!$),children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M2 12s4-7 10-7 10 7 10 7-4 7-10 7S2 12 2 12z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),p?u.jsx("path",{d:"M3 21L21 3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}):u.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"1.5"})]})})]}),u.jsxs("div",{className:"role-selection",children:[u.jsxs("label",{className:"label",children:[u.jsx("span",{className:"label-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M2 17l10 5 10-5",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M2 12l10 5 10-5",stroke:"currentColor",strokeWidth:"1.5"})]})}),u.jsx("span",{children:"Account Type"})]}),u.jsxs("div",{className:"role-options",children:[u.jsxs("label",{className:"role-option",children:[u.jsx("input",{type:"radio",name:"userRole",value:"Coordinator",checked:T==="Coordinator",onChange:$=>C($.target.value)}),u.jsxs("span",{className:"role-label",children:[u.jsx("span",{className:"role-icon",children:"👨‍🏫"}),u.jsxs("div",{children:[u.jsx("span",{className:"role-title",children:"Coordinator"}),u.jsx("span",{className:"role-description",children:"Standard access to dashboard features"})]})]})]}),u.jsxs("label",{className:`role-option ${ee?"disabled":""}`,children:[u.jsx("input",{type:"radio",name:"userRole",value:"admin",checked:T==="admin",onChange:$=>C($.target.value),disabled:ee}),u.jsxs("span",{className:"role-label",children:[u.jsx("span",{className:"role-icon",children:"👑"}),u.jsxs("div",{children:[u.jsx("span",{className:"role-title",children:"GSO"}),u.jsx("span",{className:"role-description",children:ee?"GSO account already exists. Only one GSO is allowed.":"Full access to all features and user management"})]})]})]})]})]}),u.jsx("button",{type:"submit",className:"primary-btn",disabled:_,children:_?"Creating Account...":"Create Account"}),u.jsx("div",{className:"divider",role:"separator","aria-label":"or continue with",children:u.jsx("span",{children:"or continue with"})}),u.jsxs("button",{type:"button",className:"oauth-btn",onClick:j,disabled:_,children:[u.jsx("span",{className:"google-icon","aria-hidden":"true",children:u.jsxs("svg",{viewBox:"0 0 48 48",width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{fill:"#FFC107",d:"M43.611 20.083H42V20H24v8h11.303C33.602 31.91 29.218 35 24 35c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.676 5.099 29.627 3 24 3 12.955 3 4 11.955 4 23s8.955 20 20 20 20-8.955 20-20c0-1.341-.138-2.651-.389-3.917z"}),u.jsx("path",{fill:"#FF3D00",d:"M6.306 14.691l6.571 4.814C14.297 16.108 18.789 13 24 13c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.676 5.099 29.627 3 24 3 16.318 3 9.656 7.337 6.306 14.691z"}),u.jsx("path",{fill:"#4CAF50",d:"M24 43c5.137 0 9.773-1.967 13.285-5.178l-6.129-5.177C29.153 34.091 26.687 35 24 35c-5.196 0-9.571-3.061-11.292-7.436l-6.54 5.037C9.474 39.556 16.229 43 24 43z"}),u.jsx("path",{fill:"#1976D2",d:"M43.611 20.083H42V20H24v8h11.303c-1.101 3.261-3.645 5.824-6.747 7.046l-6.129 5.177C36.293 41.466 44 36.5 44 23c0-1.341-.138-2.651-.389-3.917z"})]})}),u.jsx("span",{children:"Continue with Google"})]})]}),u.jsxs("footer",{className:"signup-footer",children:[u.jsx("span",{children:"Already have an account?"}),u.jsx("button",{type:"button",className:"link",onClick:e,disabled:_,children:"Sign In"})]})]}),K&&u.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",onClick:re,children:u.jsxs("div",{className:`modal-card ${le}`,onClick:$=>$.stopPropagation(),children:[le!=="success"&&u.jsx("button",{className:"modal-close",onClick:re,"aria-label":"Close",children:u.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),u.jsx("div",{className:"modal-icon","aria-hidden":"true",children:le==="success"?u.jsxs("svg",{width:"36",height:"36",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"11",fill:"url(#s)"}),u.jsx("path",{d:"M7 12.5l2.8 2.8L17 9",stroke:"#fff",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("defs",{children:u.jsxs("linearGradient",{id:"s",x1:"0",y1:"0",x2:"1",y2:"1",children:[u.jsx("stop",{offset:"0%",stopColor:"#22c55e"}),u.jsx("stop",{offset:"100%",stopColor:"#16a34a"})]})})]}):u.jsxs("svg",{width:"36",height:"36",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"11",fill:"url(#e)"}),u.jsx("path",{d:"M8 8l8 8M16 8l-8 8",stroke:"#fff",strokeWidth:"2.2",strokeLinecap:"round"}),u.jsx("defs",{children:u.jsxs("linearGradient",{id:"e",x1:"0",y1:"0",x2:"1",y2:"1",children:[u.jsx("stop",{offset:"0%",stopColor:"#ef4444"}),u.jsx("stop",{offset:"100%",stopColor:"#dc2626"})]})})]})}),u.jsx("h2",{className:"modal-title",children:R}),u.jsx("p",{className:"modal-message",children:F}),u.jsx("div",{className:"modal-actions"})]})}),A&&u.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",onClick:()=>I(!1),children:u.jsxs("div",{className:"modal-card role-modal",onClick:$=>$.stopPropagation(),children:[u.jsx("div",{className:"modal-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"36",height:"36",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"11",fill:"url(#roleGradient)"}),u.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z",stroke:"#fff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M2 17l10 5 10-5",stroke:"#fff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M2 12l10 5 10-5",stroke:"#fff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("defs",{children:u.jsxs("linearGradient",{id:"roleGradient",x1:"0",y1:"0",x2:"1",y2:"1",children:[u.jsx("stop",{offset:"0%",stopColor:"#4f8cff"}),u.jsx("stop",{offset:"100%",stopColor:"#7b61ff"})]})})]})}),u.jsx("h2",{className:"modal-title",children:"Choose Your Account Type"}),u.jsx("p",{className:"modal-message",children:"Please select the type of account you want to create with Google."}),u.jsxs("div",{className:"role-modal-options",children:[u.jsxs("button",{className:"role-modal-option",onClick:()=>U("Coordinator"),children:[u.jsx("span",{className:"role-icon",children:"👨‍🏫"}),u.jsxs("div",{children:[u.jsx("span",{className:"role-title",children:"Coordinator Account"}),u.jsx("span",{className:"role-description",children:"Standard access to dashboard features"})]})]}),u.jsxs("button",{className:`role-modal-option ${ee?"disabled":""}`,onClick:()=>!ee&&U("admin"),disabled:ee,children:[u.jsx("span",{className:"role-icon",children:"👑"}),u.jsxs("div",{children:[u.jsx("span",{className:"role-title",children:"GSO Account"}),u.jsx("span",{className:"role-description",children:ee?"GSO account already exists. Only one GSO is allowed.":"Full access to all features and user management"})]})]})]}),u.jsx("button",{className:"modal-cancel-btn",onClick:()=>I(!1),children:"Cancel"})]})})]})}function n7({onLogout:n,onNavigate:e,isOpen:t=!0,onToggle:i,activeView:s="dashboard",userRole:o="Coordinator"}){const[l,c]=me.useState(!1),d=()=>{c(!0)},f=async()=>{try{console.log("SideBar: Starting logout process...");const _=Nr.currentUser;if(console.log("SideBar: Current user:",_),_){const b=_.email||"Unknown",T=_.displayName||b,C=_.uid;console.log("SideBar: User details:",{userEmail:b,displayName:T,userId:C});let A="system";if(_.providerData&&_.providerData.length>0){const I=_.providerData[0].providerId;console.log("SideBar: Provider ID:",I),I==="google.com"?A="google":I==="password"&&(A="email")}console.log("SideBar: Auth provider:",A),await G2(A==="google"?"google_logout":"logout",T,C,"unknown",`User logged out from ${A==="google"?"Google":"email"} account: ${b}`,A),console.log("SideBar: Logout event logged successfully")}else console.log("SideBar: No current user found")}catch(_){console.error("SideBar: Error logging logout event:",_)}console.log("SideBar: Calling onLogout callback..."),n?.(),c(!1),window.innerWidth<=768&&i?.(),console.log("SideBar: Logout process completed")},p=()=>{c(!1)},v=({k:_,label:b,icon:T})=>u.jsxs("button",{className:`sb-item ${s===_?"active":""}`,onClick:()=>{e?.(_),window.innerWidth<=768&&i?.()},"aria-current":s===_?"page":void 0,children:[u.jsx("span",{className:"sb-icon","aria-hidden":"true",children:T}),u.jsx("span",{className:"sb-label",children:b})]});return u.jsxs(u.Fragment,{children:[t&&window.innerWidth<=768&&u.jsx("div",{className:"sidebar-overlay",onClick:i,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:999}}),u.jsxs("aside",{className:`sidebar ${t?"open":""}`,"aria-label":"Primary",children:[u.jsxs("div",{className:"sb-header",children:[u.jsx("span",{className:"sb-brand-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M10 2h4v3h-4zM4 7h16v3H4zM5 12h14v10H5z",fill:"#dbe7ff"}),u.jsx("path",{d:"M8 14h8v6H8z",fill:"#a8b7ff"})]})}),u.jsx("span",{className:"sb-brand",children:"EcoPlug"})]}),u.jsx("div",{className:"sb-divider"}),u.jsxs("nav",{className:"sb-nav",children:[u.jsx(v,{k:"dashboard",label:"Dashboard",icon:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"3",y:"3",width:"8",height:"8",rx:"2",fill:"currentColor"}),u.jsx("rect",{x:"13",y:"3",width:"8",height:"5",rx:"2",fill:"currentColor",opacity:".8"}),u.jsx("rect",{x:"3",y:"13",width:"5",height:"8",rx:"2",fill:"currentColor",opacity:".8"}),u.jsx("rect",{x:"10",y:"13",width:"11",height:"8",rx:"2",fill:"currentColor"})]})}),u.jsx("div",{className:"sb-rule"}),u.jsx(v,{k:"activeDevice",label:"Active Device",icon:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z",stroke:"currentColor",strokeWidth:"1.6"})]})}),o==="admin"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"sb-rule"}),u.jsx(v,{k:"setup",label:"Set up",icon:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M12 8a4 4 0 100 8 4 4 0 000-8z",stroke:"currentColor",strokeWidth:"1.8"}),u.jsx("path",{d:"M12 2v3M12 19v3M4.93 4.93l2.12 2.12M16.95 16.95l2.12 2.12M2 12h3M19 12h3M4.93 19.07l2.12-2.12M16.95 7.05l2.12-2.12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})}),u.jsx("div",{className:"sb-rule"}),u.jsx(v,{k:"schedule",label:"Schedule",icon:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"3",y:"4",width:"18",height:"17",rx:"2",stroke:"currentColor",strokeWidth:"1.6"}),u.jsx("path",{d:"M8 2v4M16 2v4M3 9h18",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})}),u.jsx("div",{className:"sb-rule"}),u.jsx(v,{k:"reports",label:"Reports",icon:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M4 4h10l6 6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z",stroke:"currentColor",strokeWidth:"1.6"}),u.jsx("path",{d:"M14 4v6h6",stroke:"currentColor",strokeWidth:"1.6"})]})}),u.jsx("div",{className:"sb-rule"}),u.jsx(v,{k:"users",label:"User Management",icon:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"8",r:"3.2",stroke:"currentColor",strokeWidth:"1.6"}),u.jsx("path",{d:"M4.5 20c1.8-3.5 5-5.3 7.5-5.3S17.7 16.5 19.5 20",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})})]})]}),u.jsx("div",{className:"sb-spacer"}),u.jsx("nav",{className:"sb-bottom",children:u.jsxs("button",{className:"sb-item",onClick:d,children:[u.jsx("span",{className:"sb-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M10 4H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h4",stroke:"currentColor",strokeWidth:"1.6"}),u.jsx("path",{d:"M14 16l4-4-4-4M18 12H8",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})}),u.jsx("span",{className:"sb-label",children:"Logout"})]})})]}),l&&u.jsx("div",{className:"logout-modal-overlay",onClick:p,children:u.jsxs("div",{className:"logout-modal",onClick:_=>_.stopPropagation(),children:[u.jsx("div",{className:"logout-modal-header",children:u.jsx("h3",{children:"Confirm Logout"})}),u.jsx("div",{className:"logout-modal-body",children:u.jsx("p",{children:"Are you sure you want to logout? This will clear your session and you'll need to sign in again."})}),u.jsxs("div",{className:"logout-modal-actions",children:[u.jsx("button",{className:"logout-modal-btn cancel",onClick:p,children:"Cancel"}),u.jsx("button",{className:"logout-modal-btn confirm",onClick:f,children:"Logout"})]})]})})]})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function sp(n){return n+.5|0}const eu=(n,e,t)=>Math.max(Math.min(n,t),e);function Qf(n){return eu(sp(n*2.55),0,255)}function uu(n){return eu(sp(n*255),0,255)}function tc(n){return eu(sp(n/2.55)/100,0,1)}function Ux(n){return eu(sp(n*100),0,100)}const pa={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},K2=[..."0123456789ABCDEF"],i7=n=>K2[n&15],s7=n=>K2[(n&240)>>4]+K2[n&15],mg=n=>(n&240)>>4===(n&15),o7=n=>mg(n.r)&&mg(n.g)&&mg(n.b)&&mg(n.a);function r7(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&pa[n[1]]*17,g:255&pa[n[2]]*17,b:255&pa[n[3]]*17,a:e===5?pa[n[4]]*17:255}:(e===7||e===9)&&(t={r:pa[n[1]]<<4|pa[n[2]],g:pa[n[3]]<<4|pa[n[4]],b:pa[n[5]]<<4|pa[n[6]],a:e===9?pa[n[7]]<<4|pa[n[8]]:255})),t}const a7=(n,e)=>n<255?e(n):"";function l7(n){var e=o7(n)?i7:s7;return n?"#"+e(n.r)+e(n.g)+e(n.b)+a7(n.a,e):void 0}const c7=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function uT(n,e,t){const i=e*Math.min(t,1-t),s=(o,l=(o+n/30)%12)=>t-i*Math.max(Math.min(l-3,9-l,1),-1);return[s(0),s(8),s(4)]}function u7(n,e,t){const i=(s,o=(s+n/60)%6)=>t-t*e*Math.max(Math.min(o,4-o,1),0);return[i(5),i(3),i(1)]}function d7(n,e,t){const i=uT(n,1,.5);let s;for(e+t>1&&(s=1/(e+t),e*=s,t*=s),s=0;s<3;s++)i[s]*=1-e-t,i[s]+=e;return i}function h7(n,e,t,i,s){return n===s?(e-t)/i+(e<t?6:0):e===s?(t-n)/i+2:(n-e)/i+4}function Sb(n){const t=n.r/255,i=n.g/255,s=n.b/255,o=Math.max(t,i,s),l=Math.min(t,i,s),c=(o+l)/2;let d,f,p;return o!==l&&(p=o-l,f=c>.5?p/(2-o-l):p/(o+l),d=h7(t,i,s,p,o),d=d*60+.5),[d|0,f||0,c]}function Nb(n,e,t,i){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,i)).map(uu)}function Eb(n,e,t){return Nb(uT,n,e,t)}function f7(n,e,t){return Nb(d7,n,e,t)}function m7(n,e,t){return Nb(u7,n,e,t)}function dT(n){return(n%360+360)%360}function p7(n){const e=c7.exec(n);let t=255,i;if(!e)return;e[5]!==i&&(t=e[6]?Qf(+e[5]):uu(+e[5]));const s=dT(+e[2]),o=+e[3]/100,l=+e[4]/100;return e[1]==="hwb"?i=f7(s,o,l):e[1]==="hsv"?i=m7(s,o,l):i=Eb(s,o,l),{r:i[0],g:i[1],b:i[2],a:t}}function g7(n,e){var t=Sb(n);t[0]=dT(t[0]+e),t=Eb(t),n.r=t[0],n.g=t[1],n.b=t[2]}function y7(n){if(!n)return;const e=Sb(n),t=e[0],i=Ux(e[1]),s=Ux(e[2]);return n.a<255?`hsla(${t}, ${i}%, ${s}%, ${tc(n.a)})`:`hsl(${t}, ${i}%, ${s}%)`}const Fx={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},$x={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function v7(){const n={},e=Object.keys($x),t=Object.keys(Fx);let i,s,o,l,c;for(i=0;i<e.length;i++){for(l=c=e[i],s=0;s<t.length;s++)o=t[s],c=c.replace(o,Fx[o]);o=parseInt($x[l],16),n[c]=[o>>16&255,o>>8&255,o&255]}return n}let pg;function b7(n){pg||(pg=v7(),pg.transparent=[0,0,0,0]);const e=pg[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const w7=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function _7(n){const e=w7.exec(n);let t=255,i,s,o;if(e){if(e[7]!==i){const l=+e[7];t=e[8]?Qf(l):eu(l*255,0,255)}return i=+e[1],s=+e[3],o=+e[5],i=255&(e[2]?Qf(i):eu(i,0,255)),s=255&(e[4]?Qf(s):eu(s,0,255)),o=255&(e[6]?Qf(o):eu(o,0,255)),{r:i,g:s,b:o,a:t}}}function x7(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${tc(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const $y=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,sh=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function S7(n,e,t){const i=sh(tc(n.r)),s=sh(tc(n.g)),o=sh(tc(n.b));return{r:uu($y(i+t*(sh(tc(e.r))-i))),g:uu($y(s+t*(sh(tc(e.g))-s))),b:uu($y(o+t*(sh(tc(e.b))-o))),a:n.a+t*(e.a-n.a)}}function gg(n,e,t){if(n){let i=Sb(n);i[e]=Math.max(0,Math.min(i[e]+i[e]*t,e===0?360:1)),i=Eb(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function hT(n,e){return n&&Object.assign(e||{},n)}function Bx(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=uu(n[3]))):(e=hT(n,{r:0,g:0,b:0,a:1}),e.a=uu(e.a)),e}function N7(n){return n.charAt(0)==="r"?_7(n):p7(n)}class Dm{constructor(e){if(e instanceof Dm)return e;const t=typeof e;let i;t==="object"?i=Bx(e):t==="string"&&(i=r7(e)||b7(e)||N7(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=hT(this._rgb);return e&&(e.a=tc(e.a)),e}set rgb(e){this._rgb=Bx(e)}rgbString(){return this._valid?x7(this._rgb):void 0}hexString(){return this._valid?l7(this._rgb):void 0}hslString(){return this._valid?y7(this._rgb):void 0}mix(e,t){if(e){const i=this.rgb,s=e.rgb;let o;const l=t===o?.5:t,c=2*l-1,d=i.a-s.a,f=((c*d===-1?c:(c+d)/(1+c*d))+1)/2;o=1-f,i.r=255&f*i.r+o*s.r+.5,i.g=255&f*i.g+o*s.g+.5,i.b=255&f*i.b+o*s.b+.5,i.a=l*i.a+(1-l)*s.a,this.rgb=i}return this}interpolate(e,t){return e&&(this._rgb=S7(this._rgb,e._rgb,t)),this}clone(){return new Dm(this.rgb)}alpha(e){return this._rgb.a=uu(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=sp(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return gg(this._rgb,2,e),this}darken(e){return gg(this._rgb,2,-e),this}saturate(e){return gg(this._rgb,1,e),this}desaturate(e){return gg(this._rgb,1,-e),this}rotate(e){return g7(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Xl(){}const E7=(()=>{let n=0;return()=>n++})();function Hi(n){return n==null}function to(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function wi(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function _a(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function pl(n,e){return _a(n)?n:e}function si(n,e){return typeof n>"u"?e:n}const T7=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Ji(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function Ai(n,e,t,i){let s,o,l;if(to(n))for(o=n.length,s=0;s<o;s++)e.call(t,n[s],s);else if(wi(n))for(l=Object.keys(n),o=l.length,s=0;s<o;s++)e.call(t,n[l[s]],l[s])}function T0(n,e){let t,i,s,o;if(!n||!e||n.length!==e.length)return!1;for(t=0,i=n.length;t<i;++t)if(s=n[t],o=e[t],s.datasetIndex!==o.datasetIndex||s.index!==o.index)return!1;return!0}function C0(n){if(to(n))return n.map(C0);if(wi(n)){const e=Object.create(null),t=Object.keys(n),i=t.length;let s=0;for(;s<i;++s)e[t[s]]=C0(n[t[s]]);return e}return n}function fT(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function C7(n,e,t,i){if(!fT(n))return;const s=e[n],o=t[n];wi(s)&&wi(o)?Om(s,o,i):e[n]=C0(o)}function Om(n,e,t){const i=to(e)?e:[e],s=i.length;if(!wi(n))return n;t=t||{};const o=t.merger||C7;let l;for(let c=0;c<s;++c){if(l=i[c],!wi(l))continue;const d=Object.keys(l);for(let f=0,p=d.length;f<p;++f)o(d[f],n,l,t)}return n}function dm(n,e){return Om(n,e,{merger:k7})}function k7(n,e,t){if(!fT(n))return;const i=e[n],s=t[n];wi(i)&&wi(s)?dm(i,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=C0(s))}const Wx={"":n=>n,x:n=>n.x,y:n=>n.y};function L7(n){const e=n.split("."),t=[];let i="";for(const s of e)i+=s,i.endsWith("\\")?i=i.slice(0,-1)+".":(t.push(i),i="");return t}function A7(n){const e=L7(n);return t=>{for(const i of e){if(i==="")break;t=t&&t[i]}return t}}function jh(n,e){return(Wx[e]||(Wx[e]=A7(e)))(n)}function Tb(n){return n.charAt(0).toUpperCase()+n.slice(1)}const jm=n=>typeof n<"u",pu=n=>typeof n=="function",zx=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function D7(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const vo=Math.PI,Tl=2*vo,O7=Tl+vo,k0=Number.POSITIVE_INFINITY,j7=vo/180,Ga=vo/2,zu=vo/4,Hx=vo*2/3,mT=Math.log10,Cl=Math.sign;function hm(n,e,t){return Math.abs(n-e)<t}function qx(n){const e=Math.round(n);n=hm(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(mT(n))),i=n/t;return(i<=1?1:i<=2?2:i<=5?5:10)*t}function M7(n){const e=[],t=Math.sqrt(n);let i;for(i=1;i<t;i++)n%i===0&&(e.push(i),e.push(n/i));return t===(t|0)&&e.push(t),e.sort((s,o)=>s-o).pop(),e}function R7(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function L0(n){return!R7(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function I7(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function P7(n,e,t){let i,s,o;for(i=0,s=n.length;i<s;i++)o=n[i][t],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function od(n){return n*(vo/180)}function U7(n){return n*(180/vo)}function Vx(n){if(!_a(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function F7(n,e){const t=e.x-n.x,i=e.y-n.y,s=Math.sqrt(t*t+i*i);let o=Math.atan2(i,t);return o<-.5*vo&&(o+=Tl),{angle:o,distance:s}}function X2(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function $7(n,e){return(n-e+O7)%Tl-vo}function Kc(n){return(n%Tl+Tl)%Tl}function pT(n,e,t,i){const s=Kc(n),o=Kc(e),l=Kc(t),c=Kc(o-s),d=Kc(l-s),f=Kc(s-o),p=Kc(s-l);return s===o||s===l||i&&o===l||c>d&&f<p}function Ka(n,e,t){return Math.max(e,Math.min(t,n))}function B7(n){return Ka(n,-32768,32767)}function rd(n,e,t,i=1e-6){return n>=Math.min(e,t)-i&&n<=Math.max(e,t)+i}function Cb(n,e,t){t=t||(l=>n[l]<e);let i=n.length-1,s=0,o;for(;i-s>1;)o=s+i>>1,t(o)?s=o:i=o;return{lo:s,hi:i}}const Q2=(n,e,t,i)=>Cb(n,t,i?s=>{const o=n[s][e];return o<t||o===t&&n[s+1][e]===t}:s=>n[s][e]<t),W7=(n,e,t)=>Cb(n,t,i=>n[i][e]>=t);function z7(n,e,t){let i=0,s=n.length;for(;i<s&&n[i]<e;)i++;for(;s>i&&n[s-1]>t;)s--;return i>0||s<n.length?n.slice(i,s):n}const gT=["push","pop","shift","splice","unshift"];function H7(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),gT.forEach(t=>{const i="_onData"+Tb(t),s=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...o){const l=s.apply(this,o);return n._chartjs.listeners.forEach(c=>{typeof c[i]=="function"&&c[i](...o)}),l}})})}function Yx(n,e){const t=n._chartjs;if(!t)return;const i=t.listeners,s=i.indexOf(e);s!==-1&&i.splice(s,1),!(i.length>0)&&(gT.forEach(o=>{delete n[o]}),delete n._chartjs)}function yT(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const vT=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function bT(n,e){let t=[],i=!1;return function(...s){t=s,i||(i=!0,vT.call(window,()=>{i=!1,n.apply(e,t)}))}}function q7(n,e){let t;return function(...i){return e?(clearTimeout(t),t=setTimeout(n,e,i)):n.apply(this,i),e}}const kb=n=>n==="start"?"left":n==="end"?"right":"center",Yo=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,V7=(n,e,t,i)=>n===(i?"left":"right")?t:n==="center"?(e+t)/2:e,yg=n=>n===0||n===1,Gx=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Tl/t)),Kx=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Tl/t)+1,fm={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Ga)+1,easeOutSine:n=>Math.sin(n*Ga),easeInOutSine:n=>-.5*(Math.cos(vo*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>yg(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>yg(n)?n:Gx(n,.075,.3),easeOutElastic:n=>yg(n)?n:Kx(n,.075,.3),easeInOutElastic(n){return yg(n)?n:n<.5?.5*Gx(n*2,.1125,.45):.5+.5*Kx(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-fm.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?fm.easeInBounce(n*2)*.5:fm.easeOutBounce(n*2-1)*.5+.5};function Lb(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Xx(n){return Lb(n)?n:new Dm(n)}function By(n){return Lb(n)?n:new Dm(n).saturate(.5).darken(.1).hexString()}const Y7=["x","y","borderWidth","radius","tension"],G7=["color","borderColor","backgroundColor"];function K7(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:G7},numbers:{type:"number",properties:Y7}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function X7(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Qx=new Map;function Q7(n,e){e=e||{};const t=n+JSON.stringify(e);let i=Qx.get(t);return i||(i=new Intl.NumberFormat(n,e),Qx.set(t,i)),i}function wT(n,e,t){return Q7(e,t).format(n)}const Z7={values(n){return to(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const i=this.chart.options.locale;let s,o=n;if(t.length>1){const f=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(f<1e-4||f>1e15)&&(s="scientific"),o=J7(n,t)}const l=mT(Math.abs(o)),c=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),d={notation:s,minimumFractionDigits:c,maximumFractionDigits:c};return Object.assign(d,this.options.ticks.format),wT(n,i,d)}};function J7(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var _T={formatters:Z7};function eP(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:_T.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const bd=Object.create(null),Z2=Object.create(null);function mm(n,e){if(!e)return n;const t=e.split(".");for(let i=0,s=t.length;i<s;++i){const o=t[i];n=n[o]||(n[o]=Object.create(null))}return n}function Wy(n,e,t){return typeof e=="string"?Om(mm(n,e),t):Om(mm(n,""),e)}class tP{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,s)=>By(s.backgroundColor),this.hoverBorderColor=(i,s)=>By(s.borderColor),this.hoverColor=(i,s)=>By(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Wy(this,e,t)}get(e){return mm(this,e)}describe(e,t){return Wy(Z2,e,t)}override(e,t){return Wy(bd,e,t)}route(e,t,i,s){const o=mm(this,e),l=mm(this,i),c="_"+t;Object.defineProperties(o,{[c]:{value:o[t],writable:!0},[t]:{enumerable:!0,get(){const d=this[c],f=l[s];return wi(d)?Object.assign({},f,d):si(d,f)},set(d){this[c]=d}}})}apply(e){e.forEach(t=>t(this))}}var Fs=new tP({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[K7,X7,eP]);function nP(n){return!n||Hi(n.size)||Hi(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function Zx(n,e,t,i,s){let o=e[s];return o||(o=e[s]=n.measureText(s).width,t.push(s)),o>i&&(i=o),i}function Hu(n,e,t){const i=n.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*i)/i+s}function Jx(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function J2(n,e,t,i){xT(n,e,t,i,null)}function xT(n,e,t,i,s){let o,l,c,d,f,p,v,_;const b=e.pointStyle,T=e.rotation,C=e.radius;let A=(T||0)*j7;if(b&&typeof b=="object"&&(o=b.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){n.save(),n.translate(t,i),n.rotate(A),n.drawImage(b,-b.width/2,-b.height/2,b.width,b.height),n.restore();return}if(!(isNaN(C)||C<=0)){switch(n.beginPath(),b){default:s?n.ellipse(t,i,s/2,C,0,0,Tl):n.arc(t,i,C,0,Tl),n.closePath();break;case"triangle":p=s?s/2:C,n.moveTo(t+Math.sin(A)*p,i-Math.cos(A)*C),A+=Hx,n.lineTo(t+Math.sin(A)*p,i-Math.cos(A)*C),A+=Hx,n.lineTo(t+Math.sin(A)*p,i-Math.cos(A)*C),n.closePath();break;case"rectRounded":f=C*.516,d=C-f,l=Math.cos(A+zu)*d,v=Math.cos(A+zu)*(s?s/2-f:d),c=Math.sin(A+zu)*d,_=Math.sin(A+zu)*(s?s/2-f:d),n.arc(t-v,i-c,f,A-vo,A-Ga),n.arc(t+_,i-l,f,A-Ga,A),n.arc(t+v,i+c,f,A,A+Ga),n.arc(t-_,i+l,f,A+Ga,A+vo),n.closePath();break;case"rect":if(!T){d=Math.SQRT1_2*C,p=s?s/2:d,n.rect(t-p,i-d,2*p,2*d);break}A+=zu;case"rectRot":v=Math.cos(A)*(s?s/2:C),l=Math.cos(A)*C,c=Math.sin(A)*C,_=Math.sin(A)*(s?s/2:C),n.moveTo(t-v,i-c),n.lineTo(t+_,i-l),n.lineTo(t+v,i+c),n.lineTo(t-_,i+l),n.closePath();break;case"crossRot":A+=zu;case"cross":v=Math.cos(A)*(s?s/2:C),l=Math.cos(A)*C,c=Math.sin(A)*C,_=Math.sin(A)*(s?s/2:C),n.moveTo(t-v,i-c),n.lineTo(t+v,i+c),n.moveTo(t+_,i-l),n.lineTo(t-_,i+l);break;case"star":v=Math.cos(A)*(s?s/2:C),l=Math.cos(A)*C,c=Math.sin(A)*C,_=Math.sin(A)*(s?s/2:C),n.moveTo(t-v,i-c),n.lineTo(t+v,i+c),n.moveTo(t+_,i-l),n.lineTo(t-_,i+l),A+=zu,v=Math.cos(A)*(s?s/2:C),l=Math.cos(A)*C,c=Math.sin(A)*C,_=Math.sin(A)*(s?s/2:C),n.moveTo(t-v,i-c),n.lineTo(t+v,i+c),n.moveTo(t+_,i-l),n.lineTo(t-_,i+l);break;case"line":l=s?s/2:Math.cos(A)*C,c=Math.sin(A)*C,n.moveTo(t-l,i-c),n.lineTo(t+l,i+c);break;case"dash":n.moveTo(t,i),n.lineTo(t+Math.cos(A)*(s?s/2:C),i+Math.sin(A)*C);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function Mm(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Ab(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function Db(n){n.restore()}function iP(n,e,t,i,s){if(!e)return n.lineTo(t.x,t.y);if(s==="middle"){const o=(e.x+t.x)/2;n.lineTo(o,e.y),n.lineTo(o,t.y)}else s==="after"!=!!i?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function sP(n,e,t,i){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?t.cp2x:t.cp1x,i?t.cp2y:t.cp1y,t.x,t.y)}function oP(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),Hi(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function rP(n,e,t,i,s){if(s.strikethrough||s.underline){const o=n.measureText(i),l=e-o.actualBoundingBoxLeft,c=e+o.actualBoundingBoxRight,d=t-o.actualBoundingBoxAscent,f=t+o.actualBoundingBoxDescent,p=s.strikethrough?(d+f)/2:f;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(l,p),n.lineTo(c,p),n.stroke()}}function aP(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Rm(n,e,t,i,s,o={}){const l=to(e)?e:[e],c=o.strokeWidth>0&&o.strokeColor!=="";let d,f;for(n.save(),n.font=s.string,oP(n,o),d=0;d<l.length;++d)f=l[d],o.backdrop&&aP(n,o.backdrop),c&&(o.strokeColor&&(n.strokeStyle=o.strokeColor),Hi(o.strokeWidth)||(n.lineWidth=o.strokeWidth),n.strokeText(f,t,i,o.maxWidth)),n.fillText(f,t,i,o.maxWidth),rP(n,t,i,f,o),i+=Number(s.lineHeight);n.restore()}function A0(n,e){const{x:t,y:i,w:s,h:o,radius:l}=e;n.arc(t+l.topLeft,i+l.topLeft,l.topLeft,1.5*vo,vo,!0),n.lineTo(t,i+o-l.bottomLeft),n.arc(t+l.bottomLeft,i+o-l.bottomLeft,l.bottomLeft,vo,Ga,!0),n.lineTo(t+s-l.bottomRight,i+o),n.arc(t+s-l.bottomRight,i+o-l.bottomRight,l.bottomRight,Ga,0,!0),n.lineTo(t+s,i+l.topRight),n.arc(t+s-l.topRight,i+l.topRight,l.topRight,0,-Ga,!0),n.lineTo(t+l.topLeft,i)}const lP=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,cP=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function uP(n,e){const t=(""+n).match(lP);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const dP=n=>+n||0;function ST(n,e){const t={},i=wi(e),s=i?Object.keys(e):e,o=wi(n)?i?l=>si(n[l],n[e[l]]):l=>n[l]:()=>n;for(const l of s)t[l]=dP(o(l));return t}function NT(n){return ST(n,{top:"y",right:"x",bottom:"y",left:"x"})}function bh(n){return ST(n,["topLeft","topRight","bottomLeft","bottomRight"])}function xa(n){const e=NT(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ko(n,e){n=n||{},e=e||Fs.font;let t=si(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let i=si(n.style,e.style);i&&!(""+i).match(cP)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const s={family:si(n.family,e.family),lineHeight:uP(si(n.lineHeight,e.lineHeight),t),size:t,style:i,weight:si(n.weight,e.weight),string:""};return s.string=nP(s),s}function vg(n,e,t,i){let s,o,l;for(s=0,o=n.length;s<o;++s)if(l=n[s],l!==void 0&&l!==void 0)return l}function hP(n,e,t){const{min:i,max:s}=n,o=T7(e,(s-i)/2),l=(c,d)=>t&&c===0?0:c+d;return{min:l(i,-Math.abs(o)),max:l(s,o)}}function Ed(n,e){return Object.assign(Object.create(n),e)}function Ob(n,e=[""],t,i,s=()=>n[0]){const o=t||n;typeof i>"u"&&(i=kT("_fallback",n));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:o,_fallback:i,_getTarget:s,override:c=>Ob([c,...n],e,o,i)};return new Proxy(l,{deleteProperty(c,d){return delete c[d],delete c._keys,delete n[0][d],!0},get(c,d){return TT(c,d,()=>wP(d,e,n,c))},getOwnPropertyDescriptor(c,d){return Reflect.getOwnPropertyDescriptor(c._scopes[0],d)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(c,d){return tS(c).includes(d)},ownKeys(c){return tS(c)},set(c,d,f){const p=c._storage||(c._storage=s());return c[d]=p[d]=f,delete c._keys,!0}})}function Mh(n,e,t,i){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:ET(n,i),setContext:o=>Mh(n,o,t,i),override:o=>Mh(n.override(o),e,t,i)};return new Proxy(s,{deleteProperty(o,l){return delete o[l],delete n[l],!0},get(o,l,c){return TT(o,l,()=>mP(o,l,c))},getOwnPropertyDescriptor(o,l){return o._descriptors.allKeys?Reflect.has(n,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,l)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(o,l){return Reflect.has(n,l)},ownKeys(){return Reflect.ownKeys(n)},set(o,l,c){return n[l]=c,delete o[l],!0}})}function ET(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:i=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:t,indexable:i,isScriptable:pu(t)?t:()=>t,isIndexable:pu(i)?i:()=>i}}const fP=(n,e)=>n?n+Tb(e):e,jb=(n,e)=>wi(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function TT(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const i=t();return n[e]=i,i}function mP(n,e,t){const{_proxy:i,_context:s,_subProxy:o,_descriptors:l}=n;let c=i[e];return pu(c)&&l.isScriptable(e)&&(c=pP(e,c,n,t)),to(c)&&c.length&&(c=gP(e,c,n,l.isIndexable)),jb(e,c)&&(c=Mh(c,s,o&&o[e],l)),c}function pP(n,e,t,i){const{_proxy:s,_context:o,_subProxy:l,_stack:c}=t;if(c.has(n))throw new Error("Recursion detected: "+Array.from(c).join("->")+"->"+n);c.add(n);let d=e(o,l||i);return c.delete(n),jb(n,d)&&(d=Mb(s._scopes,s,n,d)),d}function gP(n,e,t,i){const{_proxy:s,_context:o,_subProxy:l,_descriptors:c}=t;if(typeof o.index<"u"&&i(n))return e[o.index%e.length];if(wi(e[0])){const d=e,f=s._scopes.filter(p=>p!==d);e=[];for(const p of d){const v=Mb(f,s,n,p);e.push(Mh(v,o,l&&l[n],c))}}return e}function CT(n,e,t){return pu(n)?n(e,t):n}const yP=(n,e)=>n===!0?e:typeof n=="string"?jh(e,n):void 0;function vP(n,e,t,i,s){for(const o of e){const l=yP(t,o);if(l){n.add(l);const c=CT(l._fallback,t,s);if(typeof c<"u"&&c!==t&&c!==i)return c}else if(l===!1&&typeof i<"u"&&t!==i)return null}return!1}function Mb(n,e,t,i){const s=e._rootScopes,o=CT(e._fallback,t,i),l=[...n,...s],c=new Set;c.add(i);let d=eS(c,l,t,o||t,i);return d===null||typeof o<"u"&&o!==t&&(d=eS(c,l,o,d,i),d===null)?!1:Ob(Array.from(c),[""],s,o,()=>bP(e,t,i))}function eS(n,e,t,i,s){for(;t;)t=vP(n,e,t,i,s);return t}function bP(n,e,t){const i=n._getTarget();e in i||(i[e]={});const s=i[e];return to(s)&&wi(t)?t:s||{}}function wP(n,e,t,i){let s;for(const o of e)if(s=kT(fP(o,n),t),typeof s<"u")return jb(n,s)?Mb(t,i,n,s):s}function kT(n,e){for(const t of e){if(!t)continue;const i=t[n];if(typeof i<"u")return i}}function tS(n){let e=n._keys;return e||(e=n._keys=_P(n._scopes)),e}function _P(n){const e=new Set;for(const t of n)for(const i of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(i);return Array.from(e)}const xP=Number.EPSILON||1e-14,Rh=(n,e)=>e<n.length&&!n[e].skip&&n[e],LT=n=>n==="x"?"y":"x";function SP(n,e,t,i){const s=n.skip?e:n,o=e,l=t.skip?e:t,c=X2(o,s),d=X2(l,o);let f=c/(c+d),p=d/(c+d);f=isNaN(f)?0:f,p=isNaN(p)?0:p;const v=i*f,_=i*p;return{previous:{x:o.x-v*(l.x-s.x),y:o.y-v*(l.y-s.y)},next:{x:o.x+_*(l.x-s.x),y:o.y+_*(l.y-s.y)}}}function NP(n,e,t){const i=n.length;let s,o,l,c,d,f=Rh(n,0);for(let p=0;p<i-1;++p)if(d=f,f=Rh(n,p+1),!(!d||!f)){if(hm(e[p],0,xP)){t[p]=t[p+1]=0;continue}s=t[p]/e[p],o=t[p+1]/e[p],c=Math.pow(s,2)+Math.pow(o,2),!(c<=9)&&(l=3/Math.sqrt(c),t[p]=s*l*e[p],t[p+1]=o*l*e[p])}}function EP(n,e,t="x"){const i=LT(t),s=n.length;let o,l,c,d=Rh(n,0);for(let f=0;f<s;++f){if(l=c,c=d,d=Rh(n,f+1),!c)continue;const p=c[t],v=c[i];l&&(o=(p-l[t])/3,c[`cp1${t}`]=p-o,c[`cp1${i}`]=v-o*e[f]),d&&(o=(d[t]-p)/3,c[`cp2${t}`]=p+o,c[`cp2${i}`]=v+o*e[f])}}function TP(n,e="x"){const t=LT(e),i=n.length,s=Array(i).fill(0),o=Array(i);let l,c,d,f=Rh(n,0);for(l=0;l<i;++l)if(c=d,d=f,f=Rh(n,l+1),!!d){if(f){const p=f[e]-d[e];s[l]=p!==0?(f[t]-d[t])/p:0}o[l]=c?f?Cl(s[l-1])!==Cl(s[l])?0:(s[l-1]+s[l])/2:s[l-1]:s[l]}NP(n,s,o),EP(n,o,e)}function bg(n,e,t){return Math.max(Math.min(n,t),e)}function CP(n,e){let t,i,s,o,l,c=Mm(n[0],e);for(t=0,i=n.length;t<i;++t)l=o,o=c,c=t<i-1&&Mm(n[t+1],e),o&&(s=n[t],l&&(s.cp1x=bg(s.cp1x,e.left,e.right),s.cp1y=bg(s.cp1y,e.top,e.bottom)),c&&(s.cp2x=bg(s.cp2x,e.left,e.right),s.cp2y=bg(s.cp2y,e.top,e.bottom)))}function kP(n,e,t,i,s){let o,l,c,d;if(e.spanGaps&&(n=n.filter(f=>!f.skip)),e.cubicInterpolationMode==="monotone")TP(n,s);else{let f=i?n[n.length-1]:n[0];for(o=0,l=n.length;o<l;++o)c=n[o],d=SP(f,c,n[Math.min(o+1,l-(i?0:1))%l],e.tension),c.cp1x=d.previous.x,c.cp1y=d.previous.y,c.cp2x=d.next.x,c.cp2y=d.next.y,f=c}e.capBezierPoints&&CP(n,t)}function Rb(){return typeof window<"u"&&typeof document<"u"}function Ib(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function D0(n,e,t){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*e.parentNode[t])):i=n,i}const i1=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function LP(n,e){return i1(n).getPropertyValue(e)}const AP=["top","right","bottom","left"];function cd(n,e,t){const i={};t=t?"-"+t:"";for(let s=0;s<4;s++){const o=AP[s];i[o]=parseFloat(n[e+"-"+o+t])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const DP=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function OP(n,e){const t=n.touches,i=t&&t.length?t[0]:n,{offsetX:s,offsetY:o}=i;let l=!1,c,d;if(DP(s,o,n.target))c=s,d=o;else{const f=e.getBoundingClientRect();c=i.clientX-f.left,d=i.clientY-f.top,l=!0}return{x:c,y:d,box:l}}function Ku(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:i}=e,s=i1(t),o=s.boxSizing==="border-box",l=cd(s,"padding"),c=cd(s,"border","width"),{x:d,y:f,box:p}=OP(n,t),v=l.left+(p&&c.left),_=l.top+(p&&c.top);let{width:b,height:T}=e;return o&&(b-=l.width+c.width,T-=l.height+c.height),{x:Math.round((d-v)/b*t.width/i),y:Math.round((f-_)/T*t.height/i)}}function jP(n,e,t){let i,s;if(e===void 0||t===void 0){const o=n&&Ib(n);if(!o)e=n.clientWidth,t=n.clientHeight;else{const l=o.getBoundingClientRect(),c=i1(o),d=cd(c,"border","width"),f=cd(c,"padding");e=l.width-f.width-d.width,t=l.height-f.height-d.height,i=D0(c.maxWidth,o,"clientWidth"),s=D0(c.maxHeight,o,"clientHeight")}}return{width:e,height:t,maxWidth:i||k0,maxHeight:s||k0}}const wg=n=>Math.round(n*10)/10;function MP(n,e,t,i){const s=i1(n),o=cd(s,"margin"),l=D0(s.maxWidth,n,"clientWidth")||k0,c=D0(s.maxHeight,n,"clientHeight")||k0,d=jP(n,e,t);let{width:f,height:p}=d;if(s.boxSizing==="content-box"){const _=cd(s,"border","width"),b=cd(s,"padding");f-=b.width+_.width,p-=b.height+_.height}return f=Math.max(0,f-o.width),p=Math.max(0,i?f/i:p-o.height),f=wg(Math.min(f,l,d.maxWidth)),p=wg(Math.min(p,c,d.maxHeight)),f&&!p&&(p=wg(f/2)),(e!==void 0||t!==void 0)&&i&&d.height&&p>d.height&&(p=d.height,f=wg(Math.floor(p*i))),{width:f,height:p}}function nS(n,e,t){const i=e||1,s=Math.floor(n.height*i),o=Math.floor(n.width*i);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const l=n.canvas;return l.style&&(t||!l.style.height&&!l.style.width)&&(l.style.height=`${n.height}px`,l.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||l.height!==s||l.width!==o?(n.currentDevicePixelRatio=i,l.height=s,l.width=o,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const RP=(function(){let n=!1;try{const e={get passive(){return n=!0,!1}};Rb()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n})();function iS(n,e){const t=LP(n,e),i=t&&t.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Xu(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function IP(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:i==="middle"?t<.5?n.y:e.y:i==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function PP(n,e,t,i){const s={x:n.cp2x,y:n.cp2y},o={x:e.cp1x,y:e.cp1y},l=Xu(n,s,t),c=Xu(s,o,t),d=Xu(o,e,t),f=Xu(l,c,t),p=Xu(c,d,t);return Xu(f,p,t)}const UP=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,i){return t-i},leftForLtr(t,i){return t-i}}},FP=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function wh(n,e,t){return n?UP(e,t):FP()}function AT(n,e){let t,i;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,i=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=i)}function DT(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function OT(n){return n==="angle"?{between:pT,compare:$7,normalize:Kc}:{between:rd,compare:(e,t)=>e-t,normalize:e=>e}}function sS({start:n,end:e,count:t,loop:i,style:s}){return{start:n%t,end:e%t,loop:i&&(e-n+1)%t===0,style:s}}function $P(n,e,t){const{property:i,start:s,end:o}=t,{between:l,normalize:c}=OT(i),d=e.length;let{start:f,end:p,loop:v}=n,_,b;if(v){for(f+=d,p+=d,_=0,b=d;_<b&&l(c(e[f%d][i]),s,o);++_)f--,p--;f%=d,p%=d}return p<f&&(p+=d),{start:f,end:p,loop:v,style:n.style}}function BP(n,e,t){if(!t)return[n];const{property:i,start:s,end:o}=t,l=e.length,{compare:c,between:d,normalize:f}=OT(i),{start:p,end:v,loop:_,style:b}=$P(n,e,t),T=[];let C=!1,A=null,I,ee,G;const K=()=>d(s,G,I)&&c(s,G)!==0,de=()=>c(o,I)===0||d(o,G,I),le=()=>C||K(),z=()=>!C||de();for(let R=p,D=p;R<=v;++R)ee=e[R%l],!ee.skip&&(I=f(ee[i]),I!==G&&(C=d(I,s,o),A===null&&le()&&(A=c(I,s)===0?R:D),A!==null&&z()&&(T.push(sS({start:A,end:R,loop:_,count:l,style:b})),A=null),D=R,G=I));return A!==null&&T.push(sS({start:A,end:v,loop:_,count:l,style:b})),T}function WP(n,e){const t=[],i=n.segments;for(let s=0;s<i.length;s++){const o=BP(i[s],n.points,e);o.length&&t.push(...o)}return t}function zP(n,e,t,i){let s=0,o=e-1;if(t&&!i)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,t&&(o+=s);o>s&&n[o%e].skip;)o--;return o%=e,{start:s,end:o}}function HP(n,e,t,i){const s=n.length,o=[];let l=e,c=n[e],d;for(d=e+1;d<=t;++d){const f=n[d%s];f.skip||f.stop?c.skip||(i=!1,o.push({start:e%s,end:(d-1)%s,loop:i}),e=l=f.stop?d:null):(l=d,c.skip&&(e=d)),c=f}return l!==null&&o.push({start:e%s,end:l%s,loop:i}),o}function qP(n,e){const t=n.points,i=n.options.spanGaps,s=t.length;if(!s)return[];const o=!!n._loop,{start:l,end:c}=zP(t,s,o,i);if(i===!0)return oS(n,[{start:l,end:c,loop:o}],t,e);const d=c<l?c+s:c,f=!!n._fullLoop&&l===0&&c===s-1;return oS(n,HP(t,l,d,f),t,e)}function oS(n,e,t,i){return!i||!i.setContext||!t?e:VP(n,e,t,i)}function VP(n,e,t,i){const s=n._chart.getContext(),o=rS(n.options),{_datasetIndex:l,options:{spanGaps:c}}=n,d=t.length,f=[];let p=o,v=e[0].start,_=v;function b(T,C,A,I){const ee=c?-1:1;if(T!==C){for(T+=d;t[T%d].skip;)T-=ee;for(;t[C%d].skip;)C+=ee;T%d!==C%d&&(f.push({start:T%d,end:C%d,loop:A,style:I}),p=I,v=C%d)}}for(const T of e){v=c?v:T.start;let C=t[v%d],A;for(_=v+1;_<=T.end;_++){const I=t[_%d];A=rS(i.setContext(Ed(s,{type:"segment",p0:C,p1:I,p0DataIndex:(_-1)%d,p1DataIndex:_%d,datasetIndex:l}))),YP(A,p)&&b(v,_-1,T.loop,p),C=I,p=A}v<_-1&&b(v,_-1,T.loop,p)}return f}function rS(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function YP(n,e){if(!e)return!1;const t=[],i=function(s,o){return Lb(o)?(t.includes(o)||t.push(o),t.indexOf(o)):o};return JSON.stringify(n,i)!==JSON.stringify(e,i)}function _g(n,e,t){return n.options.clip?n[t]:e[t]}function GP(n,e){const{xScale:t,yScale:i}=n;return t&&i?{left:_g(t,e,"left"),right:_g(t,e,"right"),top:_g(i,e,"top"),bottom:_g(i,e,"bottom")}:e}function KP(n,e){const t=e._clip;if(t.disabled)return!1;const i=GP(e,n.chartArea);return{left:t.left===!1?0:i.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:i.right+(t.right===!0?0:t.right),top:t.top===!1?0:i.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:i.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class XP{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,s){const o=t.listeners[s],l=t.duration;o.forEach(c=>c({chart:e,initial:t.initial,numSteps:l,currentStep:Math.min(i-t.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=vT.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,s)=>{if(!i.running||!i.items.length)return;const o=i.items;let l=o.length-1,c=!1,d;for(;l>=0;--l)d=o[l],d._active?(d._total>i.duration&&(i.duration=d._total),d.tick(e),c=!0):(o[l]=o[o.length-1],o.pop());c&&(s.draw(),this._notify(s,i,e,"progress")),o.length||(i.running=!1,this._notify(s,i,e,"complete"),i.initial=!1),t+=o.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,s)=>Math.max(i,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let s=i.length-1;for(;s>=0;--s)i[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Jl=new XP;const aS="transparent",QP={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const i=Xx(n||aS),s=i.valid&&Xx(e||aS);return s&&s.valid?s.mix(i,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class ZP{constructor(e,t,i,s){const o=t[i];s=vg([e.to,s,o,e.from]);const l=vg([e.from,o,s]);this._active=!0,this._fn=e.fn||QP[e.type||typeof l],this._easing=fm[e.easing]||fm.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=l,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);const s=this._target[this._prop],o=i-this._start,l=this._duration-o;this._start=i,this._duration=Math.floor(Math.max(l,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=vg([e.to,t,s,e.from]),this._from=vg([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,s=this._prop,o=this._from,l=this._loop,c=this._to;let d;if(this._active=o!==c&&(l||t<i),!this._active){this._target[s]=c,this._notify(!0);return}if(t<0){this._target[s]=o;return}d=t/i%2,d=l&&d>1?2-d:d,d=this._easing(Math.min(1,Math.max(0,d))),this._target[s]=this._fn(o,c,d)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let s=0;s<i.length;s++)i[s][t]()}}class jT{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!wi(e))return;const t=Object.keys(Fs.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const o=e[s];if(!wi(o))return;const l={};for(const c of t)l[c]=o[c];(to(o.properties)&&o.properties||[s]).forEach(c=>{(c===s||!i.has(c))&&i.set(c,l)})})}_animateOptions(e,t){const i=t.options,s=e9(e,i);if(!s)return[];const o=this._createAnimations(s,i);return i.$shared&&JP(e.options.$animations,i).then(()=>{e.options=i},()=>{}),o}_createAnimations(e,t){const i=this._properties,s=[],o=e.$animations||(e.$animations={}),l=Object.keys(t),c=Date.now();let d;for(d=l.length-1;d>=0;--d){const f=l[d];if(f.charAt(0)==="$")continue;if(f==="options"){s.push(...this._animateOptions(e,t));continue}const p=t[f];let v=o[f];const _=i.get(f);if(v)if(_&&v.active()){v.update(_,p,c);continue}else v.cancel();if(!_||!_.duration){e[f]=p;continue}o[f]=v=new ZP(_,e,f,p),s.push(v)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const i=this._createAnimations(e,t);if(i.length)return Jl.add(this._chart,i),!0}}function JP(n,e){const t=[],i=Object.keys(e);for(let s=0;s<i.length;s++){const o=n[i[s]];o&&o.active()&&t.push(o.wait())}return Promise.all(t)}function e9(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function lS(n,e){const t=n&&n.options||{},i=t.reverse,s=t.min===void 0?e:0,o=t.max===void 0?e:0;return{start:i?o:s,end:i?s:o}}function t9(n,e,t){if(t===!1)return!1;const i=lS(n,t),s=lS(e,t);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}function n9(n){let e,t,i,s;return wi(n)?(e=n.top,t=n.right,i=n.bottom,s=n.left):e=t=i=s=n,{top:e,right:t,bottom:i,left:s,disabled:n===!1}}function MT(n,e){const t=[],i=n._getSortedDatasetMetas(e);let s,o;for(s=0,o=i.length;s<o;++s)t.push(i[s].index);return t}function cS(n,e,t,i={}){const s=n.keys,o=i.mode==="single";let l,c,d,f;if(e===null)return;let p=!1;for(l=0,c=s.length;l<c;++l){if(d=+s[l],d===t){if(p=!0,i.all)continue;break}f=n.values[d],_a(f)&&(o||e===0||Cl(e)===Cl(f))&&(e+=f)}return!p&&!i.all?0:e}function i9(n,e){const{iScale:t,vScale:i}=e,s=t.axis==="x"?"x":"y",o=i.axis==="x"?"x":"y",l=Object.keys(n),c=new Array(l.length);let d,f,p;for(d=0,f=l.length;d<f;++d)p=l[d],c[d]={[s]:p,[o]:n[p]};return c}function zy(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function s9(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function o9(n){const{min:e,max:t,minDefined:i,maxDefined:s}=n.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function r9(n,e,t){const i=n[e]||(n[e]={});return i[t]||(i[t]={})}function uS(n,e,t,i){for(const s of e.getMatchingVisibleMetas(i).reverse()){const o=n[s.index];if(t&&o>0||!t&&o<0)return s.index}return null}function dS(n,e){const{chart:t,_cachedMeta:i}=n,s=t._stacks||(t._stacks={}),{iScale:o,vScale:l,index:c}=i,d=o.axis,f=l.axis,p=s9(o,l,i),v=e.length;let _;for(let b=0;b<v;++b){const T=e[b],{[d]:C,[f]:A}=T,I=T._stacks||(T._stacks={});_=I[f]=r9(s,p,C),_[c]=A,_._top=uS(_,l,!0,i.type),_._bottom=uS(_,l,!1,i.type);const ee=_._visualValues||(_._visualValues={});ee[c]=A}}function Hy(n,e){const t=n.scales;return Object.keys(t).filter(i=>t[i].axis===e).shift()}function a9(n,e){return Ed(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function l9(n,e,t){return Ed(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Wf(n,e){const t=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){e=e||n._parsed;for(const s of e){const o=s._stacks;if(!o||o[i]===void 0||o[i][t]===void 0)return;delete o[i][t],o[i]._visualValues!==void 0&&o[i]._visualValues[t]!==void 0&&delete o[i]._visualValues[t]}}}const qy=n=>n==="reset"||n==="none",hS=(n,e)=>e?n:Object.assign({},n),c9=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:MT(t,!0),values:null};class RT{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=zy(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Wf(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),s=(v,_,b,T)=>v==="x"?_:v==="r"?T:b,o=t.xAxisID=si(i.xAxisID,Hy(e,"x")),l=t.yAxisID=si(i.yAxisID,Hy(e,"y")),c=t.rAxisID=si(i.rAxisID,Hy(e,"r")),d=t.indexAxis,f=t.iAxisID=s(d,o,l,c),p=t.vAxisID=s(d,l,o,c);t.xScale=this.getScaleForId(o),t.yScale=this.getScaleForId(l),t.rScale=this.getScaleForId(c),t.iScale=this.getScaleForId(f),t.vScale=this.getScaleForId(p)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Yx(this._data,this),e._stacked&&Wf(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(wi(t)){const s=this._cachedMeta;this._data=i9(t,s)}else if(i!==t){if(i){Yx(i,this);const s=this._cachedMeta;Wf(s),s._parsed=[]}t&&Object.isExtensible(t)&&H7(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let s=!1;this._dataCheck();const o=t._stacked;t._stacked=zy(t.vScale,t),t.stack!==i.stack&&(s=!0,Wf(t),t.stack=i.stack),this._resyncElements(e),(s||o!==t._stacked)&&(dS(this,t._parsed),t._stacked=zy(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:s}=this,{iScale:o,_stacked:l}=i,c=o.axis;let d=e===0&&t===s.length?!0:i._sorted,f=e>0&&i._parsed[e-1],p,v,_;if(this._parsing===!1)i._parsed=s,i._sorted=!0,_=s;else{to(s[e])?_=this.parseArrayData(i,s,e,t):wi(s[e])?_=this.parseObjectData(i,s,e,t):_=this.parsePrimitiveData(i,s,e,t);const b=()=>v[c]===null||f&&v[c]<f[c];for(p=0;p<t;++p)i._parsed[p+e]=v=_[p],d&&(b()&&(d=!1),f=v);i._sorted=d}l&&dS(this,_)}parsePrimitiveData(e,t,i,s){const{iScale:o,vScale:l}=e,c=o.axis,d=l.axis,f=o.getLabels(),p=o===l,v=new Array(s);let _,b,T;for(_=0,b=s;_<b;++_)T=_+i,v[_]={[c]:p||o.parse(f[T],T),[d]:l.parse(t[T],T)};return v}parseArrayData(e,t,i,s){const{xScale:o,yScale:l}=e,c=new Array(s);let d,f,p,v;for(d=0,f=s;d<f;++d)p=d+i,v=t[p],c[d]={x:o.parse(v[0],p),y:l.parse(v[1],p)};return c}parseObjectData(e,t,i,s){const{xScale:o,yScale:l}=e,{xAxisKey:c="x",yAxisKey:d="y"}=this._parsing,f=new Array(s);let p,v,_,b;for(p=0,v=s;p<v;++p)_=p+i,b=t[_],f[p]={x:o.parse(jh(b,c),_),y:l.parse(jh(b,d),_)};return f}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const s=this.chart,o=this._cachedMeta,l=t[e.axis],c={keys:MT(s,!0),values:t._stacks[e.axis]._visualValues};return cS(c,l,o.index,{mode:i})}updateRangeFromParsed(e,t,i,s){const o=i[t.axis];let l=o===null?NaN:o;const c=s&&i._stacks[t.axis];s&&c&&(s.values=c,l=cS(s,o,this._cachedMeta.index)),e.min=Math.min(e.min,l),e.max=Math.max(e.max,l)}getMinMax(e,t){const i=this._cachedMeta,s=i._parsed,o=i._sorted&&e===i.iScale,l=s.length,c=this._getOtherScale(e),d=c9(t,i,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:p,max:v}=o9(c);let _,b;function T(){b=s[_];const C=b[c.axis];return!_a(b[e.axis])||p>C||v<C}for(_=0;_<l&&!(!T()&&(this.updateRangeFromParsed(f,e,b,d),o));++_);if(o){for(_=l-1;_>=0;--_)if(!T()){this.updateRangeFromParsed(f,e,b,d);break}}return f}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let s,o,l;for(s=0,o=t.length;s<o;++s)l=t[s][e.axis],_a(l)&&i.push(l);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,s=t.vScale,o=this.getParsed(e);return{label:i?""+i.getLabelForValue(o[i.axis]):"",value:s?""+s.getLabelForValue(o[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=n9(si(this.options.clip,t9(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,s=i.data||[],o=t.chartArea,l=[],c=this._drawStart||0,d=this._drawCount||s.length-c,f=this.options.drawActiveElementsOnTop;let p;for(i.dataset&&i.dataset.draw(e,o,c,d),p=c;p<c+d;++p){const v=s[p];v.hidden||(v.active&&f?l.push(v):v.draw(e,o))}for(p=0;p<l.length;++p)l[p].draw(e,o)}getStyle(e,t){const i=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const s=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const l=this._cachedMeta.data[e];o=l.$context||(l.$context=l9(this.getContext(),e,l)),o.parsed=this.getParsed(e),o.raw=s.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=a9(this.chart.getContext(),this.index)),o.dataset=s,o.index=o.datasetIndex=this.index;return o.active=!!t,o.mode=i,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const s=t==="active",o=this._cachedDataOpts,l=e+"-"+t,c=o[l],d=this.enableOptionSharing&&jm(i);if(c)return hS(c,d);const f=this.chart.config,p=f.datasetElementScopeKeys(this._type,e),v=s?[`${e}Hover`,"hover",e,""]:[e,""],_=f.getOptionScopes(this.getDataset(),p),b=Object.keys(Fs.elements[e]),T=()=>this.getContext(i,s,t),C=f.resolveNamedOptions(_,b,T,v);return C.$shared&&(C.$shared=d,o[l]=Object.freeze(hS(C,d))),C}_resolveAnimations(e,t,i){const s=this.chart,o=this._cachedDataOpts,l=`animation-${t}`,c=o[l];if(c)return c;let d;if(s.options.animation!==!1){const p=this.chart.config,v=p.datasetAnimationScopeKeys(this._type,t),_=p.getOptionScopes(this.getDataset(),v);d=p.createResolver(_,this.getContext(e,i,t))}const f=new jT(s,d&&d.animations);return d&&d._cacheable&&(o[l]=Object.freeze(f)),f}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||qy(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),s=this._sharedOptions,o=this.getSharedOptions(i),l=this.includeOptions(t,o)||o!==s;return this.updateSharedOptions(o,t,i),{sharedOptions:o,includeOptions:l}}updateElement(e,t,i,s){qy(s)?Object.assign(e,i):this._resolveAnimations(t,s).update(e,i)}updateSharedOptions(e,t,i){e&&!qy(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,s){e.active=s;const o=this.getStyle(t,s);this._resolveAnimations(t,i,s).update(e,{options:!s&&this.getSharedOptions(o)||o})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[c,d,f]of this._syncList)this[c](d,f);this._syncList=[];const s=i.length,o=t.length,l=Math.min(o,s);l&&this.parse(0,l),o>s?this._insertElements(s,o-s,e):o<s&&this._removeElements(o,s-o)}_insertElements(e,t,i=!0){const s=this._cachedMeta,o=s.data,l=e+t;let c;const d=f=>{for(f.length+=t,c=f.length-1;c>=l;c--)f[c]=f[c-t]};for(d(o),c=e;c<l;++c)o[c]=new this.dataElementType;this._parsing&&d(s._parsed),this.parse(e,t),i&&this.updateElements(o,e,t,"reset")}updateElements(e,t,i,s){}_removeElements(e,t){const i=this._cachedMeta;if(this._parsing){const s=i._parsed.splice(e,t);i._stacked&&Wf(i,s)}i.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,i,s]=e;this[t](i,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function u9(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let i=[];for(let s=0,o=t.length;s<o;s++)i=i.concat(t[s].controller.getAllParsedValues(n));n._cache.$bar=yT(i.sort((s,o)=>s-o))}return n._cache.$bar}function d9(n){const e=n.iScale,t=u9(e,n.type);let i=e._length,s,o,l,c;const d=()=>{l===32767||l===-32768||(jm(c)&&(i=Math.min(i,Math.abs(l-c)||i)),c=l)};for(s=0,o=t.length;s<o;++s)l=e.getPixelForValue(t[s]),d();for(c=void 0,s=0,o=e.ticks.length;s<o;++s)l=e.getPixelForTick(s),d();return i}function h9(n,e,t,i){const s=t.barThickness;let o,l;return Hi(s)?(o=e.min*t.categoryPercentage,l=t.barPercentage):(o=s*i,l=1),{chunk:o/i,ratio:l,start:e.pixels[n]-o/2}}function f9(n,e,t,i){const s=e.pixels,o=s[n];let l=n>0?s[n-1]:null,c=n<s.length-1?s[n+1]:null;const d=t.categoryPercentage;l===null&&(l=o-(c===null?e.end-e.start:c-o)),c===null&&(c=o+o-l);const f=o-(o-Math.min(l,c))/2*d;return{chunk:Math.abs(c-l)/2*d/i,ratio:t.barPercentage,start:f}}function m9(n,e,t,i){const s=t.parse(n[0],i),o=t.parse(n[1],i),l=Math.min(s,o),c=Math.max(s,o);let d=l,f=c;Math.abs(l)>Math.abs(c)&&(d=c,f=l),e[t.axis]=f,e._custom={barStart:d,barEnd:f,start:s,end:o,min:l,max:c}}function IT(n,e,t,i){return to(n)?m9(n,e,t,i):e[t.axis]=t.parse(n,i),e}function fS(n,e,t,i){const s=n.iScale,o=n.vScale,l=s.getLabels(),c=s===o,d=[];let f,p,v,_;for(f=t,p=t+i;f<p;++f)_=e[f],v={},v[s.axis]=c||s.parse(l[f],f),d.push(IT(_,v,o,f));return d}function Vy(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function p9(n,e,t){return n!==0?Cl(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function g9(n){let e,t,i,s,o;return n.horizontal?(e=n.base>n.x,t="left",i="right"):(e=n.base<n.y,t="bottom",i="top"),e?(s="end",o="start"):(s="start",o="end"),{start:t,end:i,reverse:e,top:s,bottom:o}}function y9(n,e,t,i){let s=e.borderSkipped;const o={};if(!s){n.borderSkipped=o;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:c,reverse:d,top:f,bottom:p}=g9(n);s==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===i?s=f:(t._bottom||0)===i?s=p:(o[mS(p,l,c,d)]=!0,s=f)),o[mS(s,l,c,d)]=!0,n.borderSkipped=o}function mS(n,e,t,i){return i?(n=v9(n,e,t),n=pS(n,t,e)):n=pS(n,e,t),n}function v9(n,e,t){return n===e?t:n===t?e:n}function pS(n,e,t){return n==="start"?e:n==="end"?t:n}function b9(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class w9 extends RT{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,i,s){return fS(e,t,i,s)}parseArrayData(e,t,i,s){return fS(e,t,i,s)}parseObjectData(e,t,i,s){const{iScale:o,vScale:l}=e,{xAxisKey:c="x",yAxisKey:d="y"}=this._parsing,f=o.axis==="x"?c:d,p=l.axis==="x"?c:d,v=[];let _,b,T,C;for(_=i,b=i+s;_<b;++_)C=t[_],T={},T[o.axis]=o.parse(jh(C,f),_),v.push(IT(jh(C,p),T,l,_));return v}updateRangeFromParsed(e,t,i,s){super.updateRangeFromParsed(e,t,i,s);const o=i._custom;o&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:s}=t,o=this.getParsed(e),l=o._custom,c=Vy(l)?"["+l.start+", "+l.end+"]":""+s.getLabelForValue(o[s.axis]);return{label:""+i.getLabelForValue(o[i.axis]),value:c}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,i,s){const o=s==="reset",{index:l,_cachedMeta:{vScale:c}}=this,d=c.getBasePixel(),f=c.isHorizontal(),p=this._getRuler(),{sharedOptions:v,includeOptions:_}=this._getSharedOptions(t,s);for(let b=t;b<t+i;b++){const T=this.getParsed(b),C=o||Hi(T[c.axis])?{base:d,head:d}:this._calculateBarValuePixels(b),A=this._calculateBarIndexPixels(b,p),I=(T._stacks||{})[c.axis],ee={horizontal:f,base:C.base,enableBorderRadius:!I||Vy(T._custom)||l===I._top||l===I._bottom,x:f?C.head:A.center,y:f?A.center:C.head,height:f?A.size:Math.abs(C.size),width:f?Math.abs(C.size):A.size};_&&(ee.options=v||this.resolveDataElementOptions(b,e[b].active?"active":s));const G=ee.options||e[b].options;y9(ee,G,I,l),b9(ee,G,p.ratio),this.updateElement(e[b],b,ee,s)}}_getStacks(e,t){const{iScale:i}=this._cachedMeta,s=i.getMatchingVisibleMetas(this._type).filter(p=>p.controller.options.grouped),o=i.options.stacked,l=[],c=this._cachedMeta.controller.getParsed(t),d=c&&c[i.axis],f=p=>{const v=p._parsed.find(b=>b[i.axis]===d),_=v&&v[p.vScale.axis];if(Hi(_)||isNaN(_))return!0};for(const p of s)if(!(t!==void 0&&f(p))&&((o===!1||l.indexOf(p.stack)===-1||o===void 0&&p.stack===void 0)&&l.push(p.stack),p.index===e))break;return l.length||l.push(void 0),l}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(i=>e[i].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)e[si(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,i){const s=this._getStacks(e,i),o=t!==void 0?s.indexOf(t):-1;return o===-1?s.length-1:o}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,s=[];let o,l;for(o=0,l=t.data.length;o<l;++o)s.push(i.getPixelForValue(this.getParsed(o)[i.axis],o));const c=e.barThickness;return{min:c||d9(t),pixels:s,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:c?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i,index:s},options:{base:o,minBarLength:l}}=this,c=o||0,d=this.getParsed(e),f=d._custom,p=Vy(f);let v=d[t.axis],_=0,b=i?this.applyStack(t,d,i):v,T,C;b!==v&&(_=b-v,b=v),p&&(v=f.barStart,b=f.barEnd-f.barStart,v!==0&&Cl(v)!==Cl(f.barEnd)&&(_=0),_+=v);const A=!Hi(o)&&!p?o:_;let I=t.getPixelForValue(A);if(this.chart.getDataVisibility(e)?T=t.getPixelForValue(_+b):T=I,C=T-I,Math.abs(C)<l){C=p9(C,t,c)*l,v===c&&(I-=C/2);const ee=t.getPixelForDecimal(0),G=t.getPixelForDecimal(1),K=Math.min(ee,G),de=Math.max(ee,G);I=Math.max(Math.min(I,de),K),T=I+C,i&&!p&&(d._stacks[t.axis]._visualValues[s]=t.getValueForPixel(T)-t.getValueForPixel(I))}if(I===t.getPixelForValue(c)){const ee=Cl(C)*t.getLineWidthForValue(c)/2;I+=ee,C-=ee}return{size:C,base:I,head:T,center:T+C/2}}_calculateBarIndexPixels(e,t){const i=t.scale,s=this.options,o=s.skipNull,l=si(s.maxBarThickness,1/0);let c,d;const f=this._getAxisCount();if(t.grouped){const p=o?this._getStackCount(e):t.stackCount,v=s.barThickness==="flex"?f9(e,t,s,p*f):h9(e,t,s,p*f),_=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,b=this._getAxis().indexOf(si(_,this.getFirstScaleIdForIndexAxis())),T=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0)+b;c=v.start+v.chunk*T+v.chunk/2,d=Math.min(l,v.chunk*v.ratio)}else c=i.getPixelForValue(this.getParsed(e)[i.axis],e),d=Math.min(l,t.min*t.ratio);return{base:c-d/2,head:c+d/2,center:c,size:d}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,s=i.length;let o=0;for(;o<s;++o)this.getParsed(o)[t.axis]!==null&&!i[o].hidden&&i[o].draw(this._ctx)}}function qu(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Pb{static override(e){Object.assign(Pb.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return qu()}parse(){return qu()}format(){return qu()}add(){return qu()}diff(){return qu()}startOf(){return qu()}endOf(){return qu()}}var _9={_date:Pb};function x9(n,e,t,i){const{controller:s,data:o,_sorted:l}=n,c=s._cachedMeta.iScale,d=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(c&&e===c.axis&&e!=="r"&&l&&o.length){const f=c._reversePixels?W7:Q2;if(i){if(s._sharedOptions){const p=o[0],v=typeof p.getRange=="function"&&p.getRange(e);if(v){const _=f(o,e,t-v),b=f(o,e,t+v);return{lo:_.lo,hi:b.hi}}}}else{const p=f(o,e,t);if(d){const{vScale:v}=s._cachedMeta,{_parsed:_}=n,b=_.slice(0,p.lo+1).reverse().findIndex(C=>!Hi(C[v.axis]));p.lo-=Math.max(0,b);const T=_.slice(p.hi).findIndex(C=>!Hi(C[v.axis]));p.hi+=Math.max(0,T)}return p}}return{lo:0,hi:o.length-1}}function s1(n,e,t,i,s){const o=n.getSortedVisibleDatasetMetas(),l=t[e];for(let c=0,d=o.length;c<d;++c){const{index:f,data:p}=o[c],{lo:v,hi:_}=x9(o[c],e,l,s);for(let b=v;b<=_;++b){const T=p[b];T.skip||i(T,f,b)}}}function S9(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(i,s){const o=e?Math.abs(i.x-s.x):0,l=t?Math.abs(i.y-s.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(l,2))}}function Yy(n,e,t,i,s){const o=[];return!s&&!n.isPointInArea(e)||s1(n,t,e,function(c,d,f){!s&&!Mm(c,n.chartArea,0)||c.inRange(e.x,e.y,i)&&o.push({element:c,datasetIndex:d,index:f})},!0),o}function N9(n,e,t,i){let s=[];function o(l,c,d){const{startAngle:f,endAngle:p}=l.getProps(["startAngle","endAngle"],i),{angle:v}=F7(l,{x:e.x,y:e.y});pT(v,f,p)&&s.push({element:l,datasetIndex:c,index:d})}return s1(n,t,e,o),s}function E9(n,e,t,i,s,o){let l=[];const c=S9(t);let d=Number.POSITIVE_INFINITY;function f(p,v,_){const b=p.inRange(e.x,e.y,s);if(i&&!b)return;const T=p.getCenterPoint(s);if(!(!!o||n.isPointInArea(T))&&!b)return;const A=c(e,T);A<d?(l=[{element:p,datasetIndex:v,index:_}],d=A):A===d&&l.push({element:p,datasetIndex:v,index:_})}return s1(n,t,e,f),l}function Gy(n,e,t,i,s,o){return!o&&!n.isPointInArea(e)?[]:t==="r"&&!i?N9(n,e,t,s):E9(n,e,t,i,s,o)}function gS(n,e,t,i,s){const o=[],l=t==="x"?"inXRange":"inYRange";let c=!1;return s1(n,t,e,(d,f,p)=>{d[l]&&d[l](e[t],s)&&(o.push({element:d,datasetIndex:f,index:p}),c=c||d.inRange(e.x,e.y,s))}),i&&!c?[]:o}var T9={modes:{index(n,e,t,i){const s=Ku(e,n),o=t.axis||"x",l=t.includeInvisible||!1,c=t.intersect?Yy(n,s,o,i,l):Gy(n,s,o,!1,i,l),d=[];return c.length?(n.getSortedVisibleDatasetMetas().forEach(f=>{const p=c[0].index,v=f.data[p];v&&!v.skip&&d.push({element:v,datasetIndex:f.index,index:p})}),d):[]},dataset(n,e,t,i){const s=Ku(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;let c=t.intersect?Yy(n,s,o,i,l):Gy(n,s,o,!1,i,l);if(c.length>0){const d=c[0].datasetIndex,f=n.getDatasetMeta(d).data;c=[];for(let p=0;p<f.length;++p)c.push({element:f[p],datasetIndex:d,index:p})}return c},point(n,e,t,i){const s=Ku(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;return Yy(n,s,o,i,l)},nearest(n,e,t,i){const s=Ku(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;return Gy(n,s,o,t.intersect,i,l)},x(n,e,t,i){const s=Ku(e,n);return gS(n,s,"x",t.intersect,i)},y(n,e,t,i){const s=Ku(e,n);return gS(n,s,"y",t.intersect,i)}}};const PT=["left","top","right","bottom"];function zf(n,e){return n.filter(t=>t.pos===e)}function yS(n,e){return n.filter(t=>PT.indexOf(t.pos)===-1&&t.box.axis===e)}function Hf(n,e){return n.sort((t,i)=>{const s=e?i:t,o=e?t:i;return s.weight===o.weight?s.index-o.index:s.weight-o.weight})}function C9(n){const e=[];let t,i,s,o,l,c;for(t=0,i=(n||[]).length;t<i;++t)s=n[t],{position:o,options:{stack:l,stackWeight:c=1}}=s,e.push({index:t,box:s,pos:o,horizontal:s.isHorizontal(),weight:s.weight,stack:l&&o+l,stackWeight:c});return e}function k9(n){const e={};for(const t of n){const{stack:i,pos:s,stackWeight:o}=t;if(!i||!PT.includes(s))continue;const l=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=o}return e}function L9(n,e){const t=k9(n),{vBoxMaxWidth:i,hBoxMaxHeight:s}=e;let o,l,c;for(o=0,l=n.length;o<l;++o){c=n[o];const{fullSize:d}=c.box,f=t[c.stack],p=f&&c.stackWeight/f.weight;c.horizontal?(c.width=p?p*i:d&&e.availableWidth,c.height=s):(c.width=i,c.height=p?p*s:d&&e.availableHeight)}return t}function A9(n){const e=C9(n),t=Hf(e.filter(f=>f.box.fullSize),!0),i=Hf(zf(e,"left"),!0),s=Hf(zf(e,"right")),o=Hf(zf(e,"top"),!0),l=Hf(zf(e,"bottom")),c=yS(e,"x"),d=yS(e,"y");return{fullSize:t,leftAndTop:i.concat(o),rightAndBottom:s.concat(d).concat(l).concat(c),chartArea:zf(e,"chartArea"),vertical:i.concat(s).concat(d),horizontal:o.concat(l).concat(c)}}function vS(n,e,t,i){return Math.max(n[t],e[t])+Math.max(n[i],e[i])}function UT(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function D9(n,e,t,i){const{pos:s,box:o}=t,l=n.maxPadding;if(!wi(s)){t.size&&(n[s]-=t.size);const v=i[t.stack]||{size:0,count:1};v.size=Math.max(v.size,t.horizontal?o.height:o.width),t.size=v.size/v.count,n[s]+=t.size}o.getPadding&&UT(l,o.getPadding());const c=Math.max(0,e.outerWidth-vS(l,n,"left","right")),d=Math.max(0,e.outerHeight-vS(l,n,"top","bottom")),f=c!==n.w,p=d!==n.h;return n.w=c,n.h=d,t.horizontal?{same:f,other:p}:{same:p,other:f}}function O9(n){const e=n.maxPadding;function t(i){const s=Math.max(e[i]-n[i],0);return n[i]+=s,s}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function j9(n,e){const t=e.maxPadding;function i(s){const o={left:0,top:0,right:0,bottom:0};return s.forEach(l=>{o[l]=Math.max(e[l],t[l])}),o}return i(n?["left","right"]:["top","bottom"])}function Zf(n,e,t,i){const s=[];let o,l,c,d,f,p;for(o=0,l=n.length,f=0;o<l;++o){c=n[o],d=c.box,d.update(c.width||e.w,c.height||e.h,j9(c.horizontal,e));const{same:v,other:_}=D9(e,t,c,i);f|=v&&s.length,p=p||_,d.fullSize||s.push(c)}return f&&Zf(s,e,t,i)||p}function xg(n,e,t,i,s){n.top=t,n.left=e,n.right=e+i,n.bottom=t+s,n.width=i,n.height=s}function bS(n,e,t,i){const s=t.padding;let{x:o,y:l}=e;for(const c of n){const d=c.box,f=i[c.stack]||{placed:0,weight:1},p=c.stackWeight/f.weight||1;if(c.horizontal){const v=e.w*p,_=f.size||d.height;jm(f.start)&&(l=f.start),d.fullSize?xg(d,s.left,l,t.outerWidth-s.right-s.left,_):xg(d,e.left+f.placed,l,v,_),f.start=l,f.placed+=v,l=d.bottom}else{const v=e.h*p,_=f.size||d.width;jm(f.start)&&(o=f.start),d.fullSize?xg(d,o,s.top,_,t.outerHeight-s.bottom-s.top):xg(d,o,e.top+f.placed,_,v),f.start=o,f.placed+=v,o=d.right}}e.x=o,e.y=l}var ya={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,i){if(!n)return;const s=xa(n.options.layout.padding),o=Math.max(e-s.width,0),l=Math.max(t-s.height,0),c=A9(n.boxes),d=c.vertical,f=c.horizontal;Ai(n.boxes,C=>{typeof C.beforeLayout=="function"&&C.beforeLayout()});const p=d.reduce((C,A)=>A.box.options&&A.box.options.display===!1?C:C+1,0)||1,v=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:o,availableHeight:l,vBoxMaxWidth:o/2/p,hBoxMaxHeight:l/2}),_=Object.assign({},s);UT(_,xa(i));const b=Object.assign({maxPadding:_,w:o,h:l,x:s.left,y:s.top},s),T=L9(d.concat(f),v);Zf(c.fullSize,b,v,T),Zf(d,b,v,T),Zf(f,b,v,T)&&Zf(d,b,v,T),O9(b),bS(c.leftAndTop,b,v,T),b.x+=b.w,b.y+=b.h,bS(c.rightAndBottom,b,v,T),n.chartArea={left:b.left,top:b.top,right:b.left+b.w,bottom:b.top+b.h,height:b.h,width:b.w},Ai(c.chartArea,C=>{const A=C.box;Object.assign(A,n.chartArea),A.update(b.w,b.h,{left:0,top:0,right:0,bottom:0})})}};class FT{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,s){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):i)}}isAttached(e){return!0}updateConfig(e){}}class M9 extends FT{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const zg="$chartjs",R9={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},wS=n=>n===null||n==="";function I9(n,e){const t=n.style,i=n.getAttribute("height"),s=n.getAttribute("width");if(n[zg]={initial:{height:i,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",wS(s)){const o=iS(n,"width");o!==void 0&&(n.width=o)}if(wS(i))if(n.style.height==="")n.height=n.width/(e||2);else{const o=iS(n,"height");o!==void 0&&(n.height=o)}return n}const $T=RP?{passive:!0}:!1;function P9(n,e,t){n&&n.addEventListener(e,t,$T)}function U9(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,$T)}function F9(n,e){const t=R9[n.type]||n.type,{x:i,y:s}=Ku(n,e);return{type:t,chart:e,native:n,x:i!==void 0?i:null,y:s!==void 0?s:null}}function O0(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function $9(n,e,t){const i=n.canvas,s=new MutationObserver(o=>{let l=!1;for(const c of o)l=l||O0(c.addedNodes,i),l=l&&!O0(c.removedNodes,i);l&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function B9(n,e,t){const i=n.canvas,s=new MutationObserver(o=>{let l=!1;for(const c of o)l=l||O0(c.removedNodes,i),l=l&&!O0(c.addedNodes,i);l&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const Im=new Map;let _S=0;function BT(){const n=window.devicePixelRatio;n!==_S&&(_S=n,Im.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function W9(n,e){Im.size||window.addEventListener("resize",BT),Im.set(n,e)}function z9(n){Im.delete(n),Im.size||window.removeEventListener("resize",BT)}function H9(n,e,t){const i=n.canvas,s=i&&Ib(i);if(!s)return;const o=bT((c,d)=>{const f=s.clientWidth;t(c,d),f<s.clientWidth&&t()},window),l=new ResizeObserver(c=>{const d=c[0],f=d.contentRect.width,p=d.contentRect.height;f===0&&p===0||o(f,p)});return l.observe(s),W9(n,o),l}function Ky(n,e,t){t&&t.disconnect(),e==="resize"&&z9(n)}function q9(n,e,t){const i=n.canvas,s=bT(o=>{n.ctx!==null&&t(F9(o,n))},n);return P9(i,e,s),s}class V9 extends FT{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(I9(e,t),i):null}releaseContext(e){const t=e.canvas;if(!t[zg])return!1;const i=t[zg].initial;["height","width"].forEach(o=>{const l=i[o];Hi(l)?t.removeAttribute(o):t.setAttribute(o,l)});const s=i.style||{};return Object.keys(s).forEach(o=>{t.style[o]=s[o]}),t.width=t.width,delete t[zg],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),l={attach:$9,detach:B9,resize:H9}[t]||q9;s[t]=l(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),s=i[t];if(!s)return;({attach:Ky,detach:Ky,resize:Ky}[t]||U9)(e,t,s),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,s){return MP(e,t,i,s)}isAttached(e){const t=e&&Ib(e);return!!(t&&t.isConnected)}}function Y9(n){return!Rb()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?M9:V9}class _u{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return L0(this.x)&&L0(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const s={};return e.forEach(o=>{s[o]=i[o]&&i[o].active()?i[o]._to:this[o]}),s}}function G9(n,e){const t=n.options.ticks,i=K9(n),s=Math.min(t.maxTicksLimit||i,i),o=t.major.enabled?Q9(e):[],l=o.length,c=o[0],d=o[l-1],f=[];if(l>s)return Z9(e,f,o,l/s),f;const p=X9(o,e,s);if(l>0){let v,_;const b=l>1?Math.round((d-c)/(l-1)):null;for(Sg(e,f,p,Hi(b)?0:c-b,c),v=0,_=l-1;v<_;v++)Sg(e,f,p,o[v],o[v+1]);return Sg(e,f,p,d,Hi(b)?e.length:d+b),f}return Sg(e,f,p),f}function K9(n){const e=n.options.offset,t=n._tickSize(),i=n._length/t+(e?0:1),s=n._maxLength/t;return Math.floor(Math.min(i,s))}function X9(n,e,t){const i=J9(n),s=e.length/t;if(!i)return Math.max(s,1);const o=M7(i);for(let l=0,c=o.length-1;l<c;l++){const d=o[l];if(d>s)return d}return Math.max(s,1)}function Q9(n){const e=[];let t,i;for(t=0,i=n.length;t<i;t++)n[t].major&&e.push(t);return e}function Z9(n,e,t,i){let s=0,o=t[0],l;for(i=Math.ceil(i),l=0;l<n.length;l++)l===o&&(e.push(n[l]),s++,o=t[s*i])}function Sg(n,e,t,i,s){const o=si(i,0),l=Math.min(si(s,n.length),n.length);let c=0,d,f,p;for(t=Math.ceil(t),s&&(d=s-i,t=d/Math.floor(d/t)),p=o;p<0;)c++,p=Math.round(o+c*t);for(f=Math.max(o,0);f<l;f++)f===p&&(e.push(n[f]),c++,p=Math.round(o+c*t))}function J9(n){const e=n.length;let t,i;if(e<2)return!1;for(i=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==i)return!1;return i}const eU=n=>n==="left"?"right":n==="right"?"left":n,xS=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,SS=(n,e)=>Math.min(e||n,n);function NS(n,e){const t=[],i=n.length/e,s=n.length;let o=0;for(;o<s;o+=i)t.push(n[Math.floor(o)]);return t}function tU(n,e,t){const i=n.ticks.length,s=Math.min(e,i-1),o=n._startPixel,l=n._endPixel,c=1e-6;let d=n.getPixelForTick(s),f;if(!(t&&(i===1?f=Math.max(d-o,l-d):e===0?f=(n.getPixelForTick(1)-d)/2:f=(d-n.getPixelForTick(s-1))/2,d+=s<e?f:-f,d<o-c||d>l+c)))return d}function nU(n,e){Ai(n,t=>{const i=t.gc,s=i.length/2;let o;if(s>e){for(o=0;o<s;++o)delete t.data[i[o]];i.splice(0,s)}})}function qf(n){return n.drawTicks?n.tickLength:0}function ES(n,e){if(!n.display)return 0;const t=Ko(n.font,e),i=xa(n.padding);return(to(n.text)?n.text.length:1)*t.lineHeight+i.height}function iU(n,e){return Ed(n,{scale:e,type:"scale"})}function sU(n,e,t){return Ed(n,{tick:t,index:e,type:"tick"})}function oU(n,e,t){let i=kb(n);return(t&&e!=="right"||!t&&e==="right")&&(i=eU(i)),i}function rU(n,e,t,i){const{top:s,left:o,bottom:l,right:c,chart:d}=n,{chartArea:f,scales:p}=d;let v=0,_,b,T;const C=l-s,A=c-o;if(n.isHorizontal()){if(b=Yo(i,o,c),wi(t)){const I=Object.keys(t)[0],ee=t[I];T=p[I].getPixelForValue(ee)+C-e}else t==="center"?T=(f.bottom+f.top)/2+C-e:T=xS(n,t,e);_=c-o}else{if(wi(t)){const I=Object.keys(t)[0],ee=t[I];b=p[I].getPixelForValue(ee)-A+e}else t==="center"?b=(f.left+f.right)/2-A+e:b=xS(n,t,e);T=Yo(i,l,s),v=t==="left"?-Ga:Ga}return{titleX:b,titleY:T,maxWidth:_,rotation:v}}class Wh extends _u{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:s}=this;return e=pl(e,Number.POSITIVE_INFINITY),t=pl(t,Number.NEGATIVE_INFINITY),i=pl(i,Number.POSITIVE_INFINITY),s=pl(s,Number.NEGATIVE_INFINITY),{min:pl(e,i),max:pl(t,s),minDefined:_a(e),maxDefined:_a(t)}}getMinMax(e){let{min:t,max:i,minDefined:s,maxDefined:o}=this.getUserBounds(),l;if(s&&o)return{min:t,max:i};const c=this.getMatchingVisibleMetas();for(let d=0,f=c.length;d<f;++d)l=c[d].controller.getMinMax(this,e),s||(t=Math.min(t,l.min)),o||(i=Math.max(i,l.max));return t=o&&t>i?i:t,i=s&&t>i?t:i,{min:pl(t,pl(i,t)),max:pl(i,pl(t,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ji(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:s,grace:o,ticks:l}=this.options,c=l.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=hP(this,o,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const d=c<this.ticks.length;this._convertTicksToLabels(d?NS(this.ticks,c):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=G9(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),d&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,i;this.isHorizontal()?(t=this.left,i=this.right):(t=this.top,i=this.bottom,e=!e),this._startPixel=t,this._endPixel=i,this._reversePixels=e,this._length=i-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ji(this.options.afterUpdate,[this])}beforeSetDimensions(){Ji(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ji(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Ji(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ji(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,s,o;for(i=0,s=e.length;i<s;i++)o=e[i],o.label=Ji(t.callback,[o.value,i,e],this)}afterTickToLabelConversion(){Ji(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ji(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=SS(this.ticks.length,e.ticks.maxTicksLimit),s=t.minRotation||0,o=t.maxRotation;let l=s,c,d,f;if(!this._isVisible()||!t.display||s>=o||i<=1||!this.isHorizontal()){this.labelRotation=s;return}const p=this._getLabelSizes(),v=p.widest.width,_=p.highest.height,b=Ka(this.chart.width-v,0,this.maxWidth);c=e.offset?this.maxWidth/i:b/(i-1),v+6>c&&(c=b/(i-(e.offset?.5:1)),d=this.maxHeight-qf(e.grid)-t.padding-ES(e.title,this.chart.options.font),f=Math.sqrt(v*v+_*_),l=U7(Math.min(Math.asin(Ka((p.highest.height+6)/c,-1,1)),Math.asin(Ka(d/f,-1,1))-Math.asin(Ka(_/f,-1,1)))),l=Math.max(s,Math.min(o,l))),this.labelRotation=l}afterCalculateLabelRotation(){Ji(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ji(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:i,title:s,grid:o}}=this,l=this._isVisible(),c=this.isHorizontal();if(l){const d=ES(s,t.options.font);if(c?(e.width=this.maxWidth,e.height=qf(o)+d):(e.height=this.maxHeight,e.width=qf(o)+d),i.display&&this.ticks.length){const{first:f,last:p,widest:v,highest:_}=this._getLabelSizes(),b=i.padding*2,T=od(this.labelRotation),C=Math.cos(T),A=Math.sin(T);if(c){const I=i.mirror?0:A*v.width+C*_.height;e.height=Math.min(this.maxHeight,e.height+I+b)}else{const I=i.mirror?0:C*v.width+A*_.height;e.width=Math.min(this.maxWidth,e.width+I+b)}this._calculatePadding(f,p,A,C)}}this._handleMargins(),c?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,i,s){const{ticks:{align:o,padding:l},position:c}=this.options,d=this.labelRotation!==0,f=c!=="top"&&this.axis==="x";if(this.isHorizontal()){const p=this.getPixelForTick(0)-this.left,v=this.right-this.getPixelForTick(this.ticks.length-1);let _=0,b=0;d?f?(_=s*e.width,b=i*t.height):(_=i*e.height,b=s*t.width):o==="start"?b=t.width:o==="end"?_=e.width:o!=="inner"&&(_=e.width/2,b=t.width/2),this.paddingLeft=Math.max((_-p+l)*this.width/(this.width-p),0),this.paddingRight=Math.max((b-v+l)*this.width/(this.width-v),0)}else{let p=t.height/2,v=e.height/2;o==="start"?(p=0,v=e.height):o==="end"&&(p=t.height,v=0),this.paddingTop=p+l,this.paddingBottom=v+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ji(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,i;for(t=0,i=e.length;t<i;t++)Hi(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let i=this.ticks;t<i.length&&(i=NS(i,t)),this._labelSizes=e=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,i){const{ctx:s,_longestTextCache:o}=this,l=[],c=[],d=Math.floor(t/SS(t,i));let f=0,p=0,v,_,b,T,C,A,I,ee,G,K,de;for(v=0;v<t;v+=d){if(T=e[v].label,C=this._resolveTickFontOptions(v),s.font=A=C.string,I=o[A]=o[A]||{data:{},gc:[]},ee=C.lineHeight,G=K=0,!Hi(T)&&!to(T))G=Zx(s,I.data,I.gc,G,T),K=ee;else if(to(T))for(_=0,b=T.length;_<b;++_)de=T[_],!Hi(de)&&!to(de)&&(G=Zx(s,I.data,I.gc,G,de),K+=ee);l.push(G),c.push(K),f=Math.max(G,f),p=Math.max(K,p)}nU(o,t);const le=l.indexOf(f),z=c.indexOf(p),R=D=>({width:l[D]||0,height:c[D]||0});return{first:R(0),last:R(t-1),widest:R(le),highest:R(z),widths:l,heights:c}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return B7(this._alignToPixels?Hu(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const i=t[e];return i.$context||(i.$context=sU(this.getContext(),e,i))}return this.$context||(this.$context=iU(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=od(this.labelRotation),i=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),o=this._getLabelSizes(),l=e.autoSkipPadding||0,c=o?o.widest.width+l:0,d=o?o.highest.height+l:0;return this.isHorizontal()?d*i>c*s?c/i:d/s:d*s<c*i?d/i:c/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,s=this.options,{grid:o,position:l,border:c}=s,d=o.offset,f=this.isHorizontal(),v=this.ticks.length+(d?1:0),_=qf(o),b=[],T=c.setContext(this.getContext()),C=T.display?T.width:0,A=C/2,I=function(q){return Hu(i,q,C)};let ee,G,K,de,le,z,R,D,F,E,O,M;if(l==="top")ee=I(this.bottom),z=this.bottom-_,D=ee-A,E=I(e.top)+A,M=e.bottom;else if(l==="bottom")ee=I(this.top),E=e.top,M=I(e.bottom)-A,z=ee+A,D=this.top+_;else if(l==="left")ee=I(this.right),le=this.right-_,R=ee-A,F=I(e.left)+A,O=e.right;else if(l==="right")ee=I(this.left),F=e.left,O=I(e.right)-A,le=ee+A,R=this.left+_;else if(t==="x"){if(l==="center")ee=I((e.top+e.bottom)/2+.5);else if(wi(l)){const q=Object.keys(l)[0],re=l[q];ee=I(this.chart.scales[q].getPixelForValue(re))}E=e.top,M=e.bottom,z=ee+A,D=z+_}else if(t==="y"){if(l==="center")ee=I((e.left+e.right)/2);else if(wi(l)){const q=Object.keys(l)[0],re=l[q];ee=I(this.chart.scales[q].getPixelForValue(re))}le=ee-A,R=le-_,F=e.left,O=e.right}const Y=si(s.ticks.maxTicksLimit,v),ie=Math.max(1,Math.ceil(v/Y));for(G=0;G<v;G+=ie){const q=this.getContext(G),re=o.setContext(q),V=c.setContext(q),se=re.lineWidth,W=re.color,te=V.dash||[],j=V.dashOffset,U=re.tickWidth,$=re.tickColor,X=re.tickBorderDash||[],Q=re.tickBorderDashOffset;K=tU(this,G,d),K!==void 0&&(de=Hu(i,K,se),f?le=R=F=O=de:z=D=E=M=de,b.push({tx1:le,ty1:z,tx2:R,ty2:D,x1:F,y1:E,x2:O,y2:M,width:se,color:W,borderDash:te,borderDashOffset:j,tickWidth:U,tickColor:$,tickBorderDash:X,tickBorderDashOffset:Q}))}return this._ticksLength=v,this._borderValue=ee,b}_computeLabelItems(e){const t=this.axis,i=this.options,{position:s,ticks:o}=i,l=this.isHorizontal(),c=this.ticks,{align:d,crossAlign:f,padding:p,mirror:v}=o,_=qf(i.grid),b=_+p,T=v?-p:b,C=-od(this.labelRotation),A=[];let I,ee,G,K,de,le,z,R,D,F,E,O,M="middle";if(s==="top")le=this.bottom-T,z=this._getXAxisLabelAlignment();else if(s==="bottom")le=this.top+T,z=this._getXAxisLabelAlignment();else if(s==="left"){const ie=this._getYAxisLabelAlignment(_);z=ie.textAlign,de=ie.x}else if(s==="right"){const ie=this._getYAxisLabelAlignment(_);z=ie.textAlign,de=ie.x}else if(t==="x"){if(s==="center")le=(e.top+e.bottom)/2+b;else if(wi(s)){const ie=Object.keys(s)[0],q=s[ie];le=this.chart.scales[ie].getPixelForValue(q)+b}z=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")de=(e.left+e.right)/2-b;else if(wi(s)){const ie=Object.keys(s)[0],q=s[ie];de=this.chart.scales[ie].getPixelForValue(q)}z=this._getYAxisLabelAlignment(_).textAlign}t==="y"&&(d==="start"?M="top":d==="end"&&(M="bottom"));const Y=this._getLabelSizes();for(I=0,ee=c.length;I<ee;++I){G=c[I],K=G.label;const ie=o.setContext(this.getContext(I));R=this.getPixelForTick(I)+o.labelOffset,D=this._resolveTickFontOptions(I),F=D.lineHeight,E=to(K)?K.length:1;const q=E/2,re=ie.color,V=ie.textStrokeColor,se=ie.textStrokeWidth;let W=z;l?(de=R,z==="inner"&&(I===ee-1?W=this.options.reverse?"left":"right":I===0?W=this.options.reverse?"right":"left":W="center"),s==="top"?f==="near"||C!==0?O=-E*F+F/2:f==="center"?O=-Y.highest.height/2-q*F+F:O=-Y.highest.height+F/2:f==="near"||C!==0?O=F/2:f==="center"?O=Y.highest.height/2-q*F:O=Y.highest.height-E*F,v&&(O*=-1),C!==0&&!ie.showLabelBackdrop&&(de+=F/2*Math.sin(C))):(le=R,O=(1-E)*F/2);let te;if(ie.showLabelBackdrop){const j=xa(ie.backdropPadding),U=Y.heights[I],$=Y.widths[I];let X=O-j.top,Q=0-j.left;switch(M){case"middle":X-=U/2;break;case"bottom":X-=U;break}switch(z){case"center":Q-=$/2;break;case"right":Q-=$;break;case"inner":I===ee-1?Q-=$:I>0&&(Q-=$/2);break}te={left:Q,top:X,width:$+j.width,height:U+j.height,color:ie.backdropColor}}A.push({label:K,font:D,textOffset:O,options:{rotation:C,color:re,strokeColor:V,strokeWidth:se,textAlign:W,textBaseline:M,translation:[de,le],backdrop:te}})}return A}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-od(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:s,padding:o}}=this.options,l=this._getLabelSizes(),c=e+o,d=l.widest.width;let f,p;return t==="left"?s?(p=this.right+o,i==="near"?f="left":i==="center"?(f="center",p+=d/2):(f="right",p+=d)):(p=this.right-c,i==="near"?f="right":i==="center"?(f="center",p-=d/2):(f="left",p=this.left)):t==="right"?s?(p=this.left+o,i==="near"?f="right":i==="center"?(f="center",p-=d/2):(f="left",p-=d)):(p=this.left+c,i==="near"?f="left":i==="center"?(f="center",p+=d/2):(f="right",p=this.right)):f="right",{textAlign:f,x:p}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:s,width:o,height:l}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,s,o,l),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(o=>o.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,i=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,l;const c=(d,f,p)=>{!p.width||!p.color||(i.save(),i.lineWidth=p.width,i.strokeStyle=p.color,i.setLineDash(p.borderDash||[]),i.lineDashOffset=p.borderDashOffset,i.beginPath(),i.moveTo(d.x,d.y),i.lineTo(f.x,f.y),i.stroke(),i.restore())};if(t.display)for(o=0,l=s.length;o<l;++o){const d=s[o];t.drawOnChartArea&&c({x:d.x1,y:d.y1},{x:d.x2,y:d.y2},d),t.drawTicks&&c({x:d.tx1,y:d.ty1},{x:d.tx2,y:d.ty2},{color:d.tickColor,width:d.tickWidth,borderDash:d.tickBorderDash,borderDashOffset:d.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:i,grid:s}}=this,o=i.setContext(this.getContext()),l=i.display?o.width:0;if(!l)return;const c=s.setContext(this.getContext(0)).lineWidth,d=this._borderValue;let f,p,v,_;this.isHorizontal()?(f=Hu(e,this.left,l)-l/2,p=Hu(e,this.right,c)+c/2,v=_=d):(v=Hu(e,this.top,l)-l/2,_=Hu(e,this.bottom,c)+c/2,f=p=d),t.save(),t.lineWidth=o.width,t.strokeStyle=o.color,t.beginPath(),t.moveTo(f,v),t.lineTo(p,_),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,s=this._computeLabelArea();s&&Ab(i,s);const o=this.getLabelItems(e);for(const l of o){const c=l.options,d=l.font,f=l.label,p=l.textOffset;Rm(i,f,0,p,d,c)}s&&Db(i)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:s}}=this;if(!i.display)return;const o=Ko(i.font),l=xa(i.padding),c=i.align;let d=o.lineHeight/2;t==="bottom"||t==="center"||wi(t)?(d+=l.bottom,to(i.text)&&(d+=o.lineHeight*(i.text.length-1))):d+=l.top;const{titleX:f,titleY:p,maxWidth:v,rotation:_}=rU(this,d,t,c);Rm(e,i.text,0,0,o,{color:i.color,maxWidth:v,rotation:_,textAlign:oU(c,t,s),textBaseline:"middle",translation:[f,p]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=si(e.grid&&e.grid.z,-1),s=si(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Wh.prototype.draw?[{z:t,draw:o=>{this.draw(o)}}]:[{z:i,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:t,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",s=[];let o,l;for(o=0,l=t.length;o<l;++o){const c=t[o];c[i]===this.id&&(!e||c.type===e)&&s.push(c)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Ko(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Ng{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;cU(t)&&(i=this.register(t));const s=this.items,o=e.id,l=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in s||(s[o]=e,aU(e,l,i),this.override&&Fs.override(e.id,e.overrides)),l}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,s=this.scope;i in t&&delete t[i],s&&i in Fs[s]&&(delete Fs[s][i],this.override&&delete bd[i])}}function aU(n,e,t){const i=Om(Object.create(null),[t?Fs.get(t):{},Fs.get(e),n.defaults]);Fs.set(e,i),n.defaultRoutes&&lU(e,n.defaultRoutes),n.descriptors&&Fs.describe(e,n.descriptors)}function lU(n,e){Object.keys(e).forEach(t=>{const i=t.split("."),s=i.pop(),o=[n].concat(i).join("."),l=e[t].split("."),c=l.pop(),d=l.join(".");Fs.route(o,s,d,c)})}function cU(n){return"id"in n&&"defaults"in n}class uU{constructor(){this.controllers=new Ng(RT,"datasets",!0),this.elements=new Ng(_u,"elements"),this.plugins=new Ng(Object,"plugins"),this.scales=new Ng(Wh,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(s=>{const o=i||this._getRegistryForType(s);i||o.isForType(s)||o===this.plugins&&s.id?this._exec(e,o,s):Ai(s,l=>{const c=i||this._getRegistryForType(l);this._exec(e,c,l)})})}_exec(e,t,i){const s=Tb(e);Ji(i["before"+s],[],i),t[e](i),Ji(i["after"+s],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return s}}var bl=new uU;class dU{constructor(){this._init=[]}notify(e,t,i,s){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const o=s?this._descriptors(e).filter(s):this._descriptors(e),l=this._notify(o,e,t,i);return t==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall")),l}_notify(e,t,i,s){s=s||{};for(const o of e){const l=o.plugin,c=l[i],d=[t,s,o.options];if(Ji(c,d,l)===!1&&s.cancelable)return!1}return!0}invalidate(){Hi(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,s=si(i.options&&i.options.plugins,{}),o=hU(i);return s===!1&&!t?[]:mU(e,o,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,s=(o,l)=>o.filter(c=>!l.some(d=>c.plugin.id===d.plugin.id));this._notify(s(t,i),e,"stop"),this._notify(s(i,t),e,"start")}}function hU(n){const e={},t=[],i=Object.keys(bl.plugins.items);for(let o=0;o<i.length;o++)t.push(bl.getPlugin(i[o]));const s=n.plugins||[];for(let o=0;o<s.length;o++){const l=s[o];t.indexOf(l)===-1&&(t.push(l),e[l.id]=!0)}return{plugins:t,localIds:e}}function fU(n,e){return!e&&n===!1?null:n===!0?{}:n}function mU(n,{plugins:e,localIds:t},i,s){const o=[],l=n.getContext();for(const c of e){const d=c.id,f=fU(i[d],s);f!==null&&o.push({plugin:c,options:pU(n.config,{plugin:c,local:t[d]},f,l)})}return o}function pU(n,{plugin:e,local:t},i,s){const o=n.pluginScopeKeys(e),l=n.getOptionScopes(i,o);return t&&e.defaults&&l.push(e.defaults),n.createResolver(l,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ev(n,e){const t=Fs.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function gU(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function yU(n,e){return n===e?"_index_":"_value_"}function TS(n){if(n==="x"||n==="y"||n==="r")return n}function vU(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function tv(n,...e){if(TS(n))return n;for(const t of e){const i=t.axis||vU(t.position)||n.length>1&&TS(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function CS(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function bU(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(t.length)return CS(n,"x",t[0])||CS(n,"y",t[0])}return{}}function wU(n,e){const t=bd[n.type]||{scales:{}},i=e.scales||{},s=ev(n.type,e),o=Object.create(null);return Object.keys(i).forEach(l=>{const c=i[l];if(!wi(c))return console.error(`Invalid scale configuration for scale: ${l}`);if(c._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const d=tv(l,c,bU(l,n),Fs.scales[c.type]),f=yU(d,s),p=t.scales||{};o[l]=dm(Object.create(null),[{axis:d},c,p[d],p[f]])}),n.data.datasets.forEach(l=>{const c=l.type||n.type,d=l.indexAxis||ev(c,e),p=(bd[c]||{}).scales||{};Object.keys(p).forEach(v=>{const _=gU(v,d),b=l[_+"AxisID"]||_;o[b]=o[b]||Object.create(null),dm(o[b],[{axis:_},i[b],p[v]])})}),Object.keys(o).forEach(l=>{const c=o[l];dm(c,[Fs.scales[c.type],Fs.scale])}),o}function WT(n){const e=n.options||(n.options={});e.plugins=si(e.plugins,{}),e.scales=wU(n,e)}function zT(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function _U(n){return n=n||{},n.data=zT(n.data),WT(n),n}const kS=new Map,HT=new Set;function Eg(n,e){let t=kS.get(n);return t||(t=e(),kS.set(n,t),HT.add(t)),t}const Vf=(n,e,t)=>{const i=jh(e,t);i!==void 0&&n.add(i)};class xU{constructor(e){this._config=_U(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=zT(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),WT(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Eg(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Eg(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Eg(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,i=this.type;return Eg(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let s=i.get(e);return(!s||t)&&(s=new Map,i.set(e,s)),s}getOptionScopes(e,t,i){const{options:s,type:o}=this,l=this._cachedScopes(e,i),c=l.get(t);if(c)return c;const d=new Set;t.forEach(p=>{e&&(d.add(e),p.forEach(v=>Vf(d,e,v))),p.forEach(v=>Vf(d,s,v)),p.forEach(v=>Vf(d,bd[o]||{},v)),p.forEach(v=>Vf(d,Fs,v)),p.forEach(v=>Vf(d,Z2,v))});const f=Array.from(d);return f.length===0&&f.push(Object.create(null)),HT.has(t)&&l.set(t,f),f}chartOptionScopes(){const{options:e,type:t}=this;return[e,bd[t]||{},Fs.datasets[t]||{},{type:t},Fs,Z2]}resolveNamedOptions(e,t,i,s=[""]){const o={$shared:!0},{resolver:l,subPrefixes:c}=LS(this._resolverCache,e,s);let d=l;if(NU(l,t)){o.$shared=!1,i=pu(i)?i():i;const f=this.createResolver(e,i,c);d=Mh(l,i,f)}for(const f of t)o[f]=d[f];return o}createResolver(e,t,i=[""],s){const{resolver:o}=LS(this._resolverCache,e,i);return wi(t)?Mh(o,t,void 0,s):o}}function LS(n,e,t){let i=n.get(e);i||(i=new Map,n.set(e,i));const s=t.join();let o=i.get(s);return o||(o={resolver:Ob(e,t),subPrefixes:t.filter(c=>!c.toLowerCase().includes("hover"))},i.set(s,o)),o}const SU=n=>wi(n)&&Object.getOwnPropertyNames(n).some(e=>pu(n[e]));function NU(n,e){const{isScriptable:t,isIndexable:i}=ET(n);for(const s of e){const o=t(s),l=i(s),c=(l||o)&&n[s];if(o&&(pu(c)||SU(c))||l&&to(c))return!0}return!1}var EU="4.5.0";const TU=["top","bottom","left","right","chartArea"];function AS(n,e){return n==="top"||n==="bottom"||TU.indexOf(n)===-1&&e==="x"}function DS(n,e){return function(t,i){return t[n]===i[n]?t[e]-i[e]:t[n]-i[n]}}function OS(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Ji(t&&t.onComplete,[n],e)}function CU(n){const e=n.chart,t=e.options.animation;Ji(t&&t.onProgress,[n],e)}function qT(n){return Rb()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Hg={},jS=n=>{const e=qT(n);return Object.values(Hg).filter(t=>t.canvas===e).pop()};function kU(n,e,t){const i=Object.keys(n);for(const s of i){const o=+s;if(o>=e){const l=n[s];delete n[s],(t>0||o>e)&&(n[o+t]=l)}}}function LU(n,e,t,i){return!t||n.type==="mouseout"?null:i?e:n}let op=class{static defaults=Fs;static instances=Hg;static overrides=bd;static registry=bl;static version=EU;static getChart=jS;static register(...e){bl.add(...e),MS()}static unregister(...e){bl.remove(...e),MS()}constructor(e,t){const i=this.config=new xU(t),s=qT(e),o=jS(s);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const l=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||Y9(s)),this.platform.updateConfig(i);const c=this.platform.acquireContext(s,l.aspectRatio),d=c&&c.canvas,f=d&&d.height,p=d&&d.width;if(this.id=E7(),this.ctx=c,this.canvas=d,this.width=p,this.height=f,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new dU,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=q7(v=>this.update(v),l.resizeDelay||0),this._dataChanges=[],Hg[this.id]=this,!c||!d){console.error("Failed to create chart: can't acquire context from the given item");return}Jl.listen(this,"complete",OS),Jl.listen(this,"progress",CU),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:s,_aspectRatio:o}=this;return Hi(e)?t&&o?o:s?i/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return bl}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():nS(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Jx(this.canvas,this.ctx),this}stop(){return Jl.stop(this),this}resize(e,t){Jl.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,s=this.canvas,o=i.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(s,e,t,o),c=i.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,nS(this,c,!0)&&(this.notifyPlugins("resize",{size:l}),Ji(i.onResize,[this,l],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};Ai(t,(i,s)=>{i.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,i=this.scales,s=Object.keys(i).reduce((l,c)=>(l[c]=!1,l),{});let o=[];t&&(o=o.concat(Object.keys(t).map(l=>{const c=t[l],d=tv(l,c),f=d==="r",p=d==="x";return{options:c,dposition:f?"chartArea":p?"bottom":"left",dtype:f?"radialLinear":p?"category":"linear"}}))),Ai(o,l=>{const c=l.options,d=c.id,f=tv(d,c),p=si(c.type,l.dtype);(c.position===void 0||AS(c.position,f)!==AS(l.dposition))&&(c.position=l.dposition),s[d]=!0;let v=null;if(d in i&&i[d].type===p)v=i[d];else{const _=bl.getScale(p);v=new _({id:d,type:p,ctx:this.ctx,chart:this}),i[v.id]=v}v.init(c,e)}),Ai(s,(l,c)=>{l||delete i[c]}),Ai(i,l=>{ya.configure(this,l,l.options),ya.addBox(this,l)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((s,o)=>s.index-o.index),i>t){for(let s=t;s<i;++s)this._destroyDatasetMeta(s);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(DS("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((i,s)=>{t.filter(o=>o===i._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let i,s;for(this._removeUnreferencedMetasets(),i=0,s=t.length;i<s;i++){const o=t[i];let l=this.getDatasetMeta(i);const c=o.type||this.config.type;if(l.type&&l.type!==c&&(this._destroyDatasetMeta(i),l=this.getDatasetMeta(i)),l.type=c,l.indexAxis=o.indexAxis||ev(c,this.options),l.order=o.order||0,l.index=i,l.label=""+o.label,l.visible=this.isDatasetVisible(i),l.controller)l.controller.updateIndex(i),l.controller.linkScales();else{const d=bl.getController(c),{datasetElementType:f,dataElementType:p}=Fs.datasets[c];Object.assign(d,{dataElementType:bl.getElement(p),datasetElementType:f&&bl.getElement(f)}),l.controller=new d(this,i),e.push(l.controller)}}return this._updateMetasets(),e}_resetElements(){Ai(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const i=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let f=0,p=this.data.datasets.length;f<p;f++){const{controller:v}=this.getDatasetMeta(f),_=!s&&o.indexOf(v)===-1;v.buildOrUpdateElements(_),l=Math.max(+v.getMaxOverflow(),l)}l=this._minPadding=i.layout.autoPadding?l:0,this._updateLayout(l),s||Ai(o,f=>{f.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(DS("z","_idx"));const{_active:c,_lastEvent:d}=this;d?this._eventHandler(d,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){Ai(this.scales,e=>{ya.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!zx(t,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:i,start:s,count:o}of t){const l=i==="_removeElements"?-o:o;kU(e,s,l)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=o=>new Set(e.filter(l=>l[0]===o).map((l,c)=>c+","+l.splice(1).join(","))),s=i(0);for(let o=1;o<t;o++)if(!zx(s,i(o)))return;return Array.from(s).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ya.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],Ai(this.boxes,s=>{i&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,o)=>{s._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,i=this.data.datasets.length;t<i;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,i=this.data.datasets.length;t<i;++t)this._updateDataset(t,pu(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),s={meta:i,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(i.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Jl.has(this)?this.attached&&!Jl.running(this)&&Jl.start(this):(this.draw(),OS({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let s,o;for(s=0,o=t.length;s<o;++s){const l=t[s];(!e||l.visible)&&i.push(l)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i={meta:e,index:e.index,cancelable:!0},s=KP(this,e);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(s&&Ab(t,s),e.controller.draw(),s&&Db(t),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(e){return Mm(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,s){const o=T9.modes[t];return typeof o=="function"?o(this,e,i,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let s=i.filter(o=>o&&o._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(s)),s}getContext(){return this.$context||(this.$context=Ed(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!t.hidden}setDatasetVisibility(e,t){const i=this.getDatasetMeta(e);i.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,i){const s=i?"show":"hide",o=this.getDatasetMeta(e),l=o.controller._resolveAnimations(void 0,s);jm(t)?(o.data[t].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),l.update(o,{visible:i}),this.update(c=>c.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Jl.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Jx(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Hg[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,i=(o,l)=>{t.addEventListener(this,o,l),e[o]=l},s=(o,l,c)=>{o.offsetX=l,o.offsetY=c,this._eventHandler(o)};Ai(this.options.events,o=>i(o,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,i=(d,f)=>{t.addEventListener(this,d,f),e[d]=f},s=(d,f)=>{e[d]&&(t.removeEventListener(this,d,f),delete e[d])},o=(d,f)=>{this.canvas&&this.resize(d,f)};let l;const c=()=>{s("attach",c),this.attached=!0,this.resize(),i("resize",o),i("detach",l)};l=()=>{this.attached=!1,s("resize",o),this._stop(),this._resize(0,0),i("attach",c)},t.isAttached(this.canvas)?c():l()}unbindEvents(){Ai(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},Ai(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const s=i?"set":"remove";let o,l,c,d;for(t==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+s+"DatasetHoverStyle"]()),c=0,d=e.length;c<d;++c){l=e[c];const f=l&&this.getDatasetMeta(l.datasetIndex).controller;f&&f[s+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:o,index:l})=>{const c=this.getDatasetMeta(o);if(!c)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:c.data[l],index:l}});!T0(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,i){const s=this.options.hover,o=(d,f)=>d.filter(p=>!f.some(v=>p.datasetIndex===v.datasetIndex&&p.index===v.index)),l=o(t,e),c=i?e:o(e,t);l.length&&this.updateHoverStyle(l,s.mode,!1),c.length&&s.mode&&this.updateHoverStyle(c,s.mode,!0)}_eventHandler(e,t){const i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=l=>(l.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,s)===!1)return;const o=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,s),(o||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:s=[],options:o}=this,l=t,c=this._getActiveElements(e,s,i,l),d=D7(e),f=LU(e,this._lastEvent,i,d);i&&(this._lastEvent=null,Ji(o.onHover,[e,c,this],this),d&&Ji(o.onClick,[e,c,this],this));const p=!T0(c,s);return(p||t)&&(this._active=c,this._updateHoverStyles(c,s,t)),this._lastEvent=f,p}_getActiveElements(e,t,i,s){if(e.type==="mouseout")return[];if(!i)return t;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,s)}};function MS(){return Ai(op.instances,n=>n._plugins.invalidate())}function VT(n,e,t=e){n.lineCap=si(t.borderCapStyle,e.borderCapStyle),n.setLineDash(si(t.borderDash,e.borderDash)),n.lineDashOffset=si(t.borderDashOffset,e.borderDashOffset),n.lineJoin=si(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=si(t.borderWidth,e.borderWidth),n.strokeStyle=si(t.borderColor,e.borderColor)}function AU(n,e,t){n.lineTo(t.x,t.y)}function DU(n){return n.stepped?iP:n.tension||n.cubicInterpolationMode==="monotone"?sP:AU}function YT(n,e,t={}){const i=n.length,{start:s=0,end:o=i-1}=t,{start:l,end:c}=e,d=Math.max(s,l),f=Math.min(o,c),p=s<l&&o<l||s>c&&o>c;return{count:i,start:d,loop:e.loop,ilen:f<d&&!p?i+f-d:f-d}}function OU(n,e,t,i){const{points:s,options:o}=e,{count:l,start:c,loop:d,ilen:f}=YT(s,t,i),p=DU(o);let{move:v=!0,reverse:_}=i||{},b,T,C;for(b=0;b<=f;++b)T=s[(c+(_?f-b:b))%l],!T.skip&&(v?(n.moveTo(T.x,T.y),v=!1):p(n,C,T,_,o.stepped),C=T);return d&&(T=s[(c+(_?f:0))%l],p(n,C,T,_,o.stepped)),!!d}function jU(n,e,t,i){const s=e.points,{count:o,start:l,ilen:c}=YT(s,t,i),{move:d=!0,reverse:f}=i||{};let p=0,v=0,_,b,T,C,A,I;const ee=K=>(l+(f?c-K:K))%o,G=()=>{C!==A&&(n.lineTo(p,A),n.lineTo(p,C),n.lineTo(p,I))};for(d&&(b=s[ee(0)],n.moveTo(b.x,b.y)),_=0;_<=c;++_){if(b=s[ee(_)],b.skip)continue;const K=b.x,de=b.y,le=K|0;le===T?(de<C?C=de:de>A&&(A=de),p=(v*p+K)/++v):(G(),n.lineTo(K,de),T=le,v=0,C=A=de),I=de}G()}function nv(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?jU:OU}function MU(n){return n.stepped?IP:n.tension||n.cubicInterpolationMode==="monotone"?PP:Xu}function RU(n,e,t,i){let s=e._path;s||(s=e._path=new Path2D,e.path(s,t,i)&&s.closePath()),VT(n,e.options),n.stroke(s)}function IU(n,e,t,i){const{segments:s,options:o}=e,l=nv(e);for(const c of s)VT(n,o,c.style),n.beginPath(),l(n,e,c,{start:t,end:t+i-1})&&n.closePath(),n.stroke()}const PU=typeof Path2D=="function";function UU(n,e,t,i){PU&&!e.options.segment?RU(n,e,t,i):IU(n,e,t,i)}class GT extends _u{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const s=i.spanGaps?this._loop:this._fullLoop;kP(this._points,i,e,s,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=qP(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(e,t){const i=this.options,s=e[t],o=this.points,l=WP(this,{property:t,start:s,end:s});if(!l.length)return;const c=[],d=MU(i);let f,p;for(f=0,p=l.length;f<p;++f){const{start:v,end:_}=l[f],b=o[v],T=o[_];if(b===T){c.push(b);continue}const C=Math.abs((s-b[t])/(T[t]-b[t])),A=d(b,T,C,i.stepped);A[t]=e[t],c.push(A)}return c.length===1?c[0]:c}pathSegment(e,t,i){return nv(this)(e,this,t,i)}path(e,t,i){const s=this.segments,o=nv(this);let l=this._loop;t=t||0,i=i||this.points.length-t;for(const c of s)l&=o(e,this,c,{start:t,end:t+i-1});return!!l}draw(e,t,i,s){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(e.save(),UU(e,this,i,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function RS(n,e,t,i){const s=n.options,{[t]:o}=n.getProps([t],i);return Math.abs(e-o)<s.radius+s.hitRadius}class KT extends _u{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,i){const s=this.options,{x:o,y:l}=this.getProps(["x","y"],i);return Math.pow(e-o,2)+Math.pow(t-l,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,t){return RS(this,e,"x",t)}inYRange(e,t){return RS(this,e,"y",t)}getCenterPoint(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const i=t&&e.borderWidth||0;return(t+i)*2}draw(e,t){const i=this.options;this.skip||i.radius<.1||!Mm(this,t,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,J2(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function XT(n,e){const{x:t,y:i,base:s,width:o,height:l}=n.getProps(["x","y","base","width","height"],e);let c,d,f,p,v;return n.horizontal?(v=l/2,c=Math.min(t,s),d=Math.max(t,s),f=i-v,p=i+v):(v=o/2,c=t-v,d=t+v,f=Math.min(i,s),p=Math.max(i,s)),{left:c,top:f,right:d,bottom:p}}function tu(n,e,t,i){return n?0:Ka(e,t,i)}function FU(n,e,t){const i=n.options.borderWidth,s=n.borderSkipped,o=NT(i);return{t:tu(s.top,o.top,0,t),r:tu(s.right,o.right,0,e),b:tu(s.bottom,o.bottom,0,t),l:tu(s.left,o.left,0,e)}}function $U(n,e,t){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,o=bh(s),l=Math.min(e,t),c=n.borderSkipped,d=i||wi(s);return{topLeft:tu(!d||c.top||c.left,o.topLeft,0,l),topRight:tu(!d||c.top||c.right,o.topRight,0,l),bottomLeft:tu(!d||c.bottom||c.left,o.bottomLeft,0,l),bottomRight:tu(!d||c.bottom||c.right,o.bottomRight,0,l)}}function BU(n){const e=XT(n),t=e.right-e.left,i=e.bottom-e.top,s=FU(n,t/2,i/2),o=$U(n,t/2,i/2);return{outer:{x:e.left,y:e.top,w:t,h:i,radius:o},inner:{x:e.left+s.l,y:e.top+s.t,w:t-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,o.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(s.b,s.r))}}}}function Xy(n,e,t,i){const s=e===null,o=t===null,c=n&&!(s&&o)&&XT(n,i);return c&&(s||rd(e,c.left,c.right))&&(o||rd(t,c.top,c.bottom))}function WU(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function zU(n,e){n.rect(e.x,e.y,e.w,e.h)}function Qy(n,e,t={}){const i=n.x!==t.x?-e:0,s=n.y!==t.y?-e:0,o=(n.x+n.w!==t.x+t.w?e:0)-i,l=(n.y+n.h!==t.y+t.h?e:0)-s;return{x:n.x+i,y:n.y+s,w:n.w+o,h:n.h+l,radius:n.radius}}class QT extends _u{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:s}}=this,{inner:o,outer:l}=BU(this),c=WU(l.radius)?A0:zU;e.save(),(l.w!==o.w||l.h!==o.h)&&(e.beginPath(),c(e,Qy(l,t,o)),e.clip(),c(e,Qy(o,-t,l)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),c(e,Qy(o,t)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,t,i){return Xy(this,e,t,i)}inXRange(e,t){return Xy(this,e,null,t)}inYRange(e,t){return Xy(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:s,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(t+s)/2:t,y:o?i:(i+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const IS=(n,e)=>{let{boxHeight:t=e,boxWidth:i=e}=n;return n.usePointStyle&&(t=Math.min(t,e),i=n.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:t,itemHeight:Math.max(e,t)}},HU=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class PS extends _u{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Ji(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(i=>e.filter(i,this.chart.data))),e.sort&&(t=t.sort((i,s)=>e.sort(i,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,s=Ko(i.font),o=s.size,l=this._computeTitleHeight(),{boxWidth:c,itemHeight:d}=IS(i,o);let f,p;t.font=s.string,this.isHorizontal()?(f=this.maxWidth,p=this._fitRows(l,o,c,d)+10):(p=this.maxHeight,f=this._fitCols(l,s,c,d)+10),this.width=Math.min(f,e.maxWidth||this.maxWidth),this.height=Math.min(p,e.maxHeight||this.maxHeight)}_fitRows(e,t,i,s){const{ctx:o,maxWidth:l,options:{labels:{padding:c}}}=this,d=this.legendHitBoxes=[],f=this.lineWidths=[0],p=s+c;let v=e;o.textAlign="left",o.textBaseline="middle";let _=-1,b=-p;return this.legendItems.forEach((T,C)=>{const A=i+t/2+o.measureText(T.text).width;(C===0||f[f.length-1]+A+2*c>l)&&(v+=p,f[f.length-(C>0?0:1)]=0,b+=p,_++),d[C]={left:0,top:b,row:_,width:A,height:s},f[f.length-1]+=A+c}),v}_fitCols(e,t,i,s){const{ctx:o,maxHeight:l,options:{labels:{padding:c}}}=this,d=this.legendHitBoxes=[],f=this.columnSizes=[],p=l-e;let v=c,_=0,b=0,T=0,C=0;return this.legendItems.forEach((A,I)=>{const{itemWidth:ee,itemHeight:G}=qU(i,t,o,A,s);I>0&&b+G+2*c>p&&(v+=_+c,f.push({width:_,height:b}),T+=_+c,C++,_=b=0),d[I]={left:T,top:b,col:C,width:ee,height:G},_=Math.max(_,ee),b+=G+c}),v+=_,f.push({width:_,height:b}),v}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:i,labels:{padding:s},rtl:o}}=this,l=wh(o,this.left,this.width);if(this.isHorizontal()){let c=0,d=Yo(i,this.left+s,this.right-this.lineWidths[c]);for(const f of t)c!==f.row&&(c=f.row,d=Yo(i,this.left+s,this.right-this.lineWidths[c])),f.top+=this.top+e+s,f.left=l.leftForLtr(l.x(d),f.width),d+=f.width+s}else{let c=0,d=Yo(i,this.top+e+s,this.bottom-this.columnSizes[c].height);for(const f of t)f.col!==c&&(c=f.col,d=Yo(i,this.top+e+s,this.bottom-this.columnSizes[c].height)),f.top=d,f.left+=this.left+s,f.left=l.leftForLtr(l.x(f.left),f.width),d+=f.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Ab(e,this),this._draw(),Db(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:i,ctx:s}=this,{align:o,labels:l}=e,c=Fs.color,d=wh(e.rtl,this.left,this.width),f=Ko(l.font),{padding:p}=l,v=f.size,_=v/2;let b;this.drawTitle(),s.textAlign=d.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=f.string;const{boxWidth:T,boxHeight:C,itemHeight:A}=IS(l,v),I=function(le,z,R){if(isNaN(T)||T<=0||isNaN(C)||C<0)return;s.save();const D=si(R.lineWidth,1);if(s.fillStyle=si(R.fillStyle,c),s.lineCap=si(R.lineCap,"butt"),s.lineDashOffset=si(R.lineDashOffset,0),s.lineJoin=si(R.lineJoin,"miter"),s.lineWidth=D,s.strokeStyle=si(R.strokeStyle,c),s.setLineDash(si(R.lineDash,[])),l.usePointStyle){const F={radius:C*Math.SQRT2/2,pointStyle:R.pointStyle,rotation:R.rotation,borderWidth:D},E=d.xPlus(le,T/2),O=z+_;xT(s,F,E,O,l.pointStyleWidth&&T)}else{const F=z+Math.max((v-C)/2,0),E=d.leftForLtr(le,T),O=bh(R.borderRadius);s.beginPath(),Object.values(O).some(M=>M!==0)?A0(s,{x:E,y:F,w:T,h:C,radius:O}):s.rect(E,F,T,C),s.fill(),D!==0&&s.stroke()}s.restore()},ee=function(le,z,R){Rm(s,R.text,le,z+A/2,f,{strikethrough:R.hidden,textAlign:d.textAlign(R.textAlign)})},G=this.isHorizontal(),K=this._computeTitleHeight();G?b={x:Yo(o,this.left+p,this.right-i[0]),y:this.top+p+K,line:0}:b={x:this.left+p,y:Yo(o,this.top+K+p,this.bottom-t[0].height),line:0},AT(this.ctx,e.textDirection);const de=A+p;this.legendItems.forEach((le,z)=>{s.strokeStyle=le.fontColor,s.fillStyle=le.fontColor;const R=s.measureText(le.text).width,D=d.textAlign(le.textAlign||(le.textAlign=l.textAlign)),F=T+_+R;let E=b.x,O=b.y;d.setWidth(this.width),G?z>0&&E+F+p>this.right&&(O=b.y+=de,b.line++,E=b.x=Yo(o,this.left+p,this.right-i[b.line])):z>0&&O+de>this.bottom&&(E=b.x=E+t[b.line].width+p,b.line++,O=b.y=Yo(o,this.top+K+p,this.bottom-t[b.line].height));const M=d.x(E);if(I(M,O,le),E=V7(D,E+T+_,G?E+F:this.right,e.rtl),ee(d.x(E),O,le),G)b.x+=F+p;else if(typeof le.text!="string"){const Y=f.lineHeight;b.y+=ZT(le,Y)+p}else b.y+=de}),DT(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,i=Ko(t.font),s=xa(t.padding);if(!t.display)return;const o=wh(e.rtl,this.left,this.width),l=this.ctx,c=t.position,d=i.size/2,f=s.top+d;let p,v=this.left,_=this.width;if(this.isHorizontal())_=Math.max(...this.lineWidths),p=this.top+f,v=Yo(e.align,v,this.right-_);else{const T=this.columnSizes.reduce((C,A)=>Math.max(C,A.height),0);p=f+Yo(e.align,this.top,this.bottom-T-e.labels.padding-this._computeTitleHeight())}const b=Yo(c,v,v+_);l.textAlign=o.textAlign(kb(c)),l.textBaseline="middle",l.strokeStyle=t.color,l.fillStyle=t.color,l.font=i.string,Rm(l,t.text,b,p,i)}_computeTitleHeight(){const e=this.options.title,t=Ko(e.font),i=xa(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,s,o;if(rd(e,this.left,this.right)&&rd(t,this.top,this.bottom)){for(o=this.legendHitBoxes,i=0;i<o.length;++i)if(s=o[i],rd(e,s.left,s.left+s.width)&&rd(t,s.top,s.top+s.height))return this.legendItems[i]}return null}handleEvent(e){const t=this.options;if(!GU(e.type,t))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,o=HU(s,i);s&&!o&&Ji(t.onLeave,[e,s,this],this),this._hoveredItem=i,i&&!o&&Ji(t.onHover,[e,i,this],this)}else i&&Ji(t.onClick,[e,i,this],this)}}function qU(n,e,t,i,s){const o=VU(i,n,e,t),l=YU(s,i,e.lineHeight);return{itemWidth:o,itemHeight:l}}function VU(n,e,t,i){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((o,l)=>o.length>l.length?o:l)),e+t.size/2+i.measureText(s).width}function YU(n,e,t){let i=n;return typeof e.text!="string"&&(i=ZT(e,t)),i}function ZT(n,e){const t=n.text?n.text.length:0;return e*t}function GU(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var JT={id:"legend",_element:PS,start(n,e,t){const i=n.legend=new PS({ctx:n.ctx,options:t,chart:n});ya.configure(n,i,t),ya.addBox(n,i)},stop(n){ya.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const i=n.legend;ya.configure(n,i,t),i.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const i=e.datasetIndex,s=t.chart;s.isDatasetVisible(i)?(s.hide(i),e.hidden=!0):(s.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:i,textAlign:s,color:o,useBorderRadius:l,borderRadius:c}}=n.legend.options;return n._getSortedDatasetMetas().map(d=>{const f=d.controller.getStyle(t?0:void 0),p=xa(f.borderWidth);return{text:e[d.index].label,fillStyle:f.backgroundColor,fontColor:o,hidden:!d.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(p.width+p.height)/4,strokeStyle:f.borderColor,pointStyle:i||f.pointStyle,rotation:f.rotation,textAlign:s||f.textAlign,borderRadius:l&&(c||f.borderRadius),datasetIndex:d.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class eC extends _u{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const s=to(i.text)?i.text.length:1;this._padding=xa(i.padding);const o=s*Ko(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:i,bottom:s,right:o,options:l}=this,c=l.align;let d=0,f,p,v;return this.isHorizontal()?(p=Yo(c,i,o),v=t+e,f=o-i):(l.position==="left"?(p=i+e,v=Yo(c,s,t),d=vo*-.5):(p=o-e,v=Yo(c,t,s),d=vo*.5),f=s-t),{titleX:p,titleY:v,maxWidth:f,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=Ko(t.font),o=i.lineHeight/2+this._padding.top,{titleX:l,titleY:c,maxWidth:d,rotation:f}=this._drawArgs(o);Rm(e,t.text,0,0,i,{color:t.color,maxWidth:d,rotation:f,textAlign:kb(t.align),textBaseline:"middle",translation:[l,c]})}}function KU(n,e){const t=new eC({ctx:n.ctx,options:e,chart:n});ya.configure(n,t,e),ya.addBox(n,t),n.titleBlock=t}var tC={id:"title",_element:eC,start(n,e,t){KU(n,t)},stop(n){const e=n.titleBlock;ya.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const i=n.titleBlock;ya.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Jf={average(n){if(!n.length)return!1;let e,t,i=new Set,s=0,o=0;for(e=0,t=n.length;e<t;++e){const c=n[e].element;if(c&&c.hasValue()){const d=c.tooltipPosition();i.add(d.x),s+=d.y,++o}}return o===0||i.size===0?!1:{x:[...i].reduce((c,d)=>c+d)/i.size,y:s/o}},nearest(n,e){if(!n.length)return!1;let t=e.x,i=e.y,s=Number.POSITIVE_INFINITY,o,l,c;for(o=0,l=n.length;o<l;++o){const d=n[o].element;if(d&&d.hasValue()){const f=d.getCenterPoint(),p=X2(e,f);p<s&&(s=p,c=d)}}if(c){const d=c.tooltipPosition();t=d.x,i=d.y}return{x:t,y:i}}};function yl(n,e){return e&&(to(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function ec(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function XU(n,e){const{element:t,datasetIndex:i,index:s}=e,o=n.getDatasetMeta(i).controller,{label:l,value:c}=o.getLabelAndValue(s);return{chart:n,label:l,parsed:o.getParsed(s),raw:n.data.datasets[i].data[s],formattedValue:c,dataset:o.getDataset(),dataIndex:s,datasetIndex:i,element:t}}function US(n,e){const t=n.chart.ctx,{body:i,footer:s,title:o}=n,{boxWidth:l,boxHeight:c}=e,d=Ko(e.bodyFont),f=Ko(e.titleFont),p=Ko(e.footerFont),v=o.length,_=s.length,b=i.length,T=xa(e.padding);let C=T.height,A=0,I=i.reduce((K,de)=>K+de.before.length+de.lines.length+de.after.length,0);if(I+=n.beforeBody.length+n.afterBody.length,v&&(C+=v*f.lineHeight+(v-1)*e.titleSpacing+e.titleMarginBottom),I){const K=e.displayColors?Math.max(c,d.lineHeight):d.lineHeight;C+=b*K+(I-b)*d.lineHeight+(I-1)*e.bodySpacing}_&&(C+=e.footerMarginTop+_*p.lineHeight+(_-1)*e.footerSpacing);let ee=0;const G=function(K){A=Math.max(A,t.measureText(K).width+ee)};return t.save(),t.font=f.string,Ai(n.title,G),t.font=d.string,Ai(n.beforeBody.concat(n.afterBody),G),ee=e.displayColors?l+2+e.boxPadding:0,Ai(i,K=>{Ai(K.before,G),Ai(K.lines,G),Ai(K.after,G)}),ee=0,t.font=p.string,Ai(n.footer,G),t.restore(),A+=T.width,{width:A,height:C}}function QU(n,e){const{y:t,height:i}=e;return t<i/2?"top":t>n.height-i/2?"bottom":"center"}function ZU(n,e,t,i){const{x:s,width:o}=i,l=t.caretSize+t.caretPadding;if(n==="left"&&s+o+l>e.width||n==="right"&&s-o-l<0)return!0}function JU(n,e,t,i){const{x:s,width:o}=t,{width:l,chartArea:{left:c,right:d}}=n;let f="center";return i==="center"?f=s<=(c+d)/2?"left":"right":s<=o/2?f="left":s>=l-o/2&&(f="right"),ZU(f,n,e,t)&&(f="center"),f}function FS(n,e,t){const i=t.yAlign||e.yAlign||QU(n,t);return{xAlign:t.xAlign||e.xAlign||JU(n,e,t,i),yAlign:i}}function eF(n,e){let{x:t,width:i}=n;return e==="right"?t-=i:e==="center"&&(t-=i/2),t}function tF(n,e,t){let{y:i,height:s}=n;return e==="top"?i+=t:e==="bottom"?i-=s+t:i-=s/2,i}function $S(n,e,t,i){const{caretSize:s,caretPadding:o,cornerRadius:l}=n,{xAlign:c,yAlign:d}=t,f=s+o,{topLeft:p,topRight:v,bottomLeft:_,bottomRight:b}=bh(l);let T=eF(e,c);const C=tF(e,d,f);return d==="center"?c==="left"?T+=f:c==="right"&&(T-=f):c==="left"?T-=Math.max(p,_)+s:c==="right"&&(T+=Math.max(v,b)+s),{x:Ka(T,0,i.width-e.width),y:Ka(C,0,i.height-e.height)}}function Tg(n,e,t){const i=xa(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-i.right:n.x+i.left}function BS(n){return yl([],ec(n))}function nF(n,e,t){return Ed(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function WS(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const nC={beforeTitle:Xl,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:Xl,beforeBody:Xl,beforeLabel:Xl,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return Hi(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Xl,afterBody:Xl,beforeFooter:Xl,footer:Xl,afterFooter:Xl};function Sr(n,e,t,i){const s=n[e].call(t,i);return typeof s>"u"?nC[e].call(t,i):s}class zS extends _u{static positioners=Jf;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),s=i.enabled&&t.options.animation&&i.animations,o=new jT(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=nF(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:i}=t,s=Sr(i,"beforeTitle",this,e),o=Sr(i,"title",this,e),l=Sr(i,"afterTitle",this,e);let c=[];return c=yl(c,ec(s)),c=yl(c,ec(o)),c=yl(c,ec(l)),c}getBeforeBody(e,t){return BS(Sr(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:i}=t,s=[];return Ai(e,o=>{const l={before:[],lines:[],after:[]},c=WS(i,o);yl(l.before,ec(Sr(c,"beforeLabel",this,o))),yl(l.lines,Sr(c,"label",this,o)),yl(l.after,ec(Sr(c,"afterLabel",this,o))),s.push(l)}),s}getAfterBody(e,t){return BS(Sr(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:i}=t,s=Sr(i,"beforeFooter",this,e),o=Sr(i,"footer",this,e),l=Sr(i,"afterFooter",this,e);let c=[];return c=yl(c,ec(s)),c=yl(c,ec(o)),c=yl(c,ec(l)),c}_createItems(e){const t=this._active,i=this.chart.data,s=[],o=[],l=[];let c=[],d,f;for(d=0,f=t.length;d<f;++d)c.push(XU(this.chart,t[d]));return e.filter&&(c=c.filter((p,v,_)=>e.filter(p,v,_,i))),e.itemSort&&(c=c.sort((p,v)=>e.itemSort(p,v,i))),Ai(c,p=>{const v=WS(e.callbacks,p);s.push(Sr(v,"labelColor",this,p)),o.push(Sr(v,"labelPointStyle",this,p)),l.push(Sr(v,"labelTextColor",this,p))}),this.labelColors=s,this.labelPointStyles=o,this.labelTextColors=l,this.dataPoints=c,c}update(e,t){const i=this.options.setContext(this.getContext()),s=this._active;let o,l=[];if(!s.length)this.opacity!==0&&(o={opacity:0});else{const c=Jf[i.position].call(this,s,this._eventPosition);l=this._createItems(i),this.title=this.getTitle(l,i),this.beforeBody=this.getBeforeBody(l,i),this.body=this.getBody(l,i),this.afterBody=this.getAfterBody(l,i),this.footer=this.getFooter(l,i);const d=this._size=US(this,i),f=Object.assign({},c,d),p=FS(this.chart,i,f),v=$S(i,f,p,this.chart);this.xAlign=p.xAlign,this.yAlign=p.yAlign,o={opacity:1,x:v.x,y:v.y,width:d.width,height:d.height,caretX:c.x,caretY:c.y}}this._tooltipItems=l,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,i,s){const o=this.getCaretPosition(e,i,s);t.lineTo(o.x1,o.y1),t.lineTo(o.x2,o.y2),t.lineTo(o.x3,o.y3)}getCaretPosition(e,t,i){const{xAlign:s,yAlign:o}=this,{caretSize:l,cornerRadius:c}=i,{topLeft:d,topRight:f,bottomLeft:p,bottomRight:v}=bh(c),{x:_,y:b}=e,{width:T,height:C}=t;let A,I,ee,G,K,de;return o==="center"?(K=b+C/2,s==="left"?(A=_,I=A-l,G=K+l,de=K-l):(A=_+T,I=A+l,G=K-l,de=K+l),ee=A):(s==="left"?I=_+Math.max(d,p)+l:s==="right"?I=_+T-Math.max(f,v)-l:I=this.caretX,o==="top"?(G=b,K=G-l,A=I-l,ee=I+l):(G=b+C,K=G+l,A=I+l,ee=I-l),de=G),{x1:A,x2:I,x3:ee,y1:G,y2:K,y3:de}}drawTitle(e,t,i){const s=this.title,o=s.length;let l,c,d;if(o){const f=wh(i.rtl,this.x,this.width);for(e.x=Tg(this,i.titleAlign,i),t.textAlign=f.textAlign(i.titleAlign),t.textBaseline="middle",l=Ko(i.titleFont),c=i.titleSpacing,t.fillStyle=i.titleColor,t.font=l.string,d=0;d<o;++d)t.fillText(s[d],f.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+c,d+1===o&&(e.y+=i.titleMarginBottom-c)}}_drawColorBox(e,t,i,s,o){const l=this.labelColors[i],c=this.labelPointStyles[i],{boxHeight:d,boxWidth:f}=o,p=Ko(o.bodyFont),v=Tg(this,"left",o),_=s.x(v),b=d<p.lineHeight?(p.lineHeight-d)/2:0,T=t.y+b;if(o.usePointStyle){const C={radius:Math.min(f,d)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},A=s.leftForLtr(_,f)+f/2,I=T+d/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,J2(e,C,A,I),e.strokeStyle=l.borderColor,e.fillStyle=l.backgroundColor,J2(e,C,A,I)}else{e.lineWidth=wi(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,e.strokeStyle=l.borderColor,e.setLineDash(l.borderDash||[]),e.lineDashOffset=l.borderDashOffset||0;const C=s.leftForLtr(_,f),A=s.leftForLtr(s.xPlus(_,1),f-2),I=bh(l.borderRadius);Object.values(I).some(ee=>ee!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,A0(e,{x:C,y:T,w:f,h:d,radius:I}),e.fill(),e.stroke(),e.fillStyle=l.backgroundColor,e.beginPath(),A0(e,{x:A,y:T+1,w:f-2,h:d-2,radius:I}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(C,T,f,d),e.strokeRect(C,T,f,d),e.fillStyle=l.backgroundColor,e.fillRect(A,T+1,f-2,d-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,t,i){const{body:s}=this,{bodySpacing:o,bodyAlign:l,displayColors:c,boxHeight:d,boxWidth:f,boxPadding:p}=i,v=Ko(i.bodyFont);let _=v.lineHeight,b=0;const T=wh(i.rtl,this.x,this.width),C=function(R){t.fillText(R,T.x(e.x+b),e.y+_/2),e.y+=_+o},A=T.textAlign(l);let I,ee,G,K,de,le,z;for(t.textAlign=l,t.textBaseline="middle",t.font=v.string,e.x=Tg(this,A,i),t.fillStyle=i.bodyColor,Ai(this.beforeBody,C),b=c&&A!=="right"?l==="center"?f/2+p:f+2+p:0,K=0,le=s.length;K<le;++K){for(I=s[K],ee=this.labelTextColors[K],t.fillStyle=ee,Ai(I.before,C),G=I.lines,c&&G.length&&(this._drawColorBox(t,e,K,T,i),_=Math.max(v.lineHeight,d)),de=0,z=G.length;de<z;++de)C(G[de]),_=v.lineHeight;Ai(I.after,C)}b=0,_=v.lineHeight,Ai(this.afterBody,C),e.y-=o}drawFooter(e,t,i){const s=this.footer,o=s.length;let l,c;if(o){const d=wh(i.rtl,this.x,this.width);for(e.x=Tg(this,i.footerAlign,i),e.y+=i.footerMarginTop,t.textAlign=d.textAlign(i.footerAlign),t.textBaseline="middle",l=Ko(i.footerFont),t.fillStyle=i.footerColor,t.font=l.string,c=0;c<o;++c)t.fillText(s[c],d.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+i.footerSpacing}}drawBackground(e,t,i,s){const{xAlign:o,yAlign:l}=this,{x:c,y:d}=e,{width:f,height:p}=i,{topLeft:v,topRight:_,bottomLeft:b,bottomRight:T}=bh(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(c+v,d),l==="top"&&this.drawCaret(e,t,i,s),t.lineTo(c+f-_,d),t.quadraticCurveTo(c+f,d,c+f,d+_),l==="center"&&o==="right"&&this.drawCaret(e,t,i,s),t.lineTo(c+f,d+p-T),t.quadraticCurveTo(c+f,d+p,c+f-T,d+p),l==="bottom"&&this.drawCaret(e,t,i,s),t.lineTo(c+b,d+p),t.quadraticCurveTo(c,d+p,c,d+p-b),l==="center"&&o==="left"&&this.drawCaret(e,t,i,s),t.lineTo(c,d+v),t.quadraticCurveTo(c,d,c+v,d),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,i=this.$animations,s=i&&i.x,o=i&&i.y;if(s||o){const l=Jf[e.position].call(this,this._active,this._eventPosition);if(!l)return;const c=this._size=US(this,e),d=Object.assign({},l,this._size),f=FS(t,e,d),p=$S(e,d,f,t);(s._to!==p.x||o._to!==p.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=c.width,this.height=c.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,p))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},o={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const l=xa(t.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&c&&(e.save(),e.globalAlpha=i,this.drawBackground(o,e,s,t),AT(e,t.textDirection),o.y+=l.top,this.drawTitle(o,e,t),this.drawBody(o,e,t),this.drawFooter(o,e,t),DT(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,s=e.map(({datasetIndex:c,index:d})=>{const f=this.chart.getDatasetMeta(c);if(!f)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:f.data[d],index:d}}),o=!T0(i,s),l=this._positionChanged(s,t);(o||l)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,o=this._active||[],l=this._getActiveElements(e,o,t,i),c=this._positionChanged(l,e),d=t||!T0(l,o)||c;return d&&(this._active=l,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),d}_getActiveElements(e,t,i,s){const o=this.options;if(e.type==="mouseout")return[];if(!s)return t.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);const l=this.chart.getElementsAtEventForMode(e,o.mode,o,i);return o.reverse&&l.reverse(),l}_positionChanged(e,t){const{caretX:i,caretY:s,options:o}=this,l=Jf[o.position].call(this,e,t);return l!==!1&&(i!==l.x||s!==l.y)}}var iC={id:"tooltip",_element:zS,positioners:Jf,afterInit(n,e,t){t&&(n.tooltip=new zS({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:nC},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const iF=(n,e,t,i)=>(typeof e=="string"?(t=n.push(e)-1,i.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function sF(n,e,t,i){const s=n.indexOf(e);if(s===-1)return iF(n,e,t,i);const o=n.lastIndexOf(e);return s!==o?t:s}const oF=(n,e)=>n===null?null:Ka(Math.round(n),0,e);function HS(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class sC extends Wh{static id="category";static defaults={ticks:{callback:HS}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const i=this.getLabels();for(const{index:s,label:o}of t)i[s]===o&&i.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(Hi(e))return null;const i=this.getLabels();return t=isFinite(t)&&i[t]===e?t:sF(i,e,si(t,e),this._addedLabels),oF(t,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),t||(s=this.getLabels().length-1)),this.min=i,this.max=s}buildTicks(){const e=this.min,t=this.max,i=this.options.offset,s=[];let o=this.getLabels();o=e===0&&t===o.length-1?o:o.slice(e,t+1),this._valueRange=Math.max(o.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let l=e;l<=t;l++)s.push({value:l});return s}getLabelForValue(e){return HS.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function rF(n,e){const t=[],{bounds:s,step:o,min:l,max:c,precision:d,count:f,maxTicks:p,maxDigits:v,includeBounds:_}=n,b=o||1,T=p-1,{min:C,max:A}=e,I=!Hi(l),ee=!Hi(c),G=!Hi(f),K=(A-C)/(v+1);let de=qx((A-C)/T/b)*b,le,z,R,D;if(de<1e-14&&!I&&!ee)return[{value:C},{value:A}];D=Math.ceil(A/de)-Math.floor(C/de),D>T&&(de=qx(D*de/T/b)*b),Hi(d)||(le=Math.pow(10,d),de=Math.ceil(de*le)/le),s==="ticks"?(z=Math.floor(C/de)*de,R=Math.ceil(A/de)*de):(z=C,R=A),I&&ee&&o&&I7((c-l)/o,de/1e3)?(D=Math.round(Math.min((c-l)/de,p)),de=(c-l)/D,z=l,R=c):G?(z=I?l:z,R=ee?c:R,D=f-1,de=(R-z)/D):(D=(R-z)/de,hm(D,Math.round(D),de/1e3)?D=Math.round(D):D=Math.ceil(D));const F=Math.max(Vx(de),Vx(z));le=Math.pow(10,Hi(d)?F:d),z=Math.round(z*le)/le,R=Math.round(R*le)/le;let E=0;for(I&&(_&&z!==l?(t.push({value:l}),z<l&&E++,hm(Math.round((z+E*de)*le)/le,l,qS(l,K,n))&&E++):z<l&&E++);E<D;++E){const O=Math.round((z+E*de)*le)/le;if(ee&&O>c)break;t.push({value:O})}return ee&&_&&R!==c?t.length&&hm(t[t.length-1].value,c,qS(c,K,n))?t[t.length-1].value=c:t.push({value:c}):(!ee||R===c)&&t.push({value:R}),t}function qS(n,e,{horizontal:t,minRotation:i}){const s=od(i),o=(t?Math.sin(s):Math.cos(s))||.001,l=.75*e*(""+n).length;return Math.min(e/o,l)}class aF extends Wh{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return Hi(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:s,max:o}=this;const l=d=>s=t?s:d,c=d=>o=i?o:d;if(e){const d=Cl(s),f=Cl(o);d<0&&f<0?c(0):d>0&&f>0&&l(0)}if(s===o){let d=o===0?1:Math.abs(o*.05);c(o+d),e||l(s-d)}this.min=s,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:i}=e,s;return i?(s=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),t=t||11),t&&(s=Math.min(t,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const s={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},o=this._range||this,l=rF(s,o);return e.bounds==="ticks"&&P7(l,this,"value"),e.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const e=this.ticks;let t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const s=(i-t)/Math.max(e.length-1,1)/2;t-=s,i+=s}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return wT(e,this.chart.options.locale,this.options.ticks.format)}}class oC extends aF{static id="linear";static defaults={ticks:{callback:_T.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=_a(e)?e:0,this.max=_a(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=od(this.options.ticks.minRotation),s=(e?Math.sin(i):Math.cos(i))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,o.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const o1={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Er=Object.keys(o1);function VS(n,e){return n-e}function YS(n,e){if(Hi(e))return null;const t=n._adapter,{parser:i,round:s,isoWeekday:o}=n._parseOpts;let l=e;return typeof i=="function"&&(l=i(l)),_a(l)||(l=typeof i=="string"?t.parse(l,i):t.parse(l)),l===null?null:(s&&(l=s==="week"&&(L0(o)||o===!0)?t.startOf(l,"isoWeek",o):t.startOf(l,s)),+l)}function GS(n,e,t,i){const s=Er.length;for(let o=Er.indexOf(n);o<s-1;++o){const l=o1[Er[o]],c=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((t-e)/(c*l.size))<=i)return Er[o]}return Er[s-1]}function lF(n,e,t,i,s){for(let o=Er.length-1;o>=Er.indexOf(t);o--){const l=Er[o];if(o1[l].common&&n._adapter.diff(s,i,l)>=e-1)return l}return Er[t?Er.indexOf(t):0]}function cF(n){for(let e=Er.indexOf(n)+1,t=Er.length;e<t;++e)if(o1[Er[e]].common)return Er[e]}function KS(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:i,hi:s}=Cb(t,e),o=t[i]>=e?t[i]:t[s];n[o]=!0}}function uF(n,e,t,i){const s=n._adapter,o=+s.startOf(e[0].value,i),l=e[e.length-1].value;let c,d;for(c=o;c<=l;c=+s.add(c,1,i))d=t[c],d>=0&&(e[d].major=!0);return e}function XS(n,e,t){const i=[],s={},o=e.length;let l,c;for(l=0;l<o;++l)c=e[l],s[c]=l,i.push({value:c,major:!1});return o===0||!t?i:uF(n,i,s,t)}class QS extends Wh{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const i=e.time||(e.time={}),s=this._adapter=new _9._date(e.adapters.date);s.init(t),dm(i.displayFormats,s.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:YS(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:s,max:o,minDefined:l,maxDefined:c}=this.getUserBounds();function d(f){!l&&!isNaN(f.min)&&(s=Math.min(s,f.min)),!c&&!isNaN(f.max)&&(o=Math.max(o,f.max))}(!l||!c)&&(d(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&d(this.getMinMax(!1))),s=_a(s)&&!isNaN(s)?s:+t.startOf(Date.now(),i),o=_a(o)&&!isNaN(o)?o:+t.endOf(Date.now(),i)+1,this.min=Math.min(s,o-1),this.max=Math.max(s+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,s=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const o=this.min,l=this.max,c=z7(s,o,l);return this._unit=t.unit||(i.autoSkip?GS(t.minUnit,this.min,this.max,this._getLabelCapacity(o)):lF(this,c.length,t.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:cF(this._unit),this.initOffsets(s),e.reverse&&c.reverse(),XS(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,i=0,s,o;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?i=o:i=(o-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;t=Ka(t,0,l),i=Ka(i,0,l),this._offsets={start:t,end:i,factor:1/(t+1+i)}}_generate(){const e=this._adapter,t=this.min,i=this.max,s=this.options,o=s.time,l=o.unit||GS(o.minUnit,t,i,this._getLabelCapacity(t)),c=si(s.ticks.stepSize,1),d=l==="week"?o.isoWeekday:!1,f=L0(d)||d===!0,p={};let v=t,_,b;if(f&&(v=+e.startOf(v,"isoWeek",d)),v=+e.startOf(v,f?"day":l),e.diff(i,t,l)>1e5*c)throw new Error(t+" and "+i+" are too far apart with stepSize of "+c+" "+l);const T=s.ticks.source==="data"&&this.getDataTimestamps();for(_=v,b=0;_<i;_=+e.add(_,c,l),b++)KS(p,_,T);return(_===i||s.bounds==="ticks"||b===1)&&KS(p,_,T),Object.keys(p).sort(VS).map(C=>+C)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,o=this._unit,l=t||s[o];return this._adapter.format(e,l)}_tickFormatFunction(e,t,i,s){const o=this.options,l=o.ticks.callback;if(l)return Ji(l,[e,t,i],this);const c=o.time.displayFormats,d=this._unit,f=this._majorUnit,p=d&&c[d],v=f&&c[f],_=i[t],b=f&&v&&_&&_.major;return this._adapter.format(e,s||(b?v:p))}generateTickLabels(e){let t,i,s;for(t=0,i=e.length;t<i;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,s=od(this.isHorizontal()?t.maxRotation:t.minRotation),o=Math.cos(s),l=Math.sin(s),c=this._resolveTickFontOptions(0).size;return{w:i*o+c*l,h:i*l+c*o}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,s=i[t.unit]||i.millisecond,o=this._tickFormatFunction(e,0,XS(this,[e],this._majorUnit),s),l=this._getLabelSize(o),c=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return c>0?c:1}getDataTimestamps(){let e=this._cache.data||[],t,i;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,i=s.length;t<i;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const s=this.getLabels();for(t=0,i=s.length;t<i;++t)e.push(YS(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return yT(e.sort(VS))}}function Cg(n,e,t){let i=0,s=n.length-1,o,l,c,d;t?(e>=n[i].pos&&e<=n[s].pos&&({lo:i,hi:s}=Q2(n,"pos",e)),{pos:o,time:c}=n[i],{pos:l,time:d}=n[s]):(e>=n[i].time&&e<=n[s].time&&({lo:i,hi:s}=Q2(n,"time",e)),{time:o,pos:c}=n[i],{time:l,pos:d}=n[s]);const f=l-o;return f?c+(d-c)*(e-o)/f:c}class qW extends QS{static id="timeseries";static defaults=QS.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Cg(t,this.min),this._tableRange=Cg(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,s=[],o=[];let l,c,d,f,p;for(l=0,c=e.length;l<c;++l)f=e[l],f>=t&&f<=i&&s.push(f);if(s.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(l=0,c=s.length;l<c;++l)p=s[l+1],d=s[l-1],f=s[l],Math.round((p+d)/2)!==f&&o.push({time:f,pos:l/(c-1)});return o}_generate(){const e=this.min,t=this.max;let i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(t)||i.length===1)&&i.push(t),i.sort((s,o)=>s-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(Cg(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return Cg(this._table,i*this._tableRange+this._minPos,!0)}}const rC="label";function ZS(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function dF(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function aC(n,e){n.labels=e}function lC(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:rC;const i=[];n.datasets=e.map(s=>{const o=n.datasets.find(l=>l[t]===s[t]);return!o||!s.data||i.includes(o)?{...s}:(i.push(o),Object.assign(o,s),o)})}function hF(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rC;const t={labels:[],datasets:[]};return aC(t,n.labels),lC(t,n.datasets,e),t}function fF(n,e){const{height:t=150,width:i=300,redraw:s=!1,datasetIdKey:o,type:l,data:c,options:d,plugins:f=[],fallbackContent:p,updateMode:v,..._}=n,b=me.useRef(null),T=me.useRef(null),C=()=>{b.current&&(T.current=new op(b.current,{type:l,data:hF(c,o),options:d&&{...d},plugins:f}),ZS(e,T.current))},A=()=>{ZS(e,null),T.current&&(T.current.destroy(),T.current=null)};return me.useEffect(()=>{!s&&T.current&&d&&dF(T.current,d)},[s,d]),me.useEffect(()=>{!s&&T.current&&aC(T.current.config.data,c.labels)},[s,c.labels]),me.useEffect(()=>{!s&&T.current&&c.datasets&&lC(T.current.config.data,c.datasets,o)},[s,c.datasets]),me.useEffect(()=>{T.current&&(s?(A(),setTimeout(C)):T.current.update(v))},[s,d,c.labels,c.datasets,v]),me.useEffect(()=>{T.current&&(A(),setTimeout(C))},[l]),me.useEffect(()=>(C(),()=>A()),[]),w4.createElement("canvas",{ref:b,role:"img",height:t,width:i,..._},p)}const mF=me.forwardRef(fF);function pF(n,e){return op.register(e),me.forwardRef((t,i)=>w4.createElement(mF,{...t,ref:i,type:n}))}const nu=pF("bar",w9),gF=(n,e=3)=>n.toFixed(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),yF=n=>{try{const e=new Date,t=e.getFullYear(),i=e.getMonth()+1,s=new Date(t,i,0).getDate();let o=0;for(let l=1;l<=s;l++){const c=`day_${t}_${String(i).padStart(2,"0")}_${String(l).padStart(2,"0")}`,d=n.daily_logs?.[c];d&&d.total_energy&&(o+=d.total_energy)}return`${gF(o*1e3)} Wh`}catch(e){return console.error("Error calculating monthly energy:",e),"0.000 Wh"}},JS=(n,e)=>{try{const t=new Date,i=t.getFullYear(),s=t.getMonth()+1,o=new Date(i,s,0).getDate();console.log("📊 Monthly energy calculation:",{currentYear:i,currentMonth:s,daysInMonth:o,selectedOutlets:[...new Set(e)],totalOutlets:e.length,uniqueOutlets:[...new Set(e)].length});const l=new Set;let c=0;return e.forEach((d,f)=>{if(l.has(d)){console.log(`⚠️ DUPLICATE SKIPPED: ${d} (already processed)`);return}l.add(d);const p=d.replace(" ","_"),v=n[p];if(console.log(`🔍 Processing outlet ${f+1}/${e.length}: ${d} -> ${p}`),v&&v.daily_logs){let _=0;for(let b=1;b<=o;b++){const T=`day_${i}_${String(s).padStart(2,"0")}_${String(b).padStart(2,"0")}`,C=v.daily_logs[T];C&&C.total_energy&&(_+=C.total_energy)}console.log(`📊 ${d}: ${_.toFixed(3)}kW for month ${s}/${i}`),c+=_}else console.log(`⚠️ ${d}: No data found or no daily_logs`)}),console.log(`📊 TOTAL MONTHLY ENERGY: ${c.toFixed(3)}kW (${(c*1e3).toFixed(3)}W)`),c*1e3}catch(t){return console.error("❌ Error calculating combined monthly energy:",t),0}},vF=(n,e)=>{e(t=>(t[n]&&(clearTimeout(t[n]),console.log(`🔄 Auto-turnoff: Cleared timer for ${n} - device is now idle or turned off`)),{...t,[n]:null}))};op.register(sC,oC,KT,GT,QT,tC,iC,JT);function bF({onNavigate:n}){const e=()=>{const ve=new Date,He=ve.getFullYear(),Le=String(ve.getMonth()+1).padStart(2,"0"),Re=String(ve.getDate()).padStart(2,"0");return`day_${He}_${Le}_${Re}`},t=(ve,He=3)=>ve.toLocaleString("en-US",{minimumFractionDigits:He,maximumFractionDigits:He}),i=(ve,He,Le,Re)=>{if(!ve||!ve.timeRange&&!ve.startTime)return He==="on";const Pe=new Date,At=Pe.getHours()*60+Pe.getMinutes(),rt=Pe.getDay();let Nt,xt;if(ve.startTime&&ve.endTime){const[ke,pt]=ve.startTime.split(":").map(Number),[Lt,Yt]=ve.endTime.split(":").map(Number);Nt=ke*60+pt,xt=Lt*60+Yt}else if(ve.timeRange){const ke=ve.timeRange,[pt,Lt]=ke.split(" - "),Yt=Vt=>{const[nn,yn]=Vt.split(" ");let[en,wn]=nn.split(":").map(Number);return en===12&&(en=0),yn==="PM"&&(en+=12),en*60+wn};Nt=Yt(pt),xt=Yt(Lt)}else return He==="on";const st=At>=Nt&&At<xt,St=ve.frequency||"";let yt=!1;if(St.toLowerCase()==="daily")yt=!0;else if(St.toLowerCase()==="weekdays")yt=rt>=1&&rt<=5;else if(St.toLowerCase()==="weekends")yt=rt===0||rt===6;else if(St.includes(",")){const ke={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6};yt=St.split(",").map(Lt=>{const Yt=Lt.trim().toLowerCase();return ke[Yt]}).filter(Lt=>Lt!==void 0).includes(rt)}else if(St){const pt={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6}[St.toLowerCase()];pt!==void 0&&(yt=pt===rt)}if(Le&&!Re){const ke=Le.relay_control?.auto_cutoff?.power_limit||0,pt=new Date,Lt=`day_${pt.getFullYear()}_${String(pt.getMonth()+1).padStart(2,"0")}_${String(pt.getDate()).padStart(2,"0")}`,Vt=Le?.daily_logs?.[Lt]?.total_energy||0;if(ke>0&&Vt>=ke)return console.log("Dashboard: Schedule check - Device power limit exceeded:",{todayTotalEnergy:`${(Vt*1e3).toFixed(3)}W`,powerLimit:`${ke*1e3}W`,todayDateKey:Lt,scheduleResult:!1,reason:"Today's energy consumption exceeded power limit"}),!1}return st&&yt},[s,o]=me.useState(!1),[l,c]=me.useState(!1),[d,f]=me.useState(!1),[p,v]=me.useState(!1),[_,b]=me.useState("Day"),[T,C]=me.useState("Day"),[A,I]=me.useState("Day"),[ee,G]=me.useState("Week"),[K,de]=me.useState("All Departments"),[le,z]=me.useState("All Offices"),[R,D]=me.useState([]),[F,E]=me.useState(0),[O,M]=me.useState(0),[Y,ie]=me.useState(0),[q,re]=me.useState({}),[V,se]=me.useState([]),[W,te]=me.useState(!1),[j,U]=me.useState({}),[$,X]=me.useState({}),[Q,ye]=me.useState(0),[Ae,De]=me.useState(0),[Be,Fe]=me.useState(0),[Ct,at]=me.useState(9.3885),[Ce,ce]=me.useState(""),[_t,Ne]=me.useState(0),[Ve,We]=me.useState(0),[tt,lt]=me.useState([]),[$e,pe]=me.useState([]),[be,Se]=me.useState([]),[Ee,Ye]=me.useState([]),qe=me.useRef(null),Ue=Ct,Xe=async ve=>{let He=0;const Le=new Date,Re=Le.getFullYear(),Pe=Le.getMonth()+1,At=`day_${Re}_${String(Pe).padStart(2,"0")}_`;try{const rt=Me(je,"devices"),Nt=await Pt(rt);if(Nt.exists()){const xt=Nt.val();ve.forEach(st=>{const St=st.outletId,yt=xt[St];if(!yt)return;const ke=yt.daily_logs||{};Object.keys(ke).forEach(pt=>{if(pt.startsWith(At)){const Lt=ke[pt],Yt=Lt.total_energy||0,Vt=Lt.avg_power||0,nn=Lt.usage_time_hours||0,yn=Vt*nn/1e3;let en=Yt;if(nn>0&&Vt>0){const wn=Math.abs(Yt-yn),In=Math.min(Yt,yn)/Math.max(Yt,yn);In<.95&&wn>.1?(console.log(`Dashboard runtime verification: Using calculated energy for ${St} on ${pt}. Measured: ${Yt}kWh, Calculated: ${yn}kWh, Accuracy: ${(In*100).toFixed(1)}%`),en=yn):console.log(`Dashboard runtime verification: Using measured energy for ${St} on ${pt}. Measured: ${Yt}kWh, Calculated: ${yn}kWh, Accuracy: ${(In*100).toFixed(1)}%`)}He+=en}})})}}catch(rt){console.error("Error fetching monthly data:",rt);const Nt=ve.reduce((st,St)=>st+(St.total_energy||0),0),xt=new Date(Re,Pe,0).getDate();He=Nt*xt}return console.log(`Dashboard current bill calculation: Actual monthly energy consumed = ${He} kWh, Rate = ${Ue}, Filtered devices count = ${ve.length}`),He*Ue},bt=async ve=>{const He=new Date,Le=He.getFullYear(),Re=He.getMonth()+1,Pe=new Date(Le,Re,0).getDate(),At=He.getDate();console.log(`🔍 Estimated monthly bill calculation: Processing ${Le}-${String(Re).padStart(2,"0")} with ${Pe} days (current day: ${At})`),console.log(`📅 Today is: ${He.toDateString()}`);let rt=0,Nt=0;try{const yt=Me(je,"devices"),ke=await Pt(yt);if(ke.exists()){const pt=ke.val();console.log(`📊 Processing ${ve.length} filtered devices for estimated monthly bill calculation`);for(let Lt=1;Lt<=Pe;Lt++){const Yt=String(Lt).padStart(2,"0"),Vt=`day_${Le}_${String(Re).padStart(2,"0")}_${Yt}`;let nn=0;ve.forEach(yn=>{const en=yn.outletId,wn=pt[en];if(!wn||!wn.daily_logs)return;const In=wn.daily_logs[Vt];In&&(nn+=In.total_energy||0)}),nn>0?(rt+=nn,Nt++,console.log(`📅 Day ${Lt}: Energy = ${nn.toFixed(6)} kWh`)):console.log(`📅 Day ${Lt}: No energy data`)}}}catch(yt){console.error("❌ Error calculating estimated monthly bill:",yt),rt=ve.reduce((ke,pt)=>ke+(pt.total_energy||0),0),Nt=1}const xt=Nt>0?rt/Nt:0,st=xt*Pe,St=st*Ue;return console.log("📊 Estimated monthly bill calculation results:"),console.log(`   Total energy so far: ${rt.toFixed(6)} kWh`),console.log(`   Days with data: ${Nt}`),console.log(`   Daily average: ${xt.toFixed(6)} kWh`),console.log(`   Estimated monthly energy: ${st.toFixed(6)} kWh`),console.log(`   Rate: ₱${Ue} per kWh`),console.log(`   Estimated monthly bill: ₱${St.toFixed(2)}`),St},qt=async()=>{try{if(be.length===0){ye(0);return}const ve=Me(je,"devices"),He=await Pt(ve);if(!He.exists()){ye(0);return}const Le=He.val();let Re=0;for(const Pe of be){const At=Pe.outletId,rt=Le[At];if(rt&&rt.daily_logs)for(const[Nt,xt]of Object.entries(rt.daily_logs)){const St=xt?.total_energy||0;Re+=St}}ye(Re*1e3),console.log("Total energy calculated:",{totalEnergy:`${(Re*1e3).toFixed(3)} W`,totalEnergyKw:`${Re.toFixed(3)} kW`,department:K,filteredDevicesCount:tt.length})}catch(ve){console.error("Error calculating total energy:",ve),ye(0)}},fe=async()=>{try{if(be.length===0){Fe(0),De(0);return}const ve=Me(je,"devices"),He=await Pt(ve);if(!He.exists()){Fe(0),De(0);return}const Le=He.val(),Re=new Date,Pe=Re.getFullYear(),At=Re.getMonth()+1,rt=Re.getDate(),Nt=(Lt,Yt,Vt)=>`day_${Lt}_${String(Yt).padStart(2,"0")}_${String(Vt).padStart(2,"0")}`,xt=Nt(Pe,At,rt);let st=0,St=0,yt=0;for(const Lt of be){const Yt=Lt.outletId,Vt=Le[Yt];if(!Vt)continue;const nn=Vt?.daily_logs?.[xt];if(nn){const yn=nn.total_energy||0,en=nn.avg_power||0,wn=nn.usage_time_hours||0,In=en*wn/1e3;let Tn=yn;if(wn>0&&en>0){const Vn=Math.abs(yn-In);Math.min(yn,In)/Math.max(yn,In)<.95&&Vn>.001&&(Tn=In)}st+=Tn}for(let yn=1;yn<=rt;yn++){const en=Nt(Pe,At,yn),wn=Vt?.daily_logs?.[en];if(wn){const In=wn.total_energy||0,Tn=wn.avg_power||0,Vn=wn.usage_time_hours||0,Ei=Tn*Vn/1e3;let ts=In;if(Vn>0&&Tn>0){const fs=Math.abs(In-Ei);Math.min(In,Ei)/Math.max(In,Ei)<.95&&fs>.001&&(ts=Ei)}ts>0&&(St+=ts,yt++)}}}const ke=St*1e3,pt=yt>0?ke/yt:0;Fe(st*1e3),De(pt),console.log("Daily Average Calculation (Updated Formula):",{totalMonthlyEnergyKwh:`${St.toFixed(6)} kWh`,totalMonthlyEnergyWh:`${ke.toFixed(3)} Wh`,activeDays:yt,dailyAverageWh:`${pt.toFixed(3)} Wh`,formula:`Daily Average = ${ke.toFixed(3)} Wh ÷ ${yt} days = ${pt.toFixed(3)} Wh`,todayKey:xt,department:K,filteredDevicesCount:tt.length})}catch(ve){console.error("Error calculating today energy and daily average:",ve),Fe(0),De(0)}},Ze=async()=>{try{if(be.length===0){ie(0);return}const ve=Me(je,"devices"),He=await Pt(ve);if(!He.exists()){ie(0);return}const Le=He.val(),Re=new Date,Pe=Re.getFullYear(),At=Re.getMonth()+1;let rt=0;const Nt=st=>{const St=st.getFullYear(),yt=String(st.getMonth()+1).padStart(2,"0"),ke=String(st.getDate()).padStart(2,"0");return`day_${St}_${yt}_${ke}`},xt=new Date(Pe,At,0).getDate();for(const st of be){const St=st.outletId,yt=Le[St];if(yt)for(let ke=1;ke<=xt;ke++){const pt=new Date(Pe,At-1,ke),Lt=Nt(pt),Vt=yt?.daily_logs?.[Lt]?.total_energy||0;Vt>0&&(rt+=Vt)}}ie(rt*1e3),console.log("Current month energy calculated:",{totalMonthlyEnergy:`${(rt*1e3).toFixed(3)} Wh`,currentMonth:At,currentYear:Pe,daysInMonth:xt,department:K,filteredDevicesCount:tt.length})}catch(ve){console.error("Error calculating current month energy:",ve),ie(0)}},Je=async(ve,He)=>{try{const Le=Me(je,`devices/${ve.outletId}`),Re=await Pt(Le);if(!Re.exists())return{total_energy:0,peak_power:0};const Pe=Re.val(),At=new Date,rt=st=>{const St=st.getFullYear(),yt=String(st.getMonth()+1).padStart(2,"0"),ke=String(st.getDate()).padStart(2,"0");return`day_${St}_${yt}_${ke}`};let Nt=0,xt=0;switch(He){case"Day":const st=rt(At),St=Pe?.daily_logs?.[st];Nt=St?.total_energy||0,xt=St?.peak_power||0;break;case"Week":for(let pt=6;pt>=0;pt--){const Lt=new Date(At);Lt.setDate(Lt.getDate()-pt);const Yt=rt(Lt),Vt=Pe?.daily_logs?.[Yt];Nt+=Vt?.total_energy||0,xt=Math.max(xt,Vt?.peak_power||0)}break;case"Month":for(let pt=29;pt>=0;pt--){const Lt=new Date(At);Lt.setDate(Lt.getDate()-pt);const Yt=rt(Lt),Vt=Pe?.daily_logs?.[Yt];Nt+=Vt?.total_energy||0,xt=Math.max(xt,Vt?.peak_power||0)}break;case"Year":for(let pt=11;pt>=0;pt--){const Lt=new Date(At);Lt.setMonth(Lt.getMonth()-pt);const Yt=new Date(Lt.getFullYear(),Lt.getMonth()+1,0).getDate();for(let Vt=1;Vt<=Yt;Vt++){const nn=new Date(Lt.getFullYear(),Lt.getMonth(),Vt),yn=rt(nn),en=Pe?.daily_logs?.[yn];Nt+=en?.total_energy||0,xt=Math.max(xt,en?.peak_power||0)}}break;default:const yt=rt(At),ke=Pe?.daily_logs?.[yt];Nt=ke?.total_energy||0,xt=ke?.peak_power||0}return{total_energy:Nt,peak_power:xt}}catch(Le){return console.error("Error fetching device data for time period:",Le),{total_energy:0,peak_power:0}}},mt=async(ve,He)=>{const Le=[];for(const Re of ve){const Pe=await Je(Re,He);Pe.total_energy>0&&Le.push({...Re,total_energy:Pe.total_energy,peak_power:Pe.peak_power})}return Le},Tt=()=>{const ve=new Date,He=ve.toLocaleString("default",{month:"long"}),Le=ve.getFullYear(),Re=ve.getDate();return{day:`Today (${He} ${Re})`,week:`This Week (${He} ${Re})`,month:`${He} ${Le}`,year:`${Le}`}};me.useEffect(()=>{const ve=Me(je,"rates/canoreco"),He=Go(ve,Le=>{const Re=Le.val();if(!Re)return;const Pe=Number(Re.rate??Re.value);!Number.isNaN(Pe)&&Pe>0&&at(Pe);const At=Re.updatedAt??Date.now();try{const rt=typeof At=="number"?new Date(At):new Date(At);ce(rt.toLocaleString("en-PH"))}catch{ce(new Date().toLocaleString("en-PH"))}});return()=>lr(ve,"value",He)},[]),me.useEffect(()=>{(async()=>{try{const He=Me(je,"combined_limit_settings"),Le=await Pt(He);if(Le.exists()){const Re=Le.val();Qt({enabled:Re.enabled||!1,selectedOutlets:Re.selected_outlets||[],combinedLimit:Re.combined_limit_watts||0})}else Qt({enabled:!1,selectedOutlets:[],combinedLimit:0})}catch(He){console.error("Dashboard: Error fetching combined limit info:",He)}})()},[]),me.useEffect(()=>{const ve=Me(je,"devices"),He=Go(ve,Le=>{const Re=Le.val();if(Re){const Pe=[],At=e();Object.keys(Re).forEach(rt=>{const Nt=Re[rt];if(Nt.sensor_data){const xt={"computer-lab-1":"Computer Laboratory 1","computer-lab-2":"Computer Laboratory 2","computer-lab-3":"Computer Laboratory 3","deans-office":"Dean's Office","faculty-office":"Faculty Office"},st=Nt.office_info?.office||"",St=st?xt[st]||st:"—",yt=Nt.daily_logs?.[At],ke=Nt.lifetime_energy||0,Lt=Nt.status==="idle",Yt=Date.now(),Vt=yt?.total_energy||0,nn=Nt.control?.device||"off",yn=j[rt]||{lastEnergyUpdate:Yt,lastControlUpdate:Yt,lastTotalEnergy:Vt,lastControlState:nn};Math.abs(Vt-yn.lastTotalEnergy)>1e-4&&U(fs=>({...fs,[rt]:{...yn,lastEnergyUpdate:Yt,lastTotalEnergy:Vt}})),nn!==yn.lastControlState&&U(fs=>({...fs,[rt]:{...yn,lastControlUpdate:Yt,lastControlState:nn}}));const In=Yt-yn.lastEnergyUpdate,Tn=Yt-yn.lastControlUpdate,Vn=In>15e3&&Tn>15e3;let Ei;(Lt||Vn)&&nn==="on"?Ei="Idle":Ei=nn,vF(rt,X);const ts={outletId:rt,status:Ei,power:Nt.sensor_data.power||0,energy:Nt.sensor_data.energy||0,current:Nt.sensor_data.current||0,voltage:Nt.sensor_data.voltage||0,power_factor:Nt.sensor_data.power_factor||0,timestamp:Nt.sensor_data.timestamp||"",avg_power:yt?.avg_power||0,peak_power:yt?.peak_power||0,total_energy:yt?.total_energy||0,lifetime_energy:ke,monthUsage:yF(Nt),officeRoom:St,appliances:Nt.office_info?.appliance||"Unassigned"};Pe.push(ts)}}),D(Pe),console.log("Dashboard data fetched:",{todayDateKey:At,devicesCount:Pe.length,devices:Pe.map(rt=>({outletId:rt.outletId,total_energy:rt.total_energy,peak_power:rt.peak_power,officeRoom:rt.officeRoom}))})}});return()=>lr(ve,"value",He)},[]),me.useEffect(()=>{const ve=async()=>{try{const rt=Me(je,"devices"),Nt=await Pt(rt);if(Nt.exists()){const xt=Nt.val(),st=new Date,St=st.getHours()*60+st.getMinutes(),yt=st.getDay();console.log(`Dashboard: Real-time scheduler check at ${st.toLocaleTimeString()}:`,{currentTime:`${Math.floor(St/60)}:${String(St%60).padStart(2,"0")}`,currentDay:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][yt]});for(const[ke,pt]of Object.entries(xt)){const Lt=pt;if(console.log(`Dashboard: Checking device ${ke}:`,{hasSchedule:!!(Lt.schedule&&(Lt.schedule.timeRange||Lt.schedule.startTime)),enablePowerScheduling:Lt.office_info?.enable_power_scheduling,schedule:Lt.schedule}),Lt.schedule&&(Lt.schedule.timeRange||Lt.schedule.startTime)){const Yt=Lt.control?.device||"off";if((Lt.relay_control?.main_status||"ON")==="ON"){console.log(`Dashboard: Device ${ke} has main_status = 'ON' - respecting bypass mode, skipping schedule check`);continue}const nn=ke.replace("_"," "),yn=Ut?.enabled&&Ut?.selectedOutlets?.includes(nn),en=i(Lt.schedule,"on",Lt,yn);let wn=en?"on":"off";if(!yn&&wn==="on"){const In=Lt.relay_control?.auto_cutoff?.power_limit||0;if(In>0){const Tn=new Date,Vn=`day_${Tn.getFullYear()}_${String(Tn.getMonth()+1).padStart(2,"0")}_${String(Tn.getDate()).padStart(2,"0")}`,ts=Lt?.daily_logs?.[Vn]?.total_energy||0;ts>=In&&(wn="off",console.log(`🔒 Dashboard: AUTOMATIC UPDATE - Forcing ${ke} OFF due to individual daily limit exceeded (${(ts*1e3).toFixed(3)}W >= ${In*1e3}W)`))}}console.log(`Dashboard: Schedule check for ${ke}:`,{currentControlState:Yt,shouldBeActive:en,newControlState:wn,needsUpdate:Yt!==wn,isInCombinedGroup:yn}),Yt!==wn?(console.log(`Dashboard: Real-time update: ${ke} control state from ${Yt} to ${wn}`),await Kt(Me(je,`devices/${ke}/control`),{device:wn})):console.log(`Dashboard: No update needed for ${ke} - control state already ${Yt}`)}}}}catch(rt){console.error("Dashboard: Error in real-time scheduler:",rt)}},He=async()=>{try{const rt=Me(je,"devices"),Nt=await Pt(rt);if(Nt.exists()){const xt=Nt.val();console.log(`Dashboard: Power limit monitor running at ${new Date().toLocaleTimeString()}`);for(const[st,St]of Object.entries(xt)){const yt=St,ke=yt.control?.device||"off",pt=yt.relay_control?.main_status||"ON";if(ke==="off")continue;if(pt==="ON"){console.log(`Dashboard: Device ${st} main_status is ON - respecting bypass mode, skipping automatic power limit enforcement`);continue}const Lt=st.replace("_"," "),Yt=Ut?.enabled&&Ut?.selectedOutlets?.includes(Lt);if(Yt){if(console.log(`Dashboard: Device ${st} is in combined group - checking combined group power limits`),Ut?.enabled&&Ut?.selectedOutlets?.length>0){const Vt=JS(xt,Ut.selectedOutlets),nn=Ut.combinedLimit/1e3;console.log(`Dashboard: Combined group limit check for ${st}:`,{totalMonthlyEnergy:`${(Vt*1e3).toFixed(0)}W`,combinedLimit:`${Ut.combinedLimit}W`,exceedsLimit:Vt>=nn}),Vt>=nn&&(console.log(`Dashboard: Combined monthly limit exceeded - turning off ${st}`),await Kt(Me(je,`devices/${st}/control`),{device:"off"}),await Kt(Me(je,`devices/${st}/relay_control`),{main_status:"OFF"}),console.log(`Dashboard: Device ${st} turned OFF due to combined monthly limit exceeded`))}}else{console.log(`Dashboard: Device ${st} main status is ${pt} - checking individual power limits`);const Vt=yt.relay_control?.auto_cutoff?.power_limit||0;if(Vt>0){const nn=new Date,yn=`day_${nn.getFullYear()}_${String(nn.getMonth()+1).padStart(2,"0")}_${String(nn.getDate()).padStart(2,"0")}`,wn=yt?.daily_logs?.[yn]?.total_energy||0;console.log(`Dashboard: Power limit check for ${st}:`,{powerLimit:`${Vt*1e3}W`,todayTotalEnergy:`${wn*1e3}W`,todayDateKey:yn,exceedsLimit:wn>=Vt,currentControlState:ke,isInCombinedGroup:Yt}),wn>=Vt&&(console.log(`Dashboard: POWER LIMIT EXCEEDED - Turning OFF ${st} (${(wn*1e3).toFixed(3)}W >= ${Vt*1e3}W)`),await Kt(Me(je,`devices/${st}/control`),{device:"off"}),await Kt(Me(je,`devices/${st}/relay_control`),{main_status:"OFF"}),console.log(`Dashboard: Device ${st} turned OFF due to power limit exceeded`))}}}}}catch(rt){console.error("Dashboard: Error in power limit monitor:",rt)}},Le=async()=>{try{if(!Ut?.enabled||Ut?.selectedOutlets?.length===0)return;const rt=Me(je,"devices"),Nt=await Pt(rt);if(Nt.exists()){const xt=Nt.val(),st=JS(xt,Ut.selectedOutlets),St=Ut.combinedLimit,yt=St/1e3;if(console.log(`Dashboard: Monthly limit check - Total: ${(st*1e3).toFixed(0)}W / Limit: ${St}W`),st>=yt){console.log("Dashboard: Monthly limit exceeded! Turning off all devices in combined group.");for(const ke of Ut.selectedOutlets){const pt=ke.replace(" ","_");try{const Lt=Me(je,`devices/${pt}/control`);await Kt(Lt,{device:"off"});const Yt=Me(je,`devices/${pt}/relay_control`);await Kt(Yt,{main_status:"OFF"}),console.log(`✅ TURNED OFF: ${ke} (${pt}) due to monthly limit`)}catch(Lt){console.error(`❌ FAILED to turn off ${ke}:`,Lt)}}}}}catch(rt){console.error("Dashboard: Error in monthly limit check:",rt)}};ve(),He(),Le(),window.testDashboardSchedule=ve,window.testDashboardPowerLimits=He,window.checkDashboardCurrentTime=()=>{const rt=new Date,Nt=rt.getHours()*60+rt.getMinutes(),xt=rt.getDay();console.log("Dashboard current time debug:",{time:rt.toLocaleTimeString(),minutes:Nt,day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][xt],date:rt.toLocaleDateString()})};const Re=setInterval(ve,1e4),Pe=setInterval(He,3e4),At=setInterval(Le,6e4);return()=>{clearInterval(Re),clearInterval(Pe),clearInterval(At),Object.values($).forEach(rt=>{rt&&clearTimeout(rt)})}},[]);const It=async()=>{const ve=new Date;ve.getFullYear(),ve.getMonth()+1;const He=Re=>{const Pe=Re.getFullYear(),At=String(Re.getMonth()+1).padStart(2,"0"),rt=String(Re.getDate()).padStart(2,"0");return`day_${Pe}_${At}_${rt}`},Le=async Re=>{try{const Pe=Me(je,"devices"),At=await Pt(Pe);if(At.exists()){const rt=At.val();return tt.map(Nt=>{const xt=Nt.outletId;return rt[xt]?.daily_logs?.[Re]?.total_energy||0})}return tt.map(()=>0)}catch(Pe){return console.error("Error fetching device data for date:",Re,Pe),tt.map(()=>0)}};try{switch(ee){case"Week":const Re=[],Pe=[];for(let yt=6;yt>=0;yt--){const ke=new Date(ve);ke.setDate(ke.getDate()-yt);const pt=He(ke),Lt=await Le(pt);Re.push(ke.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})),Pe.push(Lt)}return{labels:Re,energyUsage:Pe};case"Month":const At=[],rt=[];for(let yt=29;yt>=0;yt--){const ke=new Date(ve);ke.setDate(ke.getDate()-yt);const pt=He(ke),Lt=await Le(pt);At.push(ke.toLocaleDateString("en-US",{month:"short",day:"numeric"})),rt.push(Lt)}return{labels:At,energyUsage:rt};case"Year":const Nt=[],xt=[];for(let yt=11;yt>=0;yt--){const ke=new Date(ve);ke.setMonth(ke.getMonth()-yt);const pt=`${ke.getFullYear()}_${String(ke.getMonth()+1).padStart(2,"0")}`,Lt=new Date(ke.getFullYear(),ke.getMonth()+1,0).getDate(),Yt=new Array(tt.length).fill(0);for(let Vt=1;Vt<=Lt;Vt++){const nn=new Date(ke.getFullYear(),ke.getMonth(),Vt),yn=He(nn),en=await Le(yn);for(let wn=0;wn<tt.length;wn++)Yt[wn]+=en[wn]||0}Nt.push(ke.toLocaleDateString("en-US",{month:"short",year:"numeric"})),xt.push(Yt)}return{labels:Nt,energyUsage:xt};default:const st=[],St=[];for(let yt=6;yt>=0;yt--){const ke=new Date(ve);ke.setDate(ke.getDate()-yt);const pt=He(ke),Lt=await Le(pt);st.push(ke.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})),St.push(Lt)}return{labels:st,energyUsage:St}}}catch(Re){return console.error("Error in getChartDataByTimeSegment:",Re),{labels:[],energyUsage:[]}}},[gt,tn]=me.useState({labels:[],energyUsage:[]}),[Zt,Dt]=me.useState(!1),[Ut,Qt]=me.useState({enabled:!1,selectedOutlets:[],combinedLimit:0}),an=tt.length===1;me.useEffect(()=>{(async()=>{if(tt.length>0){console.log("Updating chart data for timeSegment:",ee,"filteredDevices:",tt.length);try{const He=await It();console.log("Chart data loaded:",He),tn(He)}catch(He){console.error("Error loading chart data:",He),tn({labels:[],energyUsage:[]})}}else tn({labels:[],energyUsage:[]})})()},[ee,tt]);const on=tt.map(ve=>{const He=ve.total_energy,Le=`${t(He*1e3)} Wh`;return{name:`Outlet ${ve.outletId.split("_")[1]}`,usage:ve.total_energy,usageDisplay:Le,percentage:O>0?ve.total_energy/O*100:0}}),[dn,Sn]=me.useState(["All Departments"]);me.useEffect(()=>{console.log("Departments state updated:",dn),console.log("Available departments for dropdown:",dn)},[dn]);const Te=()=>{if(K==="All Departments")return["All Offices",...V];const ve=["All Offices"];return Object.values(q).forEach(He=>{He.department===K&&He.office&&ve.push(He.office)}),ve},Qe=async(ve,He)=>{try{const Le=new Map;for(const Pe of ve){let At="Unknown Office",rt="Unknown Department";if(Pe.office_info&&Pe.office_info.office&&Pe.office_info.department)At=Pe.office_info.office,rt=Pe.office_info.department;else if(Pe.officeRoom&&Pe.officeRoom!=="—"){At=Pe.officeRoom;const St=Object.values(q).find(yt=>yt.office===Pe.officeRoom);St&&St.department&&(rt=St.department)}const Nt=`${rt}|${At}`;Le.has(Nt)||Le.set(Nt,{office:At,department:rt,totalConsumption:0,totalMonthlyConsumption:0,deviceCount:0,outlets:[]});const xt=Le.get(Nt);xt.totalConsumption+=Pe.total_energy||0;const st=parseFloat((Pe.monthUsage||"0 Wh").replace(/[^\d.]/g,""))||0;xt.totalMonthlyConsumption+=st,xt.deviceCount+=1,xt.outlets.push(Pe.outletId.split("_")[1]||Pe.outletId)}const Re=Array.from(Le.values()).sort((Pe,At)=>At.totalConsumption-Pe.totalConsumption).map((Pe,At)=>({rank:At+1,office:Pe.office,department:Pe.department,outlets:Pe.outlets.join(", "),consumption:Pe.totalConsumption*1e3,monthConsumption:Pe.totalMonthlyConsumption,deviceCount:Pe.deviceCount}));Ye(Re),console.log("Office Ranking calculated:",{period:He,totalOffices:Re.length,totalDevices:ve.length,rankingData:Re.slice(0,5),sampleDeviceData:ve.slice(0,2).map(Pe=>({outletId:Pe.outletId,total_energy:Pe.total_energy,office_info:Pe.office_info,officeRoom:Pe.officeRoom}))})}catch(Le){console.error("Error calculating office ranking:",Le),Ye([])}};me.useEffect(()=>{(async()=>{try{console.log("Fetching offices data from database...");const He=Me(je,"offices"),Le=await Pt(He);if(console.log("Database snapshot exists:",Le.exists()),console.log("Database snapshot value:",Le.val()),Le.exists()){const Re=Le.val();re(Re);const Pe=new Set,At=new Set;console.log("Processing offices data:",Object.keys(Re)),Object.values(Re).forEach(xt=>{console.log("Processing office entry:",{department:xt.department,office:xt.office,fullEntry:xt}),xt.department&&Pe.add(xt.department),xt.office&&At.add(xt.office)});const rt=Array.from(Pe);console.log("Fetched departments from database:",rt),console.log("Setting departments to:",["All Departments",...rt]),Sn(["All Departments",...rt]);const Nt=Array.from(At);console.log("Fetched offices from database:",Nt),se(Nt)}else console.log("No offices data found in database"),Sn(["All Departments"])}catch(He){console.error("Error fetching offices data:",He),Sn(["All Departments"])}})()},[]),me.useEffect(()=>{z("All Offices")},[K]),me.useEffect(()=>{let ve=R;K!=="All Departments"&&(le!=="All Offices"?ve=R.filter(Le=>{if(Le.office_info&&Le.office_info.department&&Le.office_info.office)return console.log("Device filtering check (office_info):",{deviceOfficeRoom:Le.officeRoom,deviceOfficeInfo:Le.office_info,selectedOffice:le,selectedDepartment:K,officeMatch:Le.office_info.office===le,departmentMatch:Le.office_info.department===K}),Le.office_info.department===K&&Le.office_info.office===le;if(q&&Le.officeRoom){const Re=Object.values(q).find(Pe=>Pe.office===Le.officeRoom);return console.log("Device filtering check (fallback):",{deviceOfficeRoom:Le.officeRoom,selectedOffice:le,selectedDepartment:K,deviceOfficeData:Re,officeMatch:Re&&Re.office===le,departmentMatch:Re&&Re.department===K}),Re&&Re.office===le&&Re.department===K}return!1}):ve=R.filter(Le=>{if(Le.office_info&&Le.office_info.department)return console.log("Department filtering check (office_info):",{deviceOfficeRoom:Le.officeRoom,deviceOfficeInfo:Le.office_info,selectedDepartment:K,departmentMatch:Le.office_info.department===K}),Le.office_info.department===K;if(q&&Le.officeRoom){const Re=Object.values(q).find(Pe=>Pe.office===Le.officeRoom);return console.log("Department filtering check (fallback):",{deviceOfficeRoom:Le.officeRoom,selectedDepartment:K,deviceOfficeData:Re,officeDepartment:Re?Re.department:"NOT_FOUND",matches:Re&&Re.department===K}),Re&&Re.department===K}return!1})),console.log("Dashboard filtering:",{department:K,office:le,totalDevices:R.length,filteredDevices:ve.length,officesData:Object.keys(q).length,allDevicesWithOfficeInfo:R.map(Le=>({outletId:Le.outletId,officeRoom:Le.officeRoom,office_info:Le.office_info,hasOfficeInfo:!!Le.office_info,hasDepartment:!!(Le.office_info&&Le.office_info.department),hasOffice:!!(Le.office_info&&Le.office_info.office)})),filteredDeviceDetails:ve.map(Le=>({outletId:Le.outletId,officeRoom:Le.officeRoom,appliances:Le.appliances,office_info:Le.office_info}))});const He=[...ve].sort((Le,Re)=>{const Pe=parseInt(Le.outletId.split("_")[1])||0,At=parseInt(Re.outletId.split("_")[1])||0;return Pe-At});Se(He)},[K,le,R,q]),me.useEffect(()=>{(async()=>{let He=R;if(K!=="All Departments"&&(le!=="All Offices"?He=R.filter(Le=>{if(Le.office_info&&Le.office_info.department&&Le.office_info.office)return console.log("Energy consumption filtering check (office_info):",{deviceOfficeRoom:Le.officeRoom,deviceOfficeInfo:Le.office_info,selectedOffice:le,selectedDepartment:K,officeMatch:Le.office_info.office===le,departmentMatch:Le.office_info.department===K}),Le.office_info.department===K&&Le.office_info.office===le;if(q&&Le.officeRoom){const Re=Object.values(q).find(Pe=>Pe.office===Le.officeRoom);return console.log("Energy consumption filtering check (fallback):",{deviceOfficeRoom:Le.officeRoom,selectedOffice:le,selectedDepartment:K,deviceOfficeData:Re,officeMatch:Re&&Re.office===le,departmentMatch:Re&&Re.department===K}),Re&&Re.office===le&&Re.department===K}return!1}):He=R.filter(Le=>{if(Le.office_info&&Le.office_info.department)return console.log("Energy consumption department filtering (office_info):",{deviceOfficeRoom:Le.officeRoom,deviceOfficeInfo:Le.office_info,selectedDepartment:K,departmentMatch:Le.office_info.department===K}),Le.office_info.department===K;if(q&&Le.officeRoom){const Re=Object.values(q).find(Pe=>Pe.office===Le.officeRoom);return console.log("Energy consumption department filtering (fallback):",{deviceOfficeRoom:Le.officeRoom,selectedDepartment:K,deviceOfficeData:Re,officeDepartment:Re?Re.department:"NOT_FOUND",matches:Re&&Re.department===K}),Re&&Re.department===K}return!1})),_!=="Day"){const Re=[...await mt(He,_)].sort((Pe,At)=>{const rt=parseInt(Pe.outletId.split("_")[1])||0,Nt=parseInt(At.outletId.split("_")[1])||0;return rt-Nt});lt(Re)}else{const Le=[...He].sort((Re,Pe)=>{const At=parseInt(Re.outletId.split("_")[1])||0,rt=parseInt(Pe.outletId.split("_")[1])||0;return At-rt});lt(Le)}if(T!=="Day"){const Re=[...await mt(He,T)].sort((Pe,At)=>At.total_energy-Pe.total_energy);pe(Re)}else{const Le=[...He].sort((Re,Pe)=>Pe.total_energy-Re.total_energy);pe(Le),console.log("Energy consumption filtering:",{department:K,office:le,totalDevices:R.length,filteredByOffice:He.length,filteredDevices:tt.length,filteredDevicesRank:Le.length})}if(A!=="Day"){const Le=await mt(He,A);await Qe(Le,A)}else await Qe(He,A)})()},[K,le,R,q,_,T,A]),me.useEffect(()=>{Ze()},[be]),me.useEffect(()=>{qt()},[be]),me.useEffect(()=>{fe()},[be]),me.useEffect(()=>{if(tt.length>0){const ve=tt.reduce((Le,Re)=>Le+(Re.lifetime_energy||0),0),He=tt.reduce((Le,Re)=>Le+(Re.total_energy||0),0);E(ve),M(He)}else E(0),M(0),De(0)},[tt]),me.useEffect(()=>{(async()=>{if(be.length>0){const He=await Xe(be),Le=await bt(be);Ne(He),We(Le)}else Ne(0),We(0)})()},[be,Ct]),me.useEffect(()=>{const ve=Le=>{qe.current&&(qe.current.contains(Le.target)||(o(!1),te(!1)))},He=Le=>{Le.key==="Escape"&&(o(!1),te(!1))};return document.addEventListener("mousedown",ve),document.addEventListener("keydown",He),()=>{document.removeEventListener("mousedown",ve),document.removeEventListener("keydown",He)}},[]);const dt=ve=>{const He={on:"status-active",off:"status-inactive",Idle:"status-idle"};return u.jsxs("span",{className:`status-badge ${He[ve]||"status-inactive"}`,children:[u.jsx("span",{className:`status-dot ${He[ve]||"status-inactive"}`}),ve==="on"?"Active":ve==="off"?"Inactive":"Idle"]})};return u.jsxs("div",{className:"dash-wrap",children:[u.jsxs("section",{className:"dash-hero",children:[u.jsxs("div",{className:"hero-left",children:[u.jsx("div",{className:"hero-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"3",y:"4",width:"18",height:"5",rx:"2",fill:"#dbe7ff"}),u.jsx("rect",{x:"3",y:"10",width:"10",height:"10",rx:"2",fill:"#a9b9ff"}),u.jsx("rect",{x:"14",y:"10",width:"7",height:"10",rx:"2",fill:"#dbe7ff"})]})}),u.jsxs("div",{className:"hero-text",children:[u.jsx("h1",{children:"Energy Dashboard"}),u.jsx("p",{children:"Monitor and optimize your electricity consumption"})]})]}),u.jsxs("div",{className:"dropdowns-container",ref:qe,children:[u.jsxs("div",{className:"dropdown",children:[u.jsxs("button",{className:"hero-pill",type:"button",onClick:()=>o(ve=>!ve),"aria-haspopup":"listbox","aria-expanded":s,"aria-controls":"dept-menu",children:[u.jsx("span",{children:K}),u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",style:{transform:s?"rotate(180deg)":"rotate(0deg)",transition:"transform .2s ease"},children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})]}),s&&u.jsx("ul",{id:"dept-menu",role:"listbox",className:"dropdown-menu",children:dn.map(ve=>u.jsx("li",{children:u.jsx("button",{role:"option","aria-selected":K===ve,className:`menu-item ${K===ve?"selected":""}`,onClick:()=>{de(ve),o(!1)},children:ve})},ve))})]}),K!=="All Departments"&&u.jsxs("div",{className:"dropdown",children:[u.jsxs("button",{className:"hero-pill",type:"button",onClick:()=>te(ve=>!ve),"aria-haspopup":"listbox","aria-expanded":W,"aria-controls":"office-menu",children:[u.jsx("span",{children:le}),u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",style:{transform:W?"rotate(180deg)":"rotate(0deg)",transition:"transform .2s ease"},children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})]}),W&&u.jsx("ul",{id:"office-menu",role:"listbox",className:"dropdown-menu",children:Te().map(ve=>u.jsx("li",{children:u.jsx("button",{role:"option","aria-selected":le===ve,className:`menu-item ${le===ve?"selected":""}`,onClick:()=>{z(ve),te(!1)},children:ve})},ve))})]})]})]}),u.jsxs("section",{className:"panel",children:[u.jsxs("header",{className:"panel-head",children:[u.jsx("span",{className:"bolt","aria-hidden":"true",children:"⚡"}),u.jsx("h2",{children:"Overall Consumption"}),u.jsx("p",{className:"panel-subtitle",children:K==="All Departments"?`Showing data for all departments (${be.length} devices)`:le==="All Offices"?`Showing data for ${K} department (${be.length} devices)`:`Showing data for ${le} office (${be.length} devices)`})]}),u.jsxs("div",{className:"stats-grid",children:[u.jsxs("article",{className:"stat-card stat-accent",children:[u.jsx("div",{className:"stat-title",children:"CURRENT USAGE THIS MONTH"}),u.jsx("div",{className:"stat-value",children:t(Y)}),u.jsx("div",{className:"stat-unit",children:"Wh"}),u.jsx("div",{className:"stat-badge up",children:"↑ This Month"})]}),u.jsxs("article",{className:"stat-card",children:[u.jsx("div",{className:"stat-title",children:"DAILY AVERAGE"}),u.jsx("div",{className:"stat-value",children:t(Ae)}),u.jsx("div",{className:"stat-unit",children:"Wh"})]}),u.jsxs("article",{className:"stat-card",children:[u.jsx("div",{className:"stat-title",children:"CURRENT RATE"}),u.jsxs("div",{className:"stat-value",children:["₱",t(Ue,2)]}),u.jsx("div",{className:"stat-unit",children:"per kWh"}),Ce&&u.jsxs("div",{className:"stat-badge",style:{fontSize:"10px",marginTop:"4px"},children:["Updated: ",Ce]})]})]})]}),u.jsxs("section",{className:"cards-row",children:[u.jsxs("div",{className:"mini-card purple",children:[u.jsx("div",{className:"mini-icon-circle purple","aria-hidden":"true",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M13 3L4 14h6l-1 7 9-11h-6l1-7z",fill:"#ffffff"})})}),u.jsxs("div",{className:"mini-main",children:[u.jsxs("div",{className:"mini-title",children:[t(Q)," Wh"]}),u.jsx("div",{className:"mini-sub",children:"Total Energy Usage"})]}),u.jsx("div",{className:"mini-badge",children:"Total energy consumption"})]}),u.jsxs("div",{className:"mini-card yellow",children:[u.jsx("div",{className:"mini-icon-circle yellow","aria-hidden":"true",children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2",fill:"#ffffff"}),u.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6",stroke:"#ffffff",strokeWidth:"2"}),u.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6",stroke:"#ffffff",strokeWidth:"2"}),u.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10",stroke:"#ffffff",strokeWidth:"2"})]})}),u.jsxs("div",{className:"mini-main",children:[u.jsxs("div",{className:"mini-title",children:[t(O*1e3)," Wh"]}),u.jsx("div",{className:"mini-sub",children:"Today Consumption"})]}),u.jsx("div",{className:"mini-badge",children:"Total energy consumed"})]}),u.jsxs("div",{className:"mini-card green",children:[u.jsx("div",{className:"mini-icon-circle green","aria-hidden":"true",children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M3 7h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7z",fill:"#ffffff"}),u.jsx("path",{d:"M7 11h10M9 14h6",stroke:"#16a34a",strokeWidth:"2",strokeLinecap:"round"})]})}),u.jsxs("div",{className:"mini-main",children:[u.jsxs("div",{className:"mini-title",children:["₱",t(Ve,2)]}),u.jsx("div",{className:"mini-sub",children:"Estimated Monthly Bill"})]}),u.jsx("div",{className:"mini-badge",children:"Based on current consumption"})]})]}),u.jsxs("section",{className:"energy-analytics-container",children:[u.jsx("div",{className:"analytics-header",children:u.jsxs("div",{className:"analytics-title",children:[u.jsx("h2",{children:"Energy Consumption"}),u.jsx("p",{children:"Track your energy usage over time"})]})}),u.jsxs("div",{className:"tables-section",children:[u.jsxs("div",{className:"table-panel",children:[u.jsxs("div",{className:"table-header",children:[u.jsx("div",{className:"table-subtitle",children:u.jsx("h4",{children:"Per Device Consumption"})}),u.jsxs("div",{className:"filter-container",children:[u.jsxs("button",{className:"filter-dropdown-btn",type:"button",onClick:()=>c(ve=>!ve),children:[u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),u.jsx("span",{children:_==="Day"?Tt().day:_==="Week"?Tt().week:_==="Month"?Tt().month:_==="Year"?Tt().year:"Day"}),u.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform .2s ease"},children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})]}),l&&u.jsxs("div",{className:"filter-dropdown-menu",children:[u.jsx("button",{className:`filter-option ${_==="Day"?"active":""}`,type:"button",onClick:()=>{b("Day"),c(!1)},children:"Day"}),u.jsx("button",{className:`filter-option ${_==="Week"?"active":""}`,type:"button",onClick:()=>{b("Week"),c(!1)},children:"Week"}),u.jsx("button",{className:`filter-option ${_==="Month"?"active":""}`,type:"button",onClick:()=>{b("Month"),c(!1)},children:"Month"}),u.jsx("button",{className:`filter-option ${_==="Year"?"active":""}`,type:"button",onClick:()=>{b("Year"),c(!1)},children:"Year"})]})]})]}),u.jsx("div",{className:"table-container",children:u.jsxs("table",{className:"data-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:"Outlet Number"}),u.jsx("th",{children:"Appliances"}),u.jsx("th",{children:"Today Consumption"}),u.jsx("th",{children:"Month Consumption"}),u.jsx("th",{children:"Office/ Room"}),u.jsx("th",{children:"Status"})]})}),u.jsx("tbody",{children:tt.length>0?tt.map((ve,He)=>u.jsxs("tr",{children:[u.jsx("td",{children:(He+1).toString().padStart(3,"0")}),u.jsx("td",{children:ve.outletId.split("_")[1]}),u.jsx("td",{children:ve.appliances}),u.jsxs("td",{children:[t(ve.total_energy*1e3)," Wh"]}),u.jsx("td",{children:ve.monthUsage||"0.000 Wh"}),u.jsx("td",{children:ve.officeRoom}),u.jsx("td",{children:dt(ve.status)})]},ve.outletId)):u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data-message",children:`No data available for ${_.toLowerCase()} period`})})})]})})]}),u.jsxs("div",{className:"table-panel",children:[u.jsxs("div",{className:"table-header",children:[u.jsx("div",{className:"table-title",children:u.jsx("h3",{children:"Usage Rank"})}),u.jsxs("div",{className:"filter-container",children:[u.jsxs("button",{className:"filter-dropdown-btn",type:"button",onClick:()=>f(ve=>!ve),children:[u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),u.jsx("span",{children:T==="Day"?Tt().day:T==="Week"?Tt().week:T==="Month"?Tt().month:T==="Year"?Tt().year:"Day"}),u.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{transform:d?"rotate(180deg)":"rotate(0deg)",transition:"transform .2s ease"},children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})]}),d&&u.jsxs("div",{className:"filter-dropdown-menu",children:[u.jsx("button",{className:`filter-option ${T==="Day"?"active":""}`,type:"button",onClick:()=>{C("Day"),f(!1)},children:"Day"}),u.jsx("button",{className:`filter-option ${T==="Week"?"active":""}`,type:"button",onClick:()=>{C("Week"),f(!1)},children:"Week"}),u.jsx("button",{className:`filter-option ${T==="Month"?"active":""}`,type:"button",onClick:()=>{C("Month"),f(!1)},children:"Month"}),u.jsx("button",{className:`filter-option ${T==="Year"?"active":""}`,type:"button",onClick:()=>{C("Year"),f(!1)},children:"Year"})]})]})]}),u.jsx("div",{className:"table-container",children:u.jsxs("table",{className:"data-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:"Outlet number"}),u.jsx("th",{children:"Appliances"}),u.jsx("th",{children:"Today Consumption"}),u.jsx("th",{children:"Month Consumption"}),u.jsx("th",{children:"Office/ Room"}),u.jsx("th",{children:"Status"})]})}),u.jsx("tbody",{children:$e.length>0?$e.sort((ve,He)=>He.total_energy-ve.total_energy).map((ve,He)=>u.jsxs("tr",{children:[u.jsx("td",{children:He+1}),u.jsx("td",{children:ve.outletId.split("_")[1]}),u.jsx("td",{children:ve.appliances}),u.jsxs("td",{children:[t(ve.total_energy*1e3)," Wh"]}),u.jsx("td",{children:ve.monthUsage||"0.000 Wh"}),u.jsx("td",{children:ve.officeRoom}),u.jsx("td",{children:dt(ve.status)})]},ve.outletId)):u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data-message",children:`No data available for ${T.toLowerCase()} period`})})})]})})]})]}),u.jsxs("div",{className:"table-panel",children:[u.jsxs("div",{className:"table-header",children:[u.jsx("div",{className:"table-title",children:u.jsx("h3",{children:"Office Ranking"})}),u.jsxs("div",{className:"filter-container",children:[u.jsxs("button",{className:"filter-dropdown-btn",type:"button",onClick:()=>v(ve=>!ve),children:[u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),u.jsx("span",{children:A==="Day"?Tt().day:A==="Week"?Tt().week:A==="Month"?Tt().month:A==="Year"?Tt().year:"Day"}),u.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{transform:p?"rotate(180deg)":"rotate(0deg)",transition:"transform .2s ease"},children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})]}),p&&u.jsxs("div",{className:"filter-dropdown-menu",children:[u.jsx("button",{className:`filter-option ${A==="Day"?"active":""}`,type:"button",onClick:()=>{I("Day"),v(!1)},children:"Day"}),u.jsx("button",{className:`filter-option ${A==="Week"?"active":""}`,type:"button",onClick:()=>{I("Week"),v(!1)},children:"Week"}),u.jsx("button",{className:`filter-option ${A==="Month"?"active":""}`,type:"button",onClick:()=>{I("Month"),v(!1)},children:"Month"}),u.jsx("button",{className:`filter-option ${A==="Year"?"active":""}`,type:"button",onClick:()=>{I("Year"),v(!1)},children:"Year"})]})]})]}),u.jsx("div",{className:"table-container",children:u.jsxs("table",{className:"data-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Rank"}),u.jsx("th",{children:"Office"}),u.jsx("th",{children:"Department"}),u.jsx("th",{children:"Outlet"}),u.jsx("th",{children:"Today Consumption"}),u.jsx("th",{children:"Month Consumption"})]})}),u.jsx("tbody",{children:Ee.length>0?Ee.map(ve=>u.jsxs("tr",{children:[u.jsx("td",{children:ve.rank}),u.jsx("td",{children:ve.office}),u.jsx("td",{children:ve.department}),u.jsx("td",{children:ve.outlets}),u.jsxs("td",{children:[t(ve.consumption)," Wh"]}),u.jsxs("td",{children:[t(ve.monthConsumption)," Wh"]})]},`${ve.department}-${ve.office}`)):u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"no-data-message",children:`No data available for ${A.toLowerCase()} period`})})})]})})]})]}),u.jsxs("section",{className:"consumption-report-container",children:[u.jsx("div",{className:"report-header",children:u.jsx("h2",{children:"Consumption Report"})}),u.jsxs("div",{className:"report-content",children:[u.jsxs("div",{className:"chart-panel",children:[u.jsxs("div",{className:"chart-header",children:[u.jsxs("h3",{children:[ee," Consumption"]}),u.jsx("div",{className:"chart-controls",children:u.jsxs("div",{className:"time-segments",children:[u.jsx("button",{className:`segment-btn ${ee==="Week"?"active":""}`,onClick:()=>G("Week"),children:"Week"}),u.jsx("button",{className:`segment-btn ${ee==="Month"?"active":""}`,onClick:()=>G("Month"),children:"Month"}),u.jsx("button",{className:`segment-btn ${ee==="Year"?"active":""}`,onClick:()=>G("Year"),children:"Year"})]})})]}),u.jsx("div",{className:"chart-area",onClick:()=>Dt(!0),style:{cursor:"pointer"},children:gt.energyUsage.length>0&&gt.labels.length>0?an?u.jsx(nu,{data:{labels:gt.labels,datasets:[{label:"Energy Usage (Wh)",data:gt.energyUsage.map(ve=>(ve[0]||0)*1e3),backgroundColor:"#2563eb",borderColor:"#2563eb",borderWidth:2,borderRadius:0,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{top:0,bottom:0,left:5,right:5}},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#eab308",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(ve){const He=ve.parsed.y;return`Energy Usage: ${t(He)} Wh`}}}},scales:{y:{beginAtZero:!0,grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:12},padding:2,maxTicksLimit:6},border:{display:!1},title:{display:!0,text:"Energy (Wh)",color:"#374151",font:{size:14,weight:"bold"},padding:{top:2,bottom:2}}},x:{grid:{display:!1},ticks:{color:"#6b7280",font:{size:14,weight:"bold"},padding:5},border:{display:!1},title:{display:!0,text:"Date",color:"#374151",font:{size:14,weight:"bold"},padding:{top:2,bottom:2}}}}}}):u.jsx(nu,{data:{labels:gt.labels,datasets:tt.map((ve,He)=>{const Le=["#2563eb","#059669","#dc2626","#7c3aed","#ea580c","#0891b2","#be123c","#65a30d"],Re=Le[He%Le.length];return{label:`Outlet ${ve.outletId.split("_")[1]} - Energy (Wh)`,data:gt.energyUsage.map(Pe=>(Pe[He]||0)*1e3),backgroundColor:Re,borderColor:Re,borderWidth:2,borderRadius:0,borderSkipped:!1}})},options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{top:0,bottom:0,left:2,right:2}},plugins:{legend:{display:!0,position:"top",labels:{usePointStyle:!0,padding:5,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#eab308",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(ve){const He=ve.parsed.y;return`${ve.dataset.label||""}: ${t(He)} Wh`}}}},scales:{y:{beginAtZero:!0,grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:10},padding:2,maxTicksLimit:5},border:{display:!1},title:{display:!0,text:"Energy (Wh)",color:"#374151",font:{size:12,weight:"bold"},padding:{top:10,bottom:10}}},x:{grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:10},padding:2},border:{display:!1},title:{display:!0,text:"Date",color:"#374151",font:{size:12,weight:"bold"},padding:{top:10,bottom:10}}}}}}):u.jsxs("div",{className:"chart-no-data",children:[u.jsx("div",{className:"chart-no-data-icon",children:u.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#6b7280",strokeWidth:"2",strokeLinecap:"round"})})}),u.jsxs("div",{className:"chart-no-data-text",children:[u.jsx("h3",{children:"No Data Available"}),u.jsx("p",{children:"No energy consumption data found for the selected time period."})]})]})})]}),u.jsxs("div",{className:"dashboard-device-usage-panel",children:[u.jsxs("div",{className:"dashboard-device-header",children:[u.jsxs("h3",{children:["Usage",u.jsx("br",{}),"per device"]}),u.jsx("button",{className:"dashboard-see-all-btn",onClick:()=>n?.("reports"),children:"See All"})]}),u.jsx("div",{className:"dashboard-device-list",children:on.map((ve,He)=>u.jsxs("div",{className:"dashboard-device-item",children:[u.jsxs("div",{className:"dashboard-device-info",children:[u.jsx("span",{className:"dashboard-device-name",children:ve.name}),u.jsxs("span",{className:"dashboard-device-usage",children:[ve.usageDisplay," (",t(ve.percentage,1),"%)"]})]}),u.jsx("div",{className:"dashboard-progress-bar",children:u.jsx("div",{className:"dashboard-progress-fill",style:{width:`${ve.percentage}%`}})})]},He))})]})]})]}),Zt&&u.jsx("div",{className:"chart-modal-overlay",onClick:()=>Dt(!1),children:u.jsxs("div",{className:"chart-modal-content",onClick:ve=>ve.stopPropagation(),children:[u.jsxs("div",{className:"chart-modal-header",children:[u.jsxs("h3",{children:[ee," Consumption - Full View"]}),u.jsx("button",{className:"chart-modal-close",onClick:()=>Dt(!1),"aria-label":"Close modal",children:u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsx("div",{className:"chart-modal-body",children:gt.energyUsage.length>0&&gt.labels.length>0?an?u.jsx(nu,{data:{labels:gt.labels,datasets:[{label:"Energy Usage (Wh)",data:gt.energyUsage.map(ve=>(ve[0]||0)*1e3),backgroundColor:"#2563eb",borderColor:"#2563eb",borderWidth:2,borderRadius:0,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:30,bottom:30,left:20,right:20}},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#eab308",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(ve){const He=ve.parsed.y;return`Energy Usage: ${t(He)} W`}}}},scales:{y:{beginAtZero:!0,grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:14},padding:8,maxTicksLimit:8},border:{display:!1},title:{display:!0,text:"Energy (Wh)",color:"#374151",font:{size:16,weight:"bold"},padding:{top:2,bottom:2}}},x:{grid:{display:!1},ticks:{color:"#6b7280",font:{size:16,weight:"bold"},padding:10},border:{display:!1},title:{display:!0,text:"Date",color:"#374151",font:{size:16,weight:"bold"},padding:{top:2,bottom:2}}}}}}):u.jsx(nu,{data:{labels:gt.labels,datasets:tt.map((ve,He)=>{const Le=["#2563eb","#059669","#dc2626","#7c3aed","#ea580c","#0891b2","#be123c","#65a30d"],Re=Le[He%Le.length];return{label:`Outlet ${ve.outletId.split("_")[1]} - Energy (Wh)`,data:gt.energyUsage.map(Pe=>(Pe[He]||0)*1e3),backgroundColor:Re,borderColor:Re,borderWidth:2,borderRadius:0,borderSkipped:!1}})},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:20,bottom:20,left:10,right:10}},plugins:{legend:{display:!0,position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#eab308",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(ve){const He=ve.parsed.y;return`${ve.dataset.label||""}: ${t(He)} Wh`}}}},scales:{y:{beginAtZero:!0,grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:12},padding:5,maxTicksLimit:6},border:{display:!1},title:{display:!0,text:"Energy (Wh)",color:"#374151",font:{size:14,weight:"bold"},padding:{top:10,bottom:10}}},x:{grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:12},padding:5},border:{display:!1},title:{display:!0,text:"Date",color:"#374151",font:{size:14,weight:"bold"},padding:{top:10,bottom:10}}}}}}):u.jsxs("div",{className:"chart-no-data",children:[u.jsx("div",{className:"chart-no-data-icon",children:u.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#6b7280",strokeWidth:"2",strokeLinecap:"round"})})}),u.jsxs("div",{className:"chart-no-data-text",children:[u.jsx("h3",{children:"No Data Available"}),u.jsx("p",{children:"No energy consumption data found for the selected time period."})]})]})})]})})]})}const r1=async(n,e,t,i,s)=>{try{let o,l="",c="";if(!s)if(Nr.currentUser)o=Nr.currentUser.displayName||Nr.currentUser.email||"Authenticated User",l=Nr.currentUser.uid,c="user";else{const T=localStorage.getItem("currentUser");if(T){const C=JSON.parse(T);o=C.displayName||C.email||"Unknown User",l=C.uid||"",c=C.role||"Coordinator"}else o="Unknown User",c="unknown"}const d=Me(je,`devices/${e.replace(" ","_")}`),f=await Pt(d);let p=t,v=i;if(f.exists()){const T=f.val();p=T.office_info?.office_room||t,v=T.appliances||i}const _={user:o,activity:n,officeRoom:p,outletSource:e,applianceConnected:v,timestamp:new Date().toISOString(),userId:l,userRole:c},b=Me(je,"device_logs");await w0(b,_),console.log("✅ Device activity logged:",_)}catch(o){console.error("❌ Error logging device activity:",o)}},wF=async(n,e,t,i)=>{try{console.log("🔍 LOGGING COMBINED LIMIT ACTIVITY:",{activity:n,selectedOutlets:e,combinedLimit:t,user:i});let s="";if(e.length===1)s=e[0].replace("Outlet ","Outlet");else if(e.length>1){const l=e.map(c=>c.replace("Outlet ","")).sort((c,d)=>parseInt(c)-parseInt(d));l.length>1?s=`Outlet${l[0]} to ${l[l.length-1]}`:s=e.join(", ").replace("Outlet ","Outlet")}const o=n.replace("combined limit","Monthly Limit");console.log("🔍 FINAL LOGGING DATA:",{shortActivity:o,outletList:s,user:i}),await r1(`${o} (${s})`,"Multiple Outlets","System","Combined Group",i),console.log("✅ COMBINED LIMIT ACTIVITY LOGGED SUCCESSFULLY")}catch(s){console.error("❌ Error logging combined limit activity:",s)}},_F=async(n,e,t,i,s,o)=>{try{const l=t==="No Limit"||t===0?"No Limit":`${t}Wh`;await r1(`${n} - ${l}`,e,i,s,o)}catch(l){console.error("❌ Error logging individual limit activity:",l)}},Zy=async(n,e,t,i,s,o)=>{try{await r1(`${n} - ${t}`,e,i,s,o)}catch(l){console.error("❌ Error logging schedule activity:",l)}},xF=async(n,e,t,i,s)=>{try{await r1(n,e,t,i,s)}catch(o){console.error("❌ Error logging device control activity:",o)}},iu=(n,e=3)=>n.toLocaleString("en-US",{minimumFractionDigits:e,maximumFractionDigits:e}),cC=n=>n.split(/[\s-]+/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "),eN=n=>{try{const e=new Date,t=e.getFullYear(),i=e.getMonth()+1,s=new Date(t,i,0).getDate();let o=0;for(let l=1;l<=s;l++){const c=`day_${t}_${String(i).padStart(2,"0")}_${String(l).padStart(2,"0")}`,d=n.daily_logs?.[c];d&&d.total_energy&&(o+=d.total_energy)}return`${iu(o*1e3)} Wh`}catch(e){return console.error("Error calculating monthly energy:",e),"0.000 Wh"}},Pm=(n,e)=>{try{const t=new Date,i=t.getFullYear(),s=t.getMonth()+1,o=new Date(i,s,0).getDate();let l=0;const c=new Set;return console.log("🔍 MONTHLY ENERGY CALCULATION:",{currentYear:i,currentMonth:s,daysInMonth:o,selectedOutlets:[...new Set(e)],totalOutlets:e.length,uniqueOutlets:[...new Set(e)].length}),e.forEach((d,f)=>{if(c.has(d)){console.log(`⚠️ DUPLICATE SKIPPED: ${d} (already processed)`);return}c.add(d);const p=d.replace(" ","_"),v=n[p];if(console.log(`🔍 Processing outlet ${f+1}/${e.length}: ${d} -> ${p}`),v&&v.daily_logs){let _=0,b=0;for(let T=1;T<=o;T++){const C=`day_${i}_${String(s).padStart(2,"0")}_${String(T).padStart(2,"0")}`,A=v.daily_logs[C];if(A&&A.total_energy&&A.total_energy>0){const I=A.total_energy*1e3;_+=I,b++,console.log(`📊 ${d} Day ${T}: ${A.total_energy} kW = ${I} W`)}}l+=_,console.log(`📊 ${d} MONTHLY TOTAL: ${_} W (${b} days with data)`)}else console.log(`❌ ${d}: device not found or no daily_logs`),v&&console.log("🔍 Available fields:",Object.keys(v))}),console.log(`📊 FINAL COMBINED MONTHLY ENERGY: ${l} W`),console.log(`📊 Processed ${c.size} unique outlets`),l}catch(t){return console.error("❌ Error calculating combined monthly energy:",t),0}},Vu=async(n,e)=>{try{if(console.log("🔍 Monthly limit check - Input data:",{combinedLimitInfo:e,devicesDataKeys:Object.keys(n||{}),enabled:e?.enabled,selectedOutlets:e?.selectedOutlets,combinedLimit:e?.combinedLimit}),!e?.enabled||!e?.selectedOutlets||e.selectedOutlets.length===0){console.log("🚫 Monthly limit check skipped - not enabled or no outlets selected");return}const t=Pm(n,e.selectedOutlets),i=e.combinedLimit;if(console.log("📊 Monthly limit check results:",{totalMonthlyEnergy:`${t.toFixed(3)}W`,combinedLimitWatts:`${i}W`,selectedOutlets:e.selectedOutlets,exceedsLimit:t>=i,percentage:i>0?`${(t/i*100).toFixed(1)}%`:"N/A"}),t>=i){console.log("🚨 MONTHLY LIMIT EXCEEDED!"),console.log(`📊 Current: ${t.toFixed(3)}W >= Limit: ${i}W`),console.log("🔒 TURNING OFF ALL DEVICES IN THE GROUP...");const s=e.selectedOutlets.map(async d=>{try{const f=d.replace(" ","_"),p=Me(je,`devices/${f}/control`);await Kt(p,{device:"off"});const v=Me(je,`devices/${f}`);return await Kt(v,{status:"OFF"}),console.log(`✅ TURNED OFF: ${d} (${f}) due to monthly limit`),{outletKey:d,success:!0}}catch(f){return console.error(`❌ FAILED to turn off ${d}:`,f),{outletKey:d,success:!1,error:f}}}),o=await Promise.all(s),l=o.filter(d=>d.success).length,c=o.filter(d=>!d.success).length;console.log(`🔒 MONTHLY LIMIT ENFORCEMENT COMPLETE: ${l} turned off, ${c} failed`)}else console.log("✅ Monthly limit not exceeded - devices can remain active"),console.log(`📊 Current: ${t.toFixed(3)}W < Limit: ${i}W`)}catch(t){console.error("❌ Error checking combined monthly limit:",t)}},SF=async n=>{try{console.log(`🔧 Attempting to remove ${n} from combined group due to monthly limit exceeded`);const e=Me(je,"combined_limit_settings"),t=await Pt(e);if(!t.exists())return{success:!1,reason:"No combined limit settings found"};const i=t.val(),s=i.selected_outlets||[];if(!s.includes(n))return{success:!1,reason:"Device is not in combined group"};const o=s.filter(l=>l!==n);await Kt(e,{...i,selected_outlets:o});try{const l=Me(je,`devices/${n}/control`);await Kt(l,{device:"off"});const c=Me(je,`devices/${n}`);await Kt(c,{status:"OFF"}),console.log(`🔒 SetUp: Turned OFF ${n} after removing from combined group (now subject to individual daily limits)`)}catch(l){console.error(`❌ Error turning off device ${n} after removal from combined group:`,l)}return console.log(`✅ Successfully removed ${n} from combined group and turned it OFF. Remaining outlets: ${o.length}`),{success:!0,reason:`Device removed from combined group and turned OFF. Remaining outlets: ${o.length}`}}catch(e){return console.error("❌ Error removing device from combined group:",e),{success:!1,reason:"Failed to remove device from combined group"}}},NF=async(n,e)=>{try{if(!e.enabled||e.selectedOutlets.length===0)return{canTurnOn:!0};if(!e.selectedOutlets.includes(n))return{canTurnOn:!0};const t=Me(je,"devices"),i=await Pt(t);if(!i.exists())return{canTurnOn:!0};const s=i.val(),o=Pm(s,e.selectedOutlets),l=e.combinedLimit;return console.log("Monthly limit check before turn ON:",{outletKey:n,totalMonthlyEnergy:o,combinedLimitWatts:l,selectedOutlets:e.selectedOutlets,wouldExceed:o>=l}),o>=l?{canTurnOn:!1,reason:`Monthly limit exceeded. Current monthly energy: ${(o/1e3).toFixed(3)} kW, Limit: ${(l/1e3).toFixed(3)} kW`,currentMonthlyEnergy:o,combinedLimit:l}:{canTurnOn:!0}}catch(t){return console.error("Error checking monthly limit before turn ON:",t),{canTurnOn:!0}}},EF=(n,e)=>{e(t=>(t[n]&&(clearTimeout(t[n]),console.log(`🔄 Auto-turnoff: Cleared timer for ${n} - device is now idle or turned off`)),{...t,[n]:null}))};function pm({id:n,value:e,placeholder:t,options:i,onChange:s,error:o,disabled:l}){const[c,d]=me.useState(!1),f=me.useRef(null);me.useEffect(()=>{const v=b=>{f.current&&(f.current.contains(b.target)||d(!1))},_=b=>{b.key==="Escape"&&d(!1)};return document.addEventListener("mousedown",v),document.addEventListener("keydown",_),()=>{document.removeEventListener("mousedown",v),document.removeEventListener("keydown",_)}},[]);const p=i.find(v=>v.value===e);return u.jsxs("div",{className:`styled-select${c?" open":""}${l?" disabled":""}`,ref:f,children:[u.jsxs("button",{type:"button",id:n,className:`styled-select-btn${o?" error":""}${l?" disabled":""}`,"aria-haspopup":"listbox","aria-expanded":c,onClick:()=>!l&&d(v=>!v),disabled:l,children:[u.jsx("span",{className:`styled-select-label ${p?"":"placeholder"}`,children:p?.label??t}),u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",style:{transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform .2s ease"},children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})]}),c&&u.jsx("ul",{role:"listbox",className:"styled-options",children:i.map(v=>u.jsx("li",{children:u.jsx("button",{type:"button",role:"option","aria-selected":e===v.value,className:`styled-option${e===v.value?" active":""}${v.disabled?" disabled":""}`,onClick:()=>{v.disabled||(s(v.value),d(!1))},disabled:v.disabled,children:v.label})},v.value))})]})}function uC({isOpen:n,onClose:e,title:t="Device Added Successfully!",message:i="Your new device has been configured and added to the system."}){return n?u.jsx("div",{className:"modal-overlay success-overlay",onClick:e,children:u.jsxs("div",{className:"setup-success-modal",onClick:s=>s.stopPropagation(),children:[u.jsx("div",{className:"setup-success-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#10b981",stroke:"#10b981",strokeWidth:"2"}),u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#ffffff",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("h3",{children:t}),u.jsx("p",{children:i}),u.jsx("button",{className:"btn-primary",onClick:e,children:"Continue"})]})}):null}function TF({isOpen:n,onClose:e,onConfirm:t,deviceName:i}){return n?u.jsx("div",{className:"modal-overlay delete-overlay",onClick:e,children:u.jsxs("div",{className:"delete-modal",onClick:s=>s.stopPropagation(),children:[u.jsx("div",{className:"delete-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef2f2",stroke:"#fbbf24",strokeWidth:"2"}),u.jsx("path",{d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",fill:"#f59e0b"})]})}),u.jsx("h3",{children:"Delete Device"}),u.jsxs("p",{children:["Are you sure you want to delete ",u.jsxs("strong",{children:['"',i,'"']}),"? This action cannot be undone."]}),u.jsxs("div",{className:"delete-actions",children:[u.jsx("button",{className:"btn-secondary",onClick:e,children:"Cancel"}),u.jsx("button",{className:"btn-danger",onClick:t,children:"Delete Device"})]})]})}):null}function CF({isOpen:n,onClose:e,deviceName:t}){return n?u.jsx("div",{className:"modal-overlay success-overlay",onClick:e,children:u.jsxs("div",{className:"setup-delete-success-modal",onClick:i=>i.stopPropagation(),children:[u.jsx("div",{className:"setup-delete-success-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#10b981",stroke:"#10b981",strokeWidth:"2"}),u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#ffffff",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("h3",{children:"Device Deleted Successfully!"}),u.jsxs("p",{children:[u.jsxs("strong",{children:['"',t,'"']})," has been removed from the system."]}),u.jsx("button",{className:"btn-primary",onClick:e,children:"Continue"})]})}):null}function kF({isOpen:n,onClose:e,device:t,onGoToSetup:i}){if(!n||!t)return null;const s=!t.powerLimit||t.powerLimit<=0,o=!s&&t.todayTotalEnergy>=t.powerLimit;let l="",c="",d="",f="",p="",v="",_="";return s?(l="Power Limit Required!",c=`"${t.outletName}" cannot be turned ON without a power limit.`,d="Current Status:",f="No Power Limit Set",p="Required Action:",v="Set Power Limit",_="For safety reasons, devices must have a power limit before they can be activated. Please set a power limit in the Setup section."):o&&(l="Power Limit Exceeded!",c=`"${t.outletName}" cannot be turned ON because today's energy consumption has exceeded the power limit.`,d="Today's Energy:",f=`${iu(t.todayTotalEnergy*1e3||0)} Wh`,p="Power Limit:",v=`${t.powerLimit*1e3||"0"} Wh`,_="Today's total energy consumption has reached or exceeded the daily power limit. The device cannot be activated until tomorrow or the power limit is increased."),u.jsx("div",{className:"modal-overlay warning-overlay",onClick:e,children:u.jsxs("div",{className:"warning-modal",onClick:b=>b.stopPropagation(),children:[u.jsx("div",{className:"warning-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",fill:"#f59e0b"})]})}),u.jsx("h3",{children:l}),u.jsx("p",{children:u.jsx("strong",{children:c})}),u.jsxs("div",{className:"warning-details",children:[u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:d}),u.jsx("span",{className:"value",children:f})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:p}),u.jsx("span",{className:"value",children:v})]}),o&&t.currentDate&&t.currentTime&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Date:"}),u.jsx("span",{className:"value",children:t.currentDate})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Time:"}),u.jsx("span",{className:"value",children:t.currentTime})]})]})]}),u.jsx("p",{className:"warning-message",children:_}),u.jsxs("div",{className:"warning-actions",children:[u.jsx("button",{className:"btn-secondary",onClick:e,children:"Cancel"}),u.jsx("button",{className:"btn-warning",onClick:i,children:"Go to Setup"})]})]})})}function LF({device:n,newPowerLimit:e}){const[t,i]=me.useState(null),[s,o]=me.useState(!0);return me.useEffect(()=>{(async()=>{try{const c=n.outletName.replace(" ","_"),d=Me(je,`devices/${c}`),p=(await Pt(d)).val(),v=new Date,_=`day_${v.getFullYear()}_${String(v.getMonth()+1).padStart(2,"0")}_${String(v.getDate()).padStart(2,"0")}`,T=p?.daily_logs?.[_]?.total_energy||0;i(T)}catch(c){console.error("Error fetching today's energy data:",c);const d=n.powerUsage.includes("kW")?parseFloat(n.powerUsage.replace(" kW","")):parseFloat(n.powerUsage.replace(" Wh",""))/1e3;i(d)}finally{o(!1)}})()},[n]),s?null:t!==null&&e<t?u.jsxs("div",{className:"field-warning field-warning-error",children:[u.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef2f2",stroke:"#dc2626",strokeWidth:"2"}),u.jsx("path",{d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",fill:"#dc2626"})]}),u.jsxs("span",{children:["Power limit (",(e*1e3).toFixed(3)," Wh) is below today's energy consumption (",(t*1e3).toFixed(3)," Wh). Increase the limit or reduce usage first."]})]}):null}function AF({isOpen:n,onClose:e,device:t,reason:i,currentMonthlyEnergy:s,combinedLimit:o}){return!n||!t?null:u.jsx("div",{className:"modal-overlay",onClick:e,children:u.jsxs("div",{className:"modal-content monthly-limit-modal",onClick:l=>l.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("div",{className:"modal-icon warning",children:u.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",fill:"#f59e0b"})]})}),u.jsx("h3",{children:"Monthly Limit Exceeded!"}),u.jsx("button",{type:"button",className:"modal-close",onClick:e,"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsxs("div",{className:"modal-body",children:[u.jsx("p",{children:u.jsxs("strong",{children:['"',t.outletName,'" cannot be turned ON because the monthly energy limit has been exceeded.']})}),u.jsxs("div",{className:"monthly-limit-details",children:[u.jsxs("div",{className:"limit-stat",children:[u.jsx("span",{className:"label",children:"Current Monthly Energy:"}),u.jsx("span",{className:"value",children:s?`${iu(s/1e3)} kW`:"N/A"})]}),u.jsxs("div",{className:"limit-stat",children:[u.jsx("span",{className:"label",children:"Monthly Limit:"}),u.jsx("span",{className:"value",children:o?`${iu(o/1e3)} kW`:"N/A"})]}),u.jsxs("div",{className:"limit-stat",children:[u.jsx("span",{className:"label",children:"Date:"}),u.jsx("span",{className:"value",children:new Date().toLocaleDateString()})]}),u.jsxs("div",{className:"limit-stat",children:[u.jsx("span",{className:"label",children:"Time:"}),u.jsx("span",{className:"value",children:new Date().toLocaleTimeString()})]})]}),u.jsx("p",{className:"warning-message",children:i}),u.jsx("p",{className:"info-message",children:"The device cannot be activated until next month or the monthly limit is increased. This helps prevent exceeding the combined monthly energy consumption limit for all selected outlets."})]}),u.jsx("div",{className:"modal-footer",children:u.jsx("button",{type:"button",className:"btn-primary",onClick:e,children:"Understood"})})]})})}function DF({isOpen:n,onClose:e,device:t,combinedLimit:i}){return!n||!t?null:u.jsx("div",{className:"modal-overlay",onClick:e,children:u.jsxs("div",{className:"modal-content",onClick:s=>s.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h3",{children:"Device Cannot Be Edited"}),u.jsx("button",{type:"button",className:"modal-close",onClick:e,"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsx("div",{className:"modal-body",children:u.jsxs("div",{className:"restriction-notice",children:[u.jsx("div",{className:"notice-icon",children:u.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",stroke:"#f59e0b",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),u.jsxs("div",{className:"notice-content",children:[u.jsx("h4",{children:"Monthly Limit Active"}),u.jsxs("p",{children:[u.jsx("strong",{children:t.outletName})," cannot be edited because it is part of an active monthly power limit group."]}),u.jsxs("div",{className:"limit-info",children:[u.jsxs("div",{className:"limit-item",children:[u.jsx("span",{className:"label",children:"Combined Limit:"}),u.jsx("span",{className:"value",children:i==="No Limit"?"No Limit":`${i}Wh`})]}),u.jsxs("div",{className:"limit-item",children:[u.jsx("span",{className:"label",children:"Selected Outlets:"}),u.jsx("span",{className:"value",children:"Multiple devices in group"})]})]}),u.jsx("p",{className:"instruction",children:"To edit this device, you must first disable or modify the monthly power limit settings."})]})]})}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{type:"button",className:"btn-secondary",onClick:e,children:"Close"}),u.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{e()},children:"Manage Monthly Limit"})]})]})})}function OF({isOpen:n,onClose:e,device:t,onSave:i,combinedLimitInfo:s}){const[o,l]=me.useState({outletName:"",powerLimit:"",status:"Active",department:"",office:"",officeRoom:"",enabled:!0}),[c,d]=me.useState(!1),[f,p]=me.useState(!0),[v,_]=me.useState({}),[b,T]=me.useState([]),[C,A]=me.useState({}),I=()=>{if(!o.department||!C)return[];const D=[];return Object.values(C).forEach(F=>{F.department&&F.department.toLowerCase().replace(/\s+/g,"-")===o.department&&D.push({value:F.office.toLowerCase().replace(/\s+/g,"-"),label:F.office})}),D};me.useEffect(()=>{c&&!f?(l(D=>({...D,powerLimit:"No Limit"})),l(D=>({...D,enabled:!1}))):!c&&f&&o.powerLimit==="No Limit"?l(D=>({...D,powerLimit:""})):f||l(D=>({...D,enabled:!1}))},[c,f]),me.useEffect(()=>{n&&(async()=>{try{const F=Me(je,"offices"),E=await Pt(F);if(E.exists()){const O=E.val();A(O);const M=new Set;Object.values(O).forEach(ie=>{ie.department&&M.add(ie.department)});const Y=Array.from(M).map(ie=>({value:ie.toLowerCase().replace(/\s+/g,"-"),label:ie}));T(Y)}}catch(F){console.error("Error fetching departments and offices:",F)}})()},[n]),me.useEffect(()=>{if(t){const D=t.limit.replace(" Wh","").replace(" W","").replace(" kW","");let F="",E="";t.officeRoom&&t.officeRoom!=="—"&&C&&Object.values(C).forEach(Y=>{Y.office===t.officeRoom&&(F=Y.department?.toLowerCase().replace(/\s+/g,"-")||"",E=Y.office.toLowerCase().replace(/\s+/g,"-"))}),l({outletName:t.outletName,powerLimit:D,status:t.status,department:F,office:E,officeRoom:t.officeRoom==="—"?"":t.officeRoom,enabled:t.status==="Active"||t.status==="Warning"});const O=!!(D&&D!=="No Limit"&&D!=="0"&&D!==""),M=D==="No Limit"||D==="0"||D==="";p(O),d(t.enablePowerScheduling||M),console.log("EditDeviceModal: Device data mapping:",{device:t.outletName,powerLimitValue:D,hasPowerLimit:O,isNoLimit:M,deviceEnablePowerScheduling:t.enablePowerScheduling,enablePowerLimit:O,enableScheduling:t.enablePowerScheduling||M,existingDepartment:F,existingOffice:E,deviceOfficeRoom:t.officeRoom,officesDataAvailable:!!C}),_({})}},[t,C]);const ee=(D,F)=>{l(E=>({...E,[D]:F})),v[D]&&_(E=>({...E,[D]:""})),D==="department"&&l(E=>({...E,office:""}))},G=D=>{const F=D.replace(/[^0-9.]/g,""),E=F.split("."),O=E.length>2?E[0]+"."+E.slice(1).join(""):F;l(M=>({...M,powerLimit:O})),v.powerLimit&&_(M=>({...M,powerLimit:""}))},K=async()=>{const D={};o.department||(D.department="Department is required"),o.office||(D.office="Office is required");const F=t?.outletName||"",E=F.replace("_"," "),O=s.enabled&&(s.selectedOutlets.includes(F)||s.selectedOutlets.includes(E));let M;if(O?M=s.combinedLimit:o.powerLimit==="No Limit"?M=0:M=parseFloat(o.powerLimit),O)console.log("Edit modal: Using combined limit for validation:",M);else if(f&&(!o.powerLimit||o.powerLimit!=="No Limit"&&parseFloat(o.powerLimit)<=0))D.powerLimit="Power limit must be greater than 0 Wh";else if(f&&o.powerLimit!=="No Limit"&&t)try{const Y=t.outletName.replace(" ","_"),ie=Me(je,`devices/${Y}`),re=(await Pt(ie)).val(),V=new Date,se=`day_${V.getFullYear()}_${String(V.getMonth()+1).padStart(2,"0")}_${String(V.getDate()).padStart(2,"0")}`,te=re?.daily_logs?.[se]?.total_energy||0,j=parseFloat(o.powerLimit)/1e3;j<te&&(D.powerLimit=`Power limit (${(j*1e3).toFixed(3)} Wh) cannot be less than today's energy consumption (${(te*1e3).toFixed(3)} Wh)`)}catch(Y){console.error("Error fetching today's energy data:",Y);const ie=t.powerUsage.includes("kW")?parseFloat(t.powerUsage.replace(" kW","")):parseFloat(t.powerUsage.replace(" Wh",""))/1e3,q=parseFloat(o.powerLimit)/1e3;q<ie&&(D.powerLimit=`Power limit (${(q*1e3).toFixed(3)} Wh) cannot be less than current usage (${(ie*1e3).toFixed(3)} Wh)`)}return o.enabled&&f&&M<=0&&(D.deviceControl="Cannot turn ON device without a valid power limit"),_(D),Object.keys(D).length===0},de=async D=>{if(D.preventDefault(),await K()&&t){const F=t.outletName||"",E=F.replace("_"," "),O=s.enabled&&(s.selectedOutlets.includes(F)||s.selectedOutlets.includes(E));let M;if(O?M=s.combinedLimit:o.powerLimit==="No Limit"?M=0:M=parseFloat(o.powerLimit),o.enabled&&f&&M<=0){_(Y=>({...Y,deviceControl:"Cannot turn ON device without a valid power limit"}));return}if(t&&M>0)try{const Y=t.outletName.replace(" ","_"),ie=Me(je,`devices/${Y}`),re=(await Pt(ie)).val(),V=new Date,se=`day_${V.getFullYear()}_${String(V.getMonth()+1).padStart(2,"0")}_${String(V.getDate()).padStart(2,"0")}`,te=re?.daily_logs?.[se]?.total_energy||0,j=M/1e3;if(j<te){_(U=>({...U,powerLimit:`Power limit (${(j*1e3).toFixed(3)} Wh) cannot be less than today's energy consumption (${(te*1e3).toFixed(3)} Wh)`}));return}}catch(Y){console.error("Error fetching today's energy data:",Y);const ie=t.powerUsage.includes("kW")?parseFloat(t.powerUsage.replace(" kW","")):parseFloat(t.powerUsage.replace(" Wh",""))/1e3,q=M/1e3;if(q<ie){_(re=>({...re,powerLimit:`Power limit (${(q*1e3).toFixed(3)} Wh) cannot be less than current usage (${(ie*1e3).toFixed(3)} Wh)`}));return}}try{console.log("Edit modal: Starting database update for:",t.outletName),console.log("Edit modal: Power limit to set:",o.powerLimit),console.log("Edit modal: Enabled status to set:",o.enabled),console.log("Edit modal: Office to set:",o.officeRoom);const Y=t.outletName.replace(" ","_"),ie=Me(je,`devices/${Y}/relay_control/auto_cutoff`);console.log("Edit modal: Updating auto_cutoff at path:",`devices/${Y}/relay_control/auto_cutoff`);const q=t.outletName||"",re=q.replace("_"," "),V=s.enabled&&(s.selectedOutlets.includes(q)||s.selectedOutlets.includes(re));let se;V?se=s.combinedLimit:o.powerLimit==="No Limit"?se=0:se=parseFloat(o.powerLimit),console.log("Edit modal: Using power limit:",se,V?"(Combined Limit)":"(Individual Limit)");let W;o.powerLimit==="No Limit"?W="No Limit":W=se/1e3;const te=await Kt(ie,{enabled:!0,power_limit:W});console.log("Edit modal: Auto_cutoff update result:",te);const j=Me(je,`devices/${Y}/control`),U=o.enabled?"on":"off";console.log("Edit modal: Updating control state to:",U);const $=await Kt(j,{device:U});console.log("Edit modal: Control state update result:",$);const X=Me(je,`devices/${Y}/office_info`);if(o.office.trim()){let Fe="";C&&Object.values(C).forEach(Ce=>{Ce.office.toLowerCase().replace(/\s+/g,"-")===o.office&&(Fe=Ce.office)}),console.log("Edit modal: Updating office info at path:",`devices/${Y}/office_info`),console.log("Edit modal: Scheduling settings:",{enableScheduling:c,enablePowerLimit:f});const Ct=cC(o.department);console.log("Edit Modal: Saving office_info with:",{office:Fe,department:Ct,enable_power_scheduling:c});const at=await Kt(X,{office:Fe,department:Ct,assigned_date:new Date().toISOString(),enable_power_scheduling:c});console.log("Edit modal: Office update result:",at)}else{console.log("Edit modal: Clearing office info at path:",`devices/${Y}/office_info`);const Fe=await Kt(X,{enable_power_scheduling:c});console.log("Edit modal: Office update result:",Fe)}const Q=Me(je,`devices/${Y}/schedule`);if(c)console.log("Edit modal: Scheduling is enabled - keeping existing schedule data");else{console.log("Edit modal: Scheduling is disabled - deleting existing schedule data");try{await Kt(Q,{timeRange:null,startTime:null,endTime:null,days:null,frequency:null,selectedDays:null,combinedScheduleId:null,isCombinedSchedule:!1,selectedOutlets:null,enabled:!1}),console.log(`Edit modal: Successfully deleted schedule data for ${Y}`)}catch(Fe){console.error(`Edit modal: Error deleting schedule data for ${Y}:`,Fe)}}console.log("Edit modal: Database updates completed successfully!");const ye="Edit individual limit",Ae=o.powerLimit==="No Limit"?"No Limit":o.powerLimit;await _F(ye,t.outletName,Ae,o.officeRoom||t.officeRoom||"Unknown",t.appliances||"Unknown");let De="—";o.office&&C&&Object.values(C).forEach(Fe=>{Fe.office.toLowerCase().replace(/\s+/g,"-")===o.office&&(De=Fe.office)});const Be={...t,outletName:o.outletName||t.outletName,limit:o.powerLimit==="No Limit"?"No Limit":`${se.toFixed(3)} Wh`,status:o.enabled?"Active":"Inactive",officeRoom:De,enableScheduling:c,enablePowerLimit:f};i(Be),e()}catch(Y){console.error("Edit modal: Error updating database:",Y),console.error("Edit modal: Error details:",{deviceName:t.outletName,powerLimit:o.powerLimit,enabled:o.enabled,officeRoom:o.officeRoom,error:Y})}}},le=()=>{_({}),e()},z=()=>{const D=o.enabled&&f&&(!o.powerLimit||o.powerLimit!=="No Limit"&&parseFloat(o.powerLimit)<=0),F=t&&o.powerLimit&&o.powerLimit!=="No Limit"&&parseFloat(o.powerLimit)>0&&parseFloat(o.powerLimit)<(t.powerUsage.includes("kW")?parseFloat(t.powerUsage.replace(" kW","")):parseFloat(t.powerUsage.replace(" Wh",""))/1e3);return!D&&!F},R=()=>{const D=o.enabled&&f&&(!o.powerLimit||o.powerLimit!=="No Limit"&&parseFloat(o.powerLimit)<=0),F=t&&o.powerLimit&&o.powerLimit!=="No Limit"&&parseFloat(o.powerLimit)>0&&parseFloat(o.powerLimit)<(t.powerUsage.includes("kW")?parseFloat(t.powerUsage.replace(" kW","")):parseFloat(t.powerUsage.replace(" Wh",""))/1e3);return D?"Cannot save: Power limit is required to turn ON device":F?"Cannot save: Power limit is below today's energy consumption":"Save changes"};return!n||!t?null:u.jsx("div",{className:"modal-overlay",onClick:le,children:u.jsxs("div",{className:"modal-content edit-modal",onClick:D=>D.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h3",{children:"Edit"}),u.jsx("button",{type:"button",className:"modal-close",onClick:le,"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsxs("form",{onSubmit:de,children:[u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"editOutletName",children:"Outlet Name"}),u.jsx("div",{className:"outlet-display",children:o.outletName||"No outlet name"})]}),u.jsxs("div",{className:`form-group ${v.powerLimit?"error":""}`,children:[u.jsxs("label",{htmlFor:"editPowerLimit",children:["Change power limit (Wh) ",f&&u.jsx("span",{className:"required",children:"*"})]}),(()=>{const D=t?.outletName||"",F=D.replace("_"," ");return s.enabled&&(s.selectedOutlets.includes(D)||s.selectedOutlets.includes(F))?u.jsxs("div",{className:"combined-limit-disabled-field",children:[u.jsx("input",{type:"text",id:"editPowerLimit",placeholder:"e.g., 150 Wh",value:`${String(s.combinedLimit)==="No Limit"?"No Limit":`${s.combinedLimit}Wh`} (Combined Limit)`,disabled:!0,className:"disabled-input"}),u.jsxs("div",{className:"combined-limit-notice",children:[u.jsx("div",{className:"notice-icon",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),u.jsxs("div",{className:"notice-text",children:[u.jsx("strong",{children:"Power limit cannot be edited"})," because this device is part of a combined power limit group. The combined limit of ",String(s.combinedLimit)==="No Limit"?"No Limit":`${s.combinedLimit}Wh`," applies to all selected outlets."]})]})]}):u.jsxs(u.Fragment,{children:[(f||c)&&u.jsx("input",{type:"text",id:"editPowerLimit",placeholder:"e.g., 150 Wh",value:o.powerLimit,onChange:O=>G(O.target.value),maxLength:8,className:c&&!f?"disabled-input":"",disabled:c&&!f,required:f}),u.jsx("div",{className:"field-hint",children:c&&!f?"Devices will only turn off based on the schedule set. No power limit is applied.":"Enter value in Wh (watt-hours). This limit will be applied to today's energy consumption."}),v.powerLimit&&u.jsx("span",{className:"error-message",children:v.powerLimit})]})})(),o.enabled&&f&&(!o.powerLimit||o.powerLimit!=="No Limit"&&parseFloat(o.powerLimit)<=0)&&u.jsxs("div",{className:"field-warning",children:[u.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",fill:"#f59e0b"})]}),u.jsx("span",{children:"Power limit is required to turn ON this device"})]}),t&&o.powerLimit&&parseFloat(o.powerLimit)>0&&u.jsx(LF,{device:t,newPowerLimit:parseFloat(o.powerLimit)})]}),u.jsxs("div",{className:`form-group ${v.department?"error":""}`,children:[u.jsxs("label",{htmlFor:"editDepartment",children:["Select Department ",u.jsx("span",{className:"required",children:"*"})]}),u.jsx(pm,{id:"editDepartment",value:o.department,placeholder:"Choose department",options:b,onChange:D=>ee("department",D),error:!!v.department}),v.department&&u.jsx("span",{className:"error-message",children:v.department})]}),u.jsxs("div",{className:`form-group ${v.office?"error":""}`,children:[u.jsxs("label",{htmlFor:"editOffice",children:["Select Office ",u.jsx("span",{className:"required",children:"*"})]}),u.jsx(pm,{id:"editOffice",value:o.office,placeholder:o.department?"Choose office":"Select department first",options:o.department?I():[],onChange:D=>ee("office",D),error:!!v.office,disabled:!o.department}),u.jsx("div",{className:"field-hint",children:"You can change the office assignment for any selected device"}),v.office&&u.jsx("span",{className:"error-message",children:v.office})]}),u.jsxs("div",{className:`form-group ${v.deviceControl?"error":""}`,children:[u.jsx("label",{htmlFor:"editEnabled",children:"Device Control"}),u.jsxs("select",{id:"editEnabled",value:o.enabled.toString(),onChange:D=>{const F=D.target.value==="true";l(E=>({...E,enabled:F,status:F?"Active":"Inactive"})),v.deviceControl&&_(E=>({...E,deviceControl:""})),F&&(!o.powerLimit||parseFloat(o.powerLimit)<=0)&&_(E=>({...E,deviceControl:"Cannot turn ON device without a valid power limit"}))},children:[u.jsx("option",{value:"true",children:"Turn ON (Active)"}),u.jsx("option",{value:"false",children:"Turn OFF (Inactive)"})]}),u.jsx("div",{className:"field-hint",children:"Controls the control.device setting (on/off)"}),v.deviceControl&&u.jsx("span",{className:"error-message",children:v.deviceControl}),o.enabled&&(!o.powerLimit||parseFloat(o.powerLimit)<=0)&&u.jsxs("div",{className:"validation-warning",children:[u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",fill:"#f59e0b"})]}),u.jsx("span",{children:"Device cannot be turned ON without a power limit. Please set a power limit above."})]})]}),u.jsxs("div",{className:"field-group",children:[u.jsxs("label",{className:"checkbox-label",children:[u.jsx("input",{type:"checkbox",checked:c,onChange:D=>{const F=D.target.checked;d(F),F&&!f&&l(E=>({...E,powerLimit:"No Limit",enabled:!1})),console.log("Enable Scheduling changed:",F)},className:"checkbox-input"}),u.jsx("span",{className:"checkbox-custom"}),"Enable Scheduling"]}),u.jsx("p",{className:"field-description",children:"Enable automatic scheduling for the selected outlets"})]}),u.jsxs("div",{className:"field-group",children:[u.jsxs("label",{className:"checkbox-label",children:[u.jsx("input",{type:"checkbox",checked:f,onChange:D=>{const F=D.target.checked;p(F),F?o.powerLimit==="No Limit"&&l(E=>({...E,powerLimit:""})):c&&l(E=>({...E,powerLimit:"No Limit",enabled:!1})),console.log("Enable Power Limit changed:",F)},className:"checkbox-input"}),u.jsx("span",{className:"checkbox-custom"}),"Enable Power Limit"]}),u.jsx("p",{className:"field-description",children:"Set a combined power limit for the selected outlets"})]})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{type:"button",className:"btn-secondary",onClick:le,children:"Cancel"}),u.jsx("button",{type:"submit",className:`btn-primary ${z()?"":"disabled"}`,disabled:!z(),title:R(),children:"Save"})]})]})]})})}function jF({isOpen:n,onClose:e,onSave:t,existingData:i}){const[s,o]=me.useState([]),[l,c]=me.useState(""),[d,f]=me.useState({}),[p,v]=me.useState([]),[_,b]=me.useState(!1),[T,C]=me.useState(!1),[A,I]=me.useState(!1),[ee,G]=me.useState(!1),[K,de]=me.useState("on"),[le,z]=me.useState(!1),R=[{value:"on",label:"Turn ON (Active)",description:"Device will be turned on"},{value:"off",label:"Turn OFF (Inactive)",description:"Device will be turned off"}];me.useEffect(()=>{n?((async()=>{try{const q=Me(je,"devices"),re=await Pt(q);if(re.exists()){const V=re.val(),se=Object.keys(V).map(W=>W.replace("_"," "));v(se)}}catch(q){console.error("Error fetching outlets:",q)}})(),!_&&!T&&(i&&i.enabled?(o(i.selectedOutlets),c(i.combinedLimit.toString()),G(String(i.combinedLimit)!=="No Limit"),(async()=>{try{const re=Me(je,"devices"),V=await Pt(re);if(V.exists()){const se=V.val();let W=!1;for(const te of i.selectedOutlets){const j=te.replace(" ","_");if(se[j]?.office_info?.enable_power_scheduling===!0){W=!0;break}}I(W),console.log("SetUp: Scheduling state from database:",{selectedOutlets:i.selectedOutlets,hasSchedulingEnabled:W,combinedLimit:i.combinedLimit})}}catch(re){console.error("Error checking scheduling state:",re),I(String(i.combinedLimit)==="No Limit")}})(),console.log("SetUp: Populating modal with existing data:",i)):(o([]),c(""),G(!1),I(!1),de("on")),b(!0))):(b(!1),C(!1))},[n,i,_]),me.useEffect(()=>{const ie=q=>{le&&(q.target.closest(".control-dropdown-container")||z(!1))};return le&&document.addEventListener("mousedown",ie),()=>{document.removeEventListener("mousedown",ie)}},[le]),me.useEffect(()=>{A&&!ee?(c("No Limit"),C(!0)):!A&&ee&&l==="No Limit"&&(c(""),C(!0))},[A,ee]);const D=ie=>{o(q=>q.includes(ie)?q.filter(re=>re!==ie):[...q,ie]),C(!0),d.outlets&&f(q=>({...q,outlets:""}))},F=()=>{s.length===p.length?o([]):o([...p]),C(!0),d.outlets&&f(ie=>({...ie,outlets:""}))},E=ie=>{const q=ie.replace(/[^0-9.]/g,"");c(q),C(!0),d.combinedLimit&&f(re=>({...re,combinedLimit:""}))},O=async()=>{const ie={};if(!i&&s.length===0&&(ie.outlets="Please select at least one outlet"),ee&&(!l||l!=="No Limit"&&parseFloat(l)<=0)&&(ie.combinedLimit="Combined limit must be greater than 0 Wh"),ee&&l&&l!=="No Limit"&&s.length>0)try{const q=Me(je,"devices"),re=await Pt(q);if(re.exists()){const V=re.val(),se=parseFloat(l),W=Pm(V,s);se<W&&(ie.combinedLimit=`Combined limit (${se.toFixed(0)} Wh) cannot be less than current month's energy consumption (${W.toFixed(0)} Wh)`)}}catch(q){console.error("Error validating against current monthly energy:",q)}return f(ie),Object.keys(ie).length===0},M=async ie=>{ie.preventDefault(),await O()&&t({selectedOutlets:s,combinedLimit:l==="No Limit"?0:parseFloat(l),deviceControl:K,enableScheduling:A})},Y=()=>{o([]),c(""),G(!1),I(!1),de("on"),z(!1),f({}),e()};return n?u.jsx("div",{className:"modal-overlay",onClick:Y,children:u.jsxs("div",{className:"modal-content",onClick:ie=>ie.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h3",{children:i&&i.enabled?"Edit Monthly Power Limit":"Set Combined Power Limit"}),u.jsx("button",{type:"button",className:"modal-close",onClick:Y,"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsxs("form",{onSubmit:M,children:[u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{className:`field-group ${d.outlets?"error":""}`,children:[u.jsxs("label",{children:["Select Outlets ",u.jsx("span",{className:"required",children:"*"})]}),u.jsxs("div",{className:"outlet-selection",children:[u.jsxs("div",{className:"select-all-container",children:[u.jsx("button",{type:"button",className:"select-all-btn",onClick:F,children:s.length===p.length?"Deselect All":"Select All"}),u.jsxs("span",{className:"selection-count",children:[s.length," of ",p.length," selected"]})]}),u.jsx("div",{className:"outlet-grid",children:p.map(ie=>u.jsxs("div",{className:`outlet-option ${s.includes(ie)?"selected":""}`,onClick:()=>D(ie),children:[u.jsx("div",{className:"outlet-checkbox",children:s.includes(ie)&&u.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("polyline",{points:"20,6 9,17 4,12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),u.jsx("span",{className:"outlet-label",children:ie})]},ie))})]}),d.outlets&&u.jsx("span",{className:"error-message",children:d.outlets})]}),u.jsxs("div",{className:"field-group",children:[u.jsxs("label",{className:"checkbox-label",children:[u.jsx("input",{type:"checkbox",checked:A,onChange:ie=>{I(ie.target.checked),C(!0),ie.target.checked&&!ee&&de("off")},className:"checkbox-input"}),u.jsx("span",{className:"checkbox-custom"}),"Enable Scheduling"]}),u.jsx("p",{className:"field-description",children:"Enable automatic scheduling for the selected outlets"})]}),u.jsxs("div",{className:"field-group",children:[u.jsxs("label",{className:"checkbox-label",children:[u.jsx("input",{type:"checkbox",checked:ee,onChange:ie=>{G(ie.target.checked),C(!0),ie.target.checked||(c(""),de("off"))},className:"checkbox-input"}),u.jsx("span",{className:"checkbox-custom"}),"Enable Power Limit"]}),u.jsx("p",{className:"field-description",children:"Set a combined power limit for the selected outlets"})]}),!A&&ee&&u.jsxs("div",{className:"field-group",children:[u.jsxs("label",{children:["Device Control ",u.jsx("span",{className:"required",children:"*"})]}),u.jsxs("div",{className:"control-dropdown-container",children:[u.jsxs("button",{type:"button",className:"control-dropdown-trigger",onClick:()=>z(!le),"aria-expanded":le,"aria-haspopup":"listbox",children:[u.jsx("span",{children:R.find(ie=>ie.value===K)?.label}),u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:`dropdown-arrow ${le?"open":""}`,children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),le&&u.jsx("ul",{className:"dropdown-menu",role:"listbox",children:R.map(ie=>u.jsx("li",{children:u.jsx("button",{type:"button",role:"option","aria-selected":K===ie.value,className:`menu-item ${K===ie.value?"selected":""}`,onClick:()=>{de(ie.value),z(!1),C(!0)},children:u.jsxs("div",{className:"option-content",children:[u.jsx("div",{className:"option-label",children:ie.label}),u.jsx("div",{className:"option-description",children:ie.description})]})})},ie.value))})]}),u.jsx("p",{className:"field-description",children:"Controls the control.device setting (on/off)"})]}),(ee||A)&&u.jsxs("div",{className:`field-group ${d.combinedLimit?"error":""}`,children:[u.jsxs("label",{htmlFor:"combinedLimit",children:["Monthly Power Limit (Wh) ",ee&&u.jsx("span",{className:"required",children:"*"})]}),u.jsx("input",{type:"text",id:"combinedLimit",value:l,onChange:ie=>E(ie.target.value),placeholder:"e.g., 500 W",className:`form-input ${A&&!ee?"disabled-input":""}`,disabled:A&&!ee,required:ee}),u.jsx("div",{className:"field-hint",children:A&&!ee?"Devices will only turn off based on the schedule set. No power limit is applied.":"Enter the total monthly energy limit in watts. When the combined monthly energy consumption of all selected outlets reaches this limit, all devices will automatically turn off."}),d.combinedLimit&&u.jsx("span",{className:"error-message",children:d.combinedLimit})]}),s.length>0&&(ee||A)&&u.jsxs("div",{className:"limit-summary",children:[u.jsx("h4",{children:"Summary"}),u.jsxs("div",{className:"summary-details",children:[u.jsxs("div",{className:"summary-item",children:[u.jsx("span",{className:"label",children:"Selected Outlets:"}),u.jsxs("span",{className:"value",children:[s.length," outlets"]})]}),u.jsxs("div",{className:"summary-item",children:[u.jsx("span",{className:"label",children:"Combined Limit:"}),u.jsx("span",{className:"value",children:A&&!ee?"No Limit":`${parseFloat(l).toFixed(0)} Wh`})]}),u.jsxs("div",{className:"summary-item",children:[u.jsx("span",{className:"label",children:"Action:"}),u.jsx("span",{className:"value",children:A&&!ee?"Devices will turn off based on schedule only":"All devices will turn off when limit is reached"})]})]})]})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{type:"button",className:"btn-secondary",onClick:Y,children:"Cancel"}),u.jsx("button",{type:"submit",className:"btn-primary",disabled:!i&&(s.length===0||!l),children:i&&i.enabled?"Update Combined Limit":"Set Combined Limit"})]})]})]})}):null}function MF({isOpen:n,onClose:e,selectedOutlets:t,combinedLimit:i,isEdit:s}){return n?u.jsx("div",{className:"modal-overlay",onClick:e,children:u.jsxs("div",{className:"setup-combined-limit-modal",onClick:o=>o.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("div",{className:"setup-combined-limit-icon",children:u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),u.jsx("h3",{children:s?"Combined Limit Updated Successfully!":"Combined Limit Set Successfully!"}),u.jsx("button",{type:"button",className:"modal-close",onClick:e,"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsxs("div",{className:"modal-body",children:[u.jsx("div",{className:"success-message",children:u.jsx("p",{children:s?"Your combined power limit has been successfully updated!":"Your combined power limit has been successfully configured!"})}),u.jsxs("div",{className:"success-details",children:[u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Combined Limit:"}),u.jsxs("span",{className:"detail-value",children:[i," W"]})]}),u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Selected Outlets:"}),u.jsxs("span",{className:"detail-value",children:[t.length," outlets"]})]}),u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Action:"}),u.jsx("span",{className:"detail-value",children:"All devices will turn off when limit is reached"})]})]}),u.jsxs("div",{className:"outlet-list",children:[u.jsx("h4",{children:"Selected Outlets:"}),u.jsx("div",{className:"outlet-tags",children:t.map((o,l)=>u.jsx("span",{className:"outlet-tag",children:o},l))})]}),u.jsxs("div",{className:"info-box",children:[u.jsx("div",{className:"info-icon",children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"M12 16v-4M12 8h.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsxs("div",{className:"info-text",children:[u.jsx("strong",{children:"How it works:"})," The system will continuously monitor the combined monthly energy consumption of all selected outlets. When the total monthly energy reaches ",i,"Wh, all active devices in this group will automatically turn off to prevent exceeding the monthly limit."]})]})]}),u.jsx("div",{className:"modal-footer",children:u.jsx("button",{type:"button",className:"btn-primary",onClick:e,children:"Got it!"})})]})}):null}function RF({isOpen:n,onClose:e,onSave:t}){const[i,s]=me.useState({deviceType:"",department:"",office:"",outletName:"",powerLimit:"",appliance:""}),[o,l]=me.useState(!1),[c,d]=me.useState(!0),[f,p]=me.useState("on"),[v,_]=me.useState(!1),[b,T]=me.useState({});me.useEffect(()=>{o&&!c?(s(q=>({...q,powerLimit:"No Limit"})),p("off")):!o&&c&&i.powerLimit==="No Limit"?s(q=>({...q,powerLimit:""})):c||p("off")},[o,c]),me.useEffect(()=>{const q=re=>{v&&(re.target.closest(".control-dropdown-container")||_(!1))};return v&&document.addEventListener("mousedown",q),()=>{document.removeEventListener("mousedown",q)}},[v]);const[C,A]=me.useState(!1),[I,ee]=me.useState([]),[G,K]=me.useState({}),[de,le]=me.useState([]),[z,R]=me.useState({}),D=()=>{if(!i.department||!z)return[];const q=[];return Object.values(z).forEach(re=>{re.department&&re.department.toLowerCase().replace(/\s+/g,"-")===i.department&&q.push({value:re.office.toLowerCase().replace(/\s+/g,"-"),label:re.office})}),q};me.useEffect(()=>{if(n){const q=Me(je,"devices"),re=Go(q,V=>{const se=V.val();if(se){K(se);const W=Object.keys(se);ee(W)}});return()=>lr(q,"value",re)}},[n]),me.useEffect(()=>{n&&(async()=>{try{const re=Me(je,"offices"),V=await Pt(re);if(V.exists()){const se=V.val();R(se);const W=new Set;Object.values(se).forEach(j=>{j.department&&W.add(j.department)});const te=Array.from(W).map(j=>({value:j.toLowerCase().replace(/\s+/g,"-"),label:j}));le(te)}}catch(re){console.error("Error fetching departments and offices:",re)}})()},[n]);const F=(q,re)=>{if(s(V=>({...V,[q]:re})),b[q]&&T(V=>({...V,[q]:""})),q==="department"&&s(V=>({...V,office:""})),q==="deviceType"){const V=G[re];let se="";const W=V?.relay_control?.auto_cutoff?.power_limit;W==="No Limit"?se="No Limit":W&&W>0&&(se=(W*1e3).toFixed(0));let te="";V?.office_info?.office&&z&&Object.values(z).forEach(U=>{U.office===V.office_info.office&&(te=U.department?.toLowerCase().replace(/\s+/g,"-")||"")});let j="";V?.office_info?.office&&(j=V.office_info.office.toLowerCase().replace(/\s+/g,"-")),s(U=>({...U,[q]:re,outletName:re,department:te||U.department,office:j||U.office,appliance:V?.office_info?.appliance||U.appliance,powerLimit:se||U.powerLimit})),se==="No Limit"?(l(!0),d(!1),p("off")):(l(!0),d(!0),p("on"))}},E=q=>{const re=q.replace(/[^0-9.]/g,""),V=re.split("."),se=V.length>2?V[0]+"."+V.slice(1).join(""):re;s(W=>({...W,powerLimit:se})),b.powerLimit&&T(W=>({...W,powerLimit:""}))},O=()=>{const q={};return i.deviceType||(q.deviceType="Device type is required"),i.department||(q.department="Department is required"),i.office||(q.office="Office is required"),c&&(!i.powerLimit||i.powerLimit!=="No Limit"&&parseFloat(i.powerLimit)<=0)&&(q.powerLimit="Power limit must be greater than 0 Wh"),i.appliance||(q.appliance="Appliance type is required"),T(q),Object.keys(q).length===0},M=async q=>{if(q.preventDefault(),O())try{console.log("Starting database update for:",i.deviceType),console.log("Power limit to set (Wh):",i.powerLimit),console.log("Office to assign:",i.office);const re=Me(je,`devices/${i.deviceType}`),V=Me(je,`devices/${i.deviceType}/relay_control/auto_cutoff`);console.log("Updating power limit at path:",`devices/${i.deviceType}/relay_control/auto_cutoff`);let se;i.powerLimit==="No Limit"?se="No Limit":se=parseFloat(i.powerLimit)/1e3;const W=await Kt(V,{enabled:!0,power_limit:se});console.log("Power limit update result:",W);const te=Me(je,`devices/${i.deviceType}/office_info`);console.log("Updating office info at path:",`devices/${i.deviceType}/office_info`),console.log("Add device: Scheduling settings:",{enableScheduling:o,enablePowerLimit:c});const j=cC(i.department);let U=i.office;z&&Object.values(z).forEach(Fe=>{Fe.office.toLowerCase().replace(/\s+/g,"-")===i.office&&(U=Fe.office)}),console.log("Add Device: Saving office_info with:",{office:U,department:j,appliance:i.appliance,enable_power_scheduling:o});const $=await Kt(te,{office:U,department:j,assigned_date:new Date().toISOString(),appliance:i.appliance,enable_power_scheduling:o});console.log("Office update result:",$);const X=Me(je,`devices/${i.deviceType}/control`);console.log("Updating device control at path:",`devices/${i.deviceType}/control`);const Q=await Kt(X,{device:f});console.log("Device control update result:",Q);const ye=Me(je,`devices/${i.deviceType}`);console.log("Updating device status at path:",`devices/${i.deviceType}`);const Ae=await Kt(ye,{status:f==="on"?"ON":"OFF"});console.log("Status update result:",Ae);const De=Me(je,`devices/${i.deviceType}/schedule`);if(o)console.log("Add device: Scheduling is enabled - keeping existing schedule data");else{console.log("Add device: Scheduling is disabled - clearing any existing schedule data");try{await Kt(De,{timeRange:null,startTime:null,endTime:null,days:null,frequency:null,selectedDays:null,combinedScheduleId:null,isCombinedSchedule:!1,selectedOutlets:null,enabled:!1}),console.log(`Add device: Successfully cleared schedule data for ${i.deviceType}`)}catch(Fe){console.error(`Add device: Error clearing schedule data for ${i.deviceType}:`,Fe)}}console.log("Database updates completed successfully!");const Be={...i,office:U,powerLimit:i.powerLimit==="No Limit"?"No Limit":`${i.powerLimit} W`,enableScheduling:o,enablePowerLimit:c,deviceControl:f};t(Be),s({deviceType:"",department:"",office:"",outletName:"",powerLimit:"",appliance:""}),A(!0)}catch(re){console.error("Error updating database:",re),console.error("Error details:",{deviceType:i.deviceType,powerLimit:i.powerLimit,office:i.office,error:re})}},Y=()=>{s({deviceType:"",department:"",office:"",outletName:"",powerLimit:"",appliance:""}),l(!0),d(!0),p("on"),_(!1),T({}),e()},ie=()=>{A(!1),e()};return n?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"modal-overlay",onClick:Y,children:u.jsxs("div",{className:"modal-content",onClick:q=>q.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h3",{children:"Add Device"}),u.jsx("button",{type:"button",className:"modal-close",onClick:Y,"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsxs("form",{onSubmit:M,children:[u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{className:"form-section",children:[u.jsxs("div",{className:`form-group ${b.deviceType?"error":""}`,children:[u.jsxs("label",{htmlFor:"deviceType",children:["Select Device ",u.jsx("span",{className:"required",children:"*"}),u.jsx("span",{className:"info-icon",children:"⋯"})]}),u.jsx(pm,{id:"deviceType",value:i.deviceType,placeholder:"Choose a device",options:Object.keys(G).map(q=>{const re=G[q]?.office_info?.office;return{value:q,label:re?`${q} (Currently assigned to ${G[q].office_info.office})`:q,disabled:!1}}),onChange:q=>F("deviceType",q),error:!!b.deviceType}),b.deviceType&&u.jsx("span",{className:"error-message",children:b.deviceType})]}),u.jsxs("div",{className:`form-group ${b.department?"error":""}`,children:[u.jsxs("label",{htmlFor:"department",children:["Select Department ",u.jsx("span",{className:"required",children:"*"})]}),u.jsx(pm,{id:"department",value:i.department,placeholder:"Choose department",options:de,onChange:q=>F("department",q),error:!!b.department}),b.department&&u.jsx("span",{className:"error-message",children:b.department})]}),u.jsxs("div",{className:`form-group ${b.office?"error":""}`,children:[u.jsxs("label",{htmlFor:"office",children:["Select office ",u.jsx("span",{className:"required",children:"*"})]}),u.jsx(pm,{id:"office",value:i.office,placeholder:i.department?"Choose office":"Select department first",options:i.department?D():[],onChange:q=>F("office",q),error:!!b.office,disabled:!i.department}),u.jsx("div",{className:"field-hint",children:"You can change the office assignment for any selected device"}),b.office&&u.jsx("span",{className:"error-message",children:b.office})]}),u.jsxs("div",{className:`form-group ${b.appliance?"error":""}`,children:[u.jsxs("label",{htmlFor:"appliance",children:["Appliance ",u.jsx("span",{className:"required",children:"*"})]}),u.jsx("input",{type:"text",id:"appliance",placeholder:"e.g., Computer, Monitor, Printer",value:i.appliance,onChange:q=>F("appliance",q.target.value)}),b.appliance&&u.jsx("span",{className:"error-message",children:b.appliance})]})]}),u.jsx("div",{className:"form-divider"}),u.jsxs("div",{className:"form-section",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"outletName",children:"Outlet Name"}),u.jsx("div",{className:"outlet-display",children:i.outletName||"No device selected"})]}),u.jsxs("div",{className:"field-group",children:[u.jsxs("label",{className:"checkbox-label",children:[u.jsx("input",{type:"checkbox",checked:o,onChange:q=>{l(q.target.checked),q.target.checked&&!c&&p("off")},className:"checkbox-input"}),u.jsx("span",{className:"checkbox-custom"}),"Enable Scheduling"]}),u.jsx("p",{className:"field-description",children:"Enable automatic scheduling for the selected outlets"})]}),u.jsxs("div",{className:"field-group",children:[u.jsxs("label",{className:"checkbox-label",children:[u.jsx("input",{type:"checkbox",checked:c,onChange:q=>{d(q.target.checked),!q.target.checked&&o?(s(re=>({...re,powerLimit:"No Limit"})),p("off")):q.target.checked&&i.powerLimit==="No Limit"?s(re=>({...re,powerLimit:""})):q.target.checked||p("off")},className:"checkbox-input"}),u.jsx("span",{className:"checkbox-custom"}),"Enable Power Limit"]}),u.jsx("p",{className:"field-description",children:"Set a combined power limit for the selected outlets"})]}),!o&&c&&u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"deviceControl",children:"Device Control"}),u.jsxs("div",{className:"control-dropdown-container",children:[u.jsxs("div",{className:"control-dropdown-trigger",onClick:()=>_(!v),children:[u.jsxs("div",{className:"option-content",children:[u.jsx("div",{className:"option-label",children:f==="on"?"Turn ON":"Turn OFF"}),u.jsx("div",{className:"option-description",children:f==="on"?"Device will be turned on after saving":"Device will be turned off after saving"})]}),u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:`dropdown-arrow ${v?"open":""}`,children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),v&&u.jsxs("div",{className:"control-dropdown-menu",children:[u.jsx("div",{className:`control-dropdown-option ${f==="on"?"selected":""}`,onClick:()=>{p("on"),_(!1)},children:u.jsxs("div",{className:"option-content",children:[u.jsx("div",{className:"option-label",children:"Turn ON"}),u.jsx("div",{className:"option-description",children:"Device will be turned on after saving"})]})}),u.jsx("div",{className:`control-dropdown-option ${f==="off"?"selected":""}`,onClick:()=>{p("off"),_(!1)},children:u.jsxs("div",{className:"option-content",children:[u.jsx("div",{className:"option-label",children:"Turn OFF"}),u.jsx("div",{className:"option-description",children:"Device will be turned off after saving"})]})})]})]})]}),(c||o)&&u.jsxs("div",{className:`form-group ${b.powerLimit?"error":""}`,children:[u.jsxs("label",{htmlFor:"powerLimit",children:["Set power limit (Wh) ",c&&u.jsx("span",{className:"required",children:"*"})]}),u.jsx("input",{type:"text",id:"powerLimit",placeholder:"e.g., 150 W",value:i.powerLimit,onChange:q=>E(q.target.value),maxLength:8,className:o&&!c?"disabled-input":"",disabled:o&&!c,required:c}),u.jsx("div",{className:"field-hint",children:o&&!c?"Devices will only turn off based on the schedule set. No power limit is applied.":"Enter value in Wh (watt-hours). This limit will be applied to today's energy consumption."}),b.powerLimit&&u.jsx("span",{className:"error-message",children:b.powerLimit})]})]})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{type:"button",className:"btn-secondary",onClick:Y,children:"Cancel"}),u.jsx("button",{type:"submit",className:"btn-primary",children:"Save"})]})]})]})}),u.jsx(uC,{isOpen:C,onClose:ie})]}):null}const Jy=(n,e,t,i)=>{if(!n||!n.timeRange&&!n.startTime)return e==="on";const s=new Date,o=s.getHours()*60+s.getMinutes(),l=s.getDay();let c,d;if(n.startTime&&n.endTime){const[_,b]=n.startTime.split(":").map(Number),[T,C]=n.endTime.split(":").map(Number);c=_*60+b,d=T*60+C}else if(n.timeRange){const _=n.timeRange,[b,T]=_.split(" - "),C=A=>{const[I,ee]=A.split(" ");let[G,K]=I.split(":").map(Number);return G===12&&(G=0),ee==="PM"&&(G+=12),G*60+K};c=C(b),d=C(T)}else return e==="on";const f=o>=c&&o<d,p=n.frequency||"";let v=!1;if(p.toLowerCase()==="daily")v=!0;else if(p.toLowerCase()==="weekdays")v=l>=1&&l<=5;else if(p.toLowerCase()==="weekends")v=l===0||l===6;else if(p.includes(",")){const _={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6};v=p.split(",").map(T=>{const C=T.trim().toLowerCase();return _[C]}).filter(T=>T!==void 0).includes(l)}else if(p){const b={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6}[p.toLowerCase()];b!==void 0&&(v=b===l)}if(t&&!i){const _=t.relay_control?.auto_cutoff?.power_limit||0,b=new Date,T=`day_${b.getFullYear()}_${String(b.getMonth()+1).padStart(2,"0")}_${String(b.getDate()).padStart(2,"0")}`,A=t?.daily_logs?.[T]?.total_energy||0;if(_>0&&A>=_)return console.log(`Schedule check: Device ${t.outletName||"Unknown"} power limit exceeded:`,{todayTotalEnergy:`${(A*1e3).toFixed(3)}W`,powerLimit:`${_*1e3}W`,todayDateKey:T,scheduleResult:!1,reason:"Today's energy consumption exceeded power limit"}),!1}return f&&v};function IF(){const[n,e]=me.useState(""),[t,i]=me.useState(!1),[s,o]=me.useState(null),[l,c]=me.useState(0),d=5e3,[f,p]=me.useState({isOpen:!1,device:null}),[v,_]=me.useState({isOpen:!1,deviceName:""}),[b,T]=me.useState({isOpen:!1,deviceId:"",deviceName:""}),[C,A]=me.useState({isOpen:!1}),[I,ee]=me.useState({isOpen:!1,selectedOutlets:[],combinedLimit:0,isEdit:!1}),[G,K]=me.useState({enabled:!1,selectedOutlets:[],combinedLimit:0}),[de,le]=me.useState({isOpen:!1,deviceName:""}),[z,R]=me.useState({isOpen:!1,device:null}),[D,F]=me.useState({isOpen:!1,device:null,reason:""}),[E,O]=me.useState({isOpen:!1,device:null,combinedLimit:0}),[M,Y]=me.useState([]),[ie,q]=me.useState({}),[re,V]=me.useState({});me.useEffect(()=>{const Ne=Me(je,"devices"),Ve=Go(Ne,We=>{console.log(`SetUp: Firebase data updated at ${new Date().toLocaleTimeString()}`);const tt=We.val();if(console.log("SetUp: Firebase data received:",tt),tt){const lt=[];let $e=1;const pe=new Date,be=`day_${pe.getFullYear()}_${String(pe.getMonth()+1).padStart(2,"0")}_${String(pe.getDate()).padStart(2,"0")}`;Object.keys(tt).forEach(Se=>{const Ee=tt[Se];if(Ee.sensor_data){const Ye=Ee.lifetime_energy||0,qe=`${iu(Ye*1e3)} Wh`,Ue=Ye/1e3,Xe=Ee.relay_control?.auto_cutoff?.power_limit||0,bt=Xe==="No Limit"?"No Limit":Xe,qt=Ee.relay_control?.auto_cutoff?.enabled||!1,fe=Ee.control?.device||"off",Ze=Ee.daily_logs?.[be]?.total_energy||0,Je=`${iu(Ze*1e3)} Wh`,mt=Ze/1e3,Tt={"computer-lab-1":"Computer Laboratory 1","computer-lab-2":"Computer Laboratory 2","computer-lab-3":"Computer Laboratory 3","deans-office":"Dean's Office","faculty-office":"Faculty Office"},It=Ee.office_info?.office||"",gt=It?Tt[It]||It:"—";console.log(`SetUp: Outlet ${Se}:`,{powerUsage:Ue,powerLimit:bt,enabled:qt,status:fe,totalEnergy:mt,officeValue:It,officeInfo:gt,office_info:Ee.office_info,hasOfficeInfo:!!Ee.office_info,relayControl:Ee.relay_control,hasRelayControl:!!Ee.relay_control,hasPowerLimit:!!Ee.relay_control?.auto_cutoff?.power_limit,fullOutletData:Ee}),Ee.status,console.log(`SetUp: Outlet ${Se} control object:`,Ee.control),console.log(`SetUp: Outlet ${Se} control.device value:`,Ee.control?.device);const tn=Ee.control?.device||"off";console.log(`SetUp: Outlet ${Se} control.device: "${tn}"`);const Dt=Ee.status==="idle",Ut=Date.now(),Qt=Ee.daily_logs?.[be]?.total_energy||0,an=ie[Se]||{lastEnergyUpdate:Ut,lastControlUpdate:Ut,lastTotalEnergy:Qt,lastControlState:tn};Math.abs(Qt-an.lastTotalEnergy)>1e-4&&q(Re=>({...Re,[Se]:{...an,lastEnergyUpdate:Ut,lastTotalEnergy:Qt}})),tn!==an.lastControlState&&q(Re=>({...Re,[Se]:{...an,lastControlUpdate:Ut,lastControlState:tn}}));const Sn=Ut-an.lastEnergyUpdate,Te=Ut-an.lastControlUpdate,Qe=Sn>15e3&&Te>15e3;let dt;(Dt||Qe)&&tn==="on"?dt="Idle":dt=tn==="on"?"Active":"Inactive",console.log(`SetUp: ${Se} - Final status: ${dt} (control: ${tn}, sensorIdle: ${Dt}, logicIdle: ${Qe}, energy: ${Qt})`),EF(Se,V),Ee.schedule&&(console.log(`SetUp: Schedule data for ${Se}:`,Ee.schedule),console.log(`SetUp: Schedule keys for ${Se}:`,Object.keys(Ee.schedule)),console.log("SetUp: Schedule has timeRange:",!!Ee.schedule.timeRange),console.log("SetUp: Schedule has startTime:",!!Ee.schedule.startTime),console.log("SetUp: Schedule has frequency:",!!Ee.schedule.frequency));const ve=Ee.sensor_data?.current||0,He=`${Math.round(ve)} A`,Le={id:String($e).padStart(3,"0"),outletName:Se,officeRoom:gt,appliances:Ee.office_info?.appliance||"Unassigned",enablePowerScheduling:Ee.office_info?.enable_power_scheduling||!1,limit:bt==="No Limit"?"No Limit":`${(bt*1e3).toFixed(3)} Wh`,powerUsage:qe,currentAmpere:He,todayUsage:Je,monthUsage:eN(Ee),status:dt,schedule:Ee.schedule&&(Ee.schedule.timeRange||Ee.schedule.startTime||Ee.schedule.frequency)?{timeRange:Ee.schedule.timeRange||(Ee.schedule.startTime&&Ee.schedule.endTime?(()=>{const Re=rt=>{if(!rt)return"";const[Nt,xt]=rt.split(":"),st=parseInt(Nt,10),St=st>=12?"PM":"AM";return`${st%12||12}:${xt} ${St}`},Pe=Re(Ee.schedule.startTime),At=Re(Ee.schedule.endTime);return`${Pe} - ${At}`})():""),frequency:Ee.schedule.frequency||"Daily"}:void 0};lt.push(Le),$e++}}),console.log("SetUp: Setting devices array:",lt),Y(lt),Vu(tt,G)}else console.log("SetUp: No data in Firebase - all devices deleted or database empty"),Y([])});return()=>lr(Ne,"value",Ve)},[G]);const se=Ne=>{try{const Ve=Ne.relay_control?.auto_cutoff?.power_limit||0;if(Ve<=0)return!1;const We=new Date,tt=`day_${We.getFullYear()}_${String(We.getMonth()+1).padStart(2,"0")}_${String(We.getDate()).padStart(2,"0")}`,$e=Ne.daily_logs?.[tt]?.total_energy||0;return console.log("SetUp: Daily limit check:",{powerLimit:`${Ve}kW`,todayTotalEnergy:`${$e}kW`,exceeded:$e>=Ve}),$e>=Ve}catch(Ve){return console.error("SetUp: Error checking daily limit:",Ve),!1}};me.useEffect(()=>{const Ne=async()=>{try{const $e=Me(je,"devices"),pe=await Pt($e);if(pe.exists()){const be=pe.val();console.log(`SetUp: Real-time scheduler check at ${new Date().toLocaleTimeString()}`),console.log("🔍 SetUp: Running monthly limit check FIRST..."),await Vu(be,G);let Se=!1;if(G?.enabled&&G?.selectedOutlets?.length>0){const Ee=Pm(be,G.selectedOutlets),Ye=G.combinedLimit;String(Ye)==="No Limit"?(console.log('📊 SetUp: Combined limit is set to "No Limit" - proceeding with normal schedule processing'),Se=!1):Ee>=Ye?(Se=!0,console.log("🚨 SetUp: MONTHLY LIMIT EXCEEDED for combined group"),console.log(`📊 Current: ${Ee.toFixed(3)}W >= Limit: ${Ye}W`),console.log("🔍 SetUp: Will check individual device limits within combined group")):(console.log("✅ SetUp: Monthly limit OK - proceeding with normal schedule processing"),console.log(`📊 Current: ${Ee.toFixed(3)}W < Limit: ${Ye}W`))}for(const[Ee,Ye]of Object.entries(be)){const qe=Ye;if(qe.schedule&&(qe.schedule.timeRange||qe.schedule.startTime)){const Ue=qe.control?.device||"off",Xe=qe.status||"ON",bt=qe.relay_control?.main_status||"ON";if(Xe==="OFF"){console.log(`SetUp: Device ${Ee} has status = 'OFF' - respecting manual override, skipping schedule check`);continue}if(bt==="ON"){console.log(`SetUp: Device ${Ee} has main_status = 'ON' - respecting bypass mode, skipping schedule check`);continue}const qt=Ee.replace("_"," "),fe=G?.enabled&&G?.selectedOutlets?.includes(qt),Ze=Jy(qe.schedule,"on",qe,fe);let Je=Ze?"on":"off";fe&&Se?se(qe)?(Je="off",console.log(`🔒 SetUp: AUTOMATIC UPDATE - Forcing ${Ee} OFF due to individual daily limit exceeded (monthly limit also exceeded)`)):Ze&&(Je="on",console.log(`✅ SetUp: AUTOMATIC UPDATE - Allowing ${Ee} ON (schedule says ON, individual daily limit OK despite monthly limit exceeded)`)):fe&&!Se?(await NF(Ee,G)).canTurnOn?Ze&&(Je="on",console.log(`✅ SetUp: AUTOMATIC UPDATE - Allowing ${Ee} ON (schedule says ON, monthly limit OK - individual daily limit ignored for combined group)`)):(Je="off",console.log(`🔒 SetUp: AUTOMATIC UPDATE - Forcing ${Ee} OFF due to monthly limit exceeded`)):se(qe)?(Je="off",console.log(`🔒 SetUp: AUTOMATIC UPDATE - Forcing ${Ee} OFF due to daily limit exceeded`)):Ze&&(Je="on",console.log(`✅ SetUp: AUTOMATIC UPDATE - Allowing ${Ee} ON (schedule says ON, daily limit OK)`)),console.log(`SetUp: Final status determination for ${Ee}:`,{shouldBeActive:Ze,newControlState:Je,currentControlState:Ue,isInCombinedGroup:fe,monthlyLimitExceeded:Se,needsUpdate:Ue!==Je}),Ue!==Je?(console.log(`SetUp: Real-time update: ${Ee} control state from ${Ue} to ${Je}`),await Kt(Me(je,`devices/${Ee}/control`),{device:Je})):console.log(`SetUp: No update needed for ${Ee} - control state already ${Ue}`)}}}}catch($e){console.error("SetUp: Error in real-time scheduler:",$e)}},Ve=async()=>{try{const $e=Me(je,"devices"),pe=await Pt($e);if(pe.exists()){const be=pe.val();console.log(`SetUp: Power limit monitor running at ${new Date().toLocaleTimeString()}`);for(const[Se,Ee]of Object.entries(be)){const Ye=Ee,qe=Ye.control?.device||"off",Ue=Ye.status||"ON",Xe=Ye.relay_control?.main_status||"ON";if(qe==="off")continue;if(Ue==="OFF"){console.log(`SetUp: Device ${Se} status is OFF - skipping automatic power limit enforcement (device manually disabled)`);continue}if(Xe==="ON"){console.log(`SetUp: Device ${Se} main_status is ON - respecting bypass mode, skipping automatic power limit enforcement`);continue}const bt=Se.replace("_"," "),qt=G?.enabled&&G?.selectedOutlets?.includes(bt);if(qt){if(console.log(`SetUp: Device ${Se} is in combined group - skipping individual daily limit check (monthly limit takes precedence)`),Ue==="OFF"){console.log(`SetUp: Device ${Se} status is OFF - skipping combined group power limit enforcement (device manually disabled)`);continue}if(Xe==="ON"){console.log(`SetUp: Device ${Se} main_status is ON - respecting bypass mode, skipping combined group power limit enforcement`);continue}}else{if(console.log(`SetUp: Device ${Se} status is ${Ue} - checking individual power limits`),Ue==="OFF"){console.log(`SetUp: Device ${Se} status is OFF - skipping individual power limit enforcement (device manually disabled)`);continue}if(Xe==="ON"){console.log(`SetUp: Device ${Se} main_status is ON - respecting bypass mode, skipping individual power limit enforcement`);continue}const fe=Ye.relay_control?.auto_cutoff?.power_limit||0;if(fe>0){const Ze=new Date,Je=`day_${Ze.getFullYear()}_${String(Ze.getMonth()+1).padStart(2,"0")}_${String(Ze.getDate()).padStart(2,"0")}`,Tt=Ye?.daily_logs?.[Je]?.total_energy||0;console.log(`SetUp: Power limit check for ${Se}:`,{powerLimit:`${fe*1e3}W`,powerLimitRaw:fe,todayTotalEnergy:`${Tt*1e3}W`,todayTotalEnergyRaw:Tt,todayDateKey:Je,exceedsLimit:Tt>=fe,comparison:`${Tt} >= ${fe} = ${Tt>=fe}`,currentControlState:qe,isInCombinedGroup:qt}),Tt>=fe&&(console.log(`SetUp: POWER LIMIT EXCEEDED - Turning OFF ${Se} (${(Tt*1e3).toFixed(3)}W >= ${fe*1e3}W)`),await Kt(Me(je,`devices/${Se}/control`),{device:"off"}),await Kt(Me(je,`devices/${Se}`),{status:"OFF"}),console.log(`SetUp: Device ${Se} turned OFF due to power limit exceeded`))}}}}}catch($e){console.error("SetUp: Error in power limit monitor:",$e)}},We=async()=>{try{const $e=Date.now();if($e-l<d){console.log("⏳ Monthly limit check debounced - too soon since last check");return}c($e);const pe=Me(je,"devices"),be=await Pt(pe);if(be.exists()){const Se=be.val();await Vu(Se,G)}}catch($e){console.error("SetUp: Error in monthly limit check:",$e)}};Ve(),window.testSchedule=Ne,window.testPowerLimits=Ve,window.testMonthlyLimits=We,window.forcePowerLimitCheck=async()=>{console.log("🔧 MANUAL: Forcing power limit check..."),await Ve()},window.testSpecificDevice=async $e=>{console.log(`Testing specific device: ${$e}`);try{const pe=Me(je,`devices/${$e}`),Se=(await Pt(pe)).val();if(Se)if(console.log(`Device ${$e} data:`,Se),Se.schedule){const Ee=Se.control?.device||"off",Ye=Se.status||"ON";console.log(`Current state: control=${Ee}, status=${Ye}`);const qe=$e.replace("_"," "),Ue=G?.enabled&&G?.selectedOutlets?.includes(qe),Xe=Jy(Se.schedule,"on",Se,Ue),bt=Xe?"on":"off";console.log(`Schedule check result: shouldBeActive=${Xe}, newControlState=${bt}`),console.log(Ee!==bt?`Would update: ${Ee} -> ${bt}`:`No update needed: already ${Ee}`)}else console.log(`Device ${$e} has no schedule`);else console.log(`Device ${$e} not found`)}catch(pe){console.error(`Error testing device ${$e}:`,pe)}},window.forceMonthlyLimitCheck=async()=>{console.log("🔧 FORCING monthly limit check...");try{const $e=Me(je,"devices"),pe=await Pt($e);if(pe.exists()){const be=pe.val();console.log("🔧 Current devices data:",be),console.log("🔧 Current combined limit info:",G),await Vu(be,G)}else console.log("❌ No devices data found")}catch($e){console.error("❌ Error in forced monthly limit check:",$e)}},window.checkCombinedLimitSettings=async()=>{console.log("🔍 Checking combined limit settings...");try{const $e=Me(je,"combined_limit_settings"),pe=await Pt($e);if(pe.exists()){const be=pe.val();console.log("📊 Combined limit settings:",be),console.log("Enabled:",be.enabled),console.log("Selected outlets:",be.selected_outlets),console.log("Combined limit (watts):",be.combined_limit_watts)}else console.log("❌ No combined limit settings found!")}catch($e){console.error("❌ Error checking combined limit settings:",$e)}},window.setCombinedLimitSettings=async($e,pe)=>{console.log("🔧 Setting combined limit settings...");try{const be=Me(je,"combined_limit_settings");await Kt(be,{enabled:!0,selected_outlets:$e,combined_limit_watts:pe}),console.log("✅ Combined limit settings updated:",{outlets:$e,limitWatts:pe})}catch(be){console.error("❌ Error setting combined limit settings:",be)}},window.cleanupOrphanedOutlets=async()=>{console.log("🧹 Cleaning up orphaned outlets from combined limit settings...");try{const $e=Me(je,"devices"),pe=await Pt($e),be=pe.exists()?Object.keys(pe.val()):[];console.log("📱 Current devices:",be);const Se=Me(je,"combined_limit_settings"),Ee=await Pt(Se);if(!Ee.exists()){console.log("❌ No combined limit settings found!");return}const Ye=Ee.val(),qe=Ye.selected_outlets||[];console.log("🔍 Current selected outlets:",qe);const Ue=qe.filter(bt=>!be.includes(bt));if(Ue.length===0){console.log("✅ No orphaned outlets found!");return}console.log("🗑️ Found orphaned outlets:",Ue);const Xe=qe.filter(bt=>be.includes(bt));await Kt(Se,{...Ye,selected_outlets:Xe}),console.log("✅ Successfully cleaned up orphaned outlets!"),console.log("📊 Before cleanup:",qe),console.log("📊 After cleanup:",Xe),console.log("🗑️ Removed outlets:",Ue)}catch($e){console.error("❌ Error cleaning up orphaned outlets:",$e)}},window.testOutletDeletionFromCombinedLimit=async $e=>{console.log(`🧪 TESTING: Simulating deletion of ${$e} from combined limit settings...`);try{const pe=Me(je,"combined_limit_settings"),be=await Pt(pe);if(!be.exists()){console.log("❌ No combined limit settings found!");return}const Ee=be.val().selected_outlets||[];if(console.log("🔍 Current selected outlets:",Ee),console.log("🔍 Outlet to test:",$e),console.log("🔍 Outlet name type:",typeof $e),console.log("🔍 Selected outlets types:",Ee.map(qe=>typeof qe)),Ee.some(qe=>qe.toLowerCase()===$e.toLowerCase())){console.log(`✅ Found ${$e} in selected_outlets - would be removed during deletion`);const qe=Ee.filter(Ue=>Ue.toLowerCase()!==$e.toLowerCase());console.log("📊 Before removal:",Ee),console.log("📊 After removal:",qe),console.log(`🗑️ Would remove: ${$e}`)}else console.log(`❌ ${$e} not found in selected_outlets - no removal needed`),console.log("🔍 Available outlets:",Ee)}catch(pe){console.error("❌ Error testing outlet deletion:",pe)}},window.debugOutletNames=async()=>{console.log("🔍 DEBUGGING: Comparing device names with combined limit settings...");try{const $e=Me(je,"devices"),pe=await Pt($e),be=pe.exists()?Object.keys(pe.val()):[],Se=Me(je,"combined_limit_settings"),Ee=await Pt(Se);if(Ee.exists()){const qe=Ee.val().selected_outlets||[];console.log("📱 Current devices:",be),console.log("📊 Selected outlets in combined limit:",qe);const Ue=qe.filter(bt=>!be.includes(bt)),Xe=be.filter(bt=>!qe.includes(bt));console.log("🗑️ Orphaned outlets (in combined limit but not in devices):",Ue),console.log("❓ Missing outlets (in devices but not in combined limit):",Xe)}else console.log("❌ No combined limit settings found!")}catch($e){console.error("❌ Error debugging outlet names:",$e)}},window.inspectOutletData=async $e=>{console.log(`🔍 INSPECTING: All data for outlet "${$e}"...`);try{const pe=Me(je,`devices/${$e}`),be=await Pt(pe);if(be.exists()){const Se=be.val();console.log(`📊 Complete data for ${$e}:`,Se),console.log(`📊 Data keys for ${$e}:`,Object.keys(Se)),Se.sensor_data&&console.log("📊 Sensor data:",Se.sensor_data),Se.daily_logs&&console.log(`📊 Daily logs (${Object.keys(Se.daily_logs).length} entries):`,Object.keys(Se.daily_logs)),Se.office_info&&console.log("📊 Office info:",Se.office_info),Se.schedule&&console.log("📊 Schedule:",Se.schedule),Se.relay_control&&console.log("📊 Relay control:",Se.relay_control),Se.control&&console.log("📊 Control settings:",Se.control),Se.lifetime_energy!==void 0&&console.log("📊 Lifetime energy:",Se.lifetime_energy),Se.lifetime_hours!==void 0&&console.log("📊 Lifetime hours:",Se.lifetime_hours),Se.lifetime_usage_millis!==void 0&&console.log("📊 Lifetime usage millis:",Se.lifetime_usage_millis),console.log(`✅ Found complete data for ${$e} - this will ALL be deleted when outlet is removed`)}else console.log(`❌ No data found for outlet "${$e}"`)}catch(pe){console.error("❌ Error inspecting outlet data:",pe)}},window.removeOutletFromCombinedLimit=async $e=>{console.log(`🔧 MANUALLY REMOVING: ${$e} from combined limit settings...`);try{const pe=$e,be=$e.replace(/_/g," ");console.log("🔍 Outlet name formats:",{deviceFormat:pe,combinedFormat:be});const Se=Me(je,"combined_limit_settings"),Ee=await Pt(Se);if(Ee.exists()){const Ye=Ee.val(),qe=Ye.selected_outlets||[];if(console.log("🔍 Current selected outlets:",qe),console.log("🔍 Outlet to remove (device format):",pe),console.log("🔍 Outlet to remove (combined format):",be),qe.some(Xe=>Xe.toLowerCase()===pe.toLowerCase()||Xe.toLowerCase()===be.toLowerCase())){console.log(`✅ Found ${$e} in selected_outlets - removing it...`);const Xe=qe.filter(bt=>bt.toLowerCase()!==pe.toLowerCase()&&bt.toLowerCase()!==be.toLowerCase());console.log("📊 Before removal:",qe),console.log("📊 After removal:",Xe),await Kt(Se,{...Ye,selected_outlets:Xe}),console.log(`✅ Successfully removed ${$e} from combined limit settings!`)}else console.log(`❌ ${$e} not found in selected_outlets - no removal needed`),console.log("🔍 Available outlets:",qe)}else console.log("❌ No combined limit settings found!")}catch(pe){console.error("❌ Error removing outlet from combined limit settings:",pe)}},window.testHierarchy=async()=>{console.log("🧪 Testing HIERARCHY ENFORCEMENT..."),console.log("1. Setting combined limit to 500Wh for Outlet_2 and Outlet_4"),await window.setCombinedLimitSettings(["Outlet_2","Outlet_4"],5e5),console.log("2. Forcing monthly limit check..."),await window.forceMonthlyLimitCheck(),console.log("3. Testing schedule - should be blocked by monthly limit"),await window.testSchedule(),console.log("4. Checking if devices are OFF due to monthly limit..."),setTimeout(async()=>{const $e=Me(je,"devices"),pe=await Pt($e);if(pe.exists()){const be=pe.val();console.log("📊 Device statuses after hierarchy test:"),Object.keys(be).forEach(Se=>{const Ee=be[Se],Ye=Ee.control?.device||"off",qe=Ee.status||"ON";console.log(`${Se}: control=${Ye}, status=${qe}`)})}},5e3)},window.inspectDailyLogs=async $e=>{console.log(`🔍 Inspecting daily logs for ${$e}...`);try{const pe=Me(je,`devices/${$e}`),be=await Pt(pe);if(be.exists()){const Se=be.val();if(console.log(`📊 Device data for ${$e}:`,Se),Se.daily_logs){const Ee=Object.keys(Se.daily_logs);console.log(`📊 Daily log keys (${Ee.length}):`,Ee);const Ye=new Date,qe=Ye.getFullYear(),Ue=Ye.getMonth()+1,Xe=`day_${qe}_${String(Ue).padStart(2,"0")}`,bt=Ee.filter(fe=>fe.startsWith(Xe));if(console.log(`📊 Current month (${Xe}) logs:`,bt),bt.length>0){const fe=Se.daily_logs[bt[0]];console.log("📊 Sample log data:",fe)}let qt=0;bt.forEach(fe=>{const Ze=Se.daily_logs[fe];Ze&&Ze.total_energy&&(qt+=Ze.total_energy,console.log(`📊 ${fe}: ${Ze.total_energy} kW`))}),console.log(`📊 Total energy for current month: ${qt} kW = ${qt*1e3} W`)}else console.log(`❌ No daily_logs found for ${$e}`)}else console.log(`❌ Device ${$e} not found.`)}catch(pe){console.error("❌ Error inspecting daily logs:",pe)}},window.resetMonthlyLimitCheck=()=>{console.log("🔄 Resetting monthly limit check..."),c(0),console.log("✅ Monthly limit check reset - next check will run immediately")},window.testMonthlyEnergyCalculation=async()=>{console.log("🧪 TESTING MONTHLY ENERGY CALCULATION...");try{const $e=Me(je,"devices"),pe=await Pt($e);if(!pe.exists()){console.log("❌ No devices data found");return}const be=pe.val();console.log("📊 Devices data loaded:",Object.keys(be));const Se=Me(je,"combined_limit_settings"),Ee=await Pt(Se);if(!Ee.exists()){console.log("❌ No combined limit settings found");return}const Ye=Ee.val();console.log("📊 Combined limit settings:",Ye);const qe=Ye.selected_outlets||[],Ue=Ye.combined_limit_watts||0;console.log("🧪 Testing with outlets:",qe),console.log("🧪 Combined limit:",Ue,"Wh");const Xe=Pm(be,qe);console.log("🧪 CALCULATION RESULTS:"),console.log(`📊 Total monthly energy: ${Xe.toFixed(3)} Wh`),console.log(`📊 Combined limit: ${Ue} Wh`),console.log(`📊 Exceeds limit: ${Xe>=Ue}`),console.log(`📊 Percentage: ${Ue>0?(Xe/Ue*100).toFixed(1):0}%`),Xe>=Ue?(console.log("🚨 LIMIT EXCEEDED - Testing enforcement..."),await Vu(be,{enabled:Ye.enabled,selectedOutlets:qe,combinedLimit:Ue})):console.log("✅ Limit not exceeded - no enforcement needed")}catch($e){console.error("❌ Error testing monthly energy calculation:",$e)}},window.testDeviceRemoval=async $e=>{console.log(`🧪 TESTING DEVICE REMOVAL: ${$e}`);try{const pe=await SF($e);console.log("🔧 Removal result:",pe),pe.success?console.log(`✅ Successfully removed ${$e} from combined group and turned it OFF`):console.log(`❌ Failed to remove ${$e}: ${pe.reason}`)}catch(pe){console.error("❌ Error testing device removal:",pe)}},window.testCombinedLimitSaveWithRemoval=async $e=>{console.log(`🧪 TESTING COMBINED LIMIT SAVE WITH REMOVAL: ${$e}`);try{const pe=Me(je,"combined_limit_settings"),be=await Pt(pe);if(be.exists()){const Se=be.val(),Ee=Se.selected_outlets||[],Ye=Ee.filter(Ue=>Ue!==$e);console.log("🔍 Simulating removal:",{current:Ee,new:Ye,removed:$e});const qe={selectedOutlets:Ye,combinedLimit:Se.combined_limit_watts||0,deviceControl:"on",enableScheduling:!0};await Be(qe),console.log("✅ Test completed - check if device was turned OFF")}else console.log("❌ No combined limit settings found")}catch(pe){console.error("❌ Error testing combined limit save with removal:",pe)}},console.log("SetUp: Manual test functions available:"),console.log("- window.testSchedule() - Run schedule check"),console.log("- window.testPowerLimits() - Run power limit check"),console.log("- window.testMonthlyLimits() - Run monthly limit check"),console.log('- window.testSpecificDevice("Outlet_1") - Test specific device'),console.log("- window.forceMonthlyLimitCheck() - Force monthly limit check immediately"),console.log("- window.checkCombinedLimitSettings() - Check combined limit settings"),console.log('- window.setCombinedLimitSettings(["Outlet_2", "Outlet_4"], 500000) - Set combined limit (500Wh)'),console.log("- window.testHierarchy() - Test hierarchy enforcement (monthly limit > schedule)"),console.log('- window.inspectDailyLogs("Outlet_1") - Inspect daily logs for debugging'),console.log("- window.resetMonthlyLimitCheck() - Reset monthly limit check to clear duplicates"),console.log("- window.testMonthlyEnergyCalculation() - Test complete monthly energy calculation and enforcement"),console.log('- window.testDeviceRemoval("Outlet 1") - Test removing device from combined group'),console.log('- window.testCombinedLimitSaveWithRemoval("Outlet 1") - Test combined limit save with device removal');const tt=setInterval(Ne,1e4),lt=setInterval(Ve,5e3);return()=>{clearInterval(tt),clearInterval(lt),Object.values(re).forEach($e=>{$e&&clearTimeout($e)})}},[G]),me.useEffect(()=>{if(!G.enabled||G.selectedOutlets.length===0){console.log("🚫 Monthly limit monitoring disabled - no combined limit set");return}console.log("🔍 Starting real-time monthly limit monitoring for outlets:",G.selectedOutlets);const Ne=Me(je,"devices"),Ve=Go(Ne,async We=>{if(We.exists()){const tt=We.val();console.log("📡 Real-time monthly limit check triggered by Firebase data change");const lt=Date.now();lt-l>=d?(c(lt),await Vu(tt,G)):console.log("⏳ Real-time monthly limit check debounced")}});return()=>{console.log("🛑 Stopping monthly limit monitoring"),lr(Ne,"value",Ve)}},[G]);const W=M.filter(Ne=>Ne.outletName.toLowerCase().includes(n.toLowerCase())||Ne.officeRoom.toLowerCase().includes(n.toLowerCase())||Ne.id.includes(n)),te=Ne=>{const Ve=M.find(We=>We.id===Ne);if(Ve){const We=Ve.outletName,tt=We.replace("_"," ");G.enabled&&(G.selectedOutlets.includes(We)||G.selectedOutlets.includes(tt))?O({isOpen:!0,device:Ve,combinedLimit:G.combinedLimit}):p({isOpen:!0,device:Ve})}},j=Ne=>{T({isOpen:!0,deviceId:Ne,deviceName:M.find(Ve=>Ve.id===Ne)?.outletName||""})},U=(Ne,Ve)=>Ne.replace(/_/g," "),$=async()=>{const Ne=M.find(Ve=>Ve.id===b.deviceId);if(!Ne){console.error("Device not found for deletion:",b.deviceId);return}try{console.log("SetUp: Starting COMPLETE deletion of device:",Ne.outletName);const Ve=Ne.outletName,We=U(Ne.outletName,"combined");console.log("🔍 SetUp: Outlet name formats:",{deviceFormat:Ve,combinedFormat:We});try{console.log("🔍 DEBUG: Starting combined limit cleanup for outlet:",Ne.outletName);const be=Me(je,"combined_limit_settings"),Se=await Pt(be);if(Se.exists()){const Ee=Se.val(),Ye=Ee.selected_outlets||[];console.log("🔍 DEBUG: Current combined limit data:",Ee),console.log("🔍 DEBUG: Current selected outlets:",Ye),console.log("🔍 DEBUG: Outlet to delete (device format):",Ve),console.log("🔍 DEBUG: Outlet to delete (combined format):",We),console.log("🔍 DEBUG: Selected outlets types:",Ye.map(Ue=>typeof Ue));const qe=Ye.some(Ue=>Ue.toLowerCase()===Ve.toLowerCase()||Ue.toLowerCase()===We.toLowerCase());if(console.log("🔍 DEBUG: Outlet found in selected outlets:",qe),qe){console.log("✅ SetUp: Removing outlet from combined limit settings:",We);const Ue=Ye.filter(Xe=>Xe.toLowerCase()!==Ve.toLowerCase()&&Xe.toLowerCase()!==We.toLowerCase());console.log("🔍 DEBUG: Updated selected outlets:",Ue),await Kt(be,{...Ee,selected_outlets:Ue}),console.log("✅ SetUp: Successfully removed outlet from combined limit settings. Updated outlets:",Ue)}else console.log("❌ SetUp: Outlet not found in combined limit settings, no removal needed"),console.log("🔍 DEBUG: Available outlets in selected_outlets:",Ye),console.log("🔍 DEBUG: Looking for outlet:",Ne.outletName)}else console.log("❌ SetUp: No combined limit settings found, skipping removal")}catch(be){console.error("❌ SetUp: Error removing outlet from combined limit settings:",be),console.error("❌ SetUp: Combined limit error details:",{outletName:Ne.outletName,error:be,stack:be instanceof Error?be.stack:"No stack trace available"})}try{const be=Me(je,"combined_schedule_settings"),Se=await Pt(be);if(Se.exists()){const Ee=Se.val(),Ye=Ee.selected_outlets||[];if(Ye.some(Ue=>Ue.toLowerCase()===Ve.toLowerCase()||Ue.toLowerCase()===We.toLowerCase())){console.log("SetUp: Removing outlet from combined schedule settings:",We);const Ue=Ye.filter(Xe=>Xe.toLowerCase()!==Ve.toLowerCase()&&Xe.toLowerCase()!==We.toLowerCase());await Kt(be,{...Ee,selected_outlets:Ue}),console.log("SetUp: Successfully removed outlet from combined schedule settings. Updated outlets:",Ue)}else console.log("SetUp: Outlet not found in combined schedule settings, no removal needed")}else console.log("SetUp: No combined schedule settings found, skipping removal")}catch(be){console.error("SetUp: Error removing outlet from combined schedule settings:",be)}try{console.log("SetUp: Removing device logs for outlet:",Ne.outletName);const be=Me(je,"device_logs"),Se=await Pt(be);if(Se.exists()){const Ee=Se.val(),Ye=[];Object.keys(Ee).forEach(qe=>{const Ue=Ee[qe];Ue&&Ue.outletName===Ne.outletName&&Ye.push(qe)});for(const qe of Ye){const Ue=Me(je,`device_logs/${qe}`);await dh(Ue)}console.log(`SetUp: Removed ${Ye.length} device logs for outlet:`,Ne.outletName)}else console.log("SetUp: No device logs found, skipping removal")}catch(be){console.error("SetUp: Error removing device logs:",be)}try{console.log("SetUp: Removing user logs for outlet:",Ne.outletName);const be=Me(je,"user_logs"),Se=await Pt(be);if(Se.exists()){const Ee=Se.val(),Ye=[];Object.keys(Ee).forEach(qe=>{const Ue=Ee[qe];Ue&&Ue.outletName===Ne.outletName&&Ye.push(qe)});for(const qe of Ye){const Ue=Me(je,`user_logs/${qe}`);await dh(Ue)}console.log(`SetUp: Removed ${Ye.length} user logs for outlet:`,Ne.outletName)}else console.log("SetUp: No user logs found, skipping removal")}catch(be){console.error("SetUp: Error removing user logs:",be)}try{console.log("SetUp: Removing general logs for outlet:",Ne.outletName);const be=Me(je,"logs"),Se=await Pt(be);if(Se.exists()){const Ee=Se.val(),Ye=[];Object.keys(Ee).forEach(qe=>{const Ue=Ee[qe];Ue&&Ue.outletName===Ne.outletName&&Ye.push(qe)});for(const qe of Ye){const Ue=Me(je,`logs/${qe}`);await dh(Ue)}console.log(`SetUp: Removed ${Ye.length} general logs for outlet:`,Ne.outletName)}else console.log("SetUp: No general logs found, skipping removal")}catch(be){console.error("SetUp: Error removing general logs:",be)}console.log("🗑️ SetUp: Starting complete device deletion from devices collection...");const tt=Me(je,`devices/${Ne.outletName}`),lt=await Pt(tt);if(lt.exists()){const be=lt.val();console.log("🔍 SetUp: Outlet data that will be deleted:",be),console.log("🔍 SetUp: Outlet data keys:",Object.keys(be)),be.sensor_data&&console.log("🔍 SetUp: Sensor data will be deleted:",be.sensor_data),be.daily_logs&&console.log("🔍 SetUp: Daily logs will be deleted:",Object.keys(be.daily_logs)),be.office_info&&console.log("🔍 SetUp: Office info will be deleted:",be.office_info),be.schedule&&console.log("🔍 SetUp: Schedule will be deleted:",be.schedule),be.relay_control&&console.log("🔍 SetUp: Relay control will be deleted:",be.relay_control),be.control&&console.log("🔍 SetUp: Control settings will be deleted:",be.control),be.lifetime_energy!==void 0&&console.log("🔍 SetUp: Lifetime energy will be deleted:",be.lifetime_energy),be.lifetime_hours!==void 0&&console.log("🔍 SetUp: Lifetime hours will be deleted:",be.lifetime_hours),be.lifetime_usage_millis!==void 0&&console.log("🔍 SetUp: Lifetime usage millis will be deleted:",be.lifetime_usage_millis)}else console.log("❌ SetUp: No outlet data found at path:",`devices/${Ne.outletName}`);console.log("🗑️ SetUp: Deleting outlet at path:",`devices/${Ne.outletName}`);const $e=await dh(tt);console.log("🗑️ SetUp: Delete result:",$e),(await Pt(tt)).exists()?console.log("❌ SetUp: VERIFICATION FAILED - Outlet still exists in devices collection!"):console.log("✅ SetUp: VERIFICATION SUCCESSFUL - Outlet completely deleted from devices collection!"),console.log("✅ SetUp: COMPLETE device deletion successful! All outlet data has been removed from database."),le({isOpen:!0,deviceName:Ne.outletName}),T({...b,isOpen:!1})}catch(Ve){console.error("SetUp: Error deleting device from database:",Ve),console.error("SetUp: Error details:",{deviceId:b.deviceId,deviceName:Ne?.outletName,error:Ve}),T({...b,isOpen:!1})}},X=()=>{i(!0)},Q=()=>{i(!1)},ye=()=>{A({isOpen:!0})},Ae=()=>{A({isOpen:!1})},De=()=>{ee({isOpen:!1,selectedOutlets:[],combinedLimit:0,isEdit:!1})},Be=async Ne=>{try{console.log("Saving combined limit:",Ne);const Ve=Me(je,"combined_limit_settings"),We=await Pt(Ve);if(We.exists()){const pe=We.val().selected_outlets||[],be=pe.filter(Se=>!Ne.selectedOutlets.includes(Se));if(console.log("🔍 Combined limit removal check:",{currentSelectedOutlets:pe,newSelectedOutlets:Ne.selectedOutlets,removedOutlets:be}),be.length>0){console.log("🔒 Devices removed from combined group, turning them OFF:",be);for(const Se of be){const Ee=Se.includes(" ")?Se.replace(" ","_"):Se;console.log(`🔧 Processing removal: "${Se}" -> "${Ee}"`);try{const Ye=Me(je,`devices/${Ee}/control`);await Kt(Ye,{device:"off"});const qe=Me(je,`devices/${Ee}`);await Kt(qe,{status:"OFF"}),console.log(`🔒 SetUp: Successfully turned OFF ${Ee} after removal from combined group (now subject to individual daily limits)`)}catch(Ye){console.error(`❌ Error turning off removed device ${Ee}:`,Ye)}}}else console.log("ℹ️ No devices were removed from combined group")}await Kt(Ve,{enabled:!0,selected_outlets:Ne.selectedOutlets,combined_limit_watts:Ne.combinedLimit===0?"No Limit":Ne.combinedLimit,device_control:Ne.deviceControl,scheduling_only:Ne.combinedLimit===0,created_at:new Date().toISOString(),created_by:"user"}),console.log("Updating device control for selected outlets:",Ne.selectedOutlets);for(const $e of Ne.selectedOutlets){const pe=$e.replace(" ","_"),be=Me(je,`devices/${pe}/control`);try{await Kt(be,{device:Ne.deviceControl});const Se=Me(je,`devices/${pe}`);await Kt(Se,{status:Ne.deviceControl==="on"?"ON":"OFF"}),console.log(`Updated device control for ${pe} to ${Ne.deviceControl}`)}catch(Se){console.error(`Error updating device control for ${pe}:`,Se)}}if(Ne.enableScheduling){console.log("Enabling scheduling for selected outlets:",Ne.selectedOutlets);for(const $e of Ne.selectedOutlets){const pe=$e.replace(" ","_");try{const be=Me(je,`devices/${pe}/office_info`);await Kt(be,{enable_power_scheduling:!0}),console.log(`Enabled scheduling for ${pe}`)}catch(be){console.error(`Error enabling scheduling for ${pe}:`,be)}}}else{console.log("Clearing scheduling data for selected outlets:",Ne.selectedOutlets);try{const $e=Me(je,"combined_schedule_settings");await Kt($e,{enabled:!1,selected_outlets:[],schedule_data:null,created_at:null,created_by:null}),console.log("Cleared combined schedule settings")}catch($e){console.error("Error clearing combined schedule settings:",$e)}for(const $e of Ne.selectedOutlets){const pe=$e.replace(" ","_");try{const be=Me(je,`devices/${pe}/schedule`);await Kt(be,{timeRange:null,startTime:null,endTime:null,days:null,enabled:!1});const Se=Me(je,`devices/${pe}/office_info`);await Kt(Se,{enable_power_scheduling:!1}),console.log(`Cleared scheduling data for ${pe}`)}catch(be){console.error(`Error clearing scheduling data for ${pe}:`,be)}}}console.log("Combined limit, device control, and scheduling data saved successfully");const tt=G.enabled?"Edit combined limit":"Set combined limit",lt=Ne.combinedLimit===0?"No Limit":Ne.combinedLimit;await wF(tt,Ne.selectedOutlets,lt),A({isOpen:!1}),K({enabled:!0,selectedOutlets:Ne.selectedOutlets,combinedLimit:Ne.combinedLimit}),ee({isOpen:!0,selectedOutlets:Ne.selectedOutlets,combinedLimit:Ne.combinedLimit,isEdit:G.enabled})}catch(Ve){console.error("Error saving combined limit:",Ve),alert("Failed to save combined limit. Please try again.")}};me.useEffect(()=>{(async()=>{try{const Ve=Me(je,"combined_limit_settings"),We=await Pt(Ve);if(We.exists()){const tt=We.val();console.log("SetUp: Fetched combined limit data:",tt),K({enabled:tt.enabled||!1,selectedOutlets:tt.selected_outlets||[],combinedLimit:tt.combined_limit_watts||0})}else console.log("SetUp: No combined limit settings found in database")}catch(Ve){console.error("Error fetching combined limit info:",Ve)}})()},[]),me.useEffect(()=>{const Ve=setInterval(async()=>{try{const We=Me(je,"combined_limit_settings"),tt=await Pt(We);if(tt.exists()){const lt=tt.val();console.log("SetUp: Refetching combined limit data:",lt),K({enabled:lt.enabled||!1,selectedOutlets:lt.selected_outlets||[],combinedLimit:lt.combined_limit_watts||0})}}catch(We){console.error("Error refetching combined limit info:",We)}},3e4);return()=>clearInterval(Ve)},[]),me.useEffect(()=>{const Ne=async()=>{try{const We=Me(je,"combined_limit_settings"),tt=await Pt(We);if(!tt.exists())return;const lt=tt.val();if(!lt.enabled)return;const $e=lt.selected_outlets||[],pe=lt.combined_limit_watts||0;if(pe==="No Limit"){console.log('SetUp: Combined limit is set to "No Limit" - skipping power limit check');return}if($e.length===0||pe<=0)return;const be=Me(je,"devices"),Se=await Pt(be);if(!Se.exists())return;const Ee=Se.val(),Ye=new Date,qe=`day_${Ye.getFullYear()}_${String(Ye.getMonth()+1).padStart(2,"0")}_${String(Ye.getDate()).padStart(2,"0")}`;let Ue=0;const Xe=[];if($e.forEach(bt=>{const qt=bt.replace(" ","_"),fe=Ee[qt];if(fe){const mt=(fe.daily_logs?.[qe]?.total_energy||0)*1e3;Ue+=mt,(fe.control?.device||"off")==="on"&&Xe.push(qt)}}),console.log("SetUp: Combined power limit check:",{selectedOutlets:$e,totalCombinedPower:`${Ue.toFixed(3)}W`,combinedLimitWatts:`${pe}W`,exceedsLimit:Ue>=pe,activeDevices:Xe.length}),Ue>=pe&&Xe.length>0){console.log(`SetUp: COMBINED POWER LIMIT EXCEEDED - Turning OFF all active devices (${Ue.toFixed(3)}Wh >= ${pe}Wh)`);for(const bt of Xe)try{await Kt(Me(je,`devices/${bt}/control`),{device:"off"}),await Kt(Me(je,`devices/${bt}`),{status:"OFF"}),console.log(`SetUp: Device ${bt} turned OFF due to combined power limit exceeded`)}catch(qt){console.error(`SetUp: Error turning off device ${bt}:`,qt)}console.log(`SetUp: Combined power limit action completed - ${Xe.length} devices turned off`)}}catch(We){console.error("SetUp: Error in combined power limit monitor:",We)}};Ne();const Ve=setInterval(Ne,3e4);return()=>clearInterval(Ve)},[]);const Fe=Ne=>{console.log("Saving device:",Ne),console.log("Appliance:",Ne.appliance),console.log("Enable Scheduling:",Ne.enableScheduling),console.log("Enable Power Limit:",Ne.enablePowerLimit),console.log("Device Control:",Ne.deviceControl);const Ve=Me(je,"devices");Go(Ve,We=>{const tt=We.val();if(tt){const lt=[];let $e=1;const pe=new Date,be=`day_${pe.getFullYear()}_${String(pe.getMonth()+1).padStart(2,"0")}_${String(pe.getDate()).padStart(2,"0")}`;Object.keys(tt).forEach(Se=>{const Ee=tt[Se];if(Ee.sensor_data){const Ye=Ee.lifetime_energy||0,qe=`${iu(Ye*1e3)} Wh`,Ue=Ye/1e3,Xe=Ee.relay_control?.auto_cutoff?.power_limit||0,bt=Ee.control?.device||"off",qt=Ee.daily_logs?.[be]?.total_energy||0,fe=`${iu(qt*1e3)} Wh`,Ze={"computer-lab-1":"Computer Laboratory 1","computer-lab-2":"Computer Laboratory 2","computer-lab-3":"Computer Laboratory 3","deans-office":"Dean's Office","faculty-office":"Faculty Office"},Je=Ee.office_info?.office||"",mt=Je?Ze[Je]||Je:"—",Tt=Ee.status||"ON";let It="Inactive";Tt==="OFF"?It="Inactive":bt==="ON"&&(Xe>=0&&Ue*1e3>=Xe*1e3?It="Inactive":Xe>0&&Xe*1e3-Ue*1e3<=50?It="Warning":It="Active");const gt=Ee.sensor_data?.current||0,tn=`${Math.round(gt)} A`,Zt={id:String($e).padStart(3,"0"),outletName:Se,officeRoom:mt,appliances:Ee.office_info?.appliance||"Unassigned",enablePowerScheduling:Ee.office_info?.enable_power_scheduling||!1,limit:`${(Xe*1e3).toFixed(3)} Wh`,powerUsage:qe,currentAmpere:tn,todayUsage:fe,monthUsage:eN(Ee),status:It};lt.push(Zt),$e++}}),Y(lt),Vu(tt,G)}},{onlyOnce:!0})},Ct=Ne=>{console.log("SetUp: handleEditSave called for device:",Ne.outletName),console.log("SetUp: Updated device data:",Ne);const Ve=M.find(We=>We.id===Ne.id);Ve&&(Ve.powerUsage.includes("kW")?parseFloat(Ve.powerUsage.replace(" kW","")):parseFloat(Ve.powerUsage.replace(" Wh",""))/1e3,Ne.powerUsage.includes("kW")?parseFloat(Ne.powerUsage.replace(" kW","")):parseFloat(Ne.powerUsage.replace(" Wh",""))/1e3,parseInt(Ve.limit.replace("Wh","").replace("W","")),parseInt(Ne.limit.replace("Wh","").replace("W",""))),setTimeout(()=>{console.log("SetUp: Showing success modal for:",Ne.outletName),_({isOpen:!0,deviceName:Ne.outletName})},500),console.log("SetUp: handleEditSave completed - table will update via real-time listener")},[at,Ce]=me.useState({}),ce=()=>{R({...z,isOpen:!1});const Ne=document.querySelector(".add-device-btn");Ne&&Ne.scrollIntoView({behavior:"smooth",block:"center"})};me.useEffect(()=>{Ce(Object.fromEntries(M.map(Ne=>[Ne.id,Ne.status])))},[]),me.useEffect(()=>{Ce(Object.fromEntries(M.map(Ne=>[Ne.id,Ne.status])))},[M]),me.useEffect(()=>{if(!s)return;const Ne=document.getElementById(`device-row-${s}`);Ne&&Ne.scrollIntoView({behavior:"smooth",block:"center"});const Ve=setTimeout(()=>o(null),2500);return()=>clearTimeout(Ve)},[s]);const _t=Ne=>{const Ve={Active:"status-active",Inactive:"status-inactive",Warning:"status-warning",Idle:"status-idle"};return u.jsxs("span",{className:`status-badge ${Ve[Ne]||"status-inactive"}`,children:[u.jsx("span",{className:`status-dot ${Ve[Ne]||"status-inactive"}`}),Ne]})};return u.jsxs("div",{className:"setup-wrap",children:[u.jsxs("section",{className:"setup-hero",children:[u.jsxs("div",{className:"hero-left",children:[u.jsx("div",{className:"hero-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"3",y:"4",width:"18",height:"5",rx:"2",fill:"#ffffff"}),u.jsx("rect",{x:"3",y:"10",width:"10",height:"10",rx:"2",fill:"#ffffff"}),u.jsx("rect",{x:"14",y:"10",width:"7",height:"10",rx:"2",fill:"#ffffff"}),u.jsx("path",{d:"M12 16h.01M8 16h.01M16 16h.01",stroke:"#0b3e86",strokeWidth:"2",strokeLinecap:"round"})]})}),u.jsxs("div",{className:"hero-text",children:[u.jsxs("h1",{children:["Devices ",u.jsx("span",{className:"device-count-pill",children:M.length})]}),u.jsx("p",{children:"Setup your devices"})]})]}),u.jsxs("div",{className:"hero-actions",children:[u.jsxs("button",{className:"add-device-btn",type:"button","aria-label":"Add new device",onClick:X,children:[u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),"Add device"]}),u.jsxs("button",{className:"combined-limit-btn",type:"button","aria-label":G.enabled?"Edit combined power limit":"Set combined power limit",onClick:ye,children:[u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(G.enabled,"Monthly Device Limit")]})]})]}),u.jsxs("section",{className:"setup-content",children:[u.jsxs("div",{className:"content-header",children:[u.jsx("h2",{children:"Connected Devices"}),u.jsxs("div",{className:"search-container",children:[u.jsxs("svg",{className:"search-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8",stroke:"#9ca3af",strokeWidth:"2"}),u.jsx("path",{d:"m21 21-4.35-4.35",stroke:"#9ca3af",strokeWidth:"2",strokeLinecap:"round"})]}),u.jsx("input",{type:"text",placeholder:"Search device",value:n,onChange:Ne=>e(Ne.target.value),className:"search-field","aria-label":"Search devices"})]})]}),u.jsxs("div",{className:"setup-table-container",children:[u.jsxs("table",{className:"setup-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:"OUTLET NAME"}),u.jsx("th",{children:"OFFICE / ROOM"}),u.jsx("th",{children:"APPLIANCES"}),u.jsx("th",{children:"LIMIT"}),u.jsx("th",{children:"CURRENT POWER USAGE"}),u.jsx("th",{children:"CURRENT (A)"}),u.jsx("th",{children:"TODAY'S ENERGY"}),u.jsx("th",{children:"MONTH ENERGY"}),u.jsx("th",{children:"STATUS"}),u.jsx("th",{children:"ACTIONS"})]})}),u.jsx("tbody",{children:W.map(Ne=>u.jsxs("tr",{id:`device-row-${Ne.id}`,className:s===Ne.id?"row-recent":"",children:[u.jsx("td",{className:"device-id",children:Ne.id}),u.jsx("td",{className:"outlet-name",children:Ne.outletName}),u.jsx("td",{className:"office-room",children:Ne.officeRoom}),u.jsx("td",{className:"appliances",children:Ne.appliances}),u.jsx("td",{className:"limit",children:(()=>{const Ve=Ne.outletName,We=Ve.replace("_"," "),tt=G.enabled&&(G.selectedOutlets.includes(Ve)||G.selectedOutlets.includes(We));return console.log(`SetUp: Checking device ${Ne.outletName}:`,{enabled:G.enabled,selectedOutlets:G.selectedOutlets,deviceOutletName:Ve,deviceOutletNameWithSpace:We,isUsingCombinedLimit:tt,combinedLimit:G.combinedLimit}),tt?u.jsx("div",{className:"combined-limit-display",children:u.jsxs("div",{className:"combined-limit-indicator",children:[u.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),u.jsx("span",{children:String(G.combinedLimit)==="No Limit"?"No Limit":`${G.combinedLimit}Wh`})]})}):Ne.limit.includes("Wh")?Ne.limit:Ne.limit.replace(" W"," Wh")})()}),u.jsx("td",{className:"power-usage",children:Ne.powerUsage}),u.jsx("td",{className:"current-ampere",children:Ne.currentAmpere}),u.jsx("td",{className:"today-usage",children:Ne.todayUsage}),u.jsx("td",{className:"month-usage",children:Ne.monthUsage||"0.000 W"}),u.jsx("td",{className:"status-cell",children:u.jsxs("div",{className:"status-container",children:[_t(Ne.status),Ne.schedule&&u.jsx("div",{className:`schedule-indicator ${Jy(Ne.schedule,"on",Ne,G?.enabled&&G?.selectedOutlets?.includes(Ne.outletName))?"active":"inactive"}`,children:u.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),u.jsx("polyline",{points:"12,6 12,12 16,14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})}),u.jsxs("td",{className:"actions",children:[u.jsx("button",{className:"action-btn edit-btn",onClick:()=>te(Ne.id),"aria-label":`Edit ${Ne.outletName}`,title:"Edit device",children:u.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),u.jsx("button",{className:"action-btn delete-btn",onClick:()=>j(Ne.id),"aria-label":`Delete ${Ne.outletName}`,title:"Delete device",children:u.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("path",{d:"M10 11v6M14 11v6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]})]},Ne.id))})]}),W.length===0&&u.jsxs("div",{className:"no-devices",children:[u.jsx("div",{className:"no-devices-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"3",y:"4",width:"18",height:"5",rx:"2",fill:"#e5e7eb"}),u.jsx("rect",{x:"3",y:"10",width:"10",height:"10",rx:"2",fill:"#e5e7eb"}),u.jsx("rect",{x:"14",y:"10",width:"7",height:"10",rx:"2",fill:"#e5e7eb"})]})}),u.jsx("h3",{children:"No devices found"}),u.jsx("p",{children:"Try adjusting your search terms to find devices."})]})]})]}),u.jsx(RF,{isOpen:t,onClose:Q,onSave:Fe}),u.jsx(jF,{isOpen:C.isOpen,onClose:Ae,onSave:Be,existingData:G}),u.jsx(MF,{isOpen:I.isOpen,onClose:De,selectedOutlets:I.selectedOutlets,combinedLimit:I.combinedLimit,isEdit:I.isEdit}),u.jsx(OF,{isOpen:f.isOpen,onClose:()=>p({...f,isOpen:!1}),device:f.device,onSave:Ct,combinedLimitInfo:G}),u.jsx(DF,{isOpen:E.isOpen,onClose:()=>O({...E,isOpen:!1}),device:E.device,combinedLimit:E.combinedLimit}),u.jsx(uC,{isOpen:v.isOpen,onClose:()=>{_({...v,isOpen:!1})},title:"Device Updated Successfully!",message:`"${v.deviceName}" has been updated with the new settings.`}),u.jsx(TF,{isOpen:b.isOpen,onClose:()=>T({...b,isOpen:!1}),onConfirm:$,deviceName:b.deviceName}),u.jsx(CF,{isOpen:de.isOpen,onClose:()=>{le({...de,isOpen:!1}),console.log("SetUp: Delete success modal closed - table will update via real-time listener")},deviceName:de.deviceName}),z.isOpen&&u.jsx(kF,{isOpen:z.isOpen,onClose:()=>R({...z,isOpen:!1}),device:z.device,onGoToSetup:ce}),D.isOpen&&u.jsx(AF,{isOpen:D.isOpen,onClose:()=>F({...D,isOpen:!1}),device:D.device,reason:D.reason,currentMonthlyEnergy:D.currentMonthlyEnergy,combinedLimit:D.combinedLimit})]})}const zh=(n,e)=>{try{const t=new Date,i=t.getFullYear(),s=t.getMonth()+1,o=new Date(i,s,0).getDate();let l=0;const c=new Set;return console.log("🔍 MONTHLY ENERGY CALCULATION:",{currentYear:i,currentMonth:s,daysInMonth:o,selectedOutlets:[...new Set(e)],totalOutlets:e.length,uniqueOutlets:[...new Set(e)].length}),e.forEach((d,f)=>{if(c.has(d)){console.log(`⚠️ DUPLICATE SKIPPED: ${d} (already processed)`);return}c.add(d);const p=d.replace(" ","_"),v=n[p];if(console.log(`🔍 Processing outlet ${f+1}/${e.length}: ${d} -> ${p}`),v&&v.daily_logs){let _=0,b=0;for(let T=1;T<=o;T++){const C=`day_${i}_${String(s).padStart(2,"0")}_${String(T).padStart(2,"0")}`,A=v.daily_logs[C];if(A&&A.total_energy&&A.total_energy>0){const I=A.total_energy*1e3;_+=I,b++,console.log(`📊 ${d} Day ${T}: ${A.total_energy} kW = ${I} W`)}}l+=_,console.log(`📊 ${d} MONTHLY TOTAL: ${_} W (${b} days with data)`)}else console.log(`❌ ${d}: device not found or no daily_logs`),v&&console.log("🔍 Available fields:",Object.keys(v))}),console.log(`📊 FINAL COMBINED MONTHLY ENERGY: ${l} W`),console.log(`📊 Processed ${c.size} unique outlets`),l}catch(t){return console.error("❌ Error calculating combined monthly energy:",t),0}},tN=(n,e)=>{e(t=>(t[n]&&(clearTimeout(t[n]),console.log(`🔄 Auto-turnoff: Cleared timer for ${n} - device is now idle or turned off`)),{...t,[n]:null}))},j0=async(n,e)=>{try{if(console.log("🔍 Monthly limit check - Input data:",{combinedLimitInfo:e,devicesDataKeys:Object.keys(n||{}),enabled:e?.enabled,selectedOutlets:e?.selectedOutlets,combinedLimit:e?.combinedLimit}),!e?.enabled||!e?.selectedOutlets||e.selectedOutlets.length===0){console.log("🚫 Monthly limit check skipped - not enabled or no outlets selected");return}const t=zh(n,e.selectedOutlets),i=e.combinedLimit;if(console.log("📊 Monthly limit check results:",{totalMonthlyEnergy:`${su(t)}W`,combinedLimitWatts:i==="No Limit"?"No Limit":`${i==="No Limit"?"No Limit":`${i}W`}`,selectedOutlets:e.selectedOutlets,exceedsLimit:t>=i,percentage:i!=="No Limit"&&i>0?`${(t/i*100).toFixed(1)}%`:"N/A"}),i==="No Limit"){console.log('📊 Combined limit is set to "No Limit" - skipping monthly limit check');return}if(t>=i){console.log("🚨 MONTHLY LIMIT EXCEEDED!"),console.log(`📊 Current: ${t.toFixed(3)}W >= Limit: ${i==="No Limit"?"No Limit":`${i}W`}`),console.log("🔒 TURNING OFF ALL DEVICES IN THE GROUP...");const s=e.selectedOutlets.map(async d=>{try{const f=d.replace(" ","_"),p=Me(je,`devices/${f}/control`);await Kt(p,{device:"off"});const v=Me(je,`devices/${f}/relay_control`);return await Kt(v,{main_status:"OFF"}),console.log(`✅ TURNED OFF: ${d} (${f}) due to monthly limit`),{outletKey:d,success:!0}}catch(f){return console.error(`❌ FAILED to turn off ${d}:`,f),{outletKey:d,success:!1,error:f}}}),o=await Promise.all(s),l=o.filter(d=>d.success).length,c=o.filter(d=>!d.success).length;console.log(`🔒 MONTHLY LIMIT ENFORCEMENT COMPLETE: ${l} turned off, ${c} failed`)}else console.log("✅ Monthly limit not exceeded - devices can remain active"),console.log(`📊 Current: ${t.toFixed(3)}W < Limit: ${i==="No Limit"?"No Limit":`${i}W`}`)}catch(t){console.error("❌ Error checking combined monthly limit:",t)}},rp=async(n,e)=>{try{if(!e?.enabled||!e?.selectedOutlets||e.selectedOutlets.length===0)return{canTurnOn:!0};if(!e.selectedOutlets.includes(n))return{canTurnOn:!0};const t=Me(je,"devices"),i=await Pt(t);if(!i.exists())return{canTurnOn:!0};const s=i.val(),o=zh(s,e.selectedOutlets),l=e.combinedLimit;return console.log("Monthly limit check before turn ON:",{outletKey:n,totalMonthlyEnergy:o,combinedLimitWatts:l,selectedOutlets:e.selectedOutlets,wouldExceed:o>=l}),l==="No Limit"?(console.log('📊 Combined limit is set to "No Limit" - allowing device to turn on'),{canTurnOn:!0,reason:"No monthly limit set",currentMonthlyEnergy:o,combinedLimit:l}):o>=l?{canTurnOn:!1,reason:`Monthly limit exceeded. Current monthly energy: ${(o/1e3).toFixed(3)} kW, Limit: ${(l/1e3).toFixed(3)} kW`,currentMonthlyEnergy:o,combinedLimit:l}:{canTurnOn:!0}}catch(t){return console.error("Error checking monthly limit before turn ON:",t),{canTurnOn:!0}}},nN=()=>{const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`day_${e}_${t}_${i}`},su=(n,e=3)=>n.toLocaleString("en-US",{minimumFractionDigits:e,maximumFractionDigits:e}),Um=(n,e,t,i)=>{if(!n||!n.timeRange&&!n.startTime)return e==="on";const s=new Date,o=s.getHours()*60+s.getMinutes(),l=s.getDay();let c,d;if(n.startTime&&n.endTime){const[_,b]=n.startTime.split(":").map(Number),[T,C]=n.endTime.split(":").map(Number);c=_*60+b,d=T*60+C}else if(n.timeRange){const _=n.timeRange,[b,T]=_.split(" - "),C=A=>{const[I,ee]=A.split(" ");let[G,K]=I.split(":").map(Number);return G===12&&(G=0),ee==="PM"&&(G+=12),G*60+K};c=C(b),d=C(T)}else return e==="on";const f=o>=c&&o<d;if(n.timeRange||n.startTime&&n.endTime){const _=`${Math.floor(o/60).toString().padStart(2,"0")}:${(o%60).toString().padStart(2,"0")}`,b=`${Math.floor(d/60).toString().padStart(2,"0")}:${(d%60).toString().padStart(2,"0")}`;o>=d?console.log(`⏰ END TIME REACHED: Device should be OFF (current: ${_}, end: ${b})`):o===d-1&&console.log(`⏰ ONE MINUTE TO END: Device will turn OFF at ${b} (current: ${_})`)}const p=n.frequency||"";let v=!1;if(p.toLowerCase()==="daily")v=!0;else if(p.toLowerCase()==="weekdays")v=l>=1&&l<=5;else if(p.toLowerCase()==="weekends")v=l===0||l===6;else if(p.includes(",")){const _={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6};v=p.split(",").map(T=>{const C=T.trim().toLowerCase();return _[C]}).filter(T=>T!==void 0).includes(l)}else if(p){const b={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6}[p.toLowerCase()];b!==void 0&&(v=b===l)}if(t&&!i){const _=t.relay_control?.auto_cutoff?.power_limit||0,b=new Date,T=`day_${b.getFullYear()}_${String(b.getMonth()+1).padStart(2,"0")}_${String(b.getDate()).padStart(2,"0")}`,A=t?.daily_logs?.[T]?.total_energy||0;if(_>0&&A>=_)return console.log(`Schedule check: Device ${t.outletName||"Unknown"} power limit exceeded:`,{todayTotalEnergy:`${(A*1e3).toFixed(3)}W`,powerLimit:`${_*1e3}W`,todayDateKey:T,scheduleResult:!1,reason:"Today's energy consumption exceeded power limit"}),!1}return f&&v},iv=n=>{if(!n||n==="Unassigned")return"Unassigned";const e=n.replace(/[-_]/g," ").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" ");return e.toLowerCase().includes("computer lab")?e.replace(/computer lab/i,"Computer Laboratory"):e.toLowerCase().includes("deans office")?e.replace(/deans office/i,"Dean's Office"):e},PF=n=>{if(!n)return"";const e=n.toLowerCase();if(e==="weekdays")return"Weekdays";if(e==="weekends")return"Weekends";const t={monday:"M",tuesday:"T",wednesday:"W",thursday:"TH",friday:"F",saturday:"SAT",sunday:"SUN"};return n.split(", ").map(s=>t[s.toLowerCase()]||s).join(",")};function UF({isOpen:n,onClose:e,device:t,onSave:i}){const[s,o]=me.useState(""),[l,c]=me.useState(""),[d,f]=me.useState([]),[p,v]=me.useState({}),_=["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","SUNDAY"];me.useEffect(()=>{if(t&&t.schedule){const le=t.schedule;if(le.timeRange){const[z,R]=le.timeRange.split(" - ");o(T(z)),c(T(R))}else le.startTime&&le.endTime&&(o(le.startTime),c(le.endTime));if(le.frequency){const z=le.frequency;if(z.includes(",")){const R={SUN:"SUNDAY",SUNDAY:"SUNDAY",MON:"MONDAY",MONDAY:"MONDAY",M:"MONDAY",TUE:"TUESDAY",TUESDAY:"TUESDAY",T:"TUESDAY",WED:"WEDNESDAY",WEDNESDAY:"WEDNESDAY",W:"WEDNESDAY",THU:"THURSDAY",THURSDAY:"THURSDAY",TH:"THURSDAY",FRI:"FRIDAY",FRIDAY:"FRIDAY",F:"FRIDAY",SAT:"SATURDAY",SATURDAY:"SATURDAY"},D=z.split(",").map(F=>{const E=F.trim().toUpperCase();return R[E]||E}).filter(F=>_.includes(F));f(D)}else if(z.toLowerCase()==="weekdays")f(["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY"]);else if(z.toLowerCase()==="weekends")f(["SATURDAY","SUNDAY"]);else if(z.toLowerCase()==="daily")f(_);else{const D={SUN:"SUNDAY",SUNDAY:"SUNDAY",MON:"MONDAY",MONDAY:"MONDAY",M:"MONDAY",TUE:"TUESDAY",TUESDAY:"TUESDAY",T:"TUESDAY",WED:"WEDNESDAY",WEDNESDAY:"WEDNESDAY",W:"WEDNESDAY",THU:"THURSDAY",THURSDAY:"THURSDAY",TH:"THURSDAY",FRI:"FRIDAY",FRIDAY:"FRIDAY",F:"FRIDAY",SAT:"SATURDAY",SATURDAY:"SATURDAY"}[z.toUpperCase()]||z.toUpperCase();_.includes(D)?f([D]):f([])}}else f([])}else o(""),c(""),f([]);v({})},[t]);const b=()=>{const le=Intl.DateTimeFormat().resolvedOptions().timeZone;return new Date().toLocaleTimeString("en-US",{timeZoneName:"short",timeZone:le}).split(" ").pop()||"UTC"},T=le=>{if(!le)return"";const[z,R]=le.split(" ");let[D,F]=z.split(":");return D==="12"&&(D="00"),R==="PM"&&(D=String(parseInt(D,10)+12)),`${D.padStart(2,"0")}:${F}`},C=le=>{if(!le)return"";const[z,R]=le.split(":"),D=parseInt(z,10),F=D>=12?"PM":"AM";return`${D%12||12}:${R} ${F}`},A=le=>{f(z=>z.includes(le)?z.filter(R=>R!==le):[...z,le]),p.days&&v(z=>({...z,days:""}))},I=(le,z)=>{le==="start"?o(z):c(z),p[le]&&v(R=>({...R,[le]:""}))},ee=()=>{const le={};if(s||(le.start="Start time is required"),l||(le.end="End time is required"),d.length===0&&(le.days="Please select at least one day"),s&&l){const z=new Date(`2000-01-01T${s}`),R=new Date(`2000-01-01T${l}`);z>=R&&(le.end="End time must be after start time")}return v(le),Object.keys(le).length===0},G=le=>{if(le.preventDefault(),ee()&&t){const z=`${C(s)} - ${C(l)}`;let R=d.join(", ");d.length===7?R="Daily":d.length===5&&d.includes("MONDAY")&&d.includes("TUESDAY")&&d.includes("WEDNESDAY")&&d.includes("THURSDAY")&&d.includes("FRIDAY")?R="Weekdays":d.length===2&&d.includes("SATURDAY")&&d.includes("SUNDAY")&&(R="Weekends"),i(t.id,{timeRange:z,frequency:R})}},K=()=>{v({}),e()},de=()=>d.length===0?"No days selected":d.length===7?"All days":d.length===5&&d.includes("MONDAY")&&d.includes("TUESDAY")&&d.includes("WEDNESDAY")&&d.includes("THURSDAY")&&d.includes("FRIDAY")?"Weekdays":d.length===2&&d.includes("SATURDAY")&&d.includes("SUNDAY")?"Weekends":d.join(", ");return!n||!t?null:u.jsx("div",{className:"modal-overlay",onClick:K,children:u.jsxs("div",{className:"modal-content edit-schedule-modal",onClick:le=>le.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h3",{children:"Edit Schedule"}),u.jsx("button",{type:"button",className:"modal-close",onClick:K,"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsxs("form",{onSubmit:G,children:[u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{className:"device-info",children:[u.jsx("div",{className:"device-name",children:t.outletName}),u.jsxs("div",{className:"device-details",children:[u.jsx("span",{className:"appliance-type",children:t.appliances}),u.jsx("span",{className:"separator",children:"•"}),u.jsx("span",{className:"office-room",children:t.officeRoom})]})]}),u.jsxs("div",{className:"time-section",children:[u.jsxs("div",{className:`time-input-group ${p.start?"error":""}`,children:[u.jsx("label",{htmlFor:"startTime",children:"Start Time"}),u.jsx("div",{className:"time-input-wrapper",children:u.jsx("input",{type:"time",id:"startTime",value:s,onChange:le=>I("start",le.target.value),className:"time-input",required:!0})}),u.jsx("div",{className:"timezone-info",children:b()}),p.start&&u.jsx("span",{className:"error-message",children:p.start})]}),u.jsxs("div",{className:`time-input-group ${p.end?"error":""}`,children:[u.jsx("label",{htmlFor:"endTime",children:"End Time"}),u.jsx("div",{className:"time-input-wrapper",children:u.jsx("input",{type:"time",id:"endTime",value:l,onChange:le=>I("end",le.target.value),className:"time-input",required:!0})}),u.jsx("div",{className:"timezone-info",children:b()}),p.end&&u.jsx("span",{className:"error-message",children:p.end})]})]}),u.jsx("div",{className:"form-divider"}),u.jsxs("div",{className:`day-selection ${p.days?"error":""}`,children:[u.jsx("label",{children:"Day's Applied:"}),u.jsx("div",{className:"days-grid",children:_.map(le=>u.jsxs("div",{className:`day-option ${d.includes(le)?"selected":""}`,onClick:()=>A(le),children:[u.jsx("div",{className:"day-checkbox",children:d.includes(le)&&u.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("polyline",{points:"20,6 9,17 4,12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),u.jsx("span",{className:"day-label",children:le})]},le))}),p.days&&u.jsx("span",{className:"error-message",children:p.days})]}),u.jsxs("div",{className:"selected-days-summary",children:[u.jsx("div",{className:"summary-label",children:"Selected Schedule:"}),u.jsxs("div",{className:"summary-content",children:[u.jsx("div",{className:"summary-time",children:s&&l?`${C(s)} - ${C(l)}`:"No time set"}),u.jsx("div",{className:"summary-days",children:de()})]})]})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{type:"button",className:"btn-secondary",onClick:K,children:"Cancel"}),u.jsx("button",{type:"submit",className:"btn-primary",disabled:!s||!l||d.length===0,children:"Save"})]})]})]})})}function FF({isOpen:n,onClose:e,onConfirm:t,deviceName:i}){return n?u.jsx("div",{className:"modal-overlay",onClick:e,children:u.jsxs("div",{className:"modal-content delete-confirm-modal",onClick:s=>s.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("div",{className:"warning-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M12 8v4M12 16h.01",stroke:"#f59e0b",strokeWidth:"2",strokeLinecap:"round"})]})}),u.jsx("h3",{children:"Delete Schedule"}),u.jsx("button",{type:"button",className:"modal-close",onClick:e,"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("p",{children:["Are you sure you want to delete the schedule for ",u.jsxs("strong",{children:['"',i,'"']}),"?"]}),u.jsx("p",{className:"warning-text",children:"This action cannot be undone."})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{type:"button",className:"btn-secondary",onClick:e,children:"Cancel"}),u.jsx("button",{type:"button",className:"btn-danger",onClick:t,children:"Delete Schedule"})]})]})}):null}function $F({isOpen:n,onClose:e,deviceName:t}){return n?u.jsx("div",{className:"modal-overlay warning-overlay",onClick:e,children:u.jsxs("div",{className:"warning-modal",onClick:i=>i.stopPropagation(),children:[u.jsx("div",{className:"warning-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",fill:"#f59e0b"})]})}),u.jsx("h3",{children:"Power Scheduling Not Allowed"}),u.jsxs("p",{children:[u.jsxs("strong",{children:['"',t,'"']})," does not have power scheduling enabled."]}),u.jsxs("div",{className:"warning-details",children:[u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Device:"}),u.jsx("span",{className:"value",children:t})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Status:"}),u.jsx("span",{className:"value",children:"Power Scheduling Disabled"})]})]}),u.jsx("p",{className:"warning-message",children:'To enable scheduling for this device, please go to the Setup section and enable "Power Scheduling" when adding or editing the device.'}),u.jsx("button",{className:"btn-warning",onClick:e,children:"Understood"})]})}):null}function BF({isOpen:n,onClose:e,deviceName:t,combinedOutlets:i}){return n?u.jsx("div",{className:"modal-overlay warning-overlay",onClick:e,children:u.jsxs("div",{className:"warning-modal",onClick:s=>s.stopPropagation(),children:[u.jsx("div",{className:"warning-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",fill:"#f59e0b"})]})}),u.jsx("h3",{children:"Multiple Schedule Active"}),u.jsxs("p",{children:[u.jsxs("strong",{children:['"',t,'"']})," is currently part of a combined schedule and cannot have an individual schedule."]}),u.jsxs("div",{className:"warning-details",children:[u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Device:"}),u.jsx("span",{className:"value",children:t})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Combined Outlets:"}),u.jsxs("span",{className:"value",children:[i.length," outlets"]})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Combined With:"}),u.jsx("span",{className:"value",children:i.map(s=>s.replace("_"," ")).join(", ")})]})]}),u.jsx("p",{className:"warning-message",children:'To edit the schedule for this device, please use the "Edit Multiple Schedule" button to modify the combined schedule, or remove this device from the combined schedule first.'}),u.jsx("button",{className:"btn-warning",onClick:e,children:"Understood"})]})}):null}function WF({isOpen:n,onClose:e,deviceName:t}){if(!n)return null;const i=t.includes("schedule deleted"),s=i?t.replace(" schedule deleted",""):t;return u.jsx("div",{className:"modal-overlay success-overlay",onClick:e,children:u.jsxs("div",{className:"schedule-success-modal",onClick:o=>o.stopPropagation(),children:[u.jsx("div",{className:"schedule-success-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#10b981",stroke:"#10b981",strokeWidth:"2"}),u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#ffffff",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("h3",{children:i?"Schedule Deleted Successfully!":"Schedule Updated Successfully!"}),u.jsx("p",{children:i?`The schedule for "${s}" has been deleted.`:`The schedule for "${s}" has been updated and saved.`}),u.jsx("button",{className:"btn-primary",onClick:e,children:"Continue"})]})})}function zF({isOpen:n,onClose:e,onSave:t,isEditMode:i,existingCombinedSchedule:s}){const[o,l]=me.useState([]),[c,d]=me.useState([]),[f,p]=me.useState(""),[v,_]=me.useState(""),[b,T]=me.useState([]),[C,A]=me.useState({}),[I,ee]=me.useState(!1),G=["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","SUNDAY"];me.useEffect(()=>{n&&(async()=>{try{ee(!0);const E=Me(je,"devices"),O=await Pt(E);if(O.exists()){const M=O.val(),Y=[];Object.keys(M).forEach(ie=>{const re=M[ie].office_info;re?.enable_power_scheduling===!0&&Y.push({key:ie,name:ie.replace("_"," "),appliance:re.appliance||"Unassigned",office:iv(re.office||"Unassigned"),assignedDate:re.assigned_date})}),l(Y)}}catch(E){console.error("Error fetching available outlets:",E)}finally{ee(!1)}})()},[n]),me.useEffect(()=>{if(n&&i&&s){console.log("Loading existing combined schedule data:",s),d(s.selectedOutlets),s.scheduleData.startTime&&s.scheduleData.endTime&&(p(s.scheduleData.startTime),_(s.scheduleData.endTime));const F=s.scheduleData.frequency;if(F)if(F.toLowerCase()==="daily")T(G);else if(F.toLowerCase()==="weekdays")T(["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY"]);else if(F.toLowerCase()==="weekends")T(["SATURDAY","SUNDAY"]);else if(F.includes(",")){const E={SUN:"SUNDAY",SUNDAY:"SUNDAY",MON:"MONDAY",MONDAY:"MONDAY",M:"MONDAY",TUE:"TUESDAY",TUESDAY:"TUESDAY",T:"TUESDAY",WED:"WEDNESDAY",WEDNESDAY:"WEDNESDAY",W:"WEDNESDAY",THU:"THURSDAY",THURSDAY:"THURSDAY",TH:"THURSDAY",FRI:"FRIDAY",FRIDAY:"FRIDAY",F:"FRIDAY",SAT:"SATURDAY",SATURDAY:"SATURDAY"},O=F.split(",").map(M=>{const Y=M.trim().toUpperCase();return E[Y]||Y}).filter(M=>G.includes(M));T(O)}else{const O={SUN:"SUNDAY",SUNDAY:"SUNDAY",MON:"MONDAY",MONDAY:"MONDAY",M:"MONDAY",TUE:"TUESDAY",TUESDAY:"TUESDAY",T:"TUESDAY",WED:"WEDNESDAY",WEDNESDAY:"WEDNESDAY",W:"WEDNESDAY",THU:"THURSDAY",THURSDAY:"THURSDAY",TH:"THURSDAY",FRI:"FRIDAY",FRIDAY:"FRIDAY",F:"FRIDAY",SAT:"SATURDAY",SATURDAY:"SATURDAY"}[F.toUpperCase()]||F.toUpperCase();G.includes(O)&&T([O])}}},[n,i,s]);const K=F=>{d(E=>E.includes(F)?E.filter(O=>O!==F):[...E,F])},de=F=>{T(E=>E.includes(F)?E.filter(O=>O!==F):[...E,F]),C.days&&A(E=>({...E,days:""}))},le=(F,E)=>{F==="start"?p(E):_(E),C[F]&&A(O=>({...O,[F]:""}))},z=()=>{const F={};if(c.length===0)return p(""),_(""),T([]),A({}),!0;if(f||(F.start="Start time is required"),v||(F.end="End time is required"),b.length===0&&(F.days="Please select at least one day"),f&&v){const E=new Date(`2000-01-01T${f}`),O=new Date(`2000-01-01T${v}`);E>=O&&(F.end="End time must be after start time")}return A(F),Object.keys(F).length===0},R=F=>{if(F.preventDefault(),z()){const E=ie=>{if(!ie)return"";const[q,re]=ie.split(":"),V=parseInt(q,10),se=V>=12?"PM":"AM";return`${V%12||12}:${re} ${se}`},O=`${E(f)} - ${E(v)}`;let M=b.join(", ");b.length===7?M="Daily":b.length===5&&b.includes("MONDAY")&&b.includes("TUESDAY")&&b.includes("WEDNESDAY")&&b.includes("THURSDAY")&&b.includes("FRIDAY")?M="Weekdays":b.length===2&&b.includes("SATURDAY")&&b.includes("SUNDAY")&&(M="Weekends"),t(c,{timeRange:O,frequency:M,startTime:f,endTime:v,selectedDays:b})}};me.useEffect(()=>{c.length===0&&(p(""),_(""),T([]))},[c]);const D=()=>{d([]),p(""),_(""),T([]),A({}),e()};return n?u.jsx("div",{className:"modal-overlay",onClick:D,children:u.jsxs("div",{className:"modal-content outlet-selection-modal",onClick:F=>F.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h3",{children:i?"Edit Multiple Schedule":"Add Outlets to Combined Schedule"}),u.jsx("button",{type:"button",className:"modal-close",onClick:D,"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsxs("form",{onSubmit:R,noValidate:c.length===0,children:[u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{className:`outlet-selection ${C.outlets?"error":""}`,children:[u.jsx("label",{children:"Select Outlets:"}),u.jsx("div",{className:"outlets-grid",children:I?u.jsx("div",{className:"loading-outlets",children:"Loading available outlets..."}):o.length===0?u.jsx("div",{className:"no-outlets",children:"No outlets with power scheduling enabled found."}):o.map(F=>u.jsxs("div",{className:`outlet-option ${c.includes(F.key)?"selected":""}`,onClick:()=>K(F.key),children:[u.jsx("div",{className:"outlet-checkbox",children:c.includes(F.key)&&u.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("polyline",{points:"20,6 9,17 4,12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),u.jsxs("div",{className:"outlet-info",children:[u.jsx("div",{className:"outlet-name",children:F.name}),u.jsxs("div",{className:"outlet-details",children:[u.jsx("span",{className:"appliance",children:F.appliance}),u.jsx("span",{className:"separator",children:"•"}),u.jsx("span",{className:"office",children:F.office})]})]})]},F.key))}),C.outlets&&u.jsx("span",{className:"error-message",children:C.outlets})]}),u.jsxs("div",{className:"time-section",children:[u.jsxs("div",{className:`time-input-group ${C.start?"error":""}`,children:[u.jsx("label",{htmlFor:"startTime",children:"Start Time"}),u.jsx("div",{className:"time-input-wrapper",children:u.jsx("input",{type:"time",id:"startTime",value:f,onChange:F=>le("start",F.target.value),className:"time-input",required:!0})}),C.start&&u.jsx("span",{className:"error-message",children:C.start})]}),u.jsxs("div",{className:`time-input-group ${C.end?"error":""}`,children:[u.jsx("label",{htmlFor:"endTime",children:"End Time"}),u.jsx("div",{className:"time-input-wrapper",children:u.jsx("input",{type:"time",id:"endTime",value:v,onChange:F=>le("end",F.target.value),className:"time-input",required:!0})}),C.end&&u.jsx("span",{className:"error-message",children:C.end})]})]}),u.jsxs("div",{className:`day-selection ${C.days?"error":""}`,children:[u.jsx("label",{children:"Day's Applied:"}),u.jsx("div",{className:"days-grid",children:G.map(F=>u.jsxs("div",{className:`day-option ${b.includes(F)?"selected":""}`,onClick:()=>de(F),children:[u.jsx("div",{className:"day-checkbox",children:b.includes(F)&&u.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("polyline",{points:"20,6 9,17 4,12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),u.jsx("span",{className:"day-label",children:F})]},F))}),C.days&&u.jsx("span",{className:"error-message",children:C.days})]})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{type:"button",className:"btn-secondary",onClick:D,children:"Cancel"}),u.jsx("button",{type:"submit",className:"btn-primary",disabled:c.length>0&&(!f||!v||b.length===0),children:i?"Update Multiple Schedule":"Create Combined Schedule"})]})]})]})}):null}function HF(){const[n,e]=me.useState(""),[t,i]=me.useState([]),[s,o]=me.useState(!0),[l,c]=me.useState(null),[d,f]=me.useState({isOpen:!1,device:null}),[p,v]=me.useState({isOpen:!1,deviceName:""}),[_,b]=me.useState({isOpen:!1,deviceId:"",deviceName:""}),[T,C]=me.useState({isOpen:!1,deviceName:""}),[A,I]=me.useState({enabled:!1,selectedOutlets:[],combinedLimit:0}),[ee,G]=me.useState({}),[K,de]=me.useState({}),[le,z]=me.useState({isOpen:!1,deviceName:"",combinedOutlets:[]}),[R,D]=me.useState({isOpen:!1,isEditMode:!1,existingCombinedSchedule:null}),F=()=>{const V=t.find(se=>se.schedule.isCombinedSchedule&&se.schedule.combinedScheduleId&&se.schedule.selectedOutlets);return V?{combinedScheduleId:V.schedule.combinedScheduleId,selectedOutlets:V.schedule.selectedOutlets,scheduleData:{timeRange:V.schedule.timeRange,frequency:V.schedule.frequency,startTime:V.schedule.startTime,endTime:V.schedule.endTime}}:null};me.useEffect(()=>{const V=Me(je,"devices");return(async()=>{try{o(!0),c(null);const W=await Pt(V);if(W.exists()){const te=W.val(),j=nN(),U=[];Object.keys(te).forEach(($,X)=>{const Q=te[$],ye=Q.office_info,Ae=Q.relay_control,De=Q.lifetime_energy||0,Be=`${su(De*1e3)} Wh`,Fe=Ae?.auto_cutoff?.power_limit||0,Ct=Fe==="No Limit"?"No Limit":Fe,at=Ct==="No Limit"?"No Limit":`${(Number(Ct)*1e3).toFixed(2)} Wh`,Ce=(Q.control?.device||"off").toString().trim().toLowerCase(),ce=Ae?.main_status||"ON",_t=Q.daily_logs?.[j],Ne=_t?.total_energy||0,Ve=`${su(Ne*1e3)} Wh`,We=Je=>{if(!Je)return"";const[mt,Tt]=Je.split(":"),It=parseInt(mt,10),gt=It>=12?"PM":"AM";return`${It%12||12}:${Tt} ${gt}`};let tt=Q.schedule?.timeRange||"";if(!tt&&Q.schedule?.startTime&&Q.schedule?.endTime){const Je=We(Q.schedule.startTime),mt=We(Q.schedule.endTime);Je&&mt&&!(Q.schedule.startTime==="00:00"&&Q.schedule.endTime==="00:00")&&!(Q.schedule.startTime==="00:00"&&Q.schedule.endTime==="23:59")&&(tt=`${Je} - ${mt}`)}const lt=Q.status,$e=lt==="idle"||lt==="Idle",pe=Date.now(),be=_t?.total_energy||0,Se=ee[$]||{lastEnergyUpdate:pe,lastControlUpdate:pe,lastTotalEnergy:be,lastControlState:Ce};Math.abs(be-Se.lastTotalEnergy)>1e-4&&G(Je=>({...Je,[$]:{...Se,lastEnergyUpdate:pe,lastTotalEnergy:be}})),Ce!==Se.lastControlState&&G(Je=>({...Je,[$]:{...Se,lastControlUpdate:pe,lastControlState:Ce}}));const qe=pe-Se.lastEnergyUpdate,Ue=pe-Se.lastControlUpdate,Xe=qe>15e3&&Ue>15e3;let bt;($e||Xe)&&Ce==="on"?bt="Idle":bt=Ce==="on"?"Active":"Inactive",tN($,de);const qt=Q.sensor_data?.current||0,fe=`${Math.round(qt)} A`,Ze={id:String(X+1).padStart(3,"0"),outletName:$.replace("_"," "),appliances:ye?.appliance||"Unassigned",officeRoom:iv(ye?.office||"Unassigned"),powerUsage:Be,currentAmpere:fe,limit:at,status:bt,todaysUsage:Ve,schedule:{timeRange:tt,frequency:Q.schedule?.frequency||"",startTime:Q.schedule?.startTime,endTime:Q.schedule?.endTime,combinedScheduleId:Q.schedule?.combinedScheduleId,isCombinedSchedule:Q.schedule?.isCombinedSchedule||!1,selectedOutlets:Q.schedule?.selectedOutlets},controlState:Ce,mainStatus:ce,enablePowerScheduling:ye?.enable_power_scheduling||!1};U.push(Ze)}),i(U)}else i([])}catch(W){console.error("Error fetching devices:",W),c("Failed to load devices. Please try again."),i([])}finally{o(!1)}})(),Go(V,W=>{if(W.exists()){const te=W.val(),j=nN(),U=[];Object.keys(te).forEach(($,X)=>{const Q=te[$],ye=Q.office_info,Ae=Q.relay_control,De=Q.lifetime_energy||0,Be=`${su(De*1e3)} Wh`,Fe=Ae?.auto_cutoff?.power_limit||0,Ct=Fe==="No Limit"?"No Limit":Fe,at=Ct==="No Limit"?"No Limit":`${(Number(Ct)*1e3).toFixed(2)} Wh`,Ce=(Q.control?.device||"off").toString().trim().toLowerCase(),ce=Ae?.main_status||"ON",_t=Q.daily_logs?.[j],Ne=_t?.total_energy||0,Ve=`${su(Ne*1e3)} Wh`,We=Je=>{if(!Je)return"";const[mt,Tt]=Je.split(":"),It=parseInt(mt,10),gt=It>=12?"PM":"AM";return`${It%12||12}:${Tt} ${gt}`};let tt=Q.schedule?.timeRange||"";if(!tt&&Q.schedule?.startTime&&Q.schedule?.endTime){const Je=We(Q.schedule.startTime),mt=We(Q.schedule.endTime);Je&&mt&&!(Q.schedule.startTime==="00:00"&&Q.schedule.endTime==="00:00")&&!(Q.schedule.startTime==="00:00"&&Q.schedule.endTime==="23:59")&&(tt=`${Je} - ${mt}`)}const lt=Q.status,$e=lt==="idle"||lt==="Idle",pe=Date.now(),be=_t?.total_energy||0,Se=ee[$]||{lastEnergyUpdate:pe,lastControlUpdate:pe,lastTotalEnergy:be,lastControlState:Ce};Math.abs(be-Se.lastTotalEnergy)>1e-4&&G(Je=>({...Je,[$]:{...Se,lastEnergyUpdate:pe,lastTotalEnergy:be}})),Ce!==Se.lastControlState&&G(Je=>({...Je,[$]:{...Se,lastControlUpdate:pe,lastControlState:Ce}}));const qe=pe-Se.lastEnergyUpdate,Ue=pe-Se.lastControlUpdate,Xe=qe>15e3&&Ue>15e3;let bt;($e||Xe)&&Ce==="on"?bt="Idle":bt=Ce==="on"?"Active":"Inactive",tN($,de);const qt=Q.sensor_data?.current||0,fe=`${Math.round(qt)} A`,Ze={id:String(X+1).padStart(3,"0"),outletName:$.replace("_"," "),appliances:ye?.appliance||"Unassigned",officeRoom:iv(ye?.office||"Unassigned"),powerUsage:Be,currentAmpere:fe,limit:at,status:bt,todaysUsage:Ve,schedule:{timeRange:tt,frequency:Q.schedule?.frequency||"",startTime:Q.schedule?.startTime,endTime:Q.schedule?.endTime,combinedScheduleId:Q.schedule?.combinedScheduleId,isCombinedSchedule:Q.schedule?.isCombinedSchedule||!1,selectedOutlets:Q.schedule?.selectedOutlets},controlState:Ce,mainStatus:ce,enablePowerScheduling:ye?.enable_power_scheduling||!1};U.push(Ze)}),i(U)}}),()=>{lr(V),Object.values(K).forEach(W=>{W&&clearTimeout(W)})}},[]),me.useEffect(()=>{(async()=>{try{const se=Me(je,"combined_limit_settings"),W=await Pt(se);if(W.exists()){const te=W.val();console.log("Schedule: Fetched combined limit data:",te),I({enabled:te.enabled||!1,selectedOutlets:te.selected_outlets||[],combinedLimit:te.combined_limit_watts||0})}else console.log("Schedule: No combined limit settings found"),I({enabled:!1,selectedOutlets:[],combinedLimit:0})}catch(se){console.error("Schedule: Error fetching combined limit info:",se),I({enabled:!1,selectedOutlets:[],combinedLimit:0})}})()},[]),me.useEffect(()=>((async()=>{try{console.log("🔍 Schedule: Running independent monthly limit check...");const se=Me(je,"devices"),W=await Pt(se);if(W.exists()){const te=W.val();await j0(te,A)}}catch(se){console.error("Schedule: Error in monthly limit check:",se)}})(),()=>{Object.values(K).forEach(se=>{se&&clearTimeout(se)})}),[A]),me.useEffect(()=>{const V=te=>{try{const j=te?.relay_control?.auto_cutoff?.power_limit||0,U=j==="No Limit"?"No Limit":j;if(U<=0)return!1;const $=new Date,X=`day_${$.getFullYear()}_${String($.getMonth()+1).padStart(2,"0")}_${String($.getDate()).padStart(2,"0")}`;return(te?.daily_logs?.[X]?.total_energy||0)>=U}catch(j){return console.error("Schedule: Error checking daily limit:",j),!1}},se=async()=>{try{const te=Me(je,"devices"),j=await Pt(te);if(j.exists()){const U=j.val();console.log(`Schedule: Real-time scheduler check at ${new Date().toLocaleTimeString()}`),console.log("🔍 Schedule: Running monthly limit check FIRST..."),await j0(U,A);let $=!1;if(A?.enabled&&A?.selectedOutlets?.length>0){const X=zh(U,A.selectedOutlets),Q=A.combinedLimit;String(Q)==="No Limit"?(console.log('📊 Schedule: Combined limit is set to "No Limit" - proceeding with normal schedule processing'),$=!1):X>=Q?($=!0,console.log("🚨 Schedule: MONTHLY LIMIT EXCEEDED for combined group"),console.log(`📊 Current: ${X.toFixed(3)}W >= Limit: ${Q}W`),console.log("🔍 Schedule: Will check individual device limits within combined group")):(console.log("✅ Schedule: Monthly limit OK - proceeding with normal schedule processing"),console.log(`📊 Current: ${X.toFixed(3)}W < Limit: ${Q}W`))}for(const[X,Q]of Object.entries(U)){const ye=Q;if(ye.schedule&&(ye.schedule.timeRange||ye.schedule.startTime)){const Ae=ye.control?.device||"off";if((ye.relay_control?.main_status||"ON")==="ON"){console.log(`Schedule: Device ${X} has main_status = 'ON' - respecting bypass mode, skipping schedule check`);continue}if(ye.schedule&&(ye.schedule.timeRange||ye.schedule.startTime)){const Ce=new Date,ce=Ce.getHours()*60+Ce.getMinutes();let _t=0;if(ye.schedule.startTime&&ye.schedule.endTime){const[Ne,Ve]=ye.schedule.endTime.split(":").map(Number);_t=Ne*60+Ve}else if(ye.schedule.timeRange){const[,Ne]=ye.schedule.timeRange.split(" - ");_t=(We=>{const[tt,lt]=We.split(" ");let[$e,pe]=tt.split(":").map(Number);return $e===12&&($e=0),lt==="PM"&&($e+=12),$e*60+pe})(Ne)}if(_t>0&&ce>=_t){console.log(`🔒 Schedule: Device ${X} is past schedule end time - FORCING OFF and locking main_status`),await Kt(Me(je,`devices/${X}/control`),{device:"off"}),await Kt(Me(je,`devices/${X}/relay_control`),{main_status:"OFF"}),console.log(`🔒 Schedule: Device ${X} LOCKED OFF - past schedule end time (current: ${Math.floor(ce/60)}:${(ce%60).toString().padStart(2,"0")}, end: ${Math.floor(_t/60)}:${(_t%60).toString().padStart(2,"0")})`);continue}}const Be=X.replace("_"," "),Fe=A?.enabled&&A?.selectedOutlets?.includes(Be),Ct=Um(ye.schedule,"on",ye,Fe);let at=Ct?"on":"off";if(Fe&&$?V(ye)?(at="off",console.log(`🔒 Schedule: AUTOMATIC UPDATE - Forcing ${X} OFF due to individual daily limit exceeded (monthly limit also exceeded)`)):Ct&&(at="on",console.log(`✅ Schedule: AUTOMATIC UPDATE - Allowing ${X} ON (schedule says ON, individual daily limit OK despite monthly limit exceeded)`)):Fe&&!$?(await rp(X,A)).canTurnOn?Ct&&(at="on",console.log(`✅ Schedule: AUTOMATIC UPDATE - Allowing ${X} ON (schedule says ON, monthly limit OK - individual daily limit ignored for combined group)`)):(at="off",console.log(`🔒 Schedule: AUTOMATIC UPDATE - Forcing ${X} OFF due to monthly limit exceeded`)):V(ye)?(at="off",console.log(`🔒 Schedule: AUTOMATIC UPDATE - Forcing ${X} OFF due to daily limit exceeded`)):Ct&&(at="on",console.log(`✅ Schedule: AUTOMATIC UPDATE - Allowing ${X} ON (schedule says ON, daily limit OK)`)),console.log(`Schedule: Final status determination for ${X}:`,{scheduleSays:Ct?"ON":"OFF",finalDecision:at,currentState:Ae,needsUpdate:Ae!==at,isInCombinedGroup:Fe,monthlyLimitExceeded:$}),!Ct&&ye.schedule&&(ye.schedule.timeRange||ye.schedule.startTime&&ye.schedule.endTime)){const Ce=new Date,ce=Ce.getHours()*60+Ce.getMinutes();let _t=0;if(ye.schedule.startTime&&ye.schedule.endTime){const[Ne,Ve]=ye.schedule.endTime.split(":").map(Number);_t=Ne*60+Ve}else if(ye.schedule.timeRange){const[,Ne]=ye.schedule.timeRange.split(" - ");_t=(We=>{const[tt,lt]=We.split(" ");let[$e,pe]=tt.split(":").map(Number);return $e===12&&($e=0),lt==="PM"&&($e+=12),$e*60+pe})(Ne)}if(_t>0&&ce>=_t){const Ne=`${Math.floor(_t/60).toString().padStart(2,"0")}:${(_t%60).toString().padStart(2,"0")}`,Ve=`${Math.floor(ce/60).toString().padStart(2,"0")}:${(ce%60).toString().padStart(2,"0")}`;console.log(`⏰ SCHEDULE TURN-OFF: ${X} turned OFF at exact time ${Ne} (current: ${Ve})`)}}Ae!==at?(console.log(`Schedule: AUTOMATIC UPDATE - ${X} control state from ${Ae} to ${at}`),await Kt(Me(je,`devices/${X}/control`),{device:at}),at==="off"?(await Kt(Me(je,`devices/${X}/relay_control`),{main_status:"OFF"}),console.log(`🔒 Schedule: Set main_status to 'OFF' for ${X} to prevent re-activation after schedule expiration`)):console.log(`✅ Schedule: Device ${X} turned ON by schedule - main_status unchanged`),console.log(`✅ Schedule: AUTOMATIC UPDATE COMPLETE - ${X} updated to ${at}`)):console.log(`Schedule: No update needed for ${X} - control state already ${Ae}`)}}}}catch(te){console.error("Schedule: Error in real-time scheduler:",te)}};se();const W=setInterval(se,1e4);return()=>{clearInterval(W),Object.values(K).forEach(te=>{te&&clearTimeout(te)})}},[A]);const E=t.filter(V=>V.outletName.toLowerCase().includes(n.toLowerCase())||V.appliances.toLowerCase().includes(n.toLowerCase())||V.officeRoom.toLowerCase().includes(n.toLowerCase())),O=V=>{const se=t.find(W=>W.id===V);if(se){if(se.schedule.isCombinedSchedule){z({isOpen:!0,deviceName:se.outletName,combinedOutlets:se.schedule.selectedOutlets||[]});return}if(!se.enablePowerScheduling){C({isOpen:!0,deviceName:se.outletName});return}f({isOpen:!0,device:se})}},M=async(V,se)=>{try{const W=t.find(at=>at.id===V);if(!W)return;const te=W.outletName.replace(" ","_"),j=at=>{if(!at)return"";const[Ce,ce]=at.split(" ");let[_t,Ne]=Ce.split(":");return _t==="12"&&(_t="00"),ce==="PM"&&(_t=String(parseInt(_t,10)+12)),`${_t.padStart(2,"0")}:${Ne}`},U=Me(je,`devices/${te}/schedule`),$=j(se.timeRange.split(" - ")[0]),X=j(se.timeRange.split(" - ")[1]);await qa(U,{timeRange:se.timeRange,frequency:se.frequency,startTime:$,endTime:X,selectedDays:se.frequency.toLowerCase()==="daily"?["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","SUNDAY"]:se.frequency.toLowerCase()==="weekdays"?["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY"]:se.frequency.toLowerCase()==="weekends"?["SATURDAY","SUNDAY"]:se.frequency.split(", ").map(at=>at.trim())}),console.log(`Saved schedule for ${te}:`,{timeRange:se.timeRange,frequency:se.frequency,startTime:$,endTime:X});const Q=Me(je,`devices/${te}`),Ae=(await Pt(Q)).val(),Be=Um({timeRange:se.timeRange,frequency:se.frequency,startTime:$,endTime:X},"on",Ae)?"on":"off";console.log(`Setting ${te} control state to ${Be} based on new schedule`),console.log("Note: Main status ON will override schedule restrictions for manual control"),await Kt(Me(je,`devices/${te}/control`),{device:Be}),console.log(`✅ Updated control state to ${Be} for ${te} based on new schedule`);const Fe=`${se.timeRange} (${se.frequency})`;await Zy("Edit schedule",W.outletName,Fe,W.officeRoom||"Unknown",W.appliances||"Unknown",void 0);const Ct=W.outletName;f({isOpen:!1,device:null}),v({isOpen:!0,deviceName:Ct})}catch(W){console.error("Error saving schedule:",W)}},Y=V=>{const se=t.find(W=>W.id===V);se&&b({isOpen:!0,deviceId:V,deviceName:se.outletName})},ie=async()=>{try{const V=t.find(j=>j.id===_.deviceId);if(!V)return;const se=V.outletName.replace(" ","_"),W=Me(je,`devices/${se}/schedule`);await qa(W,null),console.log(`Turning off ${se} relay and main status after schedule deletion`),await Kt(Me(je,`devices/${se}/relay_control`),{status:"OFF",main_status:"OFF"}),await Zy("Remove schedule",V.outletName,"Schedule deleted",V.officeRoom||"Unknown",V.appliances||"Unknown",void 0),b({isOpen:!1,deviceId:"",deviceName:""});const te=V.outletName;v({isOpen:!0,deviceName:`${te} schedule deleted`})}catch(V){console.error("Error deleting schedule:",V)}},q=async(V,se)=>{try{const W=R.isEditMode,te=R.existingCombinedSchedule;console.log("Saving combined schedule for outlets:",V),console.log("Schedule data:",se),console.log("Edit mode:",W);const j=W&&te?te.combinedScheduleId:`combined_${Date.now()}`;if(W&&te){const Q=te.selectedOutlets.filter(ye=>!V.includes(ye));for(const ye of Q){const Ae=Me(je,`devices/${ye}/schedule`);await qa(Ae,null),console.log(`Removed combined schedule from ${ye}`)}}for(const Q of V){const ye=Me(je,`devices/${Q}/schedule`);await qa(ye,{...se,combinedScheduleId:j,isCombinedSchedule:!0,selectedOutlets:V}),console.log(`Saved combined schedule to ${Q}`)}const U=W?"Edit schedule":"Set schedule",$=`${se.timeRange} (${se.frequency})`;let X="";if(V.length===1)X=V[0].replace("Outlet ","Outlet");else if(V.length>1){const Q=V.map(ye=>{const Ae=ye.match(/Outlet[_\s]*(\d+)/);return Ae?Ae[1]:ye.replace(/Outlet[_\s]*/,"")}).sort((ye,Ae)=>parseInt(ye)-parseInt(Ae));X=`Outlet${Q[0]} to ${Q[Q.length-1]}`}await Zy(U==="Edit schedule"?"Edit schedule":"Set schedule",X,$,"Multiple Outlets","Combined Group",void 0),D({isOpen:!1,isEditMode:!1,existingCombinedSchedule:null}),v({isOpen:!0,deviceName:`Combined schedule ${W?"updated":"created"} for ${V.length} outlets`})}catch(W){console.error("Error saving combined schedule:",W)}},re=V=>{const se={Active:"status-active",Inactive:"status-inactive",Blocked:"status-blocked",Idle:"status-idle"};return u.jsxs("span",{className:`status-badge ${se[V]||"status-inactive"}`,children:[u.jsx("span",{className:`status-dot ${se[V]||"status-inactive"}`}),V]})};return u.jsxs("div",{className:"schedule-container",children:[u.jsxs("div",{className:"schedule-header",children:[u.jsxs("div",{className:"header-left",children:[u.jsx("div",{className:"header-icon",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"3",y:"4",width:"18",height:"17",rx:"2",stroke:"currentColor",strokeWidth:"1.6"}),u.jsx("path",{d:"M8 2v4M16 2v4M3 9h18",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})}),u.jsx("h1",{className:"header-title",children:"Schedule Devices"})]}),u.jsxs("div",{className:"header-search",children:[u.jsxs("div",{className:"search-container",children:[u.jsxs("svg",{className:"search-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"m21 21-4.35-4.35",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),u.jsx("input",{type:"text",placeholder:"Search device",value:n,onChange:V=>e(V.target.value),className:"search-input"})]}),u.jsxs("button",{className:"add-outlets-btn",onClick:()=>{const V=F();D(V?{isOpen:!0,isEditMode:!0,existingCombinedSchedule:V}:{isOpen:!0,isEditMode:!1,existingCombinedSchedule:null})},title:F()?"Edit Multiple Schedule":"Add Outlets to Schedule",children:[u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),F()?"Edit Multiple Schedule":"Multiple Schedule"]})]})]}),u.jsx("div",{className:"schedule-table-container",children:s?u.jsxs("div",{className:"loading-container",children:[u.jsx("div",{className:"loading-spinner"}),u.jsx("p",{children:"Loading devices..."})]}):l?u.jsxs("div",{className:"error-container",children:[u.jsx("div",{className:"error-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"#ef4444",strokeWidth:"2"}),u.jsx("path",{d:"M15 9l-6 6M9 9l6 6",stroke:"#ef4444",strokeWidth:"2",strokeLinecap:"round"})]})}),u.jsx("p",{className:"error-message",children:l}),u.jsx("button",{className:"btn-primary",onClick:()=>window.location.reload(),children:"Retry"})]}):t.length===0?u.jsxs("div",{className:"empty-container",children:[u.jsx("div",{className:"empty-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#6b7280",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z",stroke:"#6b7280",strokeWidth:"2"})]})}),u.jsx("p",{children:"No devices found"}),u.jsx("p",{className:"empty-subtitle",children:"Devices will appear here once they are connected to the system."})]}):u.jsxs("table",{className:"schedule-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:"OUTLET NAME"}),u.jsx("th",{children:"APPLIANCES"}),u.jsx("th",{children:"OFFICE/ ROOM"}),u.jsx("th",{children:"LIMIT"}),u.jsx("th",{children:"POWER USAGE"}),u.jsx("th",{children:"CURRENT (A)"}),u.jsx("th",{children:"STATUS"}),u.jsx("th",{children:"TODAY'S USAGE"}),u.jsx("th",{children:"SCHEDULE"}),u.jsx("th",{children:"ACTION"})]})}),u.jsx("tbody",{children:E.map(V=>u.jsxs("tr",{children:[u.jsx("td",{className:"device-id",children:V.id}),u.jsx("td",{className:"outlet-name",children:V.outletName}),u.jsx("td",{className:"appliances",children:V.appliances}),u.jsx("td",{className:"office-room",children:V.officeRoom}),u.jsx("td",{className:"limit",children:(()=>{const se=V.outletName,W=se.replace("_"," "),te=A.enabled&&(A.selectedOutlets.includes(se)||A.selectedOutlets.includes(W));return console.log(`Schedule: Checking device ${V.outletName}:`,{enabled:A.enabled,selectedOutlets:A.selectedOutlets,deviceOutletName:se,deviceOutletNameWithSpace:W,isUsingCombinedLimit:te,combinedLimit:A.combinedLimit}),te?u.jsx("div",{className:"combined-limit-display",children:u.jsxs("div",{className:"combined-limit-indicator",children:[u.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),u.jsx("span",{children:String(A.combinedLimit)==="No Limit"?"No Limit":`${A.combinedLimit}Wh`})]})}):V.limit.includes("Wh")?V.limit:V.limit.replace(" W"," Wh")})()}),u.jsx("td",{className:"power-usage",children:V.powerUsage}),u.jsx("td",{className:"current-ampere",children:V.currentAmpere}),u.jsx("td",{children:u.jsxs("div",{className:"status-container",children:[re(V.status),V.schedule.timeRange&&u.jsx("div",{className:`schedule-indicator ${V.status==="Active"?"active":"inactive"}`,title:`Schedule: ${V.schedule.timeRange} (${V.schedule.frequency}) - Currently ${V.status==="Active"?"ACTIVE":"INACTIVE"}`,children:u.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),u.jsx("polyline",{points:"12,6 12,12 16,14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})}),u.jsx("td",{className:"todays-usage",children:V.todaysUsage}),u.jsx("td",{children:V.schedule.timeRange?u.jsxs("div",{className:"schedule-info",children:[u.jsxs("div",{className:"schedule-time",children:[V.schedule.timeRange,V.status==="Active"&&u.jsx("span",{className:"schedule-active-indicator",title:"Currently active",children:"●"}),V.schedule.isCombinedSchedule&&u.jsx("span",{className:"combined-schedule-indicator",title:`Combined schedule with ${V.schedule.selectedOutlets?.length||0} outlets`,children:"🔗"})]}),u.jsxs("span",{className:`schedule-frequency ${V.schedule.frequency.toLowerCase()==="daily"||V.schedule.frequency.toLowerCase()==="weekdays"||V.schedule.frequency.toLowerCase()==="weekends"?V.schedule.frequency.toLowerCase():"custom"}`,children:[PF(V.schedule.frequency),V.schedule.isCombinedSchedule&&u.jsxs("span",{className:"combined-label",title:`Combined with: ${V.schedule.selectedOutlets?.map(se=>se.replace("_"," ")).join(", ")}`,children:["(Combined - ",V.schedule.selectedOutlets?.length||0," outlets)"]})]})]}):u.jsx("div",{className:"no-schedule",children:u.jsx("span",{className:"no-schedule-text",children:"No schedule set"})})}),u.jsx("td",{children:u.jsxs("div",{className:"action-buttons",children:[u.jsx("div",{className:"more-options",children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"1",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"6",r:"1",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"18",r:"1",fill:"currentColor"})]})}),u.jsx("button",{className:"edit-btn",onClick:()=>O(V.id),title:"Edit Schedule",children:V.schedule.timeRange?"Edit Schedule":"Set Schedule"}),u.jsx("button",{className:"action-btn delete-btn",onClick:()=>Y(V.id),title:"Delete Schedule",children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("path",{d:"M10 11v6M14 11v6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]})})]},V.id))})]})}),u.jsx(UF,{isOpen:d.isOpen,onClose:()=>f({isOpen:!1,device:null}),device:d.device,onSave:M}),u.jsx(FF,{isOpen:_.isOpen,onClose:()=>b({isOpen:!1,deviceId:"",deviceName:""}),onConfirm:ie,deviceName:_.deviceName}),u.jsx(WF,{isOpen:p.isOpen,onClose:()=>v({isOpen:!1,deviceName:""}),deviceName:p.deviceName}),u.jsx($F,{isOpen:T.isOpen,onClose:()=>C({isOpen:!1,deviceName:""}),deviceName:T.deviceName}),u.jsx(BF,{isOpen:le.isOpen,onClose:()=>z({isOpen:!1,deviceName:"",combinedOutlets:[]}),deviceName:le.deviceName,combinedOutlets:le.combinedOutlets}),u.jsx(zF,{isOpen:R.isOpen,onClose:()=>D({isOpen:!1,isEditMode:!1,existingCombinedSchedule:null}),onSave:q,isEditMode:R.isEditMode,existingCombinedSchedule:R.existingCombinedSchedule})]})}window.testScheduleMonthlyLimit=async()=>{console.log("🧪 SCHEDULE - TESTING MONTHLY LIMIT CHECKING...");try{const n=Me(je,"devices"),e=await Pt(n);if(!e.exists()){console.log("❌ SCHEDULE - No devices data found");return}const t=e.val();console.log("📊 SCHEDULE - Devices data loaded:",Object.keys(t));const i=Me(je,"combined_limit_settings"),s=await Pt(i);if(!s.exists()){console.log("❌ SCHEDULE - No combined limit settings found");return}const o=s.val();console.log("📊 SCHEDULE - Combined limit settings:",o);const l=o.selected_outlets||[],c=o.combined_limit_watts||0;console.log("🧪 SCHEDULE - Testing monthly limit checks for outlets:",l);for(const d of l){console.log(`
🔍 SCHEDULE - Testing ${d}...`);const f=await rp(d,{enabled:o.enabled,selectedOutlets:l,combinedLimit:c});console.log(`📊 SCHEDULE - ${d} result:`,{canTurnOn:f.canTurnOn,reason:f.reason,currentEnergy:f.currentMonthlyEnergy,limit:f.combinedLimit})}console.log(`
🧪 SCHEDULE - Testing scheduler function...`),console.log("📊 SCHEDULE - Scheduler test completed (function would need component context)")}catch(n){console.error("❌ SCHEDULE - Error testing monthly limit checking:",n)}};window.testScheduleHierarchy=async()=>{console.log("🧪 SCHEDULE - TESTING HIERARCHY ENFORCEMENT...");try{const n=Me(je,"devices"),e=await Pt(n);if(!e.exists()){console.log("❌ SCHEDULE - No devices data found");return}const t=e.val();console.log("📊 SCHEDULE - Devices data loaded:",Object.keys(t));const i=Me(je,"combined_limit_settings"),s=await Pt(i);if(!s.exists()){console.log("❌ SCHEDULE - No combined limit settings found");return}const o=s.val();console.log("📊 SCHEDULE - Combined limit settings:",o);const l=o.selected_outlets||[],c=o.combined_limit_watts||0;console.log("🧪 SCHEDULE - Testing hierarchy for devices with schedules...");for(const[d,f]of Object.entries(t)){const p=f;if(p.schedule&&(p.schedule.timeRange||p.schedule.startTime)){console.log(`
🔍 SCHEDULE - Testing hierarchy for ${d}...`);const v=await rp(d,{enabled:o.enabled,selectedOutlets:l,combinedLimit:c});console.log(`📊 SCHEDULE - ${d} monthly limit check:`,{canTurnOn:v.canTurnOn,reason:v.reason,currentEnergy:v.currentMonthlyEnergy,limit:v.combinedLimit});const _=p?.relay_control?.auto_cutoff?.power_limit||0,b=_==="No Limit"?"No Limit":_,T=new Date,C=`day_${T.getFullYear()}_${String(T.getMonth()+1).padStart(2,"0")}_${String(T.getDate()).padStart(2,"0")}`,I=p?.daily_logs?.[C]?.total_energy||0,ee=b!=="No Limit"&&b>0&&I>=b;console.log(`📊 SCHEDULE - ${d} daily limit check:`,{powerLimit:b==="No Limit"?"No Limit":`${b*1e3}W`,todayTotalEnergy:`${I*1e3}W`,isExceeded:ee});const G=Um(p.schedule,"on",p);console.log(`📊 SCHEDULE - ${d} schedule check:`,{shouldBeActive:G,schedule:p.schedule});let K="OFF";v.canTurnOn&&!ee&&G&&(K="ON"),console.log(`📊 SCHEDULE - ${d} FINAL HIERARCHY RESULT: ${K}`),console.log(`📊 SCHEDULE - ${d} hierarchy: Monthly=${v.canTurnOn?"OK":"BLOCKED"}, Daily=${ee?"BLOCKED":"OK"}, Schedule=${G?"ON":"OFF"}`)}}console.log(`
🧪 SCHEDULE - HIERARCHY TEST COMPLETE`),console.log("📊 HIERARCHY ORDER: 1. Monthly Limit, 2. Daily Limit, 3. Schedule")}catch(n){console.error("❌ SCHEDULE - Error testing hierarchy:",n)}};window.checkCurrentScheduleStatus=()=>{console.log("🕐 SCHEDULE - CHECKING CURRENT TIME AND SCHEDULE STATUS...");const n=new Date,e=n.getHours()*60+n.getMinutes(),t=n.toLocaleTimeString(),i=n.toLocaleDateString();console.log("📊 Current Time Info:",{currentTime:t,currentDate:i,currentTimeMinutes:e,dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][n.getDay()]});const s=797,o=803;console.log("📊 Schedule Window Check:",{scheduleStart:"1:17 PM (797 minutes)",scheduleEnd:"1:23 PM (803 minutes)",currentTimeMinutes:e,isWithinSchedule:e>=s&&e<=o,timeUntilStart:s-e,timeUntilEnd:o-e}),e>=s&&e<=o?(console.log("✅ CURRENT TIME IS WITHIN SCHEDULED WINDOW - All outlets should be ACTIVE"),console.log("📊 This explains why outlets 1, 2, 4, and 5 are all showing as ACTIVE")):e<s?(console.log("⏰ CURRENT TIME IS BEFORE SCHEDULED WINDOW - All outlets should be INACTIVE"),console.log(`📊 Schedule starts in ${s-e} minutes`)):(console.log("⏰ CURRENT TIME IS AFTER SCHEDULED WINDOW - All outlets should be INACTIVE"),console.log(`📊 Schedule ended ${e-o} minutes ago`)),console.log(`
📊 Expected Behavior:`),console.log("- If current time is 1:17 PM - 1:23 PM: All outlets should be ACTIVE"),console.log("- If current time is outside this window: All outlets should be INACTIVE"),console.log("- Outlet 3 has no schedule, so it should remain INACTIVE")};window.forceScheduleMonthlyLimitCheck=async()=>{console.log("🚨 SCHEDULE - FORCING MONTHLY LIMIT CHECK IMMEDIATELY...");try{const n=Me(je,"devices"),e=await Pt(n);if(!e.exists()){console.log("❌ SCHEDULE - No devices data found");return}const t=e.val(),i=Me(je,"combined_limit_settings"),s=await Pt(i);if(!s.exists()){console.log("❌ SCHEDULE - No combined limit settings found");return}const o=s.val(),l={enabled:o.enabled||!1,selectedOutlets:o.selected_outlets||[],combinedLimit:o.combined_limit_watts||0};console.log("📊 SCHEDULE - Combined limit settings:",l),await j0(t,l),console.log("✅ SCHEDULE - Monthly limit check completed")}catch(n){console.error("❌ SCHEDULE - Error forcing monthly limit check:",n)}};window.checkScheduleCombinedLimitSettings=async()=>{console.log("🔍 SCHEDULE - CHECKING COMBINED LIMIT SETTINGS...");try{const n=Me(je,"combined_limit_settings"),e=await Pt(n);if(!e.exists()){console.log("❌ SCHEDULE - No combined limit settings found");return}const t=e.val();console.log("📊 SCHEDULE - Combined limit settings:",t),t.enabled?(console.log("✅ SCHEDULE - Combined limit is ENABLED"),console.log(`📊 Selected outlets: ${t.selected_outlets?.join(", ")||"None"}`),console.log(`📊 Combined limit: ${t.combined_limit_watts||0}W`)):(console.log("❌ SCHEDULE - Combined limit is DISABLED"),console.log("📊 This means monthly limit checks will be skipped!"))}catch(n){console.error("❌ SCHEDULE - Error checking combined limit settings:",n)}};window.triggerScheduleMonthlyLimitCheck=async()=>{console.log("🚨 SCHEDULE - MANUALLY TRIGGERING MONTHLY LIMIT CHECK...");try{const n=Me(je,"devices"),e=await Pt(n);if(!e.exists()){console.log("❌ SCHEDULE - No devices data found");return}const t=e.val(),i=Me(je,"combined_limit_settings"),s=await Pt(i);if(!s.exists()){console.log("❌ SCHEDULE - No combined limit settings found");return}const o=s.val(),l={enabled:o.enabled||!1,selectedOutlets:o.selected_outlets||[],combinedLimit:o.combined_limit_watts||0};console.log("📊 SCHEDULE - Triggering monthly limit check with settings:",l),await j0(t,l),console.log("✅ SCHEDULE - Monthly limit check triggered")}catch(n){console.error("❌ SCHEDULE - Error triggering monthly limit check:",n)}};window.testScheduleMonthlyLimitBlocking=async()=>{console.log("🧪 SCHEDULE - TESTING MONTHLY LIMIT BLOCKING...");try{const n=Me(je,"devices"),e=await Pt(n);if(!e.exists()){console.log("❌ SCHEDULE - No devices data found");return}const t=e.val(),i=Me(je,"combined_limit_settings"),s=await Pt(i);if(!s.exists()){console.log("❌ SCHEDULE - No combined limit settings found");return}const o=s.val(),l={enabled:o.enabled||!1,selectedOutlets:o.selected_outlets||[],combinedLimit:o.combined_limit_watts||0};if(console.log("📊 SCHEDULE - Combined limit settings:",l),!l.enabled){console.log("❌ SCHEDULE - Monthly limit is DISABLED - schedule will run normally");return}const c=zh(t,l.selectedOutlets),d=l.combinedLimit;if(console.log("📊 SCHEDULE - Monthly energy calculation:",{totalMonthlyEnergy:`${su(c)}W`,combinedLimitWatts:`${d==="No Limit"?"No Limit":`${d}W`}`,exceedsLimit:c>=d,percentage:d!=="No Limit"&&d>0?`${(c/d*100).toFixed(1)}%`:"N/A"}),d==="No Limit")return console.log('📊 SCHEDULE - Combined limit is set to "No Limit" - proceeding with normal schedule processing'),{monthlyLimitExceeded:!1};c>=d?(console.log("🚨 SCHEDULE - MONTHLY LIMIT EXCEEDED!"),console.log("📊 This means ALL schedule processing will be BLOCKED"),console.log("📊 Devices will NOT turn on even if they are in their scheduled time"),console.log("📊 This is the CORRECT behavior - monthly limit takes precedence over schedule")):(console.log("✅ SCHEDULE - Monthly limit OK"),console.log("📊 Schedule processing will proceed normally"),console.log("📊 Devices can turn on based on their schedule"))}catch(n){console.error("❌ SCHEDULE - Error testing monthly limit blocking:",n)}};window.testScheduleStatusUpdates=async()=>{console.log("🧪 SCHEDULE - TESTING STATUS UPDATES...");try{const n=Me(je,"devices"),e=await Pt(n);if(!e.exists()){console.log("❌ SCHEDULE - No devices data found");return}const t=e.val(),i=Me(je,"combined_limit_settings"),s=await Pt(i);if(!s.exists()){console.log("❌ SCHEDULE - No combined limit settings found");return}const o=s.val(),l={enabled:o.enabled||!1,selectedOutlets:o.selected_outlets||[],combinedLimit:o.combined_limit_watts||0};console.log("📊 SCHEDULE - Testing status updates for devices with schedules...");for(const[c,d]of Object.entries(t)){const f=d;if(f.schedule&&(f.schedule.timeRange||f.schedule.startTime)){console.log(`
🔍 SCHEDULE - Testing status update for ${c}...`);const p=f.control?.device||"off",v=f.relay_control?.main_status||"ON";console.log(`📊 Current status: control=${p}, main_status=${v}`);const _=await rp(c,l);console.log(`📊 Monthly limit check: canTurnOn=${_.canTurnOn}`);const b=f?.relay_control?.auto_cutoff?.power_limit||0,T=b==="No Limit"?"No Limit":b,C=new Date,A=`day_${C.getFullYear()}_${String(C.getMonth()+1).padStart(2,"0")}_${String(C.getDate()).padStart(2,"0")}`,ee=f?.daily_logs?.[A]?.total_energy||0,G=T!=="No Limit"&&T>0&&ee>=T;console.log(`📊 Daily limit check: isExceeded=${G}`);const K=Um(f.schedule,"on",f);console.log(`📊 Schedule check: shouldBeActive=${K}`);let de="off",le="OFF";_.canTurnOn&&!G&&K&&(de="on",le="ON"),console.log("📊 FINAL STATUS DETERMINATION:"),console.log(`📊 Expected: control=${de}, main_status=${le}`),console.log(`📊 Current: control=${p}, main_status=${v}`),console.log(`📊 Needs update: control=${p!==de}, main_status=${v!==le}`),console.log(p!==de||v!==le?`🔄 SCHEDULE: ${c} needs status update!`:`✅ SCHEDULE: ${c} status is correct`)}}console.log(`
🧪 SCHEDULE - STATUS UPDATE TEST COMPLETE`)}catch(n){console.error("❌ SCHEDULE - Error testing status updates:",n)}};window.testCombinedGroupIndividualLimits=async()=>{console.log("🧪 SCHEDULE - TESTING COMBINED GROUP INDIVIDUAL LIMITS...");try{const n=Me(je,"devices"),e=await Pt(n);if(!e.exists()){console.log("❌ SCHEDULE - No devices data found");return}const t=e.val(),i=Me(je,"combined_limit_settings"),s=await Pt(i);if(!s.exists()){console.log("❌ SCHEDULE - No combined limit settings found");return}const o=s.val(),l={enabled:o.enabled||!1,selectedOutlets:o.selected_outlets||[],combinedLimit:o.combined_limit_watts||0};console.log("📊 SCHEDULE - Combined limit settings:",l);const c=zh(t,l.selectedOutlets),d=c>=l.combinedLimit;console.log("📊 SCHEDULE - Monthly limit status:",{totalMonthlyEnergy:`${su(c)}W`,combinedLimit:`${l.combinedLimit}W`,exceeded:d}),console.log(`
🔍 SCHEDULE - Testing individual device limits in combined group...`);for(const f of l.selectedOutlets){const p=t[f.replace(" ","_")];if(!p){console.log(`❌ SCHEDULE - Device ${f} not found`);continue}console.log(`
🔍 SCHEDULE - Testing ${f}...`);const v=p?.relay_control?.auto_cutoff?.power_limit||0,_=new Date,b=`day_${_.getFullYear()}_${String(_.getMonth()+1).padStart(2,"0")}_${String(_.getDate()).padStart(2,"0")}`,C=p?.daily_logs?.[b]?.total_energy||0,A=v>0&&C>=v;console.log("📊 Individual daily limit:",{powerLimit:v==="No Limit"?"No Limit":`${v*1e3}W`,todayEnergy:`${(C*1e3).toFixed(3)}W`,exceeded:A});let I=!1,ee="";d?A?(I=!1,ee="Both monthly and daily limits exceeded"):(I=!0,ee="Monthly limit exceeded but individual daily limit OK"):(I=!0,ee="Monthly limit OK - individual daily limit ignored for combined group"),console.log(`📊 FINAL RESULT for ${f}:`,{canTurnOn:I,reason:ee})}console.log(`
🧪 SCHEDULE - COMBINED GROUP INDIVIDUAL LIMITS TEST COMPLETE`)}catch(n){console.error("❌ SCHEDULE - Error testing combined group individual limits:",n)}};window.testAutomaticStatusUpdates=async()=>{console.log("🧪 SCHEDULE - TESTING AUTOMATIC STATUS UPDATES...");try{const n=Me(je,"devices"),e=await Pt(n);if(!e.exists()){console.log("❌ SCHEDULE - No devices data found");return}const t=e.val(),i=Me(je,"combined_limit_settings"),s=await Pt(i);if(!s.exists()){console.log("❌ SCHEDULE - No combined limit settings found");return}const o=s.val(),l={enabled:o.enabled||!1,selectedOutlets:o.selected_outlets||[],combinedLimit:o.combined_limit_watts||0},c=zh(t,l.selectedOutlets),d=c>=l.combinedLimit;console.log("📊 SCHEDULE - Monthly limit status:",{totalMonthlyEnergy:`${su(c)}W`,combinedLimit:`${l.combinedLimit}W`,exceeded:d}),console.log(`
🔍 SCHEDULE - Testing automatic status updates...`);for(const[f,p]of Object.entries(t)){const v=p;if(v.schedule&&(v.schedule.timeRange||v.schedule.startTime)){console.log(`
🔍 SCHEDULE - Testing automatic status update for ${f}...`);const _=v.control?.device||"off",b=v.relay_control?.main_status||"ON",T=f.replace("_"," "),C=l?.enabled&&l?.selectedOutlets?.includes(T),A=Um(v.schedule,"on",v);let I=A?"on":"off";if(C&&d){const G=v?.relay_control?.auto_cutoff?.power_limit||0,K=G==="No Limit"?"No Limit":G,de=new Date,le=`day_${de.getFullYear()}_${String(de.getMonth()+1).padStart(2,"0")}_${String(de.getDate()).padStart(2,"0")}`,R=v?.daily_logs?.[le]?.total_energy||0;K!=="No Limit"&&K>0&&R>=K?(I="off",console.log(`🔒 AUTOMATIC UPDATE: Forcing ${f} OFF due to individual daily limit exceeded`)):A&&(I="on",console.log(`✅ AUTOMATIC UPDATE: Allowing ${f} ON (individual daily limit OK despite monthly limit exceeded)`))}else if(C&&!d)if(!(await rp(f,l)).canTurnOn)I="off",console.log(`🔒 AUTOMATIC UPDATE: Forcing ${f} OFF due to monthly limit exceeded`);else{const K=v?.relay_control?.auto_cutoff?.power_limit||0,de=K==="No Limit"?"No Limit":K,le=new Date,z=`day_${le.getFullYear()}_${String(le.getMonth()+1).padStart(2,"0")}_${String(le.getDate()).padStart(2,"0")}`,D=v?.daily_logs?.[z]?.total_energy||0;de!=="No Limit"&&de>0&&D>=de?(I="off",console.log(`🔒 AUTOMATIC UPDATE: Forcing ${f} OFF due to daily limit exceeded`)):A&&(I="on",console.log(`✅ AUTOMATIC UPDATE: Allowing ${f} ON (both limits OK)`))}else{const G=v?.relay_control?.auto_cutoff?.power_limit||0,K=G==="No Limit"?"No Limit":G,de=new Date,le=`day_${de.getFullYear()}_${String(de.getMonth()+1).padStart(2,"0")}_${String(de.getDate()).padStart(2,"0")}`,R=v?.daily_logs?.[le]?.total_energy||0;K!=="No Limit"&&K>0&&R>=K?(I="off",console.log(`🔒 AUTOMATIC UPDATE: Forcing ${f} OFF due to daily limit exceeded`)):A&&(I="on",console.log(`✅ AUTOMATIC UPDATE: Allowing ${f} ON (daily limit OK)`))}const ee=I==="on"?"ON":"OFF";console.log(`📊 AUTOMATIC STATUS UPDATE RESULT for ${f}:`,{currentState:`${_}/${b}`,scheduleSays:A?"ON":"OFF",finalDecision:`${I}/${ee}`,needsUpdate:_!==I,isInCombinedGroup:C,monthlyLimitExceeded:d}),console.log(_!==I?`🔄 AUTOMATIC UPDATE NEEDED: ${f} will be updated from ${_} to ${I}`:`✅ NO UPDATE NEEDED: ${f} is already in correct state`)}}console.log(`
🧪 SCHEDULE - AUTOMATIC STATUS UPDATES TEST COMPLETE`)}catch(n){console.error("❌ SCHEDULE - Error testing automatic status updates:",n)}};console.log("Schedule: Manual test functions available:");console.log("- window.testScheduleMonthlyLimit() - Test Schedule monthly limit checking specifically");console.log("- window.testScheduleHierarchy() - Test Schedule hierarchy enforcement (Monthly > Daily > Schedule)");console.log("- window.checkCurrentScheduleStatus() - Check current time and schedule status");console.log("- window.forceScheduleMonthlyLimitCheck() - Force monthly limit check immediately");console.log("- window.checkScheduleCombinedLimitSettings() - Check current combined limit settings");console.log("- window.triggerScheduleMonthlyLimitCheck() - Manually trigger monthly limit check (auto turn off)");console.log("- window.testScheduleMonthlyLimitBlocking() - Test if monthly limit blocks schedule processing");console.log("- window.testScheduleStatusUpdates() - Test if status updates are working correctly");console.log("- window.testCombinedGroupIndividualLimits() - Test combined group individual limit logic");console.log("- window.testAutomaticStatusUpdates() - Test automatic status updates with new logic");const qF="modulepreload",VF=function(n){return"/"+n},iN={},e2=function(e,t,i){let s=Promise.resolve();if(t&&t.length>0){let d=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");s=d(t.map(f=>{if(f=VF(f),f in iN)return;iN[f]=!0;const p=f.endsWith(".css"),v=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${v}`))return;const _=document.createElement("link");if(_.rel=p?"stylesheet":qF,p||(_.as="script"),_.crossOrigin="",_.href=f,c&&_.setAttribute("nonce",c),document.head.appendChild(_),p)return new Promise((b,T)=>{_.addEventListener("load",b),_.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${f}`)))})}))}function o(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return s.then(l=>{for(const c of l||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};function Di(n){"@babel/helpers - typeof";return Di=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Di(n)}var Za=Uint8Array,zr=Uint16Array,Ub=Int32Array,Fb=new Za([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$b=new Za([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),sN=new Za([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dC=function(n,e){for(var t=new zr(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var s=new Ub(t[30]),i=1;i<30;++i)for(var o=t[i];o<t[i+1];++o)s[o]=o-t[i]<<5|i;return{b:t,r:s}},hC=dC(Fb,2),YF=hC.b,sv=hC.r;YF[28]=258,sv[258]=28;var GF=dC($b,0),oN=GF.r,ov=new zr(32768);for(var es=0;es<32768;++es){var Yc=(es&43690)>>1|(es&21845)<<1;Yc=(Yc&52428)>>2|(Yc&13107)<<2,Yc=(Yc&61680)>>4|(Yc&3855)<<4,ov[es]=((Yc&65280)>>8|(Yc&255)<<8)>>1}var gm=(function(n,e,t){for(var i=n.length,s=0,o=new zr(e);s<i;++s)n[s]&&++o[n[s]-1];var l=new zr(e);for(s=1;s<e;++s)l[s]=l[s-1]+o[s-1]<<1;var c;if(t){c=new zr(1<<e);var d=15-e;for(s=0;s<i;++s)if(n[s])for(var f=s<<4|n[s],p=e-n[s],v=l[n[s]-1]++<<p,_=v|(1<<p)-1;v<=_;++v)c[ov[v]>>d]=f}else for(c=new zr(i),s=0;s<i;++s)n[s]&&(c[s]=ov[l[n[s]-1]++]>>15-n[s]);return c}),wd=new Za(288);for(var es=0;es<144;++es)wd[es]=8;for(var es=144;es<256;++es)wd[es]=9;for(var es=256;es<280;++es)wd[es]=7;for(var es=280;es<288;++es)wd[es]=8;var M0=new Za(32);for(var es=0;es<32;++es)M0[es]=5;var KF=gm(wd,9,0),XF=gm(M0,5,0),fC=function(n){return(n+7)/8|0},QF=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new Za(n.subarray(e,t))},Ql=function(n,e,t){t<<=e&7;var i=e/8|0;n[i]|=t,n[i+1]|=t>>8},Yf=function(n,e,t){t<<=e&7;var i=e/8|0;n[i]|=t,n[i+1]|=t>>8,n[i+2]|=t>>16},t2=function(n,e){for(var t=[],i=0;i<n.length;++i)n[i]&&t.push({s:i,f:n[i]});var s=t.length,o=t.slice();if(!s)return{t:pC,l:0};if(s==1){var l=new Za(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort(function(de,le){return de.f-le.f}),t.push({s:-1,f:25001});var c=t[0],d=t[1],f=0,p=1,v=2;for(t[0]={s:-1,f:c.f+d.f,l:c,r:d};p!=s-1;)c=t[t[f].f<t[v].f?f++:v++],d=t[f!=p&&t[f].f<t[v].f?f++:v++],t[p++]={s:-1,f:c.f+d.f,l:c,r:d};for(var _=o[0].s,i=1;i<s;++i)o[i].s>_&&(_=o[i].s);var b=new zr(_+1),T=rv(t[p-1],b,0);if(T>e){var i=0,C=0,A=T-e,I=1<<A;for(o.sort(function(le,z){return b[z.s]-b[le.s]||le.f-z.f});i<s;++i){var ee=o[i].s;if(b[ee]>e)C+=I-(1<<T-b[ee]),b[ee]=e;else break}for(C>>=A;C>0;){var G=o[i].s;b[G]<e?C-=1<<e-b[G]++-1:++i}for(;i>=0&&C;--i){var K=o[i].s;b[K]==e&&(--b[K],++C)}T=e}return{t:new Za(b),l:T}},rv=function(n,e,t){return n.s==-1?Math.max(rv(n.l,e,t+1),rv(n.r,e,t+1)):e[n.s]=t},rN=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new zr(++e),i=0,s=n[0],o=1,l=function(d){t[i++]=d},c=1;c<=e;++c)if(n[c]==s&&c!=e)++o;else{if(!s&&o>2){for(;o>138;o-=138)l(32754);o>2&&(l(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(l(s),--o;o>6;o-=6)l(8304);o>2&&(l(o-3<<5|8208),o=0)}for(;o--;)l(s);o=1,s=n[c]}return{c:t.subarray(0,i),n:e}},Gf=function(n,e){for(var t=0,i=0;i<e.length;++i)t+=n[i]*e[i];return t},mC=function(n,e,t){var i=t.length,s=fC(e+2);n[s]=i&255,n[s+1]=i>>8,n[s+2]=n[s]^255,n[s+3]=n[s+1]^255;for(var o=0;o<i;++o)n[s+o+4]=t[o];return(s+4+i)*8},aN=function(n,e,t,i,s,o,l,c,d,f,p){Ql(e,p++,t),++s[256];for(var v=t2(s,15),_=v.t,b=v.l,T=t2(o,15),C=T.t,A=T.l,I=rN(_),ee=I.c,G=I.n,K=rN(C),de=K.c,le=K.n,z=new zr(19),R=0;R<ee.length;++R)++z[ee[R]&31];for(var R=0;R<de.length;++R)++z[de[R]&31];for(var D=t2(z,7),F=D.t,E=D.l,O=19;O>4&&!F[sN[O-1]];--O);var M=f+5<<3,Y=Gf(s,wd)+Gf(o,M0)+l,ie=Gf(s,_)+Gf(o,C)+l+14+3*O+Gf(z,F)+2*z[16]+3*z[17]+7*z[18];if(d>=0&&M<=Y&&M<=ie)return mC(e,p,n.subarray(d,d+f));var q,re,V,se;if(Ql(e,p,1+(ie<Y)),p+=2,ie<Y){q=gm(_,b,0),re=_,V=gm(C,A,0),se=C;var W=gm(F,E,0);Ql(e,p,G-257),Ql(e,p+5,le-1),Ql(e,p+10,O-4),p+=14;for(var R=0;R<O;++R)Ql(e,p+3*R,F[sN[R]]);p+=3*O;for(var te=[ee,de],j=0;j<2;++j)for(var U=te[j],R=0;R<U.length;++R){var $=U[R]&31;Ql(e,p,W[$]),p+=F[$],$>15&&(Ql(e,p,U[R]>>5&127),p+=U[R]>>12)}}else q=KF,re=wd,V=XF,se=M0;for(var R=0;R<c;++R){var X=i[R];if(X>255){var $=X>>18&31;Yf(e,p,q[$+257]),p+=re[$+257],$>7&&(Ql(e,p,X>>23&31),p+=Fb[$]);var Q=X&31;Yf(e,p,V[Q]),p+=se[Q],Q>3&&(Yf(e,p,X>>5&8191),p+=$b[Q])}else Yf(e,p,q[X]),p+=re[X]}return Yf(e,p,q[256]),p+re[256]},ZF=new Ub([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),pC=new Za(0),JF=function(n,e,t,i,s,o){var l=o.z||n.length,c=new Za(i+l+5*(1+Math.ceil(l/7e3))+s),d=c.subarray(i,c.length-s),f=o.l,p=(o.r||0)&7;if(e){p&&(d[0]=o.r>>3);for(var v=ZF[e-1],_=v>>13,b=v&8191,T=(1<<t)-1,C=o.p||new zr(32768),A=o.h||new zr(T+1),I=Math.ceil(t/3),ee=2*I,G=function(Ce){return(n[Ce]^n[Ce+1]<<I^n[Ce+2]<<ee)&T},K=new Ub(25e3),de=new zr(288),le=new zr(32),z=0,R=0,D=o.i||0,F=0,E=o.w||0,O=0;D+2<l;++D){var M=G(D),Y=D&32767,ie=A[M];if(C[Y]=ie,A[M]=Y,E<=D){var q=l-D;if((z>7e3||F>24576)&&(q>423||!f)){p=aN(n,d,0,K,de,le,R,F,O,D-O,p),F=z=R=0,O=D;for(var re=0;re<286;++re)de[re]=0;for(var re=0;re<30;++re)le[re]=0}var V=2,se=0,W=b,te=Y-ie&32767;if(q>2&&M==G(D-te))for(var j=Math.min(_,q)-1,U=Math.min(32767,D),$=Math.min(258,q);te<=U&&--W&&Y!=ie;){if(n[D+V]==n[D+V-te]){for(var X=0;X<$&&n[D+X]==n[D+X-te];++X);if(X>V){if(V=X,se=te,X>j)break;for(var Q=Math.min(te,X-2),ye=0,re=0;re<Q;++re){var Ae=D-te+re&32767,De=C[Ae],Be=Ae-De&32767;Be>ye&&(ye=Be,ie=Ae)}}}Y=ie,ie=C[Y],te+=Y-ie&32767}if(se){K[F++]=268435456|sv[V]<<18|oN[se];var Fe=sv[V]&31,Ct=oN[se]&31;R+=Fb[Fe]+$b[Ct],++de[257+Fe],++le[Ct],E=D+V,++z}else K[F++]=n[D],++de[n[D]]}}for(D=Math.max(D,E);D<l;++D)K[F++]=n[D],++de[n[D]];p=aN(n,d,f,K,de,le,R,F,O,D-O,p),f||(o.r=p&7|d[p/8|0]<<3,p-=7,o.h=A,o.p=C,o.i=D,o.w=E)}else{for(var D=o.w||0;D<l+f;D+=65535){var at=D+65535;at>=l&&(d[p/8|0]=f,at=l),p=mC(d,p+1,n.subarray(D,at))}o.i=l}return QF(c,0,i+fC(p)+s)},gC=function(){var n=1,e=0;return{p:function(t){for(var i=n,s=e,o=t.length|0,l=0;l!=o;){for(var c=Math.min(l+2655,o);l<c;++l)s+=i+=t[l];i=(i&65535)+15*(i>>16),s=(s&65535)+15*(s>>16)}n=i,e=s},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},e$=function(n,e,t,i,s){if(!s&&(s={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),l=new Za(o.length+n.length);l.set(o),l.set(n,o.length),n=l,s.w=o.length}return JF(n,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,i,s)},yC=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},t$=function(n,e){var t=e.level,i=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=i<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var s=gC();s.p(e.dictionary),yC(n,2,s.d())}};function av(n,e){e||(e={});var t=gC();t.p(n);var i=e$(n,e,e.dictionary?6:2,4);return t$(i,e),yC(i,i.length-4,t.d()),i}var n$=typeof TextDecoder<"u"&&new TextDecoder,i$=0;try{n$.decode(pC,{stream:!0}),i$=1}catch{}function s$(n){if(Array.isArray(n))return n}function o$(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,s,o,l,c=[],d=!0,f=!1;try{if(o=(t=t.call(n)).next,e!==0)for(;!(d=(i=o.call(t)).done)&&(c.push(i.value),c.length!==e);d=!0);}catch(p){f=!0,s=p}finally{try{if(!d&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(f)throw s}}return c}}function lN(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function r$(n,e){if(n){if(typeof n=="string")return lN(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?lN(n,e):void 0}}function a$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cN(n,e){return s$(n)||o$(n,e)||r$(n,e)||a$()}function uN(n,e="utf8"){return new TextDecoder(e).decode(n)}const l$=new TextEncoder;function c$(n){return l$.encode(n)}const u$=1024*8,d$=(()=>{const n=new Uint8Array(4),e=new Uint32Array(n.buffer);return!((e[0]=1)&n[0])})(),n2={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Bb{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=u$,t={}){let i=!1;typeof e=="number"?e=new ArrayBuffer(e):(i=!0,this.lastWrittenByte=e.byteLength);const s=t.offset?t.offset>>>0:0,o=e.byteLength-s;let l=s;(ArrayBuffer.isView(e)||e instanceof Bb)&&(e.byteLength!==e.buffer.byteLength&&(l=e.byteOffset+s),e=e.buffer),i?this.lastWrittenByte=o:this.lastWrittenByte=0,this.buffer=e,this.length=o,this.byteLength=o,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,o),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const i=(this.offset+e)*2,s=new Uint8Array(i);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=i,this.byteLength=i,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const i=n2[t].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,o=this.buffer.slice(s,s+i);if(this.littleEndian===d$&&t!=="uint8"&&t!=="int8"){const c=new Uint8Array(this.buffer.slice(s,s+i));c.reverse();const d=new n2[t](c.buffer);return this.offset+=i,d.reverse(),d}const l=new n2[t](o);return this.offset+=i,l}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let i=0;i<e;i++)t+=this.readChar();return t}readUtf8(e=1){return uN(this.readBytes(e))}decodeText(e=1,t="utf8"){return uN(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(c$(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Hh(n){let e=n.length;for(;--e>=0;)n[e]=0}const h$=3,f$=258,vC=29,m$=256,p$=m$+1+vC,bC=30,g$=512,y$=new Array((p$+2)*2);Hh(y$);const v$=new Array(bC*2);Hh(v$);const b$=new Array(g$);Hh(b$);const w$=new Array(f$-h$+1);Hh(w$);const _$=new Array(vC);Hh(_$);const x$=new Array(bC);Hh(x$);const S$=(n,e,t,i)=>{let s=n&65535|0,o=n>>>16&65535|0,l=0;for(;t!==0;){l=t>2e3?2e3:t,t-=l;do s=s+e[i++]|0,o=o+s|0;while(--l);s%=65521,o%=65521}return s|o<<16|0};var lv=S$;const N$=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var i=0;i<8;i++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},E$=new Uint32Array(N$()),T$=(n,e,t,i)=>{const s=E$,o=i+t;n^=-1;for(let l=i;l<o;l++)n=n>>>8^s[(n^e[l])&255];return n^-1};var gl=T$,cv={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},wC={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const C$=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var k$=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const i in t)C$(t,i)&&(n[i]=t[i])}}return n},L$=n=>{let e=0;for(let i=0,s=n.length;i<s;i++)e+=n[i].length;const t=new Uint8Array(e);for(let i=0,s=0,o=n.length;i<o;i++){let l=n[i];t.set(l,s),s+=l.length}return t},_C={assign:k$,flattenChunks:L$};let xC=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{xC=!1}const Fm=new Uint8Array(256);for(let n=0;n<256;n++)Fm[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Fm[254]=Fm[254]=1;var A$=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,i,s,o,l=n.length,c=0;for(s=0;s<l;s++)t=n.charCodeAt(s),(t&64512)===55296&&s+1<l&&(i=n.charCodeAt(s+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),s++)),c+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(c),o=0,s=0;o<c;s++)t=n.charCodeAt(s),(t&64512)===55296&&s+1<l&&(i=n.charCodeAt(s+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),s++)),t<128?e[o++]=t:t<2048?(e[o++]=192|t>>>6,e[o++]=128|t&63):t<65536?(e[o++]=224|t>>>12,e[o++]=128|t>>>6&63,e[o++]=128|t&63):(e[o++]=240|t>>>18,e[o++]=128|t>>>12&63,e[o++]=128|t>>>6&63,e[o++]=128|t&63);return e};const D$=(n,e)=>{if(e<65534&&n.subarray&&xC)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let i=0;i<e;i++)t+=String.fromCharCode(n[i]);return t};var O$=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let i,s;const o=new Array(t*2);for(s=0,i=0;i<t;){let l=n[i++];if(l<128){o[s++]=l;continue}let c=Fm[l];if(c>4){o[s++]=65533,i+=c-1;continue}for(l&=c===2?31:c===3?15:7;c>1&&i<t;)l=l<<6|n[i++]&63,c--;if(c>1){o[s++]=65533;continue}l<65536?o[s++]=l:(l-=65536,o[s++]=55296|l>>10&1023,o[s++]=56320|l&1023)}return D$(o,s)},j$=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+Fm[n[t]]>e?t:e},uv={string2buf:A$,buf2string:O$,utf8border:j$};function M$(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var R$=M$;const kg=16209,I$=16191;var P$=function(e,t){let i,s,o,l,c,d,f,p,v,_,b,T,C,A,I,ee,G,K,de,le,z,R,D,F;const E=e.state;i=e.next_in,D=e.input,s=i+(e.avail_in-5),o=e.next_out,F=e.output,l=o-(t-e.avail_out),c=o+(e.avail_out-257),d=E.dmax,f=E.wsize,p=E.whave,v=E.wnext,_=E.window,b=E.hold,T=E.bits,C=E.lencode,A=E.distcode,I=(1<<E.lenbits)-1,ee=(1<<E.distbits)-1;e:do{T<15&&(b+=D[i++]<<T,T+=8,b+=D[i++]<<T,T+=8),G=C[b&I];t:for(;;){if(K=G>>>24,b>>>=K,T-=K,K=G>>>16&255,K===0)F[o++]=G&65535;else if(K&16){de=G&65535,K&=15,K&&(T<K&&(b+=D[i++]<<T,T+=8),de+=b&(1<<K)-1,b>>>=K,T-=K),T<15&&(b+=D[i++]<<T,T+=8,b+=D[i++]<<T,T+=8),G=A[b&ee];n:for(;;){if(K=G>>>24,b>>>=K,T-=K,K=G>>>16&255,K&16){if(le=G&65535,K&=15,T<K&&(b+=D[i++]<<T,T+=8,T<K&&(b+=D[i++]<<T,T+=8)),le+=b&(1<<K)-1,le>d){e.msg="invalid distance too far back",E.mode=kg;break e}if(b>>>=K,T-=K,K=o-l,le>K){if(K=le-K,K>p&&E.sane){e.msg="invalid distance too far back",E.mode=kg;break e}if(z=0,R=_,v===0){if(z+=f-K,K<de){de-=K;do F[o++]=_[z++];while(--K);z=o-le,R=F}}else if(v<K){if(z+=f+v-K,K-=v,K<de){de-=K;do F[o++]=_[z++];while(--K);if(z=0,v<de){K=v,de-=K;do F[o++]=_[z++];while(--K);z=o-le,R=F}}}else if(z+=v-K,K<de){de-=K;do F[o++]=_[z++];while(--K);z=o-le,R=F}for(;de>2;)F[o++]=R[z++],F[o++]=R[z++],F[o++]=R[z++],de-=3;de&&(F[o++]=R[z++],de>1&&(F[o++]=R[z++]))}else{z=o-le;do F[o++]=F[z++],F[o++]=F[z++],F[o++]=F[z++],de-=3;while(de>2);de&&(F[o++]=F[z++],de>1&&(F[o++]=F[z++]))}}else if((K&64)===0){G=A[(G&65535)+(b&(1<<K)-1)];continue n}else{e.msg="invalid distance code",E.mode=kg;break e}break}}else if((K&64)===0){G=C[(G&65535)+(b&(1<<K)-1)];continue t}else if(K&32){E.mode=I$;break e}else{e.msg="invalid literal/length code",E.mode=kg;break e}break}}while(i<s&&o<c);de=T>>3,i-=de,T-=de<<3,b&=(1<<T)-1,e.next_in=i,e.next_out=o,e.avail_in=i<s?5+(s-i):5-(i-s),e.avail_out=o<c?257+(c-o):257-(o-c),E.hold=b,E.bits=T};const oh=15,dN=852,hN=592,fN=0,i2=1,mN=2,U$=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),F$=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),$$=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),B$=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),W$=(n,e,t,i,s,o,l,c)=>{const d=c.bits;let f=0,p=0,v=0,_=0,b=0,T=0,C=0,A=0,I=0,ee=0,G,K,de,le,z,R=null,D;const F=new Uint16Array(oh+1),E=new Uint16Array(oh+1);let O=null,M,Y,ie;for(f=0;f<=oh;f++)F[f]=0;for(p=0;p<i;p++)F[e[t+p]]++;for(b=d,_=oh;_>=1&&F[_]===0;_--);if(b>_&&(b=_),_===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,c.bits=1,0;for(v=1;v<_&&F[v]===0;v++);for(b<v&&(b=v),A=1,f=1;f<=oh;f++)if(A<<=1,A-=F[f],A<0)return-1;if(A>0&&(n===fN||_!==1))return-1;for(E[1]=0,f=1;f<oh;f++)E[f+1]=E[f]+F[f];for(p=0;p<i;p++)e[t+p]!==0&&(l[E[e[t+p]]++]=p);if(n===fN?(R=O=l,D=20):n===i2?(R=U$,O=F$,D=257):(R=$$,O=B$,D=0),ee=0,p=0,f=v,z=o,T=b,C=0,de=-1,I=1<<b,le=I-1,n===i2&&I>dN||n===mN&&I>hN)return 1;for(;;){M=f-C,l[p]+1<D?(Y=0,ie=l[p]):l[p]>=D?(Y=O[l[p]-D],ie=R[l[p]-D]):(Y=96,ie=0),G=1<<f-C,K=1<<T,v=K;do K-=G,s[z+(ee>>C)+K]=M<<24|Y<<16|ie|0;while(K!==0);for(G=1<<f-1;ee&G;)G>>=1;if(G!==0?(ee&=G-1,ee+=G):ee=0,p++,--F[f]===0){if(f===_)break;f=e[t+l[p]]}if(f>b&&(ee&le)!==de){for(C===0&&(C=b),z+=v,T=f-C,A=1<<T;T+C<_&&(A-=F[T+C],!(A<=0));)T++,A<<=1;if(I+=1<<T,n===i2&&I>dN||n===mN&&I>hN)return 1;de=ee&le,s[de]=b<<24|T<<16|z-o|0}}return ee!==0&&(s[z+ee]=f-C<<24|64<<16|0),c.bits=b,0};var ym=W$;const z$=0,SC=1,NC=2,{Z_FINISH:pN,Z_BLOCK:H$,Z_TREES:Lg,Z_OK:_d,Z_STREAM_END:q$,Z_NEED_DICT:V$,Z_STREAM_ERROR:Sa,Z_DATA_ERROR:EC,Z_MEM_ERROR:TC,Z_BUF_ERROR:Y$,Z_DEFLATED:gN}=wC,a1=16180,yN=16181,vN=16182,bN=16183,wN=16184,_N=16185,xN=16186,SN=16187,NN=16188,EN=16189,R0=16190,Zl=16191,s2=16192,TN=16193,o2=16194,CN=16195,kN=16196,LN=16197,AN=16198,Ag=16199,Dg=16200,DN=16201,ON=16202,jN=16203,MN=16204,RN=16205,r2=16206,IN=16207,PN=16208,hs=16209,CC=16210,kC=16211,G$=852,K$=592,X$=15,Q$=X$,UN=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function Z$(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Td=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<a1||e.mode>kC?1:0},LC=n=>{if(Td(n))return Sa;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=a1,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(G$),e.distcode=e.distdyn=new Int32Array(K$),e.sane=1,e.back=-1,_d},AC=n=>{if(Td(n))return Sa;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,LC(n)},DC=(n,e)=>{let t;if(Td(n))return Sa;const i=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Sa:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,AC(n))},OC=(n,e)=>{if(!n)return Sa;const t=new Z$;n.state=t,t.strm=n,t.window=null,t.mode=a1;const i=DC(n,e);return i!==_d&&(n.state=null),i},J$=n=>OC(n,Q$);let FN=!0,a2,l2;const eB=n=>{if(FN){a2=new Int32Array(512),l2=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(ym(SC,n.lens,0,288,a2,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;ym(NC,n.lens,0,32,l2,0,n.work,{bits:5}),FN=!1}n.lencode=a2,n.lenbits=9,n.distcode=l2,n.distbits=5},jC=(n,e,t,i)=>{let s;const o=n.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(e.subarray(t-o.wsize,t),0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>i&&(s=i),o.window.set(e.subarray(t-i,t-i+s),o.wnext),i-=s,i?(o.window.set(e.subarray(t-i,t),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0},tB=(n,e)=>{let t,i,s,o,l,c,d,f,p,v,_,b,T,C,A=0,I,ee,G,K,de,le,z,R;const D=new Uint8Array(4);let F,E;const O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Td(n)||!n.output||!n.input&&n.avail_in!==0)return Sa;t=n.state,t.mode===Zl&&(t.mode=s2),l=n.next_out,s=n.output,d=n.avail_out,o=n.next_in,i=n.input,c=n.avail_in,f=t.hold,p=t.bits,v=c,_=d,R=_d;e:for(;;)switch(t.mode){case a1:if(t.wrap===0){t.mode=s2;break}for(;p<16;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}if(t.wrap&2&&f===35615){t.wbits===0&&(t.wbits=15),t.check=0,D[0]=f&255,D[1]=f>>>8&255,t.check=gl(t.check,D,2,0),f=0,p=0,t.mode=yN;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((f&255)<<8)+(f>>8))%31){n.msg="incorrect header check",t.mode=hs;break}if((f&15)!==gN){n.msg="unknown compression method",t.mode=hs;break}if(f>>>=4,p-=4,z=(f&15)+8,t.wbits===0&&(t.wbits=z),z>15||z>t.wbits){n.msg="invalid window size",t.mode=hs;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=f&512?EN:Zl,f=0,p=0;break;case yN:for(;p<16;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}if(t.flags=f,(t.flags&255)!==gN){n.msg="unknown compression method",t.mode=hs;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=hs;break}t.head&&(t.head.text=f>>8&1),t.flags&512&&t.wrap&4&&(D[0]=f&255,D[1]=f>>>8&255,t.check=gl(t.check,D,2,0)),f=0,p=0,t.mode=vN;case vN:for(;p<32;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}t.head&&(t.head.time=f),t.flags&512&&t.wrap&4&&(D[0]=f&255,D[1]=f>>>8&255,D[2]=f>>>16&255,D[3]=f>>>24&255,t.check=gl(t.check,D,4,0)),f=0,p=0,t.mode=bN;case bN:for(;p<16;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}t.head&&(t.head.xflags=f&255,t.head.os=f>>8),t.flags&512&&t.wrap&4&&(D[0]=f&255,D[1]=f>>>8&255,t.check=gl(t.check,D,2,0)),f=0,p=0,t.mode=wN;case wN:if(t.flags&1024){for(;p<16;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}t.length=f,t.head&&(t.head.extra_len=f),t.flags&512&&t.wrap&4&&(D[0]=f&255,D[1]=f>>>8&255,t.check=gl(t.check,D,2,0)),f=0,p=0}else t.head&&(t.head.extra=null);t.mode=_N;case _N:if(t.flags&1024&&(b=t.length,b>c&&(b=c),b&&(t.head&&(z=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(o,o+b),z)),t.flags&512&&t.wrap&4&&(t.check=gl(t.check,i,b,o)),c-=b,o+=b,t.length-=b),t.length))break e;t.length=0,t.mode=xN;case xN:if(t.flags&2048){if(c===0)break e;b=0;do z=i[o+b++],t.head&&z&&t.length<65536&&(t.head.name+=String.fromCharCode(z));while(z&&b<c);if(t.flags&512&&t.wrap&4&&(t.check=gl(t.check,i,b,o)),c-=b,o+=b,z)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=SN;case SN:if(t.flags&4096){if(c===0)break e;b=0;do z=i[o+b++],t.head&&z&&t.length<65536&&(t.head.comment+=String.fromCharCode(z));while(z&&b<c);if(t.flags&512&&t.wrap&4&&(t.check=gl(t.check,i,b,o)),c-=b,o+=b,z)break e}else t.head&&(t.head.comment=null);t.mode=NN;case NN:if(t.flags&512){for(;p<16;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}if(t.wrap&4&&f!==(t.check&65535)){n.msg="header crc mismatch",t.mode=hs;break}f=0,p=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=Zl;break;case EN:for(;p<32;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}n.adler=t.check=UN(f),f=0,p=0,t.mode=R0;case R0:if(t.havedict===0)return n.next_out=l,n.avail_out=d,n.next_in=o,n.avail_in=c,t.hold=f,t.bits=p,V$;n.adler=t.check=1,t.mode=Zl;case Zl:if(e===H$||e===Lg)break e;case s2:if(t.last){f>>>=p&7,p-=p&7,t.mode=r2;break}for(;p<3;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}switch(t.last=f&1,f>>>=1,p-=1,f&3){case 0:t.mode=TN;break;case 1:if(eB(t),t.mode=Ag,e===Lg){f>>>=2,p-=2;break e}break;case 2:t.mode=kN;break;case 3:n.msg="invalid block type",t.mode=hs}f>>>=2,p-=2;break;case TN:for(f>>>=p&7,p-=p&7;p<32;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}if((f&65535)!==(f>>>16^65535)){n.msg="invalid stored block lengths",t.mode=hs;break}if(t.length=f&65535,f=0,p=0,t.mode=o2,e===Lg)break e;case o2:t.mode=CN;case CN:if(b=t.length,b){if(b>c&&(b=c),b>d&&(b=d),b===0)break e;s.set(i.subarray(o,o+b),l),c-=b,o+=b,d-=b,l+=b,t.length-=b;break}t.mode=Zl;break;case kN:for(;p<14;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}if(t.nlen=(f&31)+257,f>>>=5,p-=5,t.ndist=(f&31)+1,f>>>=5,p-=5,t.ncode=(f&15)+4,f>>>=4,p-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=hs;break}t.have=0,t.mode=LN;case LN:for(;t.have<t.ncode;){for(;p<3;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}t.lens[O[t.have++]]=f&7,f>>>=3,p-=3}for(;t.have<19;)t.lens[O[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,F={bits:t.lenbits},R=ym(z$,t.lens,0,19,t.lencode,0,t.work,F),t.lenbits=F.bits,R){n.msg="invalid code lengths set",t.mode=hs;break}t.have=0,t.mode=AN;case AN:for(;t.have<t.nlen+t.ndist;){for(;A=t.lencode[f&(1<<t.lenbits)-1],I=A>>>24,ee=A>>>16&255,G=A&65535,!(I<=p);){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}if(G<16)f>>>=I,p-=I,t.lens[t.have++]=G;else{if(G===16){for(E=I+2;p<E;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}if(f>>>=I,p-=I,t.have===0){n.msg="invalid bit length repeat",t.mode=hs;break}z=t.lens[t.have-1],b=3+(f&3),f>>>=2,p-=2}else if(G===17){for(E=I+3;p<E;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}f>>>=I,p-=I,z=0,b=3+(f&7),f>>>=3,p-=3}else{for(E=I+7;p<E;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}f>>>=I,p-=I,z=0,b=11+(f&127),f>>>=7,p-=7}if(t.have+b>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=hs;break}for(;b--;)t.lens[t.have++]=z}}if(t.mode===hs)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=hs;break}if(t.lenbits=9,F={bits:t.lenbits},R=ym(SC,t.lens,0,t.nlen,t.lencode,0,t.work,F),t.lenbits=F.bits,R){n.msg="invalid literal/lengths set",t.mode=hs;break}if(t.distbits=6,t.distcode=t.distdyn,F={bits:t.distbits},R=ym(NC,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,F),t.distbits=F.bits,R){n.msg="invalid distances set",t.mode=hs;break}if(t.mode=Ag,e===Lg)break e;case Ag:t.mode=Dg;case Dg:if(c>=6&&d>=258){n.next_out=l,n.avail_out=d,n.next_in=o,n.avail_in=c,t.hold=f,t.bits=p,P$(n,_),l=n.next_out,s=n.output,d=n.avail_out,o=n.next_in,i=n.input,c=n.avail_in,f=t.hold,p=t.bits,t.mode===Zl&&(t.back=-1);break}for(t.back=0;A=t.lencode[f&(1<<t.lenbits)-1],I=A>>>24,ee=A>>>16&255,G=A&65535,!(I<=p);){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}if(ee&&(ee&240)===0){for(K=I,de=ee,le=G;A=t.lencode[le+((f&(1<<K+de)-1)>>K)],I=A>>>24,ee=A>>>16&255,G=A&65535,!(K+I<=p);){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}f>>>=K,p-=K,t.back+=K}if(f>>>=I,p-=I,t.back+=I,t.length=G,ee===0){t.mode=RN;break}if(ee&32){t.back=-1,t.mode=Zl;break}if(ee&64){n.msg="invalid literal/length code",t.mode=hs;break}t.extra=ee&15,t.mode=DN;case DN:if(t.extra){for(E=t.extra;p<E;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}t.length+=f&(1<<t.extra)-1,f>>>=t.extra,p-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=ON;case ON:for(;A=t.distcode[f&(1<<t.distbits)-1],I=A>>>24,ee=A>>>16&255,G=A&65535,!(I<=p);){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}if((ee&240)===0){for(K=I,de=ee,le=G;A=t.distcode[le+((f&(1<<K+de)-1)>>K)],I=A>>>24,ee=A>>>16&255,G=A&65535,!(K+I<=p);){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}f>>>=K,p-=K,t.back+=K}if(f>>>=I,p-=I,t.back+=I,ee&64){n.msg="invalid distance code",t.mode=hs;break}t.offset=G,t.extra=ee&15,t.mode=jN;case jN:if(t.extra){for(E=t.extra;p<E;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}t.offset+=f&(1<<t.extra)-1,f>>>=t.extra,p-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=hs;break}t.mode=MN;case MN:if(d===0)break e;if(b=_-d,t.offset>b){if(b=t.offset-b,b>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=hs;break}b>t.wnext?(b-=t.wnext,T=t.wsize-b):T=t.wnext-b,b>t.length&&(b=t.length),C=t.window}else C=s,T=l-t.offset,b=t.length;b>d&&(b=d),d-=b,t.length-=b;do s[l++]=C[T++];while(--b);t.length===0&&(t.mode=Dg);break;case RN:if(d===0)break e;s[l++]=t.length,d--,t.mode=Dg;break;case r2:if(t.wrap){for(;p<32;){if(c===0)break e;c--,f|=i[o++]<<p,p+=8}if(_-=d,n.total_out+=_,t.total+=_,t.wrap&4&&_&&(n.adler=t.check=t.flags?gl(t.check,s,_,l-_):lv(t.check,s,_,l-_)),_=d,t.wrap&4&&(t.flags?f:UN(f))!==t.check){n.msg="incorrect data check",t.mode=hs;break}f=0,p=0}t.mode=IN;case IN:if(t.wrap&&t.flags){for(;p<32;){if(c===0)break e;c--,f+=i[o++]<<p,p+=8}if(t.wrap&4&&f!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=hs;break}f=0,p=0}t.mode=PN;case PN:R=q$;break e;case hs:R=EC;break e;case CC:return TC;case kC:default:return Sa}return n.next_out=l,n.avail_out=d,n.next_in=o,n.avail_in=c,t.hold=f,t.bits=p,(t.wsize||_!==n.avail_out&&t.mode<hs&&(t.mode<r2||e!==pN))&&jC(n,n.output,n.next_out,_-n.avail_out),v-=n.avail_in,_-=n.avail_out,n.total_in+=v,n.total_out+=_,t.total+=_,t.wrap&4&&_&&(n.adler=t.check=t.flags?gl(t.check,s,_,n.next_out-_):lv(t.check,s,_,n.next_out-_)),n.data_type=t.bits+(t.last?64:0)+(t.mode===Zl?128:0)+(t.mode===Ag||t.mode===o2?256:0),(v===0&&_===0||e===pN)&&R===_d&&(R=Y$),R},nB=n=>{if(Td(n))return Sa;let e=n.state;return e.window&&(e.window=null),n.state=null,_d},iB=(n,e)=>{if(Td(n))return Sa;const t=n.state;return(t.wrap&2)===0?Sa:(t.head=e,e.done=!1,_d)},sB=(n,e)=>{const t=e.length;let i,s,o;return Td(n)||(i=n.state,i.wrap!==0&&i.mode!==R0)?Sa:i.mode===R0&&(s=1,s=lv(s,e,t,0),s!==i.check)?EC:(o=jC(n,e,t,t),o?(i.mode=CC,TC):(i.havedict=1,_d))};var oB=AC,rB=DC,aB=LC,lB=J$,cB=OC,uB=tB,dB=nB,hB=iB,fB=sB,mB="pako inflate (from Nodeca project)",nc={inflateReset:oB,inflateReset2:rB,inflateResetKeep:aB,inflateInit:lB,inflateInit2:cB,inflate:uB,inflateEnd:dB,inflateGetHeader:hB,inflateSetDictionary:fB,inflateInfo:mB};function pB(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gB=pB;const MC=Object.prototype.toString,{Z_NO_FLUSH:yB,Z_FINISH:vB,Z_OK:$m,Z_STREAM_END:c2,Z_NEED_DICT:u2,Z_STREAM_ERROR:bB,Z_DATA_ERROR:$N,Z_MEM_ERROR:wB}=wC;function ap(n){this.options=_C.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new R$,this.strm.avail_out=0;let t=nc.inflateInit2(this.strm,e.windowBits);if(t!==$m)throw new Error(cv[t]);if(this.header=new gB,nc.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=uv.string2buf(e.dictionary):MC.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=nc.inflateSetDictionary(this.strm,e.dictionary),t!==$m)))throw new Error(cv[t])}ap.prototype.push=function(n,e){const t=this.strm,i=this.options.chunkSize,s=this.options.dictionary;let o,l,c;if(this.ended)return!1;for(e===~~e?l=e:l=e===!0?vB:yB,MC.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),o=nc.inflate(t,l),o===u2&&s&&(o=nc.inflateSetDictionary(t,s),o===$m?o=nc.inflate(t,l):o===$N&&(o=u2));t.avail_in>0&&o===c2&&t.state.wrap>0&&n[t.next_in]!==0;)nc.inflateReset(t),o=nc.inflate(t,l);switch(o){case bB:case $N:case u2:case wB:return this.onEnd(o),this.ended=!0,!1}if(c=t.avail_out,t.next_out&&(t.avail_out===0||o===c2))if(this.options.to==="string"){let d=uv.utf8border(t.output,t.next_out),f=t.next_out-d,p=uv.buf2string(t.output,d);t.next_out=f,t.avail_out=i-f,f&&t.output.set(t.output.subarray(d,d+f),0),this.onData(p)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(o===$m&&c===0)){if(o===c2)return o=nc.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};ap.prototype.onData=function(n){this.chunks.push(n)};ap.prototype.onEnd=function(n){n===$m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=_C.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function _B(n,e){const t=new ap(e);if(t.push(n),t.err)throw t.msg||cv[t.err];return t.result}var xB=ap,SB=_B,NB={Inflate:xB,inflate:SB};const{Inflate:EB,inflate:TB}=NB;var BN=EB,CB=TB;const RC=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;RC[n]=e}const WN=4294967295;function kB(n,e,t){let i=n;for(let s=0;s<t;s++)i=RC[(i^e[s])&255]^i>>>8;return i}function LB(n,e){return(kB(WN,n,e)^WN)>>>0}function zN(n,e,t){const i=n.readUint32(),s=LB(new Uint8Array(n.buffer,n.byteOffset+n.offset-e-4,e),e);if(s!==i)throw new Error(`CRC mismatch for chunk ${t}. Expected ${i}, found ${s}`)}function IC(n,e,t){for(let i=0;i<t;i++)e[i]=n[i]}function PC(n,e,t,i){let s=0;for(;s<i;s++)e[s]=n[s];for(;s<t;s++)e[s]=n[s]+e[s-i]&255}function UC(n,e,t,i){let s=0;if(t.length===0)for(;s<i;s++)e[s]=n[s];else for(;s<i;s++)e[s]=n[s]+t[s]&255}function FC(n,e,t,i,s){let o=0;if(t.length===0){for(;o<s;o++)e[o]=n[o];for(;o<i;o++)e[o]=n[o]+(e[o-s]>>1)&255}else{for(;o<s;o++)e[o]=n[o]+(t[o]>>1)&255;for(;o<i;o++)e[o]=n[o]+(e[o-s]+t[o]>>1)&255}}function $C(n,e,t,i,s){let o=0;if(t.length===0){for(;o<s;o++)e[o]=n[o];for(;o<i;o++)e[o]=n[o]+e[o-s]&255}else{for(;o<s;o++)e[o]=n[o]+t[o]&255;for(;o<i;o++)e[o]=n[o]+AB(e[o-s],t[o],t[o-s])&255}}function AB(n,e,t){const i=n+e-t,s=Math.abs(i-n),o=Math.abs(i-e),l=Math.abs(i-t);return s<=o&&s<=l?n:o<=l?e:t}function DB(n,e,t,i,s,o){switch(n){case 0:IC(e,t,s);break;case 1:PC(e,t,s,o);break;case 2:UC(e,t,i,s);break;case 3:FC(e,t,i,s,o);break;case 4:$C(e,t,i,s,o);break;default:throw new Error(`Unsupported filter: ${n}`)}}const OB=new Uint16Array([255]),jB=new Uint8Array(OB.buffer),MB=jB[0]===255;function RB(n){const{data:e,width:t,height:i,channels:s,depth:o}=n,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(o/8)*s,d=new Uint8Array(i*t*c);let f=0;for(let p=0;p<7;p++){const v=l[p],_=Math.ceil((t-v.x)/v.xStep),b=Math.ceil((i-v.y)/v.yStep);if(_<=0||b<=0)continue;const T=_*c,C=new Uint8Array(T);for(let A=0;A<b;A++){const I=e[f++],ee=e.subarray(f,f+T);f+=T;const G=new Uint8Array(T);DB(I,ee,G,C,T,c),C.set(G);for(let K=0;K<_;K++){const de=v.x+K*v.xStep,le=v.y+A*v.yStep;if(!(de>=t||le>=i))for(let z=0;z<c;z++)d[(le*t+de)*c+z]=G[K*c+z]}}}if(o===16){const p=new Uint16Array(d.buffer);if(MB)for(let v=0;v<p.length;v++)p[v]=IB(p[v]);return p}else return d}function IB(n){return(n&255)<<8|n>>8&255}const PB=new Uint16Array([255]),UB=new Uint8Array(PB.buffer),FB=UB[0]===255,$B=new Uint8Array(0);function HN(n){const{data:e,width:t,height:i,channels:s,depth:o}=n,l=Math.ceil(o/8)*s,c=Math.ceil(o/8*s*t),d=new Uint8Array(i*c);let f=$B,p=0,v,_;for(let b=0;b<i;b++){switch(v=e.subarray(p+1,p+1+c),_=d.subarray(b*c,(b+1)*c),e[p]){case 0:IC(v,_,c);break;case 1:PC(v,_,c,l);break;case 2:UC(v,_,f,c);break;case 3:FC(v,_,f,c,l);break;case 4:$C(v,_,f,c,l);break;default:throw new Error(`Unsupported filter: ${e[p]}`)}f=_,p+=c+1}if(o===16){const b=new Uint16Array(d.buffer);if(FB)for(let T=0;T<b.length;T++)b[T]=BB(b[T]);return b}else return d}function BB(n){return(n&255)<<8|n>>8&255}const qg=Uint8Array.of(137,80,78,71,13,10,26,10);function qN(n){if(!WB(n.readBytes(qg.length)))throw new Error("wrong PNG signature")}function WB(n){if(n.length<qg.length)return!1;for(let e=0;e<qg.length;e++)if(n[e]!==qg[e])return!1;return!0}const zB="tEXt",HB=0,BC=new TextDecoder("latin1");function qB(n){if(YB(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const VB=/^[\u0000-\u00FF]*$/;function YB(n){if(!VB.test(n))throw new Error("invalid latin1 text")}function GB(n,e,t){const i=WC(e);n[i]=KB(e,t-i.length-1)}function WC(n){for(n.mark();n.readByte()!==HB;);const e=n.offset;n.reset();const t=BC.decode(n.readBytes(e-n.offset-1));return n.skip(1),qB(t),t}function KB(n,e){return BC.decode(n.readBytes(e))}const Wr={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},d2={UNKNOWN:-1,DEFLATE:0},VN={UNKNOWN:-1,ADAPTIVE:0},h2={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Og={NONE:0,BACKGROUND:1,PREVIOUS:2},f2={SOURCE:0,OVER:1};class XB extends Bb{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);const{checkCrc:i=!1}=t;this._checkCrc=i,this._inflator=new BN,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=d2.UNKNOWN,this._filterMethod=VN.UNKNOWN,this._interlaceMethod=h2.UNKNOWN,this._colorType=Wr.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(qN(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(qN(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const i=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case zB:GB(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-i!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?zN(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const i=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=i+e;break}if(this.offset-i!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?zN(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=QB(this.readUint8());const t=this.readUint8();this._colorType=t;let i;switch(t){case Wr.GREYSCALE:i=1;break;case Wr.TRUECOLOUR:i=3;break;case Wr.INDEXED_COLOUR:i=1;break;case Wr.GREYSCALE_ALPHA:i=2;break;case Wr.TRUECOLOUR_ALPHA:i=4;break;case Wr.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==d2.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<t;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,i=this.offset+this.byteOffset;if(i+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,i,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Wr.GREYSCALE:case Wr.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break}case Wr.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const i=this.readByte();this._palette[t].push(i)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case Wr.UNKNOWN:case Wr.GREYSCALE_ALPHA:case Wr.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const t=WC(this),i=this.readUint8();if(i!==d2.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:CB(s)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),i=this.readByte();this._png.resolution={x:e,y:t,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(e);if(i){if(i.data=HN({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)t.data=i.data;else{const s=this._apng.frames.at(e-1);this.disposeFrame(i,s,t),this.addFrameDataToCanvas(t,i)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,i){switch(e.disposeOp){case Og.NONE:break;case Og.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*e.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)i.data[l+c]=0}break;case Og.PREVIOUS:i.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const i=1<<this._png.depth,s=(o,l)=>{const c=((o+t.yOffset)*this._png.width+t.xOffset+l)*this._png.channels,d=(o*t.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(t.blendOp){case f2.SOURCE:for(let o=0;o<t.height;o++)for(let l=0;l<t.width;l++){const{index:c,frameIndex:d}=s(o,l);for(let f=0;f<this._png.channels;f++)e.data[c+f]=t.data[d+f]}break;case f2.OVER:for(let o=0;o<t.height;o++)for(let l=0;l<t.width;l++){const{index:c,frameIndex:d}=s(o,l);for(let f=0;f<this._png.channels;f++){const p=t.data[d+this._png.channels-1]/i,v=f%(this._png.channels-1)===0?1:t.data[d+f],_=Math.floor(p*v+(1-p)*e.data[c+f]);e.data[c+f]+=_}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==VN.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===h2.NO_INTERLACE)this._png.data=HN({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===h2.ADAM7)this._png.data=RB({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Og.NONE,blendOp:f2.SOURCE,data:e}),this._inflator=new BN,this._writingDataChunks=!1}}function QB(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var YN;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(YN||(YN={}));function ZB(n,e){return new XB(n,e).decode()}var Rn=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function m2(){Rn.console&&typeof Rn.console.log=="function"&&Rn.console.log.apply(Rn.console,arguments)}var zi={log:m2,warn:function(n){Rn.console&&(typeof Rn.console.warn=="function"?Rn.console.warn.apply(Rn.console,arguments):m2.call(null,arguments))},error:function(n){Rn.console&&(typeof Rn.console.error=="function"?Rn.console.error.apply(Rn.console,arguments):m2(n))}};function p2(n,e,t){var i=new XMLHttpRequest;i.open("GET",n),i.responseType="blob",i.onload=function(){Qu(i.response,e,t)},i.onerror=function(){zi.error("could not download file")},i.send()}function GN(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function jg(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Qu=Rn.saveAs||((typeof window>"u"?"undefined":Di(window))!=="object"||window!==Rn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var i=Rn.URL||Rn.webkitURL,s=document.createElement("a");e=e||n.name||"download",s.download=e,s.rel="noopener",typeof n=="string"?(s.href=n,s.origin!==location.origin?GN(s.href)?p2(n,e,t):jg(s,s.target="_blank"):jg(s)):(s.href=i.createObjectURL(n),setTimeout(function(){i.revokeObjectURL(s.href)},4e4),setTimeout(function(){jg(s)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(GN(n))p2(n,e,t);else{var i=document.createElement("a");i.href=n,i.target="_blank",setTimeout(function(){jg(i)})}else navigator.msSaveOrOpenBlob((function(s,o){return o===void 0?o={autoBom:!1}:Di(o)!=="object"&&(zi.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s})(n,t),e)}:function(n,e,t,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof n=="string")return p2(n,e,t);var s=n.type==="application/octet-stream",o=/constructor/i.test(Rn.HTMLElement)||Rn.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&o)&&(typeof FileReader>"u"?"undefined":Di(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var p=c.result;p=l?p:p.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=p:location=p,i=null},c.readAsDataURL(n)}else{var d=Rn.URL||Rn.webkitURL,f=d.createObjectURL(n);i?i.location=f:location.href=f,i=null,setTimeout(function(){d.revokeObjectURL(f)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function zC(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],i=0;i<t.length;i++){var s=t[i].re,o=t[i].process,l=s.exec(n);l&&(e=o(l),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),d=this.g.toString(16),f=this.b.toString(16);return c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),f.length==1&&(f="0"+f),"#"+c+d+f}}var Vg=Rn.atob.bind(Rn),KN=Rn.btoa.bind(Rn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function g2(n,e){var t=n[0],i=n[1],s=n[2],o=n[3];t=zo(t,i,s,o,e[0],7,-680876936),o=zo(o,t,i,s,e[1],12,-389564586),s=zo(s,o,t,i,e[2],17,606105819),i=zo(i,s,o,t,e[3],22,-1044525330),t=zo(t,i,s,o,e[4],7,-176418897),o=zo(o,t,i,s,e[5],12,1200080426),s=zo(s,o,t,i,e[6],17,-1473231341),i=zo(i,s,o,t,e[7],22,-45705983),t=zo(t,i,s,o,e[8],7,1770035416),o=zo(o,t,i,s,e[9],12,-1958414417),s=zo(s,o,t,i,e[10],17,-42063),i=zo(i,s,o,t,e[11],22,-1990404162),t=zo(t,i,s,o,e[12],7,1804603682),o=zo(o,t,i,s,e[13],12,-40341101),s=zo(s,o,t,i,e[14],17,-1502002290),t=Ho(t,i=zo(i,s,o,t,e[15],22,1236535329),s,o,e[1],5,-165796510),o=Ho(o,t,i,s,e[6],9,-1069501632),s=Ho(s,o,t,i,e[11],14,643717713),i=Ho(i,s,o,t,e[0],20,-373897302),t=Ho(t,i,s,o,e[5],5,-701558691),o=Ho(o,t,i,s,e[10],9,38016083),s=Ho(s,o,t,i,e[15],14,-660478335),i=Ho(i,s,o,t,e[4],20,-405537848),t=Ho(t,i,s,o,e[9],5,568446438),o=Ho(o,t,i,s,e[14],9,-1019803690),s=Ho(s,o,t,i,e[3],14,-187363961),i=Ho(i,s,o,t,e[8],20,1163531501),t=Ho(t,i,s,o,e[13],5,-1444681467),o=Ho(o,t,i,s,e[2],9,-51403784),s=Ho(s,o,t,i,e[7],14,1735328473),t=qo(t,i=Ho(i,s,o,t,e[12],20,-1926607734),s,o,e[5],4,-378558),o=qo(o,t,i,s,e[8],11,-2022574463),s=qo(s,o,t,i,e[11],16,1839030562),i=qo(i,s,o,t,e[14],23,-35309556),t=qo(t,i,s,o,e[1],4,-1530992060),o=qo(o,t,i,s,e[4],11,1272893353),s=qo(s,o,t,i,e[7],16,-155497632),i=qo(i,s,o,t,e[10],23,-1094730640),t=qo(t,i,s,o,e[13],4,681279174),o=qo(o,t,i,s,e[0],11,-358537222),s=qo(s,o,t,i,e[3],16,-722521979),i=qo(i,s,o,t,e[6],23,76029189),t=qo(t,i,s,o,e[9],4,-640364487),o=qo(o,t,i,s,e[12],11,-421815835),s=qo(s,o,t,i,e[15],16,530742520),t=Vo(t,i=qo(i,s,o,t,e[2],23,-995338651),s,o,e[0],6,-198630844),o=Vo(o,t,i,s,e[7],10,1126891415),s=Vo(s,o,t,i,e[14],15,-1416354905),i=Vo(i,s,o,t,e[5],21,-57434055),t=Vo(t,i,s,o,e[12],6,1700485571),o=Vo(o,t,i,s,e[3],10,-1894986606),s=Vo(s,o,t,i,e[10],15,-1051523),i=Vo(i,s,o,t,e[1],21,-2054922799),t=Vo(t,i,s,o,e[8],6,1873313359),o=Vo(o,t,i,s,e[15],10,-30611744),s=Vo(s,o,t,i,e[6],15,-1560198380),i=Vo(i,s,o,t,e[13],21,1309151649),t=Vo(t,i,s,o,e[4],6,-145523070),o=Vo(o,t,i,s,e[11],10,-1120210379),s=Vo(s,o,t,i,e[2],15,718787259),i=Vo(i,s,o,t,e[9],21,-343485551),n[0]=ou(t,n[0]),n[1]=ou(i,n[1]),n[2]=ou(s,n[2]),n[3]=ou(o,n[3])}function l1(n,e,t,i,s,o){return e=ou(ou(e,n),ou(i,o)),ou(e<<s|e>>>32-s,t)}function zo(n,e,t,i,s,o,l){return l1(e&t|~e&i,n,e,s,o,l)}function Ho(n,e,t,i,s,o,l){return l1(e&i|t&~i,n,e,s,o,l)}function qo(n,e,t,i,s,o,l){return l1(e^t^i,n,e,s,o,l)}function Vo(n,e,t,i,s,o,l){return l1(t^(e|~i),n,e,s,o,l)}function HC(n){var e,t=n.length,i=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)g2(i,JB(n.substring(e-64,e)));n=n.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)s[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(g2(i,s),e=0;e<16;e++)s[e]=0;return s[14]=8*t,g2(i,s),i}function JB(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}var XN="0123456789abcdef".split("");function eW(n){for(var e="",t=0;t<4;t++)e+=XN[n>>8*t+4&15]+XN[n>>8*t&15];return e}function tW(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function dv(n){return HC(n).map(tW).join("")}var nW=(function(n){for(var e=0;e<n.length;e++)n[e]=eW(n[e]);return n.join("")})(HC("hello"))!="5d41402abc4b2a76b9719d911017c592";function ou(n,e){if(nW){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function hv(n,e){var t,i,s,o;if(n!==t){for(var l=(s=n,o=1+(256/n.length|0),new Array(o+1).join(s)),c=[],d=0;d<256;d++)c[d]=d;var f=0;for(d=0;d<256;d++){var p=c[d];f=(f+p+l.charCodeAt(d))%256,c[d]=c[f],c[f]=p}t=n,i=c}else c=i;var v=e.length,_=0,b=0,T="";for(d=0;d<v;d++)b=(b+(p=c[_=(_+1)%256]))%256,c[_]=c[b],c[b]=p,l=c[(c[_]+c[b])%256],T+=String.fromCharCode(e.charCodeAt(d)^l);return T}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var QN={print:4,modify:8,copy:16,"annot-forms":32};function lh(n,e,t,i){this.v=1,this.r=2;var s=192;n.forEach(function(c){if(QN.perm!==void 0)throw new Error("Invalid permission: "+c);s+=QN[c]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var o=(e+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,l),this.P=-(1+(255^s)),this.encryptionKey=dv(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=hv(this.encryptionKey,this.padding)}function ch(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,i=0;i<t;i++){var s=n.charCodeAt(i);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):n[i]}return e}function ZN(n){if(Di(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,i,s){if(s=s||!1,typeof t!="string"||typeof i!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var o=Math.random().toString(35);return e[t][o]=[i,!!s],o},this.unsubscribe=function(t){for(var i in e)if(e[i][t])return delete e[i][t],Object.keys(e[i]).length===0&&delete e[i],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var i=Array.prototype.slice.call(arguments,1),s=[];for(var o in e[t]){var l=e[t][o];try{l[0].apply(n,i)}catch(c){Rn.console&&zi.error("jsPDF PubSub Error",c.message,c)}l[1]&&s.push(o)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function I0(n){if(!(this instanceof I0))return new I0(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function qC(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function Ju(n,e,t,i,s){if(!(this instanceof Ju))return new Ju(n,e,t,i,s);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,qC.call(this,i,s)}function hh(n,e,t,i,s){if(!(this instanceof hh))return new hh(n,e,t,i,s);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,qC.call(this,i,s)}function vn(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],s=arguments[2],o=arguments[3],l=[],c=1,d=16,f="S",p=null;Di(n=n||{})==="object"&&(t=n.orientation,i=n.unit||i,s=n.format||s,o=n.compress||n.compressPdf||o,(p=n.encryption||null)!==null&&(p.userPassword=p.userPassword||"",p.ownerPassword=p.ownerPassword||"",p.userPermissions=p.userPermissions||[]),c=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(d=n.floatPrecision),f=n.defaultPathOperation||"S"),l=n.filters||(o===!0?["FlateEncode"]:l),i=i||"mm",t=(""+(t||"P")).toLowerCase();var v=n.putOnlyUsedFonts||!1,_={},b={internal:{},__private__:{}};b.__private__.PubSub=ZN;var T="1.3",C=b.__private__.getPdfVersion=function(){return T};b.__private__.setPdfVersion=function(N){T=N};var A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};b.__private__.getPageFormats=function(){return A};var I=b.__private__.getPageFormat=function(N){return A[N]};s=s||"a4";var ee="compat",G="advanced",K=ee;function de(){this.saveGraphicsState(),ce(new Te(Xe,0,0,-Xe,0,_o()*Xe).toString()+" cm"),this.setFontSize(this.getFontSize()/Xe),f="n",K=G}function le(){this.restoreGraphicsState(),f="S",K=ee}var z=b.__private__.combineFontStyleAndFontWeight=function(N,Z){if(N=="bold"&&Z=="normal"||N=="bold"&&Z==400||N=="normal"&&Z=="italic"||N=="bold"&&Z=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Z&&(N=Z==400||Z==="normal"?N==="italic"?"italic":"normal":Z!=700&&Z!=="bold"||N!=="normal"?(Z==700?"bold":Z)+""+N:"bold"),N};b.advancedAPI=function(N){var Z=K===ee;return Z&&de.call(this),typeof N!="function"||(N(this),Z&&le.call(this)),this},b.compatAPI=function(N){var Z=K===G;return Z&&le.call(this),typeof N!="function"||(N(this),Z&&de.call(this)),this},b.isAdvancedAPI=function(){return K===G};var R,D=function(N){if(K!==G)throw new Error(N+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=b.roundToPrecision=b.__private__.roundToPrecision=function(N,Z){var _e=e||Z;if(isNaN(N)||isNaN(_e))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return N.toFixed(_e).replace(/0+$/,"")};R=b.hpf=b.__private__.hpf=typeof d=="number"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return F(N,d)}:d==="smart"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return F(N,N>-1&&N<1?16:5)}:function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return F(N,16)};var E=b.f2=b.__private__.f2=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f2");return F(N,2)},O=b.__private__.f3=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f3");return F(N,3)},M=b.scale=b.__private__.scale=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.scale");return K===ee?N*Xe:K===G?N:void 0},Y=function(N){return M((function(Z){return K===ee?_o()-Z:K===G?Z:void 0})(N))};b.__private__.setPrecision=b.setPrecision=function(N){typeof parseInt(N,10)=="number"&&(e=parseInt(N,10))};var ie,q="00000000000000000000000000000000",re=b.__private__.getFileId=function(){return q},V=b.__private__.setFileId=function(N){return q=N!==void 0&&/^[a-fA-F0-9]{32}$/.test(N)?N.toUpperCase():q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),p!==null&&($n=new lh(p.userPermissions,p.userPassword,p.ownerPassword,q)),q};b.setFileId=function(N){return V(N),this},b.getFileId=function(){return re()};var se=b.__private__.convertDateToPDFDate=function(N){var Z=N.getTimezoneOffset(),_e=Z<0?"+":"-",Ie=Math.floor(Math.abs(Z/60)),et=Math.abs(Z%60),Mt=[_e,$(Ie),"'",$(et),"'"].join("");return["D:",N.getFullYear(),$(N.getMonth()+1),$(N.getDate()),$(N.getHours()),$(N.getMinutes()),$(N.getSeconds()),Mt].join("")},W=b.__private__.convertPDFDateToDate=function(N){var Z=parseInt(N.substr(2,4),10),_e=parseInt(N.substr(6,2),10)-1,Ie=parseInt(N.substr(8,2),10),et=parseInt(N.substr(10,2),10),Mt=parseInt(N.substr(12,2),10),Wt=parseInt(N.substr(14,2),10);return new Date(Z,_e,Ie,et,Mt,Wt,0)},te=b.__private__.setCreationDate=function(N){var Z;if(N===void 0&&(N=new Date),N instanceof Date)Z=se(N);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(N))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Z=N}return ie=Z},j=b.__private__.getCreationDate=function(N){var Z=ie;return N==="jsDate"&&(Z=W(ie)),Z};b.setCreationDate=function(N){return te(N),this},b.getCreationDate=function(N){return j(N)};var U,$=b.__private__.padd2=function(N){return("0"+parseInt(N)).slice(-2)},X=b.__private__.padd2Hex=function(N){return("00"+(N=N.toString())).substr(N.length)},Q=0,ye=[],Ae=[],De=0,Be=[],Fe=[],Ct=!1,at=Ae;b.__private__.setCustomOutputDestination=function(N){Ct=!0,at=N};var Ce=function(N){Ct||(at=N)};b.__private__.resetCustomOutputDestination=function(){Ct=!1,at=Ae};var ce=b.__private__.out=function(N){return N=N.toString(),De+=N.length+1,at.push(N),at},_t=b.__private__.write=function(N){return ce(arguments.length===1?N.toString():Array.prototype.join.call(arguments," "))},Ne=b.__private__.getArrayBuffer=function(N){for(var Z=N.length,_e=new ArrayBuffer(Z),Ie=new Uint8Array(_e);Z--;)Ie[Z]=N.charCodeAt(Z);return _e},Ve=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];b.__private__.getStandardFonts=function(){return Ve};var We=n.fontSize||16;b.__private__.setFontSize=b.setFontSize=function(N){return We=K===G?N/Xe:N,this};var tt,lt=b.__private__.getFontSize=b.getFontSize=function(){return K===ee?We:We*Xe},$e=n.R2L||!1;b.__private__.setR2L=b.setR2L=function(N){return $e=N,this},b.__private__.getR2L=b.getR2L=function(){return $e};var pe,be=b.__private__.setZoomMode=function(N){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(N))tt=N;else if(isNaN(N)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(N)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+N+'" is not recognized.');tt=N}else tt=parseInt(N,10)};b.__private__.getZoomMode=function(){return tt};var Se,Ee=b.__private__.setPageMode=function(N){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(N)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+N+'" is not recognized.');pe=N};b.__private__.getPageMode=function(){return pe};var Ye=b.__private__.setLayoutMode=function(N){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(N)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+N+'" is not recognized.');Se=N};b.__private__.getLayoutMode=function(){return Se},b.__private__.setDisplayMode=b.setDisplayMode=function(N,Z,_e){return be(N),Ye(Z),Ee(_e),this};var qe={title:"",subject:"",author:"",keywords:"",creator:""};b.__private__.getDocumentProperty=function(N){if(Object.keys(qe).indexOf(N)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return qe[N]},b.__private__.getDocumentProperties=function(){return qe},b.__private__.setDocumentProperties=b.setProperties=b.setDocumentProperties=function(N){for(var Z in qe)qe.hasOwnProperty(Z)&&N[Z]&&(qe[Z]=N[Z]);return this},b.__private__.setDocumentProperty=function(N,Z){if(Object.keys(qe).indexOf(N)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return qe[N]=Z};var Ue,Xe,bt,qt,fe,Ze={},Je={},mt=[],Tt={},It={},gt={},tn={},Zt=null,Dt=0,Ut=[],Qt=new ZN(b),an=n.hotfixes||[],on={},dn={},Sn=[],Te=function N(Z,_e,Ie,et,Mt,Wt){if(!(this instanceof N))return new N(Z,_e,Ie,et,Mt,Wt);isNaN(Z)&&(Z=1),isNaN(_e)&&(_e=0),isNaN(Ie)&&(Ie=0),isNaN(et)&&(et=1),isNaN(Mt)&&(Mt=0),isNaN(Wt)&&(Wt=0),this._matrix=[Z,_e,Ie,et,Mt,Wt]};Object.defineProperty(Te.prototype,"sx",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Te.prototype,"shy",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Te.prototype,"shx",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Te.prototype,"sy",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Te.prototype,"tx",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Te.prototype,"ty",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Te.prototype,"a",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Te.prototype,"b",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Te.prototype,"c",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Te.prototype,"d",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Te.prototype,"e",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Te.prototype,"f",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Te.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Te.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Te.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Te.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Te.prototype.join=function(N){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(R).join(N)},Te.prototype.multiply=function(N){var Z=N.sx*this.sx+N.shy*this.shx,_e=N.sx*this.shy+N.shy*this.sy,Ie=N.shx*this.sx+N.sy*this.shx,et=N.shx*this.shy+N.sy*this.sy,Mt=N.tx*this.sx+N.ty*this.shx+this.tx,Wt=N.tx*this.shy+N.ty*this.sy+this.ty;return new Te(Z,_e,Ie,et,Mt,Wt)},Te.prototype.decompose=function(){var N=this.sx,Z=this.shy,_e=this.shx,Ie=this.sy,et=this.tx,Mt=this.ty,Wt=Math.sqrt(N*N+Z*Z),sn=(N/=Wt)*_e+(Z/=Wt)*Ie;_e-=N*sn,Ie-=Z*sn;var fn=Math.sqrt(_e*_e+Ie*Ie);return sn/=fn,N*(Ie/=fn)<Z*(_e/=fn)&&(N=-N,Z=-Z,sn=-sn,Wt=-Wt),{scale:new Te(Wt,0,0,fn,0,0),translate:new Te(1,0,0,1,et,Mt),rotate:new Te(N,Z,-Z,N,0,0),skew:new Te(1,0,sn,1,0,0)}},Te.prototype.toString=function(N){return this.join(" ")},Te.prototype.inversed=function(){var N=this.sx,Z=this.shy,_e=this.shx,Ie=this.sy,et=this.tx,Mt=this.ty,Wt=1/(N*Ie-Z*_e),sn=Ie*Wt,fn=-Z*Wt,xn=-_e*Wt,An=N*Wt;return new Te(sn,fn,xn,An,-sn*et-xn*Mt,-fn*et-An*Mt)},Te.prototype.applyToPoint=function(N){var Z=N.x*this.sx+N.y*this.shx+this.tx,_e=N.x*this.shy+N.y*this.sy+this.ty;return new Kr(Z,_e)},Te.prototype.applyToRectangle=function(N){var Z=this.applyToPoint(N),_e=this.applyToPoint(new Kr(N.x+N.w,N.y+N.h));return new Xr(Z.x,Z.y,_e.x-Z.x,_e.y-Z.y)},Te.prototype.clone=function(){var N=this.sx,Z=this.shy,_e=this.shx,Ie=this.sy,et=this.tx,Mt=this.ty;return new Te(N,Z,_e,Ie,et,Mt)},b.Matrix=Te;var Qe=b.matrixMult=function(N,Z){return Z.multiply(N)},dt=new Te(1,0,0,1,0,0);b.unitMatrix=b.identityMatrix=dt;var ve=function(N,Z){if(!It[N]){var _e=(Z instanceof Ju?"Sh":"P")+(Object.keys(Tt).length+1).toString(10);Z.id=_e,It[N]=_e,Tt[_e]=Z,Qt.publish("addPattern",Z)}};b.ShadingPattern=Ju,b.TilingPattern=hh,b.addShadingPattern=function(N,Z){return D("addShadingPattern()"),ve(N,Z),this},b.beginTilingPattern=function(N){D("beginTilingPattern()"),Fo(N.boundingBox[0],N.boundingBox[1],N.boundingBox[2]-N.boundingBox[0],N.boundingBox[3]-N.boundingBox[1],N.matrix)},b.endTilingPattern=function(N,Z){D("endTilingPattern()"),Z.stream=Fe[U].join(`
`),ve(N,Z),Qt.publish("endTilingPattern",Z),Sn.pop().restore()};var He,Le=b.__private__.newObject=function(){var N=Re();return Pe(N,!0),N},Re=b.__private__.newObjectDeferred=function(){return Q++,ye[Q]=function(){return De},Q},Pe=function(N,Z){return Z=typeof Z=="boolean"&&Z,ye[N]=De,Z&&ce(N+" 0 obj"),N},At=b.__private__.newAdditionalObject=function(){var N={objId:Re(),content:""};return Be.push(N),N},rt=Re(),Nt=Re(),xt=b.__private__.decodeColorString=function(N){var Z=N.split(" ");if(Z.length!==2||Z[1]!=="g"&&Z[1]!=="G")Z.length!==5||Z[4]!=="k"&&Z[4]!=="K"||(Z=[(1-Z[0])*(1-Z[3]),(1-Z[1])*(1-Z[3]),(1-Z[2])*(1-Z[3]),"r"]);else{var _e=parseFloat(Z[0]);Z=[_e,_e,_e,"r"]}for(var Ie="#",et=0;et<3;et++)Ie+=("0"+Math.floor(255*parseFloat(Z[et])).toString(16)).slice(-2);return Ie},st=b.__private__.encodeColorString=function(N){var Z;typeof N=="string"&&(N={ch1:N});var _e=N.ch1,Ie=N.ch2,et=N.ch3,Mt=N.ch4,Wt=N.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof _e=="string"&&_e.charAt(0)!=="#"){var sn=new zC(_e);if(sn.ok)_e=sn.toHex();else if(!/^\d*\.?\d*$/.test(_e))throw new Error('Invalid color "'+_e+'" passed to jsPDF.encodeColorString.')}if(typeof _e=="string"&&/^#[0-9A-Fa-f]{3}$/.test(_e)&&(_e="#"+_e[1]+_e[1]+_e[2]+_e[2]+_e[3]+_e[3]),typeof _e=="string"&&/^#[0-9A-Fa-f]{6}$/.test(_e)){var fn=parseInt(_e.substr(1),16);_e=fn>>16&255,Ie=fn>>8&255,et=255&fn}if(Ie===void 0||Mt===void 0&&_e===Ie&&Ie===et)Z=typeof _e=="string"?_e+" "+Wt[0]:N.precision===2?E(_e/255)+" "+Wt[0]:O(_e/255)+" "+Wt[0];else if(Mt===void 0||Di(Mt)==="object"){if(Mt&&!isNaN(Mt.a)&&Mt.a===0)return["1.","1.","1.",Wt[1]].join(" ");Z=typeof _e=="string"?[_e,Ie,et,Wt[1]].join(" "):N.precision===2?[E(_e/255),E(Ie/255),E(et/255),Wt[1]].join(" "):[O(_e/255),O(Ie/255),O(et/255),Wt[1]].join(" ")}else Z=typeof _e=="string"?[_e,Ie,et,Mt,Wt[2]].join(" "):N.precision===2?[E(_e),E(Ie),E(et),E(Mt),Wt[2]].join(" "):[O(_e),O(Ie),O(et),O(Mt),Wt[2]].join(" ");return Z},St=b.__private__.getFilters=function(){return l},yt=b.__private__.putStream=function(N){var Z=(N=N||{}).data||"",_e=N.filters||St(),Ie=N.alreadyAppliedFilters||[],et=N.addLength1||!1,Mt=Z.length,Wt=N.objectId,sn=function(Xi){return Xi};if(p!==null&&Wt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");p!==null&&(sn=$n.encryptor(Wt,0));var fn={};_e===!0&&(_e=["FlateEncode"]);var xn=N.additionalKeyValues||[],An=(fn=vn.API.processDataByFilters!==void 0?vn.API.processDataByFilters(Z,_e):{data:Z,reverseChain:[]}).reverseChain+(Array.isArray(Ie)?Ie.join(" "):Ie.toString());if(fn.data.length!==0&&(xn.push({key:"Length",value:fn.data.length}),et===!0&&xn.push({key:"Length1",value:Mt})),An.length!=0)if(An.split("/").length-1==1)xn.push({key:"Filter",value:An});else{xn.push({key:"Filter",value:"["+An+"]"});for(var Gn=0;Gn<xn.length;Gn+=1)if(xn[Gn].key==="DecodeParms"){for(var ji=[],Fi=0;Fi<fn.reverseChain.split("/").length-1;Fi+=1)ji.push("null");ji.push(xn[Gn].value),xn[Gn].value="["+ji.join(" ")+"]"}}ce("<<");for(var pi=0;pi<xn.length;pi++)ce("/"+xn[pi].key+" "+xn[pi].value);ce(">>"),fn.data.length!==0&&(ce("stream"),ce(sn(fn.data)),ce("endstream"))},ke=b.__private__.putPage=function(N){var Z=N.number,_e=N.data,Ie=N.objId,et=N.contentsObjId;Pe(Ie,!0),ce("<</Type /Page"),ce("/Parent "+N.rootDictionaryObjId+" 0 R"),ce("/Resources "+N.resourceDictionaryObjId+" 0 R"),ce("/MediaBox ["+parseFloat(R(N.mediaBox.bottomLeftX))+" "+parseFloat(R(N.mediaBox.bottomLeftY))+" "+R(N.mediaBox.topRightX)+" "+R(N.mediaBox.topRightY)+"]"),N.cropBox!==null&&ce("/CropBox ["+R(N.cropBox.bottomLeftX)+" "+R(N.cropBox.bottomLeftY)+" "+R(N.cropBox.topRightX)+" "+R(N.cropBox.topRightY)+"]"),N.bleedBox!==null&&ce("/BleedBox ["+R(N.bleedBox.bottomLeftX)+" "+R(N.bleedBox.bottomLeftY)+" "+R(N.bleedBox.topRightX)+" "+R(N.bleedBox.topRightY)+"]"),N.trimBox!==null&&ce("/TrimBox ["+R(N.trimBox.bottomLeftX)+" "+R(N.trimBox.bottomLeftY)+" "+R(N.trimBox.topRightX)+" "+R(N.trimBox.topRightY)+"]"),N.artBox!==null&&ce("/ArtBox ["+R(N.artBox.bottomLeftX)+" "+R(N.artBox.bottomLeftY)+" "+R(N.artBox.topRightX)+" "+R(N.artBox.topRightY)+"]"),typeof N.userUnit=="number"&&N.userUnit!==1&&ce("/UserUnit "+N.userUnit),Qt.publish("putPage",{objId:Ie,pageContext:Ut[Z],pageNumber:Z,page:_e}),ce("/Contents "+et+" 0 R"),ce(">>"),ce("endobj");var Mt=_e.join(`
`);return K===G&&(Mt+=`
Q`),Pe(et,!0),yt({data:Mt,filters:St(),objectId:et}),ce("endobj"),Ie},pt=b.__private__.putPages=function(){var N,Z,_e=[];for(N=1;N<=Dt;N++)Ut[N].objId=Re(),Ut[N].contentsObjId=Re();for(N=1;N<=Dt;N++)_e.push(ke({number:N,data:Fe[N],objId:Ut[N].objId,contentsObjId:Ut[N].contentsObjId,mediaBox:Ut[N].mediaBox,cropBox:Ut[N].cropBox,bleedBox:Ut[N].bleedBox,trimBox:Ut[N].trimBox,artBox:Ut[N].artBox,userUnit:Ut[N].userUnit,rootDictionaryObjId:rt,resourceDictionaryObjId:Nt}));Pe(rt,!0),ce("<</Type /Pages");var Ie="/Kids [";for(Z=0;Z<Dt;Z++)Ie+=_e[Z]+" 0 R ";ce(Ie+"]"),ce("/Count "+Dt),ce(">>"),ce("endobj"),Qt.publish("postPutPages")},Lt=function(N){Qt.publish("putFont",{font:N,out:ce,newObject:Le,putStream:yt}),N.isAlreadyPutted!==!0&&(N.objectNumber=Le(),ce("<<"),ce("/Type /Font"),ce("/BaseFont /"+ch(N.postScriptName)),ce("/Subtype /Type1"),typeof N.encoding=="string"&&ce("/Encoding /"+N.encoding),ce("/FirstChar 32"),ce("/LastChar 255"),ce(">>"),ce("endobj"))},Yt=function(N){N.objectNumber=Le();var Z=[];Z.push({key:"Type",value:"/XObject"}),Z.push({key:"Subtype",value:"/Form"}),Z.push({key:"BBox",value:"["+[R(N.x),R(N.y),R(N.x+N.width),R(N.y+N.height)].join(" ")+"]"}),Z.push({key:"Matrix",value:"["+N.matrix.toString()+"]"});var _e=N.pages[1].join(`
`);yt({data:_e,additionalKeyValues:Z,objectId:N.objectNumber}),ce("endobj")},Vt=function(N,Z){Z||(Z=21);var _e=Le(),Ie=(function(Wt,sn){var fn,xn=[],An=1/(sn-1);for(fn=0;fn<1;fn+=An)xn.push(fn);if(xn.push(1),Wt[0].offset!=0){var Gn={offset:0,color:Wt[0].color};Wt.unshift(Gn)}if(Wt[Wt.length-1].offset!=1){var ji={offset:1,color:Wt[Wt.length-1].color};Wt.push(ji)}for(var Fi="",pi=0,Xi=0;Xi<xn.length;Xi++){for(fn=xn[Xi];fn>Wt[pi+1].offset;)pi++;var Si=Wt[pi].offset,_s=(fn-Si)/(Wt[pi+1].offset-Si),mr=Wt[pi].color,Mr=Wt[pi+1].color;Fi+=X(Math.round((1-_s)*mr[0]+_s*Mr[0]).toString(16))+X(Math.round((1-_s)*mr[1]+_s*Mr[1]).toString(16))+X(Math.round((1-_s)*mr[2]+_s*Mr[2]).toString(16))}return Fi.trim()})(N.colors,Z),et=[];et.push({key:"FunctionType",value:"0"}),et.push({key:"Domain",value:"[0.0 1.0]"}),et.push({key:"Size",value:"["+Z+"]"}),et.push({key:"BitsPerSample",value:"8"}),et.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),et.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),yt({data:Ie,additionalKeyValues:et,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:_e}),ce("endobj"),N.objectNumber=Le(),ce("<< /ShadingType "+N.type),ce("/ColorSpace /DeviceRGB");var Mt="/Coords ["+R(parseFloat(N.coords[0]))+" "+R(parseFloat(N.coords[1]))+" ";N.type===2?Mt+=R(parseFloat(N.coords[2]))+" "+R(parseFloat(N.coords[3])):Mt+=R(parseFloat(N.coords[2]))+" "+R(parseFloat(N.coords[3]))+" "+R(parseFloat(N.coords[4]))+" "+R(parseFloat(N.coords[5])),ce(Mt+="]"),N.matrix&&ce("/Matrix ["+N.matrix.toString()+"]"),ce("/Function "+_e+" 0 R"),ce("/Extend [true true]"),ce(">>"),ce("endobj")},nn=function(N,Z){var _e=Re(),Ie=Le();Z.push({resourcesOid:_e,objectOid:Ie}),N.objectNumber=Ie;var et=[];et.push({key:"Type",value:"/Pattern"}),et.push({key:"PatternType",value:"1"}),et.push({key:"PaintType",value:"1"}),et.push({key:"TilingType",value:"1"}),et.push({key:"BBox",value:"["+N.boundingBox.map(R).join(" ")+"]"}),et.push({key:"XStep",value:R(N.xStep)}),et.push({key:"YStep",value:R(N.yStep)}),et.push({key:"Resources",value:_e+" 0 R"}),N.matrix&&et.push({key:"Matrix",value:"["+N.matrix.toString()+"]"}),yt({data:N.stream,additionalKeyValues:et,objectId:N.objectNumber}),ce("endobj")},yn=function(N){for(var Z in N.objectNumber=Le(),ce("<<"),N)switch(Z){case"opacity":ce("/ca "+E(N[Z]));break;case"stroke-opacity":ce("/CA "+E(N[Z]))}ce(">>"),ce("endobj")},en=function(N){Pe(N.resourcesOid,!0),ce("<<"),ce("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Z in ce("/Font <<"),Ze)Ze.hasOwnProperty(Z)&&(v===!1||v===!0&&_.hasOwnProperty(Z))&&ce("/"+Z+" "+Ze[Z].objectNumber+" 0 R");ce(">>")})(),(function(){if(Object.keys(Tt).length>0){for(var Z in ce("/Shading <<"),Tt)Tt.hasOwnProperty(Z)&&Tt[Z]instanceof Ju&&Tt[Z].objectNumber>=0&&ce("/"+Z+" "+Tt[Z].objectNumber+" 0 R");Qt.publish("putShadingPatternDict"),ce(">>")}})(),(function(Z){if(Object.keys(Tt).length>0){for(var _e in ce("/Pattern <<"),Tt)Tt.hasOwnProperty(_e)&&Tt[_e]instanceof b.TilingPattern&&Tt[_e].objectNumber>=0&&Tt[_e].objectNumber<Z&&ce("/"+_e+" "+Tt[_e].objectNumber+" 0 R");Qt.publish("putTilingPatternDict"),ce(">>")}})(N.objectOid),(function(){if(Object.keys(gt).length>0){var Z;for(Z in ce("/ExtGState <<"),gt)gt.hasOwnProperty(Z)&&gt[Z].objectNumber>=0&&ce("/"+Z+" "+gt[Z].objectNumber+" 0 R");Qt.publish("putGStateDict"),ce(">>")}})(),(function(){for(var Z in ce("/XObject <<"),on)on.hasOwnProperty(Z)&&on[Z].objectNumber>=0&&ce("/"+Z+" "+on[Z].objectNumber+" 0 R");Qt.publish("putXobjectDict"),ce(">>")})(),ce(">>"),ce("endobj")},wn=function(N){Je[N.fontName]=Je[N.fontName]||{},Je[N.fontName][N.fontStyle]=N.id},In=function(N,Z,_e,Ie,et){var Mt={id:"F"+(Object.keys(Ze).length+1).toString(10),postScriptName:N,fontName:Z,fontStyle:_e,encoding:Ie,isStandardFont:et||!1,metadata:{}};return Qt.publish("addFont",{font:Mt,instance:this}),Ze[Mt.id]=Mt,wn(Mt),Mt.id},Tn=b.__private__.pdfEscape=b.pdfEscape=function(N,Z){return(function(_e,Ie){var et,Mt,Wt,sn,fn,xn,An,Gn,ji;if(Wt=(Ie=Ie||{}).sourceEncoding||"Unicode",fn=Ie.outputEncoding,(Ie.autoencode||fn)&&Ze[Ue].metadata&&Ze[Ue].metadata[Wt]&&Ze[Ue].metadata[Wt].encoding&&(sn=Ze[Ue].metadata[Wt].encoding,!fn&&Ze[Ue].encoding&&(fn=Ze[Ue].encoding),!fn&&sn.codePages&&(fn=sn.codePages[0]),typeof fn=="string"&&(fn=sn[fn]),fn)){for(An=!1,xn=[],et=0,Mt=_e.length;et<Mt;et++)(Gn=fn[_e.charCodeAt(et)])?xn.push(String.fromCharCode(Gn)):xn.push(_e[et]),xn[et].charCodeAt(0)>>8&&(An=!0);_e=xn.join("")}for(et=_e.length;An===void 0&&et!==0;)_e.charCodeAt(et-1)>>8&&(An=!0),et--;if(!An)return _e;for(xn=Ie.noBOM?[]:[254,255],et=0,Mt=_e.length;et<Mt;et++){if((ji=(Gn=_e.charCodeAt(et))>>8)>>8)throw new Error("Character at position "+et+" of string '"+_e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");xn.push(ji),xn.push(Gn-(ji<<8))}return String.fromCharCode.apply(void 0,xn)})(N,Z).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Vn=b.__private__.beginPage=function(N){Fe[++Dt]=[],Ut[Dt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(N[0]),topRightY:Number(N[1])}},fs(Dt),Ce(Fe[U])},Ei=function(N,Z){var _e,Ie,et;switch(t=Z||t,typeof N=="string"&&(_e=I(N.toLowerCase()),Array.isArray(_e)&&(Ie=_e[0],et=_e[1])),Array.isArray(N)&&(Ie=N[0]*Xe,et=N[1]*Xe),isNaN(Ie)&&(Ie=s[0],et=s[1]),(Ie>14400||et>14400)&&(zi.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ie=Math.min(14400,Ie),et=Math.min(14400,et)),s=[Ie,et],t.substr(0,1)){case"l":et>Ie&&(s=[et,Ie]);break;case"p":Ie>et&&(s=[et,Ie])}Vn(s),Io(mi),ce(Uo),li!==0&&ce(li+" J"),Gr!==0&&ce(Gr+" j"),Qt.publish("addPage",{pageNumber:Dt})},ts=function(N){N>0&&N<=Dt&&(Fe.splice(N,1),Ut.splice(N,1),Dt--,U>Dt&&(U=Dt),this.setPage(U))},fs=function(N){N>0&&N<=Dt&&(U=N)},Mo=b.__private__.getNumberOfPages=b.getNumberOfPages=function(){return Fe.length-1},Lr=function(N,Z,_e){var Ie,et=void 0;return _e=_e||{},N=N!==void 0?N:Ze[Ue].fontName,Z=Z!==void 0?Z:Ze[Ue].fontStyle,Ie=N.toLowerCase(),Je[Ie]!==void 0&&Je[Ie][Z]!==void 0?et=Je[Ie][Z]:Je[N]!==void 0&&Je[N][Z]!==void 0?et=Je[N][Z]:_e.disableWarning===!1&&zi.warn("Unable to look up font label for font '"+N+"', '"+Z+"'. Refer to getFontList() for available fonts."),et||_e.noFallback||(et=Je.times[Z])==null&&(et=Je.times.normal),et},Ar=b.__private__.putInfo=function(){var N=Le(),Z=function(Ie){return Ie};for(var _e in p!==null&&(Z=$n.encryptor(N,0)),ce("<<"),ce("/Producer ("+Tn(Z("jsPDF "+vn.version))+")"),qe)qe.hasOwnProperty(_e)&&qe[_e]&&ce("/"+_e.substr(0,1).toUpperCase()+_e.substr(1)+" ("+Tn(Z(qe[_e]))+")");ce("/CreationDate ("+Tn(Z(ie))+")"),ce(">>"),ce("endobj")},Vs=b.__private__.putCatalog=function(N){var Z=(N=N||{}).rootDictionaryObjId||rt;switch(Le(),ce("<<"),ce("/Type /Catalog"),ce("/Pages "+Z+" 0 R"),tt||(tt="fullwidth"),tt){case"fullwidth":ce("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ce("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ce("/OpenAction [3 0 R /Fit]");break;case"original":ce("/OpenAction [3 0 R /XYZ null null 1]");break;default:var _e=""+tt;_e.substr(_e.length-1)==="%"&&(tt=parseInt(tt)/100),typeof tt=="number"&&ce("/OpenAction [3 0 R /XYZ null null "+E(tt)+"]")}switch(Se||(Se="continuous"),Se){case"continuous":ce("/PageLayout /OneColumn");break;case"single":ce("/PageLayout /SinglePage");break;case"two":case"twoleft":ce("/PageLayout /TwoColumnLeft");break;case"tworight":ce("/PageLayout /TwoColumnRight")}pe&&ce("/PageMode /"+pe),Qt.publish("putCatalog"),ce(">>"),ce("endobj")},Yn=b.__private__.putTrailer=function(){ce("trailer"),ce("<<"),ce("/Size "+(Q+1)),ce("/Root "+Q+" 0 R"),ce("/Info "+(Q-1)+" 0 R"),p!==null&&ce("/Encrypt "+$n.oid+" 0 R"),ce("/ID [ <"+q+"> <"+q+"> ]"),ce(">>")},ai=b.__private__.putHeader=function(){ce("%PDF-"+T),ce("%ºß¬à")},tl=b.__private__.putXRef=function(){var N="0000000000";ce("xref"),ce("0 "+(Q+1)),ce("0000000000 65535 f ");for(var Z=1;Z<=Q;Z++)typeof ye[Z]=="function"?ce((N+ye[Z]()).slice(-10)+" 00000 n "):ye[Z]!==void 0?ce((N+ye[Z]).slice(-10)+" 00000 n "):ce("0000000000 00000 n ")},no=b.__private__.buildDocument=function(){var N;Q=0,De=0,Ae=[],ye=[],Be=[],rt=Re(),Nt=Re(),Ce(Ae),Qt.publish("buildDocument"),ai(),pt(),(function(){Qt.publish("putAdditionalObjects");for(var _e=0;_e<Be.length;_e++){var Ie=Be[_e];Pe(Ie.objId,!0),ce(Ie.content),ce("endobj")}Qt.publish("postPutAdditionalObjects")})(),N=[],(function(){for(var _e in Ze)Ze.hasOwnProperty(_e)&&(v===!1||v===!0&&_.hasOwnProperty(_e))&&Lt(Ze[_e])})(),(function(){var _e;for(_e in gt)gt.hasOwnProperty(_e)&&yn(gt[_e])})(),(function(){for(var _e in on)on.hasOwnProperty(_e)&&Yt(on[_e])})(),(function(_e){var Ie;for(Ie in Tt)Tt.hasOwnProperty(Ie)&&(Tt[Ie]instanceof Ju?Vt(Tt[Ie]):Tt[Ie]instanceof hh&&nn(Tt[Ie],_e))})(N),Qt.publish("putResources"),N.forEach(en),en({resourcesOid:Nt,objectOid:Number.MAX_SAFE_INTEGER}),Qt.publish("postPutResources"),p!==null&&($n.oid=Le(),ce("<<"),ce("/Filter /Standard"),ce("/V "+$n.v),ce("/R "+$n.r),ce("/U <"+$n.toHexString($n.U)+">"),ce("/O <"+$n.toHexString($n.O)+">"),ce("/P "+$n.P),ce(">>"),ce("endobj")),Ar(),Vs();var Z=De;return tl(),Yn(),ce("startxref"),ce(""+Z),ce("%%EOF"),Ce(Fe[U]),Ae.join(`
`)},Ro=b.__private__.getBlob=function(N){return new Blob([Ne(N)],{type:"application/pdf"})},ns=b.output=b.__private__.output=(He=function(N,Z){switch(typeof(Z=Z||{})=="string"?Z={filename:Z}:Z.filename=Z.filename||"generated.pdf",N){case void 0:return no();case"save":b.save(Z.filename);break;case"arraybuffer":return Ne(no());case"blob":return Ro(no());case"bloburi":case"bloburl":if(Rn.URL!==void 0&&typeof Rn.URL.createObjectURL=="function")return Rn.URL&&Rn.URL.createObjectURL(Ro(no()))||void 0;zi.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var _e="",Ie=no();try{_e=KN(Ie)}catch{_e=KN(unescape(encodeURIComponent(Ie)))}return"data:application/pdf;filename="+Z.filename+";base64,"+_e;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Rn)==="[object Window]"){var et="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Mt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Z.pdfObjectUrl&&(et=Z.pdfObjectUrl,Mt="");var Wt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+et+'"'+Mt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Z)+");<\/script></body></html>",sn=Rn.open();return sn!==null&&sn.document.write(Wt),sn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Rn)==="[object Window]"){var fn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Z.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Z.filename+'" width="500px" height="400px" /></body></html>',xn=Rn.open();if(xn!==null){xn.document.write(fn);var An=this;xn.document.documentElement.querySelector("#pdfViewer").onload=function(){xn.document.title=Z.filename,xn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(An.output("bloburl"))}}return xn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Rn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Gn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Z)+'"></iframe></body></html>',ji=Rn.open();if(ji!==null&&(ji.document.write(Gn),ji.document.title=Z.filename),ji||typeof safari>"u")return ji;break;case"datauri":case"dataurl":return Rn.document.location.href=this.output("datauristring",Z);default:return null}},He.foo=function(){try{return He.apply(this,arguments)}catch(_e){var N=_e.stack||"";~N.indexOf(" at ")&&(N=N.split(" at ")[1]);var Z="Error in function "+N.split(`
`)[0].split("<")[0]+": "+_e.message;if(!Rn.console)throw new Error(Z);Rn.console.error(Z,_e),Rn.alert&&alert(Z)}},He.foo.bar=He,He.foo),dr=function(N){return Array.isArray(an)===!0&&an.indexOf(N)>-1};switch(i){case"pt":Xe=1;break;case"mm":Xe=72/25.4;break;case"cm":Xe=72/2.54;break;case"in":Xe=72;break;case"px":Xe=dr("px_scaling")==1?.75:96/72;break;case"pc":case"em":Xe=12;break;case"ex":Xe=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);Xe=i}var $n=null;te(),V();var ks=b.__private__.getPageInfo=b.getPageInfo=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ut[N].objId,pageNumber:N,pageContext:Ut[N]}},Dr=b.__private__.getPageInfoByObjId=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Z in Ut)if(Ut[Z].objId===N)break;return ks(Z)},Or=b.__private__.getCurrentPageInfo=b.getCurrentPageInfo=function(){return{objId:Ut[U].objId,pageNumber:U,pageContext:Ut[U]}};b.addPage=function(){return Ei.apply(this,arguments),this},b.setPage=function(){return fs.apply(this,arguments),Ce.call(this,Fe[U]),this},b.insertPage=function(N){return this.addPage(),this.movePage(U,N),this},b.movePage=function(N,Z){var _e,Ie;if(N>Z){_e=Fe[N],Ie=Ut[N];for(var et=N;et>Z;et--)Fe[et]=Fe[et-1],Ut[et]=Ut[et-1];Fe[Z]=_e,Ut[Z]=Ie,this.setPage(Z)}else if(N<Z){_e=Fe[N],Ie=Ut[N];for(var Mt=N;Mt<Z;Mt++)Fe[Mt]=Fe[Mt+1],Ut[Mt]=Ut[Mt+1];Fe[Z]=_e,Ut[Z]=Ie,this.setPage(Z)}return this},b.deletePage=function(){return ts.apply(this,arguments),this},b.__private__.text=b.text=function(N,Z,_e,Ie,et){var Mt,Wt,sn,fn,xn,An,Gn,ji,Fi,pi=(Ie=Ie||{}).scope||this;if(typeof N=="number"&&typeof Z=="number"&&(typeof _e=="string"||Array.isArray(_e))){var Xi=_e;_e=Z,Z=N,N=Xi}if(arguments[3]instanceof Te==0?(sn=arguments[4],fn=arguments[5],Di(Gn=arguments[3])==="object"&&Gn!==null||(typeof sn=="string"&&(fn=sn,sn=null),typeof Gn=="string"&&(fn=Gn,Gn=null),typeof Gn=="number"&&(sn=Gn,Gn=null),Ie={flags:Gn,angle:sn,align:fn})):(D("The transform parameter of text() with a Matrix value"),Fi=et),isNaN(Z)||isNaN(_e)||N==null)throw new Error("Invalid arguments passed to jsPDF.text");if(N.length===0)return pi;var Si,_s="",mr=typeof Ie.lineHeightFactor=="number"?Ie.lineHeightFactor:Fn,Mr=pi.internal.scaleFactor;function gc(gi){return gi=gi.split("	").join(Array(Ie.TabLen||9).join(" ")),Tn(gi,Gn)}function Gs(gi){for(var Ni,$i=gi.concat(),Qi=[],sa=$i.length;sa--;)typeof(Ni=$i.shift())=="string"?Qi.push(Ni):Array.isArray(gi)&&(Ni.length===1||Ni[1]===void 0&&Ni[2]===void 0)?Qi.push(Ni[0]):Qi.push([Ni[0],Ni[1],Ni[2]]);return Qi}function Qr(gi,Ni){var $i;if(typeof gi=="string")$i=Ni(gi)[0];else if(Array.isArray(gi)){for(var Qi,sa,yr=gi.concat(),No=[],Ol=yr.length;Ol--;)typeof(Qi=yr.shift())=="string"?No.push(Ni(Qi)[0]):Array.isArray(Qi)&&typeof Qi[0]=="string"&&(sa=Ni(Qi[0],Qi[1],Qi[2]),No.push([sa[0],sa[1],sa[2]]));$i=No}return $i}var $o=!1,pr=!0;if(typeof N=="string")$o=!0;else if(Array.isArray(N)){var y=N.concat();Wt=[];for(var L,B=y.length;B--;)(typeof(L=y.shift())!="string"||Array.isArray(L)&&typeof L[0]!="string")&&(pr=!1);$o=pr}if($o===!1)throw new Error('Type of text must be string or Array. "'+N+'" is not recognized.');typeof N=="string"&&(N=N.match(/[\r?\n]/)?N.split(/\r\n|\r|\n/g):[N]);var he=We/pi.internal.scaleFactor,it=he*(mr-1);switch(Ie.baseline){case"bottom":_e-=it;break;case"top":_e+=he-it;break;case"hanging":_e+=he-2*it;break;case"middle":_e+=he/2-it}if((An=Ie.maxWidth||0)>0&&(typeof N=="string"?N=pi.splitTextToSize(N,An):Object.prototype.toString.call(N)==="[object Array]"&&(N=N.reduce(function(gi,Ni){return gi.concat(pi.splitTextToSize(Ni,An))},[]))),Mt={text:N,x:Z,y:_e,options:Ie,mutex:{pdfEscape:Tn,activeFontKey:Ue,fonts:Ze,activeFontSize:We}},Qt.publish("preProcessText",Mt),N=Mt.text,sn=(Ie=Mt.options).angle,Fi instanceof Te==0&&sn&&typeof sn=="number"){sn*=Math.PI/180,Ie.rotationDirection===0&&(sn=-sn),K===G&&(sn=-sn);var Et=Math.cos(sn),Gt=Math.sin(sn);Fi=new Te(Et,Gt,-Gt,Et,0,0)}else sn&&sn instanceof Te&&(Fi=sn);K!==G||Fi||(Fi=dt),(xn=Ie.charSpace||Yr)!==void 0&&(_s+=R(M(xn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ji=Ie.horizontalScale)!==void 0&&(_s+=R(100*ji)+` Tz
`),Ie.lang;var Pn=-1,Ti=Ie.renderingMode!==void 0?Ie.renderingMode:Ie.stroke,Hn=pi.internal.getCurrentPageInfo().pageContext;switch(Ti){case 0:case!1:case"fill":Pn=0;break;case 1:case!0:case"stroke":Pn=1;break;case 2:case"fillThenStroke":Pn=2;break;case 3:case"invisible":Pn=3;break;case 4:case"fillAndAddForClipping":Pn=4;break;case 5:case"strokeAndAddPathForClipping":Pn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Pn=6;break;case 7:case"addToPathForClipping":Pn=7}var ms=Hn.usedRenderingMode!==void 0?Hn.usedRenderingMode:-1;Pn!==-1?_s+=Pn+` Tr
`:ms!==-1&&(_s+=`0 Tr
`),Pn!==-1&&(Hn.usedRenderingMode=Pn),fn=Ie.align||"left";var Xn,xs=We*mr,$s=pi.internal.pageSize.getWidth(),Bo=Ze[Ue];xn=Ie.charSpace||Yr,An=Ie.maxWidth||0,Gn=Object.assign({autoencode:!0,noBOM:!0},Ie.flags);var lo=[],yc=function(gi){return pi.getStringUnitWidth(gi,{font:Bo,charSpace:xn,fontSize:We,doKerning:!1})*We/Mr};if(Object.prototype.toString.call(N)==="[object Array]"){var Ks;Wt=Gs(N),fn!=="left"&&(Xn=Wt.map(yc));var xo,il=0;if(fn==="right"){Z-=Xn[0],N=[],B=Wt.length;for(var gr=0;gr<B;gr++)gr===0?(xo=os(Z),Ks=Ys(_e)):(xo=M(il-Xn[gr]),Ks=-xs),N.push([Wt[gr],xo,Ks]),il=Xn[gr]}else if(fn==="center"){Z-=Xn[0]/2,N=[],B=Wt.length;for(var Zr=0;Zr<B;Zr++)Zr===0?(xo=os(Z),Ks=Ys(_e)):(xo=M((il-Xn[Zr])/2),Ks=-xs),N.push([Wt[Zr],xo,Ks]),il=Xn[Zr]}else if(fn==="left"){N=[],B=Wt.length;for(var vc=0;vc<B;vc++)N.push(Wt[vc])}else if(fn==="justify"&&Bo.encoding==="Identity-H"){N=[],B=Wt.length,An=An!==0?An:$s;for(var Ta=0,rs=0;rs<B;rs++)if(Ks=rs===0?Ys(_e):-xs,xo=rs===0?os(Z):Ta,rs<B-1){var qh=M((An-Xn[rs])/(Wt[rs].split(" ").length-1)),Jr=Wt[rs].split(" ");N.push([Jr[0]+" ",xo,Ks]),Ta=0;for(var ea=1;ea<Jr.length;ea++){var bc=(yc(Jr[ea-1]+" "+Jr[ea])-yc(Jr[ea]))*Mr+qh;ea==Jr.length-1?N.push([Jr[ea],bc,0]):N.push([Jr[ea]+" ",bc,0]),Ta-=bc}}else N.push([Wt[rs],xo,Ks]);N.push(["",Ta,0])}else{if(fn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(N=[],B=Wt.length,An=An!==0?An:$s,rs=0;rs<B;rs++)Ks=rs===0?Ys(_e):-xs,xo=rs===0?os(Z):0,rs<B-1?lo.push(R(M((An-Xn[rs])/(Wt[rs].split(" ").length-1)))):lo.push(0),N.push([Wt[rs],xo,Ks])}}(typeof Ie.R2L=="boolean"?Ie.R2L:$e)===!0&&(N=Qr(N,function(gi,Ni,$i){return[gi.split("").reverse().join(""),Ni,$i]})),Mt={text:N,x:Z,y:_e,options:Ie,mutex:{pdfEscape:Tn,activeFontKey:Ue,fonts:Ze,activeFontSize:We}},Qt.publish("postProcessText",Mt),N=Mt.text,Si=Mt.mutex.isHex||!1;var xu=Ze[Ue].encoding;xu!=="WinAnsiEncoding"&&xu!=="StandardEncoding"||(N=Qr(N,function(gi,Ni,$i){return[gc(gi),Ni,$i]})),Wt=Gs(N),N=[];for(var Bs,ta,sl,ol=Array.isArray(Wt[0])?1:0,na="",wc=function(gi,Ni,$i){var Qi="";return $i instanceof Te?($i=typeof Ie.angle=="number"?Qe($i,new Te(1,0,0,1,gi,Ni)):Qe(new Te(1,0,0,1,gi,Ni),$i),K===G&&($i=Qe(new Te(1,0,0,-1,0,0),$i)),Qi=$i.join(" ")+` Tm
`):Qi=R(gi)+" "+R(Ni)+` Td
`,Qi},So=0;So<Wt.length;So++){switch(na="",ol){case 1:sl=(Si?"<":"(")+Wt[So][0]+(Si?">":")"),Bs=parseFloat(Wt[So][1]),ta=parseFloat(Wt[So][2]);break;case 0:sl=(Si?"<":"(")+Wt[So]+(Si?">":")"),Bs=os(Z),ta=Ys(_e)}lo!==void 0&&lo[So]!==void 0&&(na=lo[So]+` Tw
`),So===0?N.push(na+wc(Bs,ta,Fi)+sl):ol===0?N.push(na+sl):ol===1&&N.push(na+wc(Bs,ta,Fi)+sl)}N=ol===0?N.join(` Tj
T* `):N.join(` Tj
`),N+=` Tj
`;var ia=`BT
/`;return ia+=Ue+" "+We+` Tf
`,ia+=R(We*mr)+` TL
`,ia+=oo+`
`,ia+=_s,ia+=N,ce(ia+="ET"),_[Ue]=!0,pi};var Qo=b.__private__.clip=b.clip=function(N){return ce(N==="evenodd"?"W*":"W"),this};b.clipEvenOdd=function(){return Qo("evenodd")},b.__private__.discardPath=b.discardPath=function(){return ce("n"),this};var zn=b.__private__.isValidStyle=function(N){var Z=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(N)!==-1&&(Z=!0),Z};b.__private__.setDefaultPathOperation=b.setDefaultPathOperation=function(N){return zn(N)&&(f=N),this};var hr=b.__private__.getStyle=b.getStyle=function(N){var Z=f;switch(N){case"D":case"S":Z="S";break;case"F":Z="f";break;case"FD":case"DF":Z="B";break;case"f":case"f*":case"B":case"B*":Z=N}return Z},io=b.close=function(){return ce("h"),this};b.stroke=function(){return ce("S"),this},b.fill=function(N){return so("f",N),this},b.fillEvenOdd=function(N){return so("f*",N),this},b.fillStroke=function(N){return so("B",N),this},b.fillStrokeEvenOdd=function(N){return so("B*",N),this};var so=function(N,Z){Di(Z)==="object"?Ui(Z,N):ce(N)},Ht=function(N){N===null||K===G&&N===void 0||(N=hr(N),ce(N))};function _n(N,Z,_e,Ie,et){var Mt=new hh(Z||this.boundingBox,_e||this.xStep,Ie||this.yStep,this.gState,et||this.matrix);Mt.stream=this.stream;var Wt=N+"$$"+this.cloneIndex+++"$$";return ve(Wt,Mt),Mt}var Ui=function(N,Z){var _e=It[N.key],Ie=Tt[_e];if(Ie instanceof Ju)ce("q"),ce(is(Z)),Ie.gState&&b.setGState(Ie.gState),ce(N.matrix.toString()+" cm"),ce("/"+_e+" sh"),ce("Q");else if(Ie instanceof hh){var et=new Te(1,0,0,-1,0,_o());N.matrix&&(et=et.multiply(N.matrix||dt),_e=_n.call(Ie,N.key,N.boundingBox,N.xStep,N.yStep,et).id),ce("q"),ce("/Pattern cs"),ce("/"+_e+" scn"),Ie.gState&&b.setGState(Ie.gState),ce(Z),ce("Q")}},is=function(N){switch(N){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},qi=b.moveTo=function(N,Z){return ce(R(M(N))+" "+R(Y(Z))+" m"),this},ss=b.lineTo=function(N,Z){return ce(R(M(N))+" "+R(Y(Z))+" l"),this},Vi=b.curveTo=function(N,Z,_e,Ie,et,Mt){return ce([R(M(N)),R(Y(Z)),R(M(_e)),R(Y(Ie)),R(M(et)),R(Y(Mt)),"c"].join(" ")),this};b.__private__.line=b.line=function(N,Z,_e,Ie,et){if(isNaN(N)||isNaN(Z)||isNaN(_e)||isNaN(Ie)||!zn(et))throw new Error("Invalid arguments passed to jsPDF.line");return K===ee?this.lines([[_e-N,Ie-Z]],N,Z,[1,1],et||"S"):this.lines([[_e-N,Ie-Z]],N,Z,[1,1]).stroke()},b.__private__.lines=b.lines=function(N,Z,_e,Ie,et,Mt){var Wt,sn,fn,xn,An,Gn,ji,Fi,pi,Xi,Si,_s;if(typeof N=="number"&&(_s=_e,_e=Z,Z=N,N=_s),Ie=Ie||[1,1],Mt=Mt||!1,isNaN(Z)||isNaN(_e)||!Array.isArray(N)||!Array.isArray(Ie)||!zn(et)||typeof Mt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(qi(Z,_e),Wt=Ie[0],sn=Ie[1],xn=N.length,Xi=Z,Si=_e,fn=0;fn<xn;fn++)(An=N[fn]).length===2?(Xi=An[0]*Wt+Xi,Si=An[1]*sn+Si,ss(Xi,Si)):(Gn=An[0]*Wt+Xi,ji=An[1]*sn+Si,Fi=An[2]*Wt+Xi,pi=An[3]*sn+Si,Xi=An[4]*Wt+Xi,Si=An[5]*sn+Si,Vi(Gn,ji,Fi,pi,Xi,Si));return Mt&&io(),Ht(et),this},b.path=function(N){for(var Z=0;Z<N.length;Z++){var _e=N[Z],Ie=_e.c;switch(_e.op){case"m":qi(Ie[0],Ie[1]);break;case"l":ss(Ie[0],Ie[1]);break;case"c":Vi.apply(this,Ie);break;case"h":io()}}return this},b.__private__.rect=b.rect=function(N,Z,_e,Ie,et){if(isNaN(N)||isNaN(Z)||isNaN(_e)||isNaN(Ie)||!zn(et))throw new Error("Invalid arguments passed to jsPDF.rect");return K===ee&&(Ie=-Ie),ce([R(M(N)),R(Y(Z)),R(M(_e)),R(M(Ie)),"re"].join(" ")),Ht(et),this},b.__private__.triangle=b.triangle=function(N,Z,_e,Ie,et,Mt,Wt){if(isNaN(N)||isNaN(Z)||isNaN(_e)||isNaN(Ie)||isNaN(et)||isNaN(Mt)||!zn(Wt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[_e-N,Ie-Z],[et-_e,Mt-Ie],[N-et,Z-Mt]],N,Z,[1,1],Wt,!0),this},b.__private__.roundedRect=b.roundedRect=function(N,Z,_e,Ie,et,Mt,Wt){if(isNaN(N)||isNaN(Z)||isNaN(_e)||isNaN(Ie)||isNaN(et)||isNaN(Mt)||!zn(Wt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var sn=4/3*(Math.SQRT2-1);return et=Math.min(et,.5*_e),Mt=Math.min(Mt,.5*Ie),this.lines([[_e-2*et,0],[et*sn,0,et,Mt-Mt*sn,et,Mt],[0,Ie-2*Mt],[0,Mt*sn,-et*sn,Mt,-et,Mt],[2*et-_e,0],[-et*sn,0,-et,-Mt*sn,-et,-Mt],[0,2*Mt-Ie],[0,-Mt*sn,et*sn,-Mt,et,-Mt]],N+et,Z,[1,1],Wt,!0),this},b.__private__.ellipse=b.ellipse=function(N,Z,_e,Ie,et){if(isNaN(N)||isNaN(Z)||isNaN(_e)||isNaN(Ie)||!zn(et))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Mt=4/3*(Math.SQRT2-1)*_e,Wt=4/3*(Math.SQRT2-1)*Ie;return qi(N+_e,Z),Vi(N+_e,Z-Wt,N+Mt,Z-Ie,N,Z-Ie),Vi(N-Mt,Z-Ie,N-_e,Z-Wt,N-_e,Z),Vi(N-_e,Z+Wt,N-Mt,Z+Ie,N,Z+Ie),Vi(N+Mt,Z+Ie,N+_e,Z+Wt,N+_e,Z),Ht(et),this},b.__private__.circle=b.circle=function(N,Z,_e,Ie){if(isNaN(N)||isNaN(Z)||isNaN(_e)||!zn(Ie))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(N,Z,_e,_e,Ie)},b.setFont=function(N,Z,_e){return _e&&(Z=z(Z,_e)),Ue=Lr(N,Z,{disableWarning:!1}),this};var Oi=b.__private__.getFont=b.getFont=function(){return Ze[Lr.apply(b,arguments)]};b.__private__.getFontList=b.getFontList=function(){var N,Z,_e={};for(N in Je)if(Je.hasOwnProperty(N))for(Z in _e[N]=[],Je[N])Je[N].hasOwnProperty(Z)&&_e[N].push(Z);return _e},b.addFont=function(N,Z,_e,Ie,et){var Mt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Mt.indexOf(arguments[3])!==-1?et=arguments[3]:arguments[3]&&Mt.indexOf(arguments[3])==-1&&(_e=z(_e,Ie)),In.call(this,N,Z,_e,et=et||"Identity-H")};var Fn,mi=n.lineWidth||.200025,cn=b.__private__.getLineWidth=b.getLineWidth=function(){return mi},Io=b.__private__.setLineWidth=b.setLineWidth=function(N){return mi=N,ce(R(M(N))+" w"),this};b.__private__.setLineDash=vn.API.setLineDash=vn.API.setLineDashPattern=function(N,Z){if(N=N||[],Z=Z||0,isNaN(Z)||!Array.isArray(N))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return N=N.map(function(_e){return R(M(_e))}).join(" "),Z=R(M(Z)),ce("["+N+"] "+Z+" d"),this};var Po=b.__private__.getLineHeight=b.getLineHeight=function(){return We*Fn};b.__private__.getLineHeight=b.getLineHeight=function(){return We*Fn};var bs=b.__private__.setLineHeightFactor=b.setLineHeightFactor=function(N){return typeof(N=N||1.15)=="number"&&(Fn=N),this},bo=b.__private__.getLineHeightFactor=b.getLineHeightFactor=function(){return Fn};bs(n.lineHeight);var os=b.__private__.getHorizontalCoordinate=function(N){return M(N)},Ys=b.__private__.getVerticalCoordinate=function(N){return K===G?N:Ut[U].mediaBox.topRightY-Ut[U].mediaBox.bottomLeftY-M(N)},fr=b.__private__.getHorizontalCoordinateString=b.getHorizontalCoordinateString=function(N){return R(os(N))},Vr=b.__private__.getVerticalCoordinateString=b.getVerticalCoordinateString=function(N){return R(Ys(N))},Uo=n.strokeColor||"0 G";b.__private__.getStrokeColor=b.getDrawColor=function(){return xt(Uo)},b.__private__.setStrokeColor=b.setDrawColor=function(N,Z,_e,Ie){return Uo=st({ch1:N,ch2:Z,ch3:_e,ch4:Ie,pdfColorType:"draw",precision:2}),ce(Uo),this};var Ea=n.fillColor||"0 g";b.__private__.getFillColor=b.getFillColor=function(){return xt(Ea)},b.__private__.setFillColor=b.setFillColor=function(N,Z,_e,Ie){return Ea=st({ch1:N,ch2:Z,ch3:_e,ch4:Ie,pdfColorType:"fill",precision:2}),ce(Ea),this};var oo=n.textColor||"0 g",wo=b.__private__.getTextColor=b.getTextColor=function(){return xt(oo)};b.__private__.setTextColor=b.setTextColor=function(N,Z,_e,Ie){return oo=st({ch1:N,ch2:Z,ch3:_e,ch4:Ie,pdfColorType:"text",precision:3}),this};var Yr=n.charSpace,ws=b.__private__.getCharSpace=b.getCharSpace=function(){return parseFloat(Yr||0)};b.__private__.setCharSpace=b.setCharSpace=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Yr=N,this};var li=0;b.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},b.__private__.setLineCap=b.setLineCap=function(N){var Z=b.CapJoinStyles[N];if(Z===void 0)throw new Error("Line cap style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return li=Z,ce(Z+" J"),this};var Gr=0;b.__private__.setLineJoin=b.setLineJoin=function(N){var Z=b.CapJoinStyles[N];if(Z===void 0)throw new Error("Line join style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Gr=Z,ce(Z+" j"),this},b.__private__.setLineMiterLimit=b.__private__.setMiterLimit=b.setLineMiterLimit=b.setMiterLimit=function(N){if(N=N||0,isNaN(N))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ce(R(M(N))+" M"),this},b.GState=I0,b.setGState=function(N){(N=typeof N=="string"?gt[tn[N]]:Zo(null,N)).equals(Zt)||(ce("/"+N.id+" gs"),Zt=N)};var Zo=function(N,Z){if(!N||!tn[N]){var _e=!1;for(var Ie in gt)if(gt.hasOwnProperty(Ie)&&gt[Ie].equals(Z)){_e=!0;break}if(_e)Z=gt[Ie];else{var et="GS"+(Object.keys(gt).length+1).toString(10);gt[et]=Z,Z.id=et}return N&&(tn[N]=Z.id),Qt.publish("addGState",Z),Z}};b.addGState=function(N,Z){return Zo(N,Z),this},b.saveGraphicsState=function(){return ce("q"),mt.push({key:Ue,size:We,color:oo}),this},b.restoreGraphicsState=function(){ce("Q");var N=mt.pop();return Ue=N.key,We=N.size,oo=N.color,Zt=null,this},b.setCurrentTransformationMatrix=function(N){return ce(N.toString()+" cm"),this},b.comment=function(N){return ce("#"+N),this};var Kr=function(N,Z){var _e=N||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return _e},set:function(Mt){isNaN(Mt)||(_e=parseFloat(Mt))}});var Ie=Z||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ie},set:function(Mt){isNaN(Mt)||(Ie=parseFloat(Mt))}});var et="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return et},set:function(Mt){et=Mt.toString()}}),this},Xr=function(N,Z,_e,Ie){Kr.call(this,N,Z),this.type="rect";var et=_e||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return et},set:function(Wt){isNaN(Wt)||(et=parseFloat(Wt))}});var Mt=Ie||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Mt},set:function(Wt){isNaN(Wt)||(Mt=parseFloat(Wt))}}),this},jr=function(){this.page=Dt,this.currentPage=U,this.pages=Fe.slice(0),this.pagesContext=Ut.slice(0),this.x=bt,this.y=qt,this.matrix=fe,this.width=ro(U),this.height=_o(U),this.outputDestination=at,this.id="",this.objectNumber=-1};jr.prototype.restore=function(){Dt=this.page,U=this.currentPage,Ut=this.pagesContext,Fe=this.pages,bt=this.x,qt=this.y,fe=this.matrix,nl(U,this.width),ao(U,this.height),at=this.outputDestination};var Fo=function(N,Z,_e,Ie,et){Sn.push(new jr),Dt=U=0,Fe=[],bt=N,qt=Z,fe=et,Vn([_e,Ie])};for(var Jo in b.beginFormObject=function(N,Z,_e,Ie,et){return Fo(N,Z,_e,Ie,et),this},b.endFormObject=function(N){return(function(Z){if(dn[Z])Sn.pop().restore();else{var _e=new jr,Ie="Xo"+(Object.keys(on).length+1).toString(10);_e.id=Ie,dn[Z]=Ie,on[Ie]=_e,Qt.publish("addFormObject",_e),Sn.pop().restore()}})(N),this},b.doFormObject=function(N,Z){var _e=on[dn[N]];return ce("q"),ce(Z.toString()+" cm"),ce("/"+_e.id+" Do"),ce("Q"),this},b.getFormObject=function(N){var Z=on[dn[N]];return{x:Z.x,y:Z.y,width:Z.width,height:Z.height,matrix:Z.matrix}},b.save=function(N,Z){return N=N||"generated.pdf",(Z=Z||{}).returnPromise=Z.returnPromise||!1,Z.returnPromise===!1?(Qu(Ro(no()),N),typeof Qu.unload=="function"&&Rn.setTimeout&&setTimeout(Qu.unload,911),this):new Promise(function(_e,Ie){try{var et=Qu(Ro(no()),N);typeof Qu.unload=="function"&&Rn.setTimeout&&setTimeout(Qu.unload,911),_e(et)}catch(Mt){Ie(Mt.message)}})},vn.API)vn.API.hasOwnProperty(Jo)&&(Jo==="events"&&vn.API.events.length?(function(N,Z){var _e,Ie,et;for(et=Z.length-1;et!==-1;et--)_e=Z[et][0],Ie=Z[et][1],N.subscribe.apply(N,[_e].concat(typeof Ie=="function"?[Ie]:Ie))})(Qt,vn.API.events):b[Jo]=vn.API[Jo]);var ro=b.getPageWidth=function(N){return(Ut[N=N||U].mediaBox.topRightX-Ut[N].mediaBox.bottomLeftX)/Xe},nl=b.setPageWidth=function(N,Z){Ut[N].mediaBox.topRightX=Z*Xe+Ut[N].mediaBox.bottomLeftX},_o=b.getPageHeight=function(N){return(Ut[N=N||U].mediaBox.topRightY-Ut[N].mediaBox.bottomLeftY)/Xe},ao=b.setPageHeight=function(N,Z){Ut[N].mediaBox.topRightY=Z*Xe+Ut[N].mediaBox.bottomLeftY};return b.internal={pdfEscape:Tn,getStyle:hr,getFont:Oi,getFontSize:lt,getCharSpace:ws,getTextColor:wo,getLineHeight:Po,getLineHeightFactor:bo,getLineWidth:cn,write:_t,getHorizontalCoordinate:os,getVerticalCoordinate:Ys,getCoordinateString:fr,getVerticalCoordinateString:Vr,collections:{},newObject:Le,newAdditionalObject:At,newObjectDeferred:Re,newObjectDeferredBegin:Pe,getFilters:St,putStream:yt,events:Qt,scaleFactor:Xe,pageSize:{getWidth:function(){return ro(U)},setWidth:function(N){nl(U,N)},getHeight:function(){return _o(U)},setHeight:function(N){ao(U,N)}},encryptionOptions:p,encryption:$n,getEncryptor:function(N){return p!==null?$n.encryptor(N,0):function(Z){return Z}},output:ns,getNumberOfPages:Mo,pages:Fe,out:ce,f2:E,f3:O,getPageInfo:ks,getPageInfoByObjId:Dr,getCurrentPageInfo:Or,getPDFVersion:C,Point:Kr,Rectangle:Xr,Matrix:Te,hasHotfix:dr},Object.defineProperty(b.internal.pageSize,"width",{get:function(){return ro(U)},set:function(N){nl(U,N)},enumerable:!0,configurable:!0}),Object.defineProperty(b.internal.pageSize,"height",{get:function(){return _o(U)},set:function(N){ao(U,N)},enumerable:!0,configurable:!0}),(function(N){for(var Z=0,_e=Ve.length;Z<_e;Z++){var Ie=In.call(this,N[Z][0],N[Z][1],N[Z][2],Ve[Z][3],!0);v===!1&&(_[Ie]=!0);var et=N[Z][0].split("-");wn({id:Ie,fontName:et[0],fontStyle:et[1]||""})}Qt.publish("addFonts",{fonts:Ze,dictionary:Je})}).call(b,Ve),Ue="F1",Ei(s,t),Qt.publish("initialized"),b}lh.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},lh.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},lh.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},lh.prototype.processOwnerPassword=function(n,e){return hv(dv(e).substr(0,5),n)},lh.prototype.encryptor=function(n,e){var t=dv(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(i){return hv(t,i)}},I0.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||Di(n)!==Di(this))return!1;var i=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;i++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&i--;return i===0},vn.API={events:[]},vn.version="3.0.2";var Es=vn.API,Wb=1,Cd=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},rh=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Bn=function(n){return n.toFixed(2)},Gc=function(n){return n.toFixed(5)};Es.__acroform__={};var kr=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},JN=function(n){return n*Wb},vl=function(n){var e=new YC,t=pn.internal.getHeight(n)||0,i=pn.internal.getWidth(n)||0;return e.BBox=[0,0,Number(Bn(i)),Number(Bn(t))],e},iW=Es.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<e},sW=Es.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<e)},oW=Es.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},Is=Es.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return oW(n,e-1)},Ps=Es.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return iW(n,e-1)},Us=Es.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return sW(n,e-1)},rW=Es.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,i=e.internal.getVerticalCoordinate,s=n[0],o=n[1],l=n[2],c=n[3],d={};return d.lowerLeft_X=t(s)||0,d.lowerLeft_Y=i(o+c)||0,d.upperRight_X=t(s+l)||0,d.upperRight_Y=i(o)||0,[Number(Bn(d.lowerLeft_X)),Number(Bn(d.lowerLeft_Y)),Number(Bn(d.upperRight_X)),Number(Bn(d.upperRight_Y))]},aW=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,i=fv(n,t),s=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+s+" "+Bn(i.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=vl(n);return o.scope=n.scope,o.stream=e.join(`
`),o}},fv=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,i={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=n.multiline?s.map(function(E){return E.split(`
`)}):s.map(function(E){return[E]});var o=t,l=pn.internal.getHeight(n)||0;l=l<0?-l:l;var c=pn.internal.getWidth(n)||0;c=c<0?-c:c;var d=function(E,O,M){if(E+1<s.length){var Y=O+" "+s[E+1][0];return Mg(Y,n,M).width<=c-4}return!1};o++;e:for(;o>0;){e="",o--;var f,p,v=Mg("3",n,o).height,_=n.multiline?l-o:(l-v)/2,b=_+=2,T=0,C=0,A=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+Mg(e,n,o=12).width+", FieldWidth:"+c+`
`;break}for(var I="",ee=0,G=0;G<s.length;G++)if(s.hasOwnProperty(G)){var K=!1;if(s[G].length!==1&&A!==s[G].length-1){if((v+2)*(ee+2)+2>l)continue e;I+=s[G][A],K=!0,C=G,G--}else{I=(I+=s[G][A]+" ").substr(I.length-1)==" "?I.substr(0,I.length-1):I;var de=parseInt(G),le=d(de,I,o),z=G>=s.length-1;if(le&&!z){I+=" ",A=0;continue}if(le||z){if(z)C=de;else if(n.multiline&&(v+2)*(ee+2)+2>l)continue e}else{if(!n.multiline||(v+2)*(ee+2)+2>l)continue e;C=de}}for(var R="",D=T;D<=C;D++){var F=s[D];if(n.multiline){if(D===C){R+=F[A]+" ",A=(A+1)%F.length;continue}if(D===T){R+=F[F.length-1]+" ";continue}}R+=F[0]+" "}switch(R=R.substr(R.length-1)==" "?R.substr(0,R.length-1):R,p=Mg(R,n,o).width,n.textAlign){case"right":f=c-p-2;break;case"center":f=(c-p)/2;break;default:f=2}e+=Bn(f)+" "+Bn(b)+` Td
`,e+="("+Cd(R)+`) Tj
`,e+=-Bn(f)+` 0 Td
`,b=-(o+2),p=0,T=K?C:C+1,ee++,I=""}break}return i.text=e,i.fontSize=o,i},Mg=function(n,e,t){var i=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(n,{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:s}},lW={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},cW=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(i){return i.type===t.type&&i.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},uW=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Ja.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(lW)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Wb=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new GC,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];o.objId=void 0,o.hasAnnotation&&cW(o,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(i,s){var o=!i;for(var l in i||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(l)){var c=i[l],d=[],f=c.Rect;if(c.Rect&&(c.Rect=rW(c.Rect,s)),s.internal.newObjectDeferredBegin(c.objId,!0),c.DA=pn.createDefaultAppearanceStream(c),Di(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(d=c.getKeyValueListForStream()),c.Rect=f,c.hasAppearanceStream&&!c.appearanceStreamContent){var p=aW(c);d.push({key:"AP",value:"<</N "+p+">>"}),s.internal.acroformPlugin.xForms.push(p)}if(c.appearanceStreamContent){var v="";for(var _ in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(_)){var b=c.appearanceStreamContent[_];if(v+="/"+_+" ",v+="<<",Object.keys(b).length>=1||Array.isArray(b)){for(var l in b)if(b.hasOwnProperty(l)){var T=b[l];typeof T=="function"&&(T=T.call(s,c)),v+="/"+l+" "+T+" ",s.internal.acroformPlugin.xForms.indexOf(T)>=0||s.internal.acroformPlugin.xForms.push(T)}}else typeof(T=b)=="function"&&(T=T.call(s,c)),v+="/"+l+" "+T,s.internal.acroformPlugin.xForms.indexOf(T)>=0||s.internal.acroformPlugin.xForms.push(T);v+=">>"}d.push({key:"AP",value:`<<
`+v+">>"})}s.internal.putStream({additionalKeyValues:d,objectId:c.objId}),s.internal.out("endobj")}o&&(function(C,A){for(var I in C)if(C.hasOwnProperty(I)){var ee=I,G=C[I];A.internal.newObjectDeferredBegin(G.objId,!0),Di(G)==="object"&&typeof G.putStream=="function"&&G.putStream(),delete C[ee]}})(s.internal.acroformPlugin.xForms,s)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},VC=Es.__acroform__.arrayToPdfArray=function(n,e,t){var i=function(l){return l};if(Array.isArray(n)){for(var s="[",o=0;o<n.length;o++)switch(o!==0&&(s+=" "),Di(n[o])){case"boolean":case"number":case"object":s+=n[o].toString();break;case"string":n[o].substr(0,1)!=="/"?(e!==void 0&&t&&(i=t.internal.getEncryptor(e)),s+="("+Cd(i(n[o].toString()))+")"):s+=n[o].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},y2=function(n,e,t){var i=function(s){return s};return e!==void 0&&t&&(i=t.internal.getEncryptor(e)),(n=n||"").toString(),"("+Cd(i(n))+")"},Nl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Nl.prototype.toString=function(){return this.objId+" 0 R"},Nl.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},Nl.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var i=e[t],s=this[i];s&&(Array.isArray(s)?n.push({key:i,value:VC(s,this.objId,this.scope)}):s instanceof Nl?(s.scope=this.scope,n.push({key:i,value:s.objId+" 0 R"})):typeof s!="function"&&n.push({key:i,value:s}))}return n};var YC=function(){Nl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};kr(YC,Nl);var GC=function(){Nl.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(i){return i};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Cd(t(n))+")"}},set:function(t){n=t}})};kr(GC,Nl);var Ja=function n(){Nl.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(I){if(isNaN(I))throw new Error('Invalid value "'+I+'" for attribute F supplied.');e=I}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Is(e,3)},set:function(I){I?this.F=Ps(e,3):this.F=Us(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(I){if(isNaN(I))throw new Error('Invalid value "'+I+'" for attribute Ff supplied.');t=I}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(I){i=I!==void 0?I:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(I){i[0]=I}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(I){i[1]=I}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(I){i[2]=I}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(I){i[3]=I}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(I){switch(I){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=I;break;default:throw new Error('Invalid value "'+I+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof P0)return;o="FieldObject"+n.FieldNum++}var I=function(ee){return ee};return this.scope&&(I=this.scope.internal.getEncryptor(this.objId)),"("+Cd(I(o))+")"},set:function(I){o=I.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(I){o=I}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(I){l=I}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(I){c=I}});var d=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return d},set:function(I){d=I}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/Wb:f},set:function(I){f=I}});var p="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return p},set:function(I){p=I}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof P0||this instanceof ud))return y2(v,this.objId,this.scope)},set:function(I){I=I.toString(),v=I}});var _=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(_)return this instanceof yo==0?y2(_,this.objId,this.scope):_},set:function(I){I=I.toString(),_=this instanceof yo==0?I.substr(0,1)==="("?rh(I.substr(1,I.length-2)):rh(I):I}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof yo==1?rh(_.substr(1,_.length-1)):_},set:function(I){I=I.toString(),_=this instanceof yo==1?"/"+I:I}});var b=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(b)return b},set:function(I){this.V=I}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof yo==0?y2(b,this.objId,this.scope):b},set:function(I){I=I.toString(),b=this instanceof yo==0?I.substr(0,1)==="("?rh(I.substr(1,I.length-2)):rh(I):I}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof yo==1?rh(b.substr(1,b.length-1)):b},set:function(I){I=I.toString(),b=this instanceof yo==1?"/"+I:I}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var T,C=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return C},set:function(I){I=!!I,C=I}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(T)return T},set:function(I){T=I}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,1)},set:function(I){I?this.Ff=Ps(this.Ff,1):this.Ff=Us(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,2)},set:function(I){I?this.Ff=Ps(this.Ff,2):this.Ff=Us(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,3)},set:function(I){I?this.Ff=Ps(this.Ff,3):this.Ff=Us(this.Ff,3)}});var A=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(A!==null)return A},set:function(I){if([0,1,2].indexOf(I)===-1)throw new Error('Invalid value "'+I+'" for attribute Q supplied.');A=I}}),Object.defineProperty(this,"textAlign",{get:function(){var I;switch(A){case 0:default:I="left";break;case 1:I="center";break;case 2:I="right"}return I},configurable:!0,enumerable:!0,set:function(I){switch(I){case"right":case 2:A=2;break;case"center":case 1:A=1;break;default:A=0}}})};kr(Ja,Nl);var _h=function(){Ja.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return VC(e,this.objId,this.scope)},set:function(t){var i,s;s=[],typeof(i=t)=="string"&&(s=(function(o,l,c){c||(c=1);for(var d,f=[];d=l.exec(o);)f.push(d[c]);return f})(i,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,i){for(i=i||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,18)},set:function(t){t?this.Ff=Ps(this.Ff,18):this.Ff=Us(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Ps(this.Ff,19):this.Ff=Us(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,20)},set:function(t){t?(this.Ff=Ps(this.Ff,20),e.sort()):this.Ff=Us(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,22)},set:function(t){t?this.Ff=Ps(this.Ff,22):this.Ff=Us(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,23)},set:function(t){t?this.Ff=Ps(this.Ff,23):this.Ff=Us(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,27)},set:function(t){t?this.Ff=Ps(this.Ff,27):this.Ff=Us(this.Ff,27)}}),this.hasAppearanceStream=!1};kr(_h,Ja);var xh=function(){_h.call(this),this.fontName="helvetica",this.combo=!1};kr(xh,_h);var Sh=function(){xh.call(this),this.combo=!0};kr(Sh,xh);var Yg=function(){Sh.call(this),this.edit=!0};kr(Yg,Sh);var yo=function(){Ja.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,15)},set:function(t){t?this.Ff=Ps(this.Ff,15):this.Ff=Us(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,16)},set:function(t){t?this.Ff=Ps(this.Ff,16):this.Ff=Us(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,17)},set:function(t){t?this.Ff=Ps(this.Ff,17):this.Ff=Us(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,26)},set:function(t){t?this.Ff=Ps(this.Ff,26):this.Ff=Us(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var i,s=[];for(i in s.push("<<"),e)s.push("/"+i+" ("+Cd(t(e[i]))+")");return s.push(">>"),s.join(`
`)}},set:function(t){Di(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};kr(yo,Ja);var Gg=function(){yo.call(this),this.pushButton=!0};kr(Gg,yo);var Nh=function(){yo.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};kr(Nh,yo);var P0=function(){var n,e;Ja.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(s){n=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var t,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(c){return c};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var o,l=[];for(o in l.push("<<"),i)l.push("/"+o+" ("+Cd(s(i[o]))+")");return l.push(">>"),l.join(`
`)},set:function(s){Di(s)==="object"&&(i=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(s){typeof s=="string"&&(i.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(s){t="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=pn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};kr(P0,Ja),Nh.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},Nh.prototype.createOption=function(n){var e=new P0;return e.Parent=this,e.optionName=n,this.Kids.push(e),dW.call(this.scope,e),e};var Kg=function(){yo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=pn.CheckBox.createAppearanceStream()};kr(Kg,yo);var ud=function(){Ja.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,13)},set:function(e){e?this.Ff=Ps(this.Ff,13):this.Ff=Us(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,21)},set:function(e){e?this.Ff=Ps(this.Ff,21):this.Ff=Us(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,23)},set:function(e){e?this.Ff=Ps(this.Ff,23):this.Ff=Us(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,24)},set:function(e){e?this.Ff=Ps(this.Ff,24):this.Ff=Us(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,25)},set:function(e){e?this.Ff=Ps(this.Ff,25):this.Ff=Us(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,26)},set:function(e){e?this.Ff=Ps(this.Ff,26):this.Ff=Us(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};kr(ud,Ja);var Xg=function(){ud.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Is(this.Ff,14)},set:function(n){n?this.Ff=Ps(this.Ff,14):this.Ff=Us(this.Ff,14)}}),this.password=!0};kr(Xg,ud);var pn={CheckBox:{createAppearanceStream:function(){return{N:{On:pn.CheckBox.YesNormal},D:{On:pn.CheckBox.YesPushDown,Off:pn.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=vl(n);e.scope=n.scope;var t=[],i=n.scope.internal.getFont(n.fontName,n.fontStyle).id,s=n.scope.__private__.encodeColorString(n.color),o=fv(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+Bn(pn.internal.getWidth(n))+" "+Bn(pn.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+i+" "+Bn(o.fontSize)+" Tf "+s),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=vl(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,i=n.scope.__private__.encodeColorString(n.color),s=[],o=pn.internal.getHeight(n),l=pn.internal.getWidth(n),c=fv(n,n.caption);return s.push("1 g"),s.push("0 0 "+Bn(l)+" "+Bn(o)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Bn(l-1)+" "+Bn(o-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+t+" "+Bn(c.fontSize)+" Tf "+i),s.push(c.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(n){var e=vl(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Bn(pn.internal.getWidth(n))+" "+Bn(pn.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:pn.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=pn.RadioButton.Circle.YesNormal,e.D[n]=pn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=vl(n);e.scope=n.scope;var t=[],i=pn.internal.getWidth(n)<=pn.internal.getHeight(n)?pn.internal.getWidth(n)/4:pn.internal.getHeight(n)/4;i=Number((.9*i).toFixed(5));var s=pn.internal.Bezier_C,o=Number((i*s).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Gc(pn.internal.getWidth(n)/2)+" "+Gc(pn.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=vl(n);e.scope=n.scope;var t=[],i=pn.internal.getWidth(n)<=pn.internal.getHeight(n)?pn.internal.getWidth(n)/4:pn.internal.getHeight(n)/4;i=Number((.9*i).toFixed(5));var s=Number((2*i).toFixed(5)),o=Number((s*pn.internal.Bezier_C).toFixed(5)),l=Number((i*pn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Gc(pn.internal.getWidth(n)/2)+" "+Gc(pn.internal.getHeight(n)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Gc(pn.internal.getWidth(n)/2)+" "+Gc(pn.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),t.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),t.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),t.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=vl(n);e.scope=n.scope;var t=[],i=pn.internal.getWidth(n)<=pn.internal.getHeight(n)?pn.internal.getWidth(n)/4:pn.internal.getHeight(n)/4;i=Number((.9*i).toFixed(5));var s=Number((2*i).toFixed(5)),o=Number((s*pn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Gc(pn.internal.getWidth(n)/2)+" "+Gc(pn.internal.getHeight(n)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:pn.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=pn.RadioButton.Cross.YesNormal,e.D[n]=pn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=vl(n);e.scope=n.scope;var t=[],i=pn.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+Bn(pn.internal.getWidth(n)-2)+" "+Bn(pn.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(Bn(i.x1.x)+" "+Bn(i.x1.y)+" m"),t.push(Bn(i.x2.x)+" "+Bn(i.x2.y)+" l"),t.push(Bn(i.x4.x)+" "+Bn(i.x4.y)+" m"),t.push(Bn(i.x3.x)+" "+Bn(i.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=vl(n);e.scope=n.scope;var t=pn.internal.calculateCross(n),i=[];return i.push("0.749023 g"),i.push("0 0 "+Bn(pn.internal.getWidth(n))+" "+Bn(pn.internal.getHeight(n))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+Bn(pn.internal.getWidth(n)-2)+" "+Bn(pn.internal.getHeight(n)-2)+" re"),i.push("W"),i.push("n"),i.push(Bn(t.x1.x)+" "+Bn(t.x1.y)+" m"),i.push(Bn(t.x2.x)+" "+Bn(t.x2.y)+" l"),i.push(Bn(t.x4.x)+" "+Bn(t.x4.y)+" m"),i.push(Bn(t.x3.x)+" "+Bn(t.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(n){var e=vl(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Bn(pn.internal.getWidth(n))+" "+Bn(pn.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};pn.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=pn.internal.getWidth(n),t=pn.internal.getHeight(n),i=Math.min(e,t);return{x1:{x:(e-i)/2,y:(t-i)/2+i},x2:{x:(e-i)/2+i,y:(t-i)/2},x3:{x:(e-i)/2,y:(t-i)/2},x4:{x:(e-i)/2+i,y:(t-i)/2+i}}}},pn.internal.getWidth=function(n){var e=0;return Di(n)==="object"&&(e=JN(n.Rect[2])),e},pn.internal.getHeight=function(n){var e=0;return Di(n)==="object"&&(e=JN(n.Rect[3])),e};var dW=Es.addField=function(n){if(uW(this,n),!(n instanceof Ja))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};Es.AcroFormChoiceField=_h,Es.AcroFormListBox=xh,Es.AcroFormComboBox=Sh,Es.AcroFormEditBox=Yg,Es.AcroFormButton=yo,Es.AcroFormPushButton=Gg,Es.AcroFormRadioButton=Nh,Es.AcroFormCheckBox=Kg,Es.AcroFormTextField=ud,Es.AcroFormPasswordField=Xg,Es.AcroFormAppearance=pn,Es.AcroForm={ChoiceField:_h,ListBox:xh,ComboBox:Sh,EditBox:Yg,Button:yo,PushButton:Gg,RadioButton:Nh,CheckBox:Kg,TextField:ud,PasswordField:Xg,Appearance:pn},vn.AcroForm={ChoiceField:_h,ListBox:xh,ComboBox:Sh,EditBox:Yg,Button:yo,PushButton:Gg,RadioButton:Nh,CheckBox:Kg,TextField:ud,PasswordField:Xg,Appearance:pn};vn.AcroForm;function KC(n){return n.reduce(function(e,t,i){return e[t]=i,e},{})}(function(n){var e="addImage_";n.__addimage__={};var t="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=n.__addimage__.getImageFileTypeByImageData=function(E,O){var M,Y,ie,q,re,V=t;if((O=O||t)==="RGBA"||E.data!==void 0&&E.data instanceof Uint8ClampedArray&&"height"in E&&"width"in E)return"RGBA";if(le(E))for(re in i)for(ie=i[re],M=0;M<ie.length;M+=1){for(q=!0,Y=0;Y<ie[M].length;Y+=1)if(ie[M][Y]!==void 0&&ie[M][Y]!==E[Y]){q=!1;break}if(q===!0){V=re;break}}else for(re in i)for(ie=i[re],M=0;M<ie.length;M+=1){for(q=!0,Y=0;Y<ie[M].length;Y+=1)if(ie[M][Y]!==void 0&&ie[M][Y]!==E.charCodeAt(Y)){q=!1;break}if(q===!0){V=re;break}}return V===t&&O!==t&&(V=O),V},o=function E(O){for(var M=this.internal.write,Y=this.internal.putStream,ie=(0,this.internal.getFilters)();ie.indexOf("FlateEncode")!==-1;)ie.splice(ie.indexOf("FlateEncode"),1);O.objectId=this.internal.newObject();var q=[];if(q.push({key:"Type",value:"/XObject"}),q.push({key:"Subtype",value:"/Image"}),q.push({key:"Width",value:O.width}),q.push({key:"Height",value:O.height}),O.colorSpace===I.INDEXED?q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(O.palette.length/3-1)+" "+("sMask"in O&&O.sMask!==void 0?O.objectId+2:O.objectId+1)+" 0 R]"}):(q.push({key:"ColorSpace",value:"/"+O.colorSpace}),O.colorSpace===I.DEVICE_CMYK&&q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),q.push({key:"BitsPerComponent",value:O.bitsPerComponent}),"decodeParameters"in O&&O.decodeParameters!==void 0&&q.push({key:"DecodeParms",value:"<<"+O.decodeParameters+">>"}),"transparency"in O&&Array.isArray(O.transparency)){for(var re="",V=0,se=O.transparency.length;V<se;V++)re+=O.transparency[V]+" "+O.transparency[V]+" ";q.push({key:"Mask",value:"["+re+"]"})}O.sMask!==void 0&&q.push({key:"SMask",value:O.objectId+1+" 0 R"});var W=O.filter!==void 0?["/"+O.filter]:void 0;if(Y({data:O.data,additionalKeyValues:q,alreadyAppliedFilters:W,objectId:O.objectId}),M("endobj"),"sMask"in O&&O.sMask!==void 0){var te=(O.predictor!=null?"/Predictor "+O.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+O.width,j={width:O.width,height:O.height,colorSpace:"DeviceGray",bitsPerComponent:O.bitsPerComponent,decodeParameters:te,data:O.sMask};"filter"in O&&(j.filter=O.filter),E.call(this,j)}if(O.colorSpace===I.INDEXED){var U=this.internal.newObject();Y({data:R(new Uint8Array(O.palette)),objectId:U}),M("endobj")}},l=function(){var E=this.internal.collections[e+"images"];for(var O in E)o.call(this,E[O])},c=function(){var E,O=this.internal.collections[e+"images"],M=this.internal.write;for(var Y in O)M("/I"+(E=O[Y]).index,E.objectId,"0","R")},d=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",c))},f=function(){var E=this.internal.collections[e+"images"];return d.call(this),E},p=function(){return Object.keys(this.internal.collections[e+"images"]).length},v=function(E){return typeof n["process"+E.toUpperCase()]=="function"},_=function(E){return Di(E)==="object"&&E.nodeType===1},b=function(E,O){if(E.nodeName==="IMG"&&E.hasAttribute("src")){var M=""+E.getAttribute("src");if(M.indexOf("data:image/")===0)return Vg(unescape(M).split("base64,").pop());var Y=n.loadFile(M,!0);if(Y!==void 0)return Y}if(E.nodeName==="CANVAS"){if(E.width===0||E.height===0)throw new Error("Given canvas must have data. Canvas width: "+E.width+", height: "+E.height);var ie;switch(O){case"PNG":ie="image/png";break;case"WEBP":ie="image/webp";break;default:ie="image/jpeg"}return Vg(E.toDataURL(ie,1).split("base64,").pop())}},T=function(E){var O=this.internal.collections[e+"images"];if(O){for(var M in O)if(E===O[M].alias)return O[M]}},C=function(E,O,M){return E||O||(E=-96,O=-96),E<0&&(E=-1*M.width*72/E/this.internal.scaleFactor),O<0&&(O=-1*M.height*72/O/this.internal.scaleFactor),E===0&&(E=O*M.width/M.height),O===0&&(O=E*M.height/M.width),[E,O]},A=function(E,O,M,Y,ie,q){var re=C.call(this,M,Y,ie),V=this.internal.getCoordinateString,se=this.internal.getVerticalCoordinateString,W=f.call(this);if(M=re[0],Y=re[1],W[ie.index]=ie,q){q*=Math.PI/180;var te=Math.cos(q),j=Math.sin(q),U=function(X){return X.toFixed(4)},$=[U(te),U(j),U(-1*j),U(te),0,0,"cm"]}this.internal.write("q"),q?(this.internal.write([1,"0","0",1,V(E),se(O+Y),"cm"].join(" ")),this.internal.write($.join(" ")),this.internal.write([V(M),"0","0",V(Y),"0","0","cm"].join(" "))):this.internal.write([V(M),"0","0",V(Y),V(E),se(O+Y),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ie.index+" Do"),this.internal.write("Q")},I=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var ee=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},G=n.__addimage__.sHashCode=function(E){var O,M,Y=0;if(typeof E=="string")for(M=E.length,O=0;O<M;O++)Y=(Y<<5)-Y+E.charCodeAt(O),Y|=0;else if(le(E))for(M=E.byteLength/2,O=0;O<M;O++)Y=(Y<<5)-Y+E[O],Y|=0;return Y},K=n.__addimage__.validateStringAsBase64=function(E){(E=E||"").toString().trim();var O=!0;return E.length===0&&(O=!1),E.length%4!=0&&(O=!1),/^[A-Za-z0-9+/]+$/.test(E.substr(0,E.length-2))===!1&&(O=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(E.substr(-2))===!1&&(O=!1),O},de=n.__addimage__.extractImageFromDataUrl=function(E){if(E==null||!(E=E.trim()).startsWith("data:"))return null;var O=E.indexOf(",");return O<0?null:E.substring(0,O).trim().endsWith("base64")?E.substring(O+1):null};n.__addimage__.isArrayBuffer=function(E){return E instanceof ArrayBuffer};var le=n.__addimage__.isArrayBufferView=function(E){return E instanceof Int8Array||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array},z=n.__addimage__.binaryStringToUint8Array=function(E){for(var O=E.length,M=new Uint8Array(O),Y=0;Y<O;Y++)M[Y]=E.charCodeAt(Y);return M},R=n.__addimage__.arrayBufferToBinaryString=function(E){for(var O="",M=le(E)?E:new Uint8Array(E),Y=0;Y<M.length;Y+=8192)O+=String.fromCharCode.apply(null,M.subarray(Y,Y+8192));return O};n.addImage=function(){var E,O,M,Y,ie,q,re,V,se;if(typeof arguments[1]=="number"?(O=t,M=arguments[1],Y=arguments[2],ie=arguments[3],q=arguments[4],re=arguments[5],V=arguments[6],se=arguments[7]):(O=arguments[1],M=arguments[2],Y=arguments[3],ie=arguments[4],q=arguments[5],re=arguments[6],V=arguments[7],se=arguments[8]),Di(E=arguments[0])==="object"&&!_(E)&&"imageData"in E){var W=E;E=W.imageData,O=W.format||O||t,M=W.x||M||0,Y=W.y||Y||0,ie=W.w||W.width||ie,q=W.h||W.height||q,re=W.alias||re,V=W.compression||V,se=W.rotation||W.angle||se}var te=this.internal.getFilters();if(V===void 0&&te.indexOf("FlateEncode")!==-1&&(V="SLOW"),isNaN(M)||isNaN(Y))throw new Error("Invalid coordinates passed to jsPDF.addImage");d.call(this);var j=D.call(this,E,O,re,V);return A.call(this,M,Y,ie,q,j,se),this};var D=function(E,O,M,Y){var ie,q,re;if(typeof E=="string"&&s(E)===t){E=unescape(E);var V=F(E,!1);(V!==""||(V=n.loadFile(E,!0))!==void 0)&&(E=V)}if(_(E)&&(E=b(E,O)),O=s(E,O),!v(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(((re=M)==null||re.length===0)&&(M=(function(se){return typeof se=="string"||le(se)?G(se):le(se.data)?G(se.data):null})(E)),(ie=T.call(this,M))||(E instanceof Uint8Array||O==="RGBA"||(q=E,E=z(E)),ie=this["process"+O.toUpperCase()](E,p.call(this),M,(function(se){return se&&typeof se=="string"&&(se=se.toUpperCase()),se in n.image_compression?se:ee.NONE})(Y),q)),!ie)throw new Error("An unknown error occurred whilst processing the image.");return ie},F=n.__addimage__.convertBase64ToBinaryString=function(E,O){O=typeof O!="boolean"||O;var M,Y="";if(typeof E=="string"){var ie;M=(ie=de(E))!==null&&ie!==void 0?ie:E;try{Y=Vg(M)}catch(q){if(O)throw K(M)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Y};n.getImageProperties=function(E){var O,M,Y="";if(_(E)&&(E=b(E)),typeof E=="string"&&s(E)===t&&((Y=F(E,!1))===""&&(Y=n.loadFile(E)||""),E=Y),M=s(E),!v(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(E instanceof Uint8Array||(E=z(E)),!(O=this["process"+M.toUpperCase()](E)))throw new Error("An unknown error occurred whilst processing the image");return O.fileType=M,O}})(vn.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};vn.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var i,s,o,l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,d=this.internal.getPageInfoByObjId(t.objId),f=t.pageContext.annotations,p=!1,v=0;v<f.length&&!p;v++)switch((i=f[v]).type){case"link":(e(i.options.url)||e(i.options.pageNumber))&&(p=!0);break;case"reference":case"text":case"freetext":p=!0}if(p!=0){this.internal.write("/Annots [");for(var _=0;_<f.length;_++){i=f[_];var b=this.internal.pdfEscape,T=this.internal.getEncryptor(t.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var C=this.internal.newAdditionalObject(),A=this.internal.newAdditionalObject(),I=this.internal.getEncryptor(C.objId),ee=i.title||"Note";o="<</Type /Annot /Subtype /Text "+(s="/Rect ["+l(i.bounds.x)+" "+c(i.bounds.y+i.bounds.h)+" "+l(i.bounds.x+i.bounds.w)+" "+c(i.bounds.y)+"] ")+"/Contents ("+b(I(i.contents))+")",o+=" /Popup "+A.objId+" 0 R",o+=" /P "+d.objId+" 0 R",o+=" /T ("+b(I(ee))+") >>",C.content=o;var G=C.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+l(i.bounds.x+30)+" "+c(i.bounds.y+i.bounds.h)+" "+l(i.bounds.x+i.bounds.w+30)+" "+c(i.bounds.y)+"] ")+" /Parent "+G,i.open&&(o+=" /Open true"),o+=" >>",A.content=o,this.internal.write(C.objId,"0 R",A.objId,"0 R");break;case"freetext":s="/Rect ["+l(i.bounds.x)+" "+c(i.bounds.y)+" "+l(i.bounds.x+i.bounds.w)+" "+c(i.bounds.y+i.bounds.h)+"] ";var K=i.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+b(T(i.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+K+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(i.options.name){var de=this.annotations._nameMap[i.options.name];i.options.pageNumber=de.page,i.options.top=de.y}else i.options.top||(i.options.top=0);if(s="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",o="",i.options.url)o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+b(T(i.options.url))+") >>";else if(i.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,o+=" /FitV "+i.options.left+"]";break;default:var le=c(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),o+=" /XYZ "+i.options.left+" "+le+" "+i.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var i=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":i.pageContext.annotations.push(t)}},n.link=function(t,i,s,o,l){var c=this.internal.getCurrentPageInfo(),d=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:d(t),y:f(i),w:d(t+s),h:f(i+o)},options:l,type:"link"})},n.textWithLink=function(t,i,s,o){var l,c,d=this.getTextWidth(t),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){c=o.maxWidth;var p=this.splitTextToSize(t,c).length;l=Math.ceil(f*p)}else c=d,l=f;return this.text(t,i,s,o),s+=.2*f,o.align==="center"&&(i-=d/2),o.align==="right"&&(i-=d),this.link(i,s-f,c,l,o),d},n.getTextWidth=function(t){var i=this.internal.getFontSize();return this.getStringUnitWidth(t)*i/this.internal.scaleFactor}})(vn.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];n.__arabicParser__={};var o=n.__arabicParser__.isInArabicSubstitutionA=function(C){return e[C.charCodeAt(0)]!==void 0},l=n.__arabicParser__.isArabicLetter=function(C){return typeof C=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(C)},c=n.__arabicParser__.isArabicEndLetter=function(C){return l(C)&&o(C)&&e[C.charCodeAt(0)].length<=2},d=n.__arabicParser__.isArabicAlfLetter=function(C){return l(C)&&s.indexOf(C.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(C){return l(C)&&o(C)&&e[C.charCodeAt(0)].length>=1};var f=n.__arabicParser__.arabicLetterHasFinalForm=function(C){return l(C)&&o(C)&&e[C.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(C){return l(C)&&o(C)&&e[C.charCodeAt(0)].length>=3};var p=n.__arabicParser__.arabicLetterHasMedialForm=function(C){return l(C)&&o(C)&&e[C.charCodeAt(0)].length==4},v=n.__arabicParser__.resolveLigatures=function(C){var A=0,I=t,ee="",G=0;for(A=0;A<C.length;A+=1)I[C.charCodeAt(A)]!==void 0?(G++,typeof(I=I[C.charCodeAt(A)])=="number"&&(ee+=String.fromCharCode(I),I=t,G=0),A===C.length-1&&(I=t,ee+=C.charAt(A-(G-1)),A-=G-1,G=0)):(I=t,ee+=C.charAt(A-G),A-=G,G=0);return ee};n.__arabicParser__.isArabicDiacritic=function(C){return C!==void 0&&i[C.charCodeAt(0)]!==void 0};var _=n.__arabicParser__.getCorrectForm=function(C,A,I){return l(C)?o(C)===!1?-1:!f(C)||!l(A)&&!l(I)||!l(I)&&c(A)||c(C)&&!l(A)||c(C)&&d(A)||c(C)&&c(A)?0:p(C)&&l(A)&&!c(A)&&l(I)&&f(I)?3:c(C)||!l(I)?1:2:-1},b=function(C){var A=0,I=0,ee=0,G="",K="",de="",le=(C=C||"").split("\\s+"),z=[];for(A=0;A<le.length;A+=1){for(z.push(""),I=0;I<le[A].length;I+=1)G=le[A][I],K=le[A][I-1],de=le[A][I+1],l(G)?(ee=_(G,K,de),z[A]+=ee!==-1?String.fromCharCode(e[G.charCodeAt(0)][ee]):G):z[A]+=G;z[A]=v(z[A])}return z.join(" ")},T=n.__arabicParser__.processArabic=n.processArabic=function(){var C,A=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,I=[];if(Array.isArray(A)){var ee=0;for(I=[],ee=0;ee<A.length;ee+=1)Array.isArray(A[ee])?I.push([b(A[ee][0]),A[ee][1],A[ee][2]]):I.push([b(A[ee])]);C=I}else C=b(A);return typeof arguments[0]=="string"?C:(arguments[0].text=C,arguments[0])};n.events.push(["preProcessText",T])})(vn.API),vn.API.autoPrint=function(n){var e;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(c){t=c}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(c){i=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(c){s=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(c){o=c}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(c){l=c}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,i){var s;if((t=t||"2d")!=="2d")return null;for(s in i)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=i[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(vn.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var d=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return d},set:function(C){d=C}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(C){f=C}});var p=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return p},set:function(C){p=C}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(C){v=C}});var _=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return _},set:function(C){_=C}});var b=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return b},set:function(C){b=C}});var T=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return T},set:function(C){T=C}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(d){return i.call(this),this.internal.__cell__.headerFunction=typeof d=="function"?d:void 0,this},n.getTextDimensions=function(d,f){i.call(this);var p=(f=f||{}).fontSize||this.getFontSize(),v=f.font||this.getFont(),_=f.scaleFactor||this.internal.scaleFactor,b=0,T=0,C=0,A=this;if(!Array.isArray(d)&&typeof d!="string"){if(typeof d!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");d=String(d)}var I=f.maxWidth;I>0?typeof d=="string"?d=this.splitTextToSize(d,I):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function(G,K){return G.concat(A.splitTextToSize(K,I))},[])):d=Array.isArray(d)?d:[d];for(var ee=0;ee<d.length;ee++)b<(C=this.getStringUnitWidth(d[ee],{font:v})*p)&&(b=C);return b!==0&&(T=d.length),{w:b/=_,h:Math.max((T*p*this.getLineHeightFactor()-p*(this.getLineHeightFactor()-1))/_,0)}},n.cellAddPage=function(){i.call(this),this.addPage();var d=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(d.left,d.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=n.cell=function(){var d;d=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var f=this.internal.__cell__.lastCell,p=this.internal.__cell__.padding,v=this.internal.__cell__.margins||e,_=this.internal.__cell__.tableHeaderRow,b=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===d.lineNumber?(d.x=(f.x||0)+(f.width||0),d.y=f.y||0):f.y+f.height+d.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),d.y=v.top,b&&_&&(this.printHeaderRow(d.lineNumber,!0),d.y+=_[0].height)):d.y=f.y+f.height||d.y),d.text[0]!==void 0&&(this.rect(d.x,d.y,d.width,d.height,t===!0?"FD":void 0),d.align==="right"?this.text(d.text,d.x+d.width-p,d.y+p,{align:"right",baseline:"top"}):d.align==="center"?this.text(d.text,d.x+d.width/2,d.y+p,{align:"center",baseline:"top",maxWidth:d.width-p-p}):this.text(d.text,d.x+p,d.y+p,{align:"left",baseline:"top",maxWidth:d.width-p-p})),this.internal.__cell__.lastCell=d,this};n.table=function(d,f,p,v,_){if(i.call(this),!p)throw new Error("No data for PDF table.");var b,T,C,A,I=[],ee=[],G=[],K={},de={},le=[],z=[],R=(_=_||{}).autoSize||!1,D=_.printHeaders!==!1,F=_.css&&_.css["font-size"]!==void 0?16*_.css["font-size"]:_.fontSize||12,E=_.margins||Object.assign({width:this.getPageWidth()},e),O=typeof _.padding=="number"?_.padding:3,M=_.headerBackgroundColor||"#c8c8c8",Y=_.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=D,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=F,this.internal.__cell__.padding=O,this.internal.__cell__.headerBackgroundColor=M,this.internal.__cell__.headerTextColor=Y,this.setFontSize(F),v==null)ee=I=Object.keys(p[0]),G=I.map(function(){return"left"});else if(Array.isArray(v)&&Di(v[0])==="object")for(I=v.map(function(W){return W.name}),ee=v.map(function(W){return W.prompt||W.name||""}),G=v.map(function(W){return W.align||"left"}),b=0;b<v.length;b+=1)de[v[b].name]=.7499990551181103*v[b].width;else Array.isArray(v)&&typeof v[0]=="string"&&(ee=I=v,G=I.map(function(){return"left"}));if(R||Array.isArray(v)&&typeof v[0]=="string")for(b=0;b<I.length;b+=1){for(K[A=I[b]]=p.map(function(W){return W[A]}),this.setFont(void 0,"bold"),le.push(this.getTextDimensions(ee[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),T=K[A],this.setFont(void 0,"normal"),C=0;C<T.length;C+=1)le.push(this.getTextDimensions(T[C],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);de[A]=Math.max.apply(null,le)+O+O,le=[]}if(D){var ie={};for(b=0;b<I.length;b+=1)ie[I[b]]={},ie[I[b]].text=ee[b],ie[I[b]].align=G[b];var q=c.call(this,ie,de);z=I.map(function(W){return new o(d,f,de[W],q,ie[W].text,void 0,ie[W].align)}),this.setTableHeaderRow(z),this.printHeaderRow(1,!1)}var re=v.reduce(function(W,te){return W[te.name]=te.align,W},{});for(b=0;b<p.length;b+=1){"rowStart"in _&&_.rowStart instanceof Function&&_.rowStart({row:b,data:p[b]},this);var V=c.call(this,p[b],de);for(C=0;C<I.length;C+=1){var se=p[b][I[C]];"cellStart"in _&&_.cellStart instanceof Function&&_.cellStart({row:b,col:C,data:se},this),l.call(this,new o(d,f,de[I[C]],V,se,b+2,re[I[C]]))}}return this.internal.__cell__.table_x=d,this.internal.__cell__.table_y=f,this};var c=function(d,f){var p=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,_=this.internal.scaleFactor;return Object.keys(d).map(function(b){var T=d[b];return this.splitTextToSize(T.hasOwnProperty("text")?T.text:T,f[b]-p-p)},this).map(function(b){return this.getLineHeightFactor()*b.length*v/_+p+p},this).reduce(function(b,T){return Math.max(b,T)},0)};n.setTableHeaderRow=function(d){i.call(this),this.internal.__cell__.tableHeaderRow=d},n.printHeaderRow=function(d,f){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var p;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var _=[],b=0;b<this.internal.__cell__.tableHeaderRow.length;b+=1){p=this.internal.__cell__.tableHeaderRow[b].clone(),f&&(p.y=this.internal.__cell__.margins.top||0,_.push(p)),p.lineNumber=d;var T=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,p),this.setTextColor(T)}_.length>0&&this.setTableHeaderRow(_),this.setFont(void 0,"normal"),t=!1}})(vn.API);var XC={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},QC=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],mv=KC(QC),ZC=[100,200,300,400,500,600,700,800,900],hW=KC(ZC);function v2(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(o){return XC[o=o||"normal"]?o:"normal"})(n.style),i=(function(o){return o?typeof o=="number"?o>=100&&o<=900&&o%100==0?o:400:/^\d00$/.test(o)?parseInt(o):o==="bold"?700:400:400})(n.weight),s=(function(o){return typeof mv[o=o||"normal"]=="number"?o:"normal"})(n.stretch);return{family:e,style:t,weight:i,stretch:s,src:n.src||[],ref:n.ref||{name:e,style:[s,t,i].join(" ")}}}function e4(n,e,t,i){var s;for(s=t;s>=0&&s<e.length;s+=i)if(n[e[s]])return n[e[s]];for(s=t;s>=0&&s<e.length;s-=i)if(n[e[s]])return n[e[s]]}var fW={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},t4={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function n4(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function i4(n){return n.trimLeft()}function mW(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function pW(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var Rg,s4,o4,ah,Ig,r4,a4,l4,b2=["times"];function c4(n,e,t,i){var s=4,o=d4;switch(i){case vn.API.image_compression.FAST:s=1,o=u4;break;case vn.API.image_compression.MEDIUM:s=6,o=h4;break;case vn.API.image_compression.SLOW:s=9,o=f4}n=(function(c,d,f,p){for(var v,_=c.length/d,b=new Uint8Array(c.length+_),T=[gW,u4,d4,h4,f4],C=0;C<_;C+=1){var A=C*d,I=c.subarray(A,A+d);if(p)b.set(p(I,f,v),A+C);else{for(var ee=T.length,G=[],K=0;K<ee;K+=1)G[K]=T[K](I,f,v);var de=vW(G.concat());b.set(G[de],A+C)}v=I}return b})(n,e,t,o);var l=av(n,{level:s});return vn.API.__addimage__.arrayBufferToBinaryString(l)}function gW(n){var e=Array.apply([],n);return e.unshift(0),e}function u4(n,e){var t=n.length,i=[];i[0]=1;for(var s=0;s<t;s+=1){var o=n[s-e]||0;i[s+1]=n[s]-o+256&255}return i}function d4(n,e,t){var i=n.length,s=[];s[0]=2;for(var o=0;o<i;o+=1){var l=t&&t[o]||0;s[o+1]=n[o]-l+256&255}return s}function h4(n,e,t){var i=n.length,s=[];s[0]=3;for(var o=0;o<i;o+=1){var l=n[o-e]||0,c=t&&t[o]||0;s[o+1]=n[o]+256-(l+c>>>1)&255}return s}function f4(n,e,t){var i=n.length,s=[];s[0]=4;for(var o=0;o<i;o+=1){var l=yW(n[o-e]||0,t&&t[o]||0,t&&t[o-e]||0);s[o+1]=n[o]-l+256&255}return s}function yW(n,e,t){if(n===e&&e===t)return n;var i=Math.abs(e-t),s=Math.abs(n-t),o=Math.abs(n+e-t-t);return i<=s&&i<=o?n:s<=o?e:t}function vW(n){var e=n.map(function(t){return t.reduce(function(i,s){return i+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function w2(n,e,t){var i=e*t,s=Math.floor(i/8),o=16-(i-8*s+t),l=(1<<t)-1;return JC(n,s)>>o&l}function m4(n,e,t,i){var s=t*i,o=Math.floor(s/8),l=16-(s-8*o+i),c=(1<<i)-1,d=(e&c)<<l;(function(f,p,v){if(p+1<f.byteLength)f.setUint16(p,v,!1);else{var _=v>>8&255;f.setUint8(p,_)}})(n,o,JC(n,o)&~(c<<l)&65535|d)}function JC(n,e){return e+1<n.byteLength?n.getUint16(e,!1):n.getUint8(e)<<8}function bW(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,i=n[e++]|n[e++]<<8,s=n[e++],o=s>>7,l=1<<1+(7&s);n[e++],n[e++];var c=null,d=null;o&&(c=e,d=l,e+=3*l);var f=!0,p=[],v=0,_=null,b=0,T=null;for(this.width=t,this.height=i;f&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,T=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((E=n[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var C=n[e++];v=n[e++]|n[e++]<<8,_=n[e++],1&C||(_=null),b=C>>2&7,e++;break;case 254:for(;;){if(!((E=n[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var A=n[e++]|n[e++]<<8,I=n[e++]|n[e++]<<8,ee=n[e++]|n[e++]<<8,G=n[e++]|n[e++]<<8,K=n[e++],de=K>>6&1,le=1<<1+(7&K),z=c,R=d,D=!1;K>>7&&(D=!0,z=e,R=le,e+=3*le);var F=e;for(e++;;){var E;if(!((E=n[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}p.push({x:A,y:I,width:ee,height:G,has_local_palette:D,palette_offset:z,palette_size:R,data_offset:F,data_length:e-F,transparent_index:_,interlaced:!!de,delay:v,disposal:b});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return p.length},this.loopCount=function(){return T},this.frameInfo=function(O){if(O<0||O>=p.length)throw new Error("Frame index out of range.");return p[O]},this.decodeAndBlitFrameBGRA=function(O,M){var Y=this.frameInfo(O),ie=Y.width*Y.height,q=new Uint8Array(ie);p4(n,Y.data_offset,q,ie);var re=Y.palette_offset,V=Y.transparent_index;V===null&&(V=256);var se=Y.width,W=t-se,te=se,j=4*(Y.y*t+Y.x),U=4*((Y.y+Y.height)*t+Y.x),$=j,X=4*W;Y.interlaced===!0&&(X+=4*t*7);for(var Q=8,ye=0,Ae=q.length;ye<Ae;++ye){var De=q[ye];if(te===0&&(te=se,($+=X)>=U&&(X=4*W+4*t*(Q-1),$=j+(se+W)*(Q<<1),Q>>=1)),De===V)$+=4;else{var Be=n[re+3*De],Fe=n[re+3*De+1],Ct=n[re+3*De+2];M[$++]=Ct,M[$++]=Fe,M[$++]=Be,M[$++]=255}--te}},this.decodeAndBlitFrameRGBA=function(O,M){var Y=this.frameInfo(O),ie=Y.width*Y.height,q=new Uint8Array(ie);p4(n,Y.data_offset,q,ie);var re=Y.palette_offset,V=Y.transparent_index;V===null&&(V=256);var se=Y.width,W=t-se,te=se,j=4*(Y.y*t+Y.x),U=4*((Y.y+Y.height)*t+Y.x),$=j,X=4*W;Y.interlaced===!0&&(X+=4*t*7);for(var Q=8,ye=0,Ae=q.length;ye<Ae;++ye){var De=q[ye];if(te===0&&(te=se,($+=X)>=U&&(X=4*W+4*t*(Q-1),$=j+(se+W)*(Q<<1),Q>>=1)),De===V)$+=4;else{var Be=n[re+3*De],Fe=n[re+3*De+1],Ct=n[re+3*De+2];M[$++]=Be,M[$++]=Fe,M[$++]=Ct,M[$++]=255}--te}}}function p4(n,e,t,i){for(var s=n[e++],o=1<<s,l=o+1,c=l+1,d=s+1,f=(1<<d)-1,p=0,v=0,_=0,b=n[e++],T=new Int32Array(4096),C=null;;){for(;p<16&&b!==0;)v|=n[e++]<<p,p+=8,b===1?b=n[e++]:--b;if(p<d)break;var A=v&f;if(v>>=d,p-=d,A!==o){if(A===l)break;for(var I=A<c?A:C,ee=0,G=I;G>o;)G=T[G]>>8,++ee;var K=G;if(_+ee+(I!==A?1:0)>i)return void zi.log("Warning, gif stream longer than expected.");t[_++]=K;var de=_+=ee;for(I!==A&&(t[_++]=K),G=I;ee--;)G=T[G],t[--de]=255&G,G>>=8;C!==null&&c<4096&&(T[c++]=C<<8|K,c>=f+1&&d<12&&(++d,f=f<<1|1)),C=A}else c=l+1,f=(1<<(d=s+1))-1,C=null}return _!==i&&zi.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function _2(n){var e,t,i,s,o,l=Math.floor,c=new Array(64),d=new Array(64),f=new Array(64),p=new Array(64),v=new Array(65535),_=new Array(65535),b=new Array(64),T=new Array(64),C=[],A=0,I=7,ee=new Array(64),G=new Array(64),K=new Array(64),de=new Array(256),le=new Array(2048),z=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],R=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],O=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ie=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function q(j,U){for(var $=0,X=0,Q=new Array,ye=1;ye<=16;ye++){for(var Ae=1;Ae<=j[ye];Ae++)Q[U[X]]=[],Q[U[X]][0]=$,Q[U[X]][1]=ye,X++,$++;$*=2}return Q}function re(j){for(var U=j[0],$=j[1]-1;$>=0;)U&1<<$&&(A|=1<<I),$--,--I<0&&(A==255?(V(255),V(0)):V(A),I=7,A=0)}function V(j){C.push(j)}function se(j){V(j>>8&255),V(255&j)}function W(j,U,$,X,Q){for(var ye,Ae=Q[0],De=Q[240],Be=(function(We,tt){var lt,$e,pe,be,Se,Ee,Ye,qe,Ue,Xe,bt=0;for(Ue=0;Ue<8;++Ue){lt=We[bt],$e=We[bt+1],pe=We[bt+2],be=We[bt+3],Se=We[bt+4],Ee=We[bt+5],Ye=We[bt+6];var qt=lt+(qe=We[bt+7]),fe=lt-qe,Ze=$e+Ye,Je=$e-Ye,mt=pe+Ee,Tt=pe-Ee,It=be+Se,gt=be-Se,tn=qt+It,Zt=qt-It,Dt=Ze+mt,Ut=Ze-mt;We[bt]=tn+Dt,We[bt+4]=tn-Dt;var Qt=.707106781*(Ut+Zt);We[bt+2]=Zt+Qt,We[bt+6]=Zt-Qt;var an=.382683433*((tn=gt+Tt)-(Ut=Je+fe)),on=.5411961*tn+an,dn=1.306562965*Ut+an,Sn=.707106781*(Dt=Tt+Je),Te=fe+Sn,Qe=fe-Sn;We[bt+5]=Qe+on,We[bt+3]=Qe-on,We[bt+1]=Te+dn,We[bt+7]=Te-dn,bt+=8}for(bt=0,Ue=0;Ue<8;++Ue){lt=We[bt],$e=We[bt+8],pe=We[bt+16],be=We[bt+24],Se=We[bt+32],Ee=We[bt+40],Ye=We[bt+48];var dt=lt+(qe=We[bt+56]),ve=lt-qe,He=$e+Ye,Le=$e-Ye,Re=pe+Ee,Pe=pe-Ee,At=be+Se,rt=be-Se,Nt=dt+At,xt=dt-At,st=He+Re,St=He-Re;We[bt]=Nt+st,We[bt+32]=Nt-st;var yt=.707106781*(St+xt);We[bt+16]=xt+yt,We[bt+48]=xt-yt;var ke=.382683433*((Nt=rt+Pe)-(St=Le+ve)),pt=.5411961*Nt+ke,Lt=1.306562965*St+ke,Yt=.707106781*(st=Pe+Le),Vt=ve+Yt,nn=ve-Yt;We[bt+40]=nn+pt,We[bt+24]=nn-pt,We[bt+8]=Vt+Lt,We[bt+56]=Vt-Lt,bt++}for(Ue=0;Ue<64;++Ue)Xe=We[Ue]*tt[Ue],b[Ue]=Xe>0?Xe+.5|0:Xe-.5|0;return b})(j,U),Fe=0;Fe<64;++Fe)T[z[Fe]]=Be[Fe];var Ct=T[0]-$;$=T[0],Ct==0?re(X[0]):(re(X[_[ye=32767+Ct]]),re(v[ye]));for(var at=63;at>0&&T[at]==0;)at--;if(at==0)return re(Ae),$;for(var Ce,ce=1;ce<=at;){for(var _t=ce;T[ce]==0&&ce<=at;)++ce;var Ne=ce-_t;if(Ne>=16){Ce=Ne>>4;for(var Ve=1;Ve<=Ce;++Ve)re(De);Ne&=15}ye=32767+T[ce],re(Q[(Ne<<4)+_[ye]]),re(v[ye]),ce++}return at!=63&&re(Ae),$}function te(j){j=Math.min(Math.max(j,1),100),o!=j&&((function(U){for(var $=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var Q=l(($[X]*U+50)/100);Q=Math.min(Math.max(Q,1),255),c[z[X]]=Q}for(var ye=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Ae=0;Ae<64;Ae++){var De=l((ye[Ae]*U+50)/100);De=Math.min(Math.max(De,1),255),d[z[Ae]]=De}for(var Be=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Fe=0,Ct=0;Ct<8;Ct++)for(var at=0;at<8;at++)f[Fe]=1/(c[z[Fe]]*Be[Ct]*Be[at]*8),p[Fe]=1/(d[z[Fe]]*Be[Ct]*Be[at]*8),Fe++})(j<50?Math.floor(5e3/j):Math.floor(200-2*j)),o=j)}this.encode=function(j,U){U&&te(U),C=new Array,A=0,I=7,se(65496),se(65504),se(16),V(74),V(70),V(73),V(70),V(0),V(1),V(1),V(0),se(1),se(1),V(0),V(0),(function(){se(65499),se(132),V(0);for(var $e=0;$e<64;$e++)V(c[$e]);V(1);for(var pe=0;pe<64;pe++)V(d[pe])})(),(function($e,pe){se(65472),se(17),V(8),se(pe),se($e),V(3),V(1),V(17),V(0),V(2),V(17),V(1),V(3),V(17),V(1)})(j.width,j.height),(function(){se(65476),se(418),V(0);for(var $e=0;$e<16;$e++)V(R[$e+1]);for(var pe=0;pe<=11;pe++)V(D[pe]);V(16);for(var be=0;be<16;be++)V(F[be+1]);for(var Se=0;Se<=161;Se++)V(E[Se]);V(1);for(var Ee=0;Ee<16;Ee++)V(O[Ee+1]);for(var Ye=0;Ye<=11;Ye++)V(M[Ye]);V(17);for(var qe=0;qe<16;qe++)V(Y[qe+1]);for(var Ue=0;Ue<=161;Ue++)V(ie[Ue])})(),se(65498),se(12),V(3),V(1),V(0),V(2),V(17),V(3),V(17),V(0),V(63),V(0);var $=0,X=0,Q=0;A=0,I=7,this.encode.displayName="_encode_";for(var ye,Ae,De,Be,Fe,Ct,at,Ce,ce,_t=j.data,Ne=j.width,Ve=j.height,We=4*Ne,tt=0;tt<Ve;){for(ye=0;ye<We;){for(Fe=We*tt+ye,at=-1,Ce=0,ce=0;ce<64;ce++)Ct=Fe+(Ce=ce>>3)*We+(at=4*(7&ce)),tt+Ce>=Ve&&(Ct-=We*(tt+1+Ce-Ve)),ye+at>=We&&(Ct-=ye+at-We+4),Ae=_t[Ct++],De=_t[Ct++],Be=_t[Ct++],ee[ce]=(le[Ae]+le[De+256|0]+le[Be+512|0]>>16)-128,G[ce]=(le[Ae+768|0]+le[De+1024|0]+le[Be+1280|0]>>16)-128,K[ce]=(le[Ae+1280|0]+le[De+1536|0]+le[Be+1792|0]>>16)-128;$=W(ee,f,$,e,i),X=W(G,p,X,t,s),Q=W(K,p,Q,t,s),ye+=32}tt+=8}if(I>=0){var lt=[];lt[1]=I+1,lt[0]=(1<<I+1)-1,re(lt)}return se(65497),new Uint8Array(C)},n=n||50,(function(){for(var j=String.fromCharCode,U=0;U<256;U++)de[U]=j(U)})(),e=q(R,D),t=q(O,M),i=q(F,E),s=q(Y,ie),(function(){for(var j=1,U=2,$=1;$<=15;$++){for(var X=j;X<U;X++)_[32767+X]=$,v[32767+X]=[],v[32767+X][1]=$,v[32767+X][0]=X;for(var Q=-(U-1);Q<=-j;Q++)_[32767+Q]=$,v[32767+Q]=[],v[32767+Q][1]=$,v[32767+Q][0]=U-1+Q;j<<=1,U<<=1}})(),(function(){for(var j=0;j<256;j++)le[j]=19595*j,le[j+256|0]=38470*j,le[j+512|0]=7471*j+32768,le[j+768|0]=-11059*j,le[j+1024|0]=-21709*j,le[j+1280|0]=32768*j+8421375,le[j+1536|0]=-27439*j,le[j+1792|0]=-5329*j})(),te(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function $a(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function g4(n){function e(D){if(!D)throw Error("assert :P")}function t(D,F,E){for(var O=0;4>O;O++)if(D[F+O]!=E.charCodeAt(O))return!0;return!1}function i(D,F,E,O,M){for(var Y=0;Y<M;Y++)D[F+Y]=E[O+Y]}function s(D,F,E,O){for(var M=0;M<O;M++)D[F+M]=E}function o(D){return new Int32Array(D)}function l(D,F){for(var E=[],O=0;O<D;O++)E.push(new F);return E}function c(D,F){var E=[];return(function O(M,Y,ie){for(var q=ie[Y],re=0;re<q&&(M.push(ie.length>Y+1?[]:new F),!(ie.length<Y+1));re++)O(M[re],Y+1,ie)})(E,0,D),E}var d=function(){var D=this;function F(g,x){for(var k=1<<x-1>>>0;g&k;)k>>>=1;return k?(g&k-1)+k:g}function E(g,x,k,P,J){e(!(P%k));do g[x+(P-=k)]=J;while(0<P)}function O(g,x,k,P,J){if(e(2328>=J),512>=J)var ne=o(512);else if((ne=o(J))==null)return 0;return(function(oe,ue,ge,xe,ze,ht){var we,Ke,ot=ue,kt=1<<ge,ut=o(16),jt=o(16);for(e(ze!=0),e(xe!=null),e(oe!=null),e(0<ge),Ke=0;Ke<ze;++Ke){if(15<xe[Ke])return 0;++ut[xe[Ke]]}if(ut[0]==ze)return 0;for(jt[1]=0,we=1;15>we;++we){if(ut[we]>1<<we)return 0;jt[we+1]=jt[we]+ut[we]}for(Ke=0;Ke<ze;++Ke)we=xe[Ke],0<xe[Ke]&&(ht[jt[we]++]=Ke);if(jt[15]==1)return(xe=new M).g=0,xe.value=ht[0],E(oe,ot,1,kt,xe),kt;var Ot,zt=-1,$t=kt-1,gn=0,rn=1,jn=1,ln=1<<ge;for(Ke=0,we=1,ze=2;we<=ge;++we,ze<<=1){if(rn+=jn<<=1,0>(jn-=ut[we]))return 0;for(;0<ut[we];--ut[we])(xe=new M).g=we,xe.value=ht[Ke++],E(oe,ot+gn,ze,ln,xe),gn=F(gn,we)}for(we=ge+1,ze=2;15>=we;++we,ze<<=1){if(rn+=jn<<=1,0>(jn-=ut[we]))return 0;for(;0<ut[we];--ut[we]){if(xe=new M,(gn&$t)!=zt){for(ot+=ln,Ot=1<<(zt=we)-ge;15>zt&&!(0>=(Ot-=ut[zt]));)++zt,Ot<<=1;kt+=ln=1<<(Ot=zt-ge),oe[ue+(zt=gn&$t)].g=Ot+ge,oe[ue+zt].value=ot-ue-zt}xe.g=we-ge,xe.value=ht[Ke++],E(oe,ot+(gn>>ge),ze,ln,xe),gn=F(gn,we)}}return rn!=2*jt[15]-1?0:kt})(g,x,k,P,J,ne)}function M(){this.value=this.g=0}function Y(){this.value=this.g=0}function ie(){this.G=l(5,M),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(gr,Y)}function q(g,x,k,P){e(g!=null),e(x!=null),e(2147483648>P),g.Ca=254,g.I=0,g.b=-8,g.Ka=0,g.oa=x,g.pa=k,g.Jd=x,g.Yc=k+P,g.Zc=4<=P?k+P-4+1:k,Ae(g)}function re(g,x){for(var k=0;0<x--;)k|=Be(g,128)<<x;return k}function V(g,x){var k=re(g,x);return De(g)?-k:k}function se(g,x,k,P){var J,ne=0;for(e(g!=null),e(x!=null),e(4294967288>P),g.Sb=P,g.Ra=0,g.u=0,g.h=0,4<P&&(P=4),J=0;J<P;++J)ne+=x[k+J]<<8*J;g.Ra=ne,g.bb=P,g.oa=x,g.pa=k}function W(g){for(;8<=g.u&&g.bb<g.Sb;)g.Ra>>>=8,g.Ra+=g.oa[g.pa+g.bb]<<Ta-8>>>0,++g.bb,g.u-=8;X(g)&&(g.h=1,g.u=0)}function te(g,x){if(e(0<=x),!g.h&&x<=vc){var k=$(g)&Zr[x];return g.u+=x,W(g),k}return g.h=1,g.u=0}function j(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function U(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function $(g){return g.Ra>>>(g.u&Ta-1)>>>0}function X(g){return e(g.bb<=g.Sb),g.h||g.bb==g.Sb&&g.u>Ta}function Q(g,x){g.u=x,g.h=X(g)}function ye(g){g.u>=rs&&(e(g.u>=rs),W(g))}function Ae(g){e(g!=null&&g.oa!=null),g.pa<g.Zc?(g.I=(g.oa[g.pa++]|g.I<<8)>>>0,g.b+=8):(e(g!=null&&g.oa!=null),g.pa<g.Yc?(g.b+=8,g.I=g.oa[g.pa++]|g.I<<8):g.Ka?g.b=0:(g.I<<=8,g.b+=8,g.Ka=1))}function De(g){return re(g,1)}function Be(g,x){var k=g.Ca;0>g.b&&Ae(g);var P=g.b,J=k*x>>>8,ne=(g.I>>>P>J)+0;for(ne?(k-=J,g.I-=J+1<<P>>>0):k=J+1,P=k,J=0;256<=P;)J+=8,P>>=8;return P=7^J+qh[P],g.b-=P,g.Ca=(k<<P)-1,ne}function Fe(g,x,k){g[x+0]=k>>24&255,g[x+1]=k>>16&255,g[x+2]=k>>8&255,g[x+3]=255&k}function Ct(g,x){return g[x+0]|g[x+1]<<8}function at(g,x){return Ct(g,x)|g[x+2]<<16}function Ce(g,x){return Ct(g,x)|Ct(g,x+2)<<16}function ce(g,x){var k=1<<x;return e(g!=null),e(0<x),g.X=o(k),g.X==null?0:(g.Mb=32-x,g.Xa=x,1)}function _t(g,x){e(g!=null),e(x!=null),e(g.Xa==x.Xa),i(x.X,0,g.X,0,1<<x.Xa)}function Ne(){this.X=[],this.Xa=this.Mb=0}function Ve(g,x,k,P){e(k!=null),e(P!=null);var J=k[0],ne=P[0];return J==0&&(J=(g*ne+x/2)/x),ne==0&&(ne=(x*J+g/2)/g),0>=J||0>=ne?0:(k[0]=J,P[0]=ne,1)}function We(g,x){return g+(1<<x)-1>>>x}function tt(g,x){return((4278255360&g)+(4278255360&x)>>>0&4278255360)+((16711935&g)+(16711935&x)>>>0&16711935)>>>0}function lt(g,x){D[x]=function(k,P,J,ne,oe,ue,ge){var xe;for(xe=0;xe<oe;++xe){var ze=D[g](ue[ge+xe-1],J,ne+xe);ue[ge+xe]=tt(k[P+xe],ze)}}}function $e(){this.ud=this.hd=this.jd=0}function pe(g,x){return((4278124286&(g^x))>>>1)+(g&x)>>>0}function be(g){return 0<=g&&256>g?g:0>g?0:255<g?255:void 0}function Se(g,x){return be(g+(g-x+.5>>1))}function Ee(g,x,k){return Math.abs(x-k)-Math.abs(g-k)}function Ye(g,x,k,P,J,ne,oe){for(P=ne[oe-1],k=0;k<J;++k)ne[oe+k]=P=tt(g[x+k],P)}function qe(g,x,k,P,J){var ne;for(ne=0;ne<k;++ne){var oe=g[x+ne],ue=oe>>8&255,ge=16711935&(ge=(ge=16711935&oe)+((ue<<16)+ue));P[J+ne]=(4278255360&oe)+ge>>>0}}function Ue(g,x){x.jd=255&g,x.hd=g>>8&255,x.ud=g>>16&255}function Xe(g,x,k,P,J,ne){var oe;for(oe=0;oe<P;++oe){var ue=x[k+oe],ge=ue>>>8,xe=ue,ze=255&(ze=(ze=ue>>>16)+((g.jd<<24>>24)*(ge<<24>>24)>>>5));xe=255&(xe=(xe+=(g.hd<<24>>24)*(ge<<24>>24)>>>5)+((g.ud<<24>>24)*(ze<<24>>24)>>>5)),J[ne+oe]=(4278255360&ue)+(ze<<16)+xe}}function bt(g,x,k,P,J){D[x]=function(ne,oe,ue,ge,xe,ze,ht,we,Ke){for(ge=ht;ge<we;++ge)for(ht=0;ht<Ke;++ht)xe[ze++]=J(ue[P(ne[oe++])])},D[g]=function(ne,oe,ue,ge,xe,ze,ht){var we=8>>ne.b,Ke=ne.Ea,ot=ne.K[0],kt=ne.w;if(8>we)for(ne=(1<<ne.b)-1,kt=(1<<we)-1;oe<ue;++oe){var ut,jt=0;for(ut=0;ut<Ke;++ut)ut&ne||(jt=P(ge[xe++])),ze[ht++]=J(ot[jt&kt]),jt>>=we}else D["VP8LMapColor"+k](ge,xe,ot,kt,ze,ht,oe,ue,Ke)}}function qt(g,x,k,P,J){for(k=x+k;x<k;){var ne=g[x++];P[J++]=ne>>16&255,P[J++]=ne>>8&255,P[J++]=255&ne}}function fe(g,x,k,P,J){for(k=x+k;x<k;){var ne=g[x++];P[J++]=ne>>16&255,P[J++]=ne>>8&255,P[J++]=255&ne,P[J++]=ne>>24&255}}function Ze(g,x,k,P,J){for(k=x+k;x<k;){var ne=(oe=g[x++])>>16&240|oe>>12&15,oe=240&oe|oe>>28&15;P[J++]=ne,P[J++]=oe}}function Je(g,x,k,P,J){for(k=x+k;x<k;){var ne=(oe=g[x++])>>16&248|oe>>13&7,oe=oe>>5&224|oe>>3&31;P[J++]=ne,P[J++]=oe}}function mt(g,x,k,P,J){for(k=x+k;x<k;){var ne=g[x++];P[J++]=255&ne,P[J++]=ne>>8&255,P[J++]=ne>>16&255}}function Tt(g,x,k,P,J,ne){if(ne==0)for(k=x+k;x<k;)Fe(P,((ne=g[x++])[0]>>24|ne[1]>>8&65280|ne[2]<<8&16711680|ne[3]<<24)>>>0),J+=32;else i(P,J,g,x,k)}function It(g,x){D[x][0]=D[g+"0"],D[x][1]=D[g+"1"],D[x][2]=D[g+"2"],D[x][3]=D[g+"3"],D[x][4]=D[g+"4"],D[x][5]=D[g+"5"],D[x][6]=D[g+"6"],D[x][7]=D[g+"7"],D[x][8]=D[g+"8"],D[x][9]=D[g+"9"],D[x][10]=D[g+"10"],D[x][11]=D[g+"11"],D[x][12]=D[g+"12"],D[x][13]=D[g+"13"],D[x][14]=D[g+"0"],D[x][15]=D[g+"0"]}function gt(g){return g==Tu||g==al||g==ka||g==Sc}function tn(){this.eb=[],this.size=this.A=this.fb=0}function Zt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Dt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new tn,this.f.kb=new Zt,this.sd=null}function Ut(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Qt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function an(g){return alert("todo:WebPSamplerProcessPlane"),g.T}function on(g,x){var k=g.T,P=x.ba.f.RGBA,J=P.eb,ne=P.fb+g.ka*P.A,oe=zs[x.ba.S],ue=g.y,ge=g.O,xe=g.f,ze=g.N,ht=g.ea,we=g.W,Ke=x.cc,ot=x.dc,kt=x.Mc,ut=x.Nc,jt=g.ka,Ot=g.ka+g.T,zt=g.U,$t=zt+1>>1;for(jt==0?oe(ue,ge,null,null,xe,ze,ht,we,xe,ze,ht,we,J,ne,null,null,zt):(oe(x.ec,x.fc,ue,ge,Ke,ot,kt,ut,xe,ze,ht,we,J,ne-P.A,J,ne,zt),++k);jt+2<Ot;jt+=2)Ke=xe,ot=ze,kt=ht,ut=we,ze+=g.Rc,we+=g.Rc,ne+=2*P.A,oe(ue,(ge+=2*g.fa)-g.fa,ue,ge,Ke,ot,kt,ut,xe,ze,ht,we,J,ne-P.A,J,ne,zt);return ge+=g.fa,g.j+Ot<g.o?(i(x.ec,x.fc,ue,ge,zt),i(x.cc,x.dc,xe,ze,$t),i(x.Mc,x.Nc,ht,we,$t),k--):1&Ot||oe(ue,ge,null,null,xe,ze,ht,we,xe,ze,ht,we,J,ne+P.A,null,null,zt),k}function dn(g,x,k){var P=g.F,J=[g.J];if(P!=null){var ne=g.U,oe=x.ba.S,ue=oe==Il||oe==ka;x=x.ba.f.RGBA;var ge=[0],xe=g.ka;ge[0]=g.T,g.Kb&&(xe==0?--ge[0]:(--xe,J[0]-=g.width),g.j+g.ka+g.T==g.o&&(ge[0]=g.o-g.j-xe));var ze=x.eb;xe=x.fb+xe*x.A,g=tr(P,J[0],g.width,ne,ge,ze,xe+(ue?0:3),x.A),e(k==ge),g&&gt(oe)&&_c(ze,xe,ue,ne,ge,x.A)}return 0}function Sn(g){var x=g.ma,k=x.ba.S,P=11>k,J=k==xc||k==Eu||k==Il||k==Ca||k==12||gt(k);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!Ks(x.Oa,g,J?11:12))return 0;if(J&&gt(k)&&pr(),g.da)alert("todo:use_scaling");else{if(P){if(x.Ib=an,g.Kb){if(k=g.U+1>>1,x.memory=o(g.U+2*k),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+g.U,x.Mc=x.cc,x.Nc=x.dc+k,x.Ib=on,pr()}}else alert("todo:EmitYUV");J&&(x.Jb=dn,P&&Qr())}if(P&&!mp){for(g=0;256>g;++g)u1[g]=89858*(g-128)+As>>ca,Lu[g]=-22014*(g-128)+As,Jh[g]=-45773*(g-128),Ds[g]=113618*(g-128)+As>>ca;for(g=ul;g<Pd;++g)x=76283*(g-16)+As>>ca,Au[g-ul]=Xn(x,255),ef[g-ul]=Xn(x+8>>4,15);mp=1}return 1}function Te(g){var x=g.ma,k=g.U,P=g.T;return e(!(1&g.ka)),0>=k||0>=P?0:(k=x.Ib(g,x),x.Jb!=null&&x.Jb(g,x,k),x.Dc+=k,1)}function Qe(g){g.ma.memory=null}function dt(g,x,k,P){return te(g,8)!=47?0:(x[0]=te(g,14)+1,k[0]=te(g,14)+1,P[0]=te(g,1),te(g,3)!=0?0:!g.h)}function ve(g,x){if(4>g)return g+1;var k=g-2>>1;return(2+(1&g)<<k)+te(x,k)+1}function He(g,x){return 120<x?x-120:1<=(k=((k=Aa[x-1])>>4)*g+(8-(15&k)))?k:1;var k}function Le(g,x,k){var P=$(k),J=g[x+=255&P].g-8;return 0<J&&(Q(k,k.u+8),P=$(k),x+=g[x].value,x+=P&(1<<J)-1),Q(k,k.u+g[x].g),g[x].value}function Re(g,x,k){return k.g+=g.g,k.value+=g.value<<x>>>0,e(8>=k.g),g.g}function Pe(g,x,k){var P=g.xc;return e((x=P==0?0:g.vc[g.md*(k>>P)+(x>>P)])<g.Wb),g.Ya[x]}function At(g,x,k,P){var J=g.ab,ne=g.c*x,oe=g.C;x=oe+x;var ue=k,ge=P;for(P=g.Ta,k=g.Ua;0<J--;){var xe=g.gc[J],ze=oe,ht=x,we=ue,Ke=ge,ot=(ge=P,ue=k,xe.Ea);switch(e(ze<ht),e(ht<=xe.nc),xe.hc){case 2:bc(we,Ke,(ht-ze)*ot,ge,ue);break;case 0:var kt=ze,ut=ht,jt=ge,Ot=ue,zt=(ln=xe).Ea;kt==0&&(Jr(we,Ke,null,null,1,jt,Ot),Ye(we,Ke+1,0,0,zt-1,jt,Ot+1),Ke+=zt,Ot+=zt,++kt);for(var $t=1<<ln.b,gn=$t-1,rn=We(zt,ln.b),jn=ln.K,ln=ln.w+(kt>>ln.b)*rn;kt<ut;){var Qn=jn,Ss=ln,Dn=1;for(ea(we,Ke,jt,Ot-zt,1,jt,Ot);Dn<zt;){var un=(Dn&~gn)+$t;un>zt&&(un=zt),(0,ol[Qn[Ss++]>>8&15])(we,Ke+ +Dn,jt,Ot+Dn-zt,un-Dn,jt,Ot+Dn),Dn=un}Ke+=zt,Ot+=zt,++kt&gn||(ln+=rn)}ht!=xe.nc&&i(ge,ue-ot,ge,ue+(ht-ze-1)*ot,ot);break;case 1:for(ot=we,ut=Ke,zt=(we=xe.Ea)-(Ot=we&~(jt=(Ke=1<<xe.b)-1)),kt=We(we,xe.b),$t=xe.K,xe=xe.w+(ze>>xe.b)*kt;ze<ht;){for(gn=$t,rn=xe,jn=new $e,ln=ut+Ot,Qn=ut+we;ut<ln;)Ue(gn[rn++],jn),na(jn,ot,ut,Ke,ge,ue),ut+=Ke,ue+=Ke;ut<Qn&&(Ue(gn[rn++],jn),na(jn,ot,ut,zt,ge,ue),ut+=zt,ue+=zt),++ze&jt||(xe+=kt)}break;case 3:if(we==ge&&Ke==ue&&0<xe.b){for(ut=ge,we=ot=ue+(ht-ze)*ot-(Ot=(ht-ze)*We(xe.Ea,xe.b)),Ke=ge,jt=ue,kt=[],Ot=(zt=Ot)-1;0<=Ot;--Ot)kt[Ot]=Ke[jt+Ot];for(Ot=zt-1;0<=Ot;--Ot)ut[we+Ot]=kt[Ot];xu(xe,ze,ht,ge,ot,ge,ue)}else xu(xe,ze,ht,we,Ke,ge,ue)}ue=P,ge=k}ge!=k&&i(P,k,ue,ge,ne)}function rt(g,x){var k=g.V,P=g.Ba+g.c*g.C,J=x-g.C;if(e(x<=g.l.o),e(16>=J),0<J){var ne=g.l,oe=g.Ta,ue=g.Ua,ge=ne.width;if(At(g,J,k,P),J=ue=[ue],e((k=g.C)<(P=x)),e(ne.v<ne.va),P>ne.o&&(P=ne.o),k<ne.j){var xe=ne.j-k;k=ne.j,J[0]+=xe*ge}if(k>=P?k=0:(J[0]+=4*ne.v,ne.ka=k-ne.j,ne.U=ne.va-ne.v,ne.T=P-k,k=1),k){if(ue=ue[0],11>(k=g.ca).S){var ze=k.f.RGBA,ht=(P=k.S,J=ne.U,ne=ne.T,xe=ze.eb,ze.A),we=ne;for(ze=ze.fb+g.Ma*ze.A;0<we--;){var Ke=oe,ot=ue,kt=J,ut=xe,jt=ze;switch(P){case co:wc(Ke,ot,kt,ut,jt);break;case xc:So(Ke,ot,kt,ut,jt);break;case Tu:So(Ke,ot,kt,ut,jt),_c(ut,jt,0,kt,1,0);break;case oa:Ni(Ke,ot,kt,ut,jt);break;case Eu:Tt(Ke,ot,kt,ut,jt,1);break;case al:Tt(Ke,ot,kt,ut,jt,1),_c(ut,jt,0,kt,1,0);break;case Il:Tt(Ke,ot,kt,ut,jt,0);break;case ka:Tt(Ke,ot,kt,ut,jt,0),_c(ut,jt,1,kt,1,0);break;case Ca:ia(Ke,ot,kt,ut,jt);break;case Sc:ia(Ke,ot,kt,ut,jt),er(ut,jt,kt,1,0);break;case Od:gi(Ke,ot,kt,ut,jt);break;default:e(0)}ue+=ge,ze+=ht}g.Ma+=ne}else alert("todo:EmitRescaledRowsYUVA");e(g.Ma<=k.height)}}g.C=x,e(g.C<=g.i)}function Nt(g){var x;if(0<g.ua)return 0;for(x=0;x<g.Wb;++x){var k=g.Ya[x].G,P=g.Ya[x].H;if(0<k[1][P[1]+0].g||0<k[2][P[2]+0].g||0<k[3][P[3]+0].g)return 0}return 1}function xt(g,x,k,P,J,ne){if(g.Z!=0){var oe=g.qd,ue=g.rd;for(e(aa[g.Z]!=null);x<k;++x)aa[g.Z](oe,ue,P,J,P,J,ne),oe=P,ue=J,J+=ne;g.qd=oe,g.rd=ue}}function st(g,x){var k=g.l.ma,P=k.Z==0||k.Z==1?g.l.j:g.C;if(P=g.C<P?P:g.C,e(x<=g.l.o),x>P){var J=g.l.width,ne=k.ca,oe=k.tb+J*P,ue=g.V,ge=g.Ba+g.c*P,xe=g.gc;e(g.ab==1),e(xe[0].hc==3),ta(xe[0],P,x,ue,ge,ne,oe),xt(k,P,x,ne,oe,J)}g.C=g.Ma=x}function St(g,x,k,P,J,ne,oe){var ue=g.$/P,ge=g.$%P,xe=g.m,ze=g.s,ht=k+g.$,we=ht;J=k+P*J;var Ke=k+P*ne,ot=280+ze.ua,kt=g.Pb?ue:16777216,ut=0<ze.ua?ze.Wa:null,jt=ze.wc,Ot=ht<Ke?Pe(ze,ge,ue):null;e(g.C<ne),e(Ke<=J);var zt=!1;e:for(;;){for(;zt||ht<Ke;){var $t=0;if(ue>=kt){var gn=ht-k;e((kt=g).Pb),kt.wd=kt.m,kt.xd=gn,0<kt.s.ua&&_t(kt.s.Wa,kt.s.vb),kt=ue+dp}if(ge&jt||(Ot=Pe(ze,ge,ue)),e(Ot!=null),Ot.Qb&&(x[ht]=Ot.qb,zt=!0),!zt)if(ye(xe),Ot.jc){$t=xe,gn=x;var rn=ht,jn=Ot.pd[$($t)&gr-1];e(Ot.jc),256>jn.g?(Q($t,$t.u+jn.g),gn[rn]=jn.value,$t=0):(Q($t,$t.u+jn.g-256),e(256<=jn.value),$t=jn.value),$t==0&&(zt=!0)}else $t=Le(Ot.G[0],Ot.H[0],xe);if(xe.h)break;if(zt||256>$t){if(!zt)if(Ot.nd)x[ht]=(Ot.qb|$t<<8)>>>0;else{if(ye(xe),zt=Le(Ot.G[1],Ot.H[1],xe),ye(xe),gn=Le(Ot.G[2],Ot.H[2],xe),rn=Le(Ot.G[3],Ot.H[3],xe),xe.h)break;x[ht]=(rn<<24|zt<<16|$t<<8|gn)>>>0}if(zt=!1,++ht,++ge>=P&&(ge=0,++ue,oe!=null&&ue<=ne&&!(ue%16)&&oe(g,ue),ut!=null))for(;we<ht;)$t=x[we++],ut.X[(506832829*$t&4294967295)>>>ut.Mb]=$t}else if(280>$t){if($t=ve($t-256,xe),gn=Le(Ot.G[4],Ot.H[4],xe),ye(xe),gn=He(P,gn=ve(gn,xe)),xe.h)break;if(ht-k<gn||J-ht<$t)break e;for(rn=0;rn<$t;++rn)x[ht+rn]=x[ht+rn-gn];for(ht+=$t,ge+=$t;ge>=P;)ge-=P,++ue,oe!=null&&ue<=ne&&!(ue%16)&&oe(g,ue);if(e(ht<=J),ge&jt&&(Ot=Pe(ze,ge,ue)),ut!=null)for(;we<ht;)$t=x[we++],ut.X[(506832829*$t&4294967295)>>>ut.Mb]=$t}else{if(!($t<ot))break e;for(zt=$t-280,e(ut!=null);we<ht;)$t=x[we++],ut.X[(506832829*$t&4294967295)>>>ut.Mb]=$t;$t=ht,e(!(zt>>>(gn=ut).Xa)),x[$t]=gn.X[zt],zt=!0}zt||e(xe.h==X(xe))}if(g.Pb&&xe.h&&ht<J)e(g.m.h),g.a=5,g.m=g.wd,g.$=g.xd,0<g.s.ua&&_t(g.s.vb,g.s.Wa);else{if(xe.h)break e;oe?.(g,ue>ne?ne:ue),g.a=0,g.$=ht-k}return 1}return g.a=3,0}function yt(g){e(g!=null),g.vc=null,g.yc=null,g.Ya=null;var x=g.Wa;x!=null&&(x.X=null),g.vb=null,e(g!=null)}function ke(){var g=new ji;return g==null?null:(g.a=0,g.xb=Nc,It("Predictor","VP8LPredictors"),It("Predictor","VP8LPredictors_C"),It("PredictorAdd","VP8LPredictorsAdd"),It("PredictorAdd","VP8LPredictorsAdd_C"),bc=qe,na=Xe,wc=qt,So=fe,ia=Ze,gi=Je,Ni=mt,D.VP8LMapColor32b=Bs,D.VP8LMapColor8b=sl,g)}function pt(g,x,k,P,J){var ne=1,oe=[g],ue=[x],ge=P.m,xe=P.s,ze=null,ht=0;e:for(;;){if(k)for(;ne&&te(ge,1);){var we=oe,Ke=ue,ot=P,kt=1,ut=ot.m,jt=ot.gc[ot.ab],Ot=te(ut,2);if(ot.Oc&1<<Ot)ne=0;else{switch(ot.Oc|=1<<Ot,jt.hc=Ot,jt.Ea=we[0],jt.nc=Ke[0],jt.K=[null],++ot.ab,e(4>=ot.ab),Ot){case 0:case 1:jt.b=te(ut,3)+2,kt=pt(We(jt.Ea,jt.b),We(jt.nc,jt.b),0,ot,jt.K),jt.K=jt.K[0];break;case 3:var zt,$t=te(ut,8)+1,gn=16<$t?0:4<$t?1:2<$t?2:3;if(we[0]=We(jt.Ea,gn),jt.b=gn,zt=kt=pt($t,1,0,ot,jt.K)){var rn,jn=$t,ln=jt,Qn=1<<(8>>ln.b),Ss=o(Qn);if(Ss==null)zt=0;else{var Dn=ln.K[0],un=ln.w;for(Ss[0]=ln.K[0][0],rn=1;rn<1*jn;++rn)Ss[rn]=tt(Dn[un+rn],Ss[rn-1]);for(;rn<4*Qn;++rn)Ss[rn]=0;ln.K[0]=null,ln.K[0]=Ss,zt=1}}kt=zt;break;case 2:break;default:e(0)}ne=kt}}if(oe=oe[0],ue=ue[0],ne&&te(ge,1)&&!(ne=1<=(ht=te(ge,4))&&11>=ht)){P.a=3;break e}var Jt;if(Jt=ne)t:{var Zi,Mn,Wn,hn=P,Un=oe,oi=ue,Bi=ht,ps=k,gs=hn.m,ls=hn.s,Kn=[null],ri=1,cs=0,Nn=Ul[Bi];n:for(;;){if(ps&&te(gs,1)){var Os=te(gs,3)+2,sr=We(Un,Os),us=We(oi,Os),To=sr*us;if(!pt(sr,us,0,hn,Kn))break n;for(Kn=Kn[0],ls.xc=Os,Zi=0;Zi<To;++Zi){var Ci=Kn[Zi]>>8&65535;Kn[Zi]=Ci,Ci>=ri&&(ri=Ci+1)}}if(gs.h)break n;for(Mn=0;5>Mn;++Mn){var ys=nr[Mn];!Mn&&0<Bi&&(ys+=1<<Bi),cs<ys&&(cs=ys)}var Co=l(ri*Nn,M),Xs=ri,Mi=l(Xs,ie);if(Mi==null)var ci=null;else e(65536>=Xs),ci=Mi;var uo=o(cs);if(ci==null||uo==null||Co==null){hn.a=1;break n}var Qs=Co;for(Zi=Wn=0;Zi<ri;++Zi){var _i=ci[Zi],ko=_i.G,js=_i.H,ua=0,Rr=1,Ms=0;for(Mn=0;5>Mn;++Mn){ys=nr[Mn],ko[Mn]=Qs,js[Mn]=Wn,!Mn&&0<Bi&&(ys+=1<<Bi);s:{var Du,Ud=ys,Ou=hn,Tc=uo,yp=Qs,vp=Wn,ju=0,Ma=Ou.m,h1=te(Ma,1);if(s(Tc,0,0,Ud),h1){var bp=te(Ma,1)+1,wp=te(Ma,1),tf=te(Ma,wp==0?1:8);Tc[tf]=1,bp==2&&(Tc[tf=te(Ma,8)]=1);var Cc=1}else{var nf=o(19),sf=te(Ma,4)+4;if(19<sf){Ou.a=3;var Mu=0;break s}for(Du=0;Du<sf;++Du)nf[La[Du]]=te(Ma,3);var Fd=void 0,kc=void 0,_p=Ou,xp=nf,Ra=Ud,Ru=Tc,$d=0,Ir=_p.m,Lc=8,of=l(128,M);i:for(;O(of,0,7,xp,19);){if(te(Ir,1)){var Sp=2+2*te(Ir,3);if((Fd=2+te(Ir,Sp))>Ra)break i}else Fd=Ra;for(kc=0;kc<Ra&&Fd--;){ye(Ir);var rf=of[0+(127&$(Ir))];Q(Ir,Ir.u+rf.g);var Bl=rf.value;if(16>Bl)Ru[kc++]=Bl,Bl!=0&&(Lc=Bl);else{var Np=Bl==16,af=Bl-16,lf=wr[af],cf=te(Ir,jd[af])+lf;if(kc+cf>Ra)break i;for(var Ep=Np?Lc:0;0<cf--;)Ru[kc++]=Ep}}$d=1;break i}$d||(_p.a=3),Cc=$d}(Cc=Cc&&!Ma.h)&&(ju=O(yp,vp,8,Tc,Ud)),Cc&&ju!=0?Mu=ju:(Ou.a=3,Mu=0)}if(Mu==0)break n;if(Rr&&Pl[Mn]==1&&(Rr=Qs[Wn].g==0),ua+=Qs[Wn].g,Wn+=Mu,3>=Mn){var Wl,Bd=uo[0];for(Wl=1;Wl<ys;++Wl)uo[Wl]>Bd&&(Bd=uo[Wl]);Ms+=Bd}}if(_i.nd=Rr,_i.Qb=0,Rr&&(_i.qb=(ko[3][js[3]+0].value<<24|ko[1][js[1]+0].value<<16|ko[2][js[2]+0].value)>>>0,ua==0&&256>ko[0][js[0]+0].value&&(_i.Qb=1,_i.qb+=ko[0][js[0]+0].value<<8)),_i.jc=!_i.Qb&&6>Ms,_i.jc){var Iu,Ia=_i;for(Iu=0;Iu<gr;++Iu){var da=Iu,Pa=Ia.pd[da],Pu=Ia.G[0][Ia.H[0]+da];256<=Pu.value?(Pa.g=Pu.g+256,Pa.value=Pu.value):(Pa.g=0,Pa.value=0,da>>=Re(Pu,8,Pa),da>>=Re(Ia.G[1][Ia.H[1]+da],16,Pa),da>>=Re(Ia.G[2][Ia.H[2]+da],0,Pa),Re(Ia.G[3][Ia.H[3]+da],24,Pa))}}}ls.vc=Kn,ls.Wb=ri,ls.Ya=ci,ls.yc=Co,Jt=1;break t}Jt=0}if(!(ne=Jt)){P.a=3;break e}if(0<ht){if(xe.ua=1<<ht,!ce(xe.Wa,ht)){P.a=1,ne=0;break e}}else xe.ua=0;var Uu=P,uf=oe,Tp=ue,df=Uu.s,hf=df.xc;if(Uu.c=uf,Uu.i=Tp,df.md=We(uf,hf),df.wc=hf==0?-1:(1<<hf)-1,k){P.xb=fp;break e}if((ze=o(oe*ue))==null){P.a=1,ne=0;break e}ne=(ne=St(P,ze,0,oe,ue,ue,null))&&!ge.h;break e}return ne?(J!=null?J[0]=ze:(e(ze==null),e(k)),P.$=0,k||yt(xe)):yt(xe),ne}function Lt(g,x){var k=g.c*g.i,P=k+x+16*x;return e(g.c<=x),g.V=o(P),g.V==null?(g.Ta=null,g.Ua=0,g.a=1,0):(g.Ta=g.V,g.Ua=g.Ba+k+x,1)}function Yt(g,x){var k=g.C,P=x-k,J=g.V,ne=g.Ba+g.c*k;for(e(x<=g.l.o);0<P;){var oe=16<P?16:P,ue=g.l.ma,ge=g.l.width,xe=ge*oe,ze=ue.ca,ht=ue.tb+ge*k,we=g.Ta,Ke=g.Ua;At(g,oe,J,ne),jl(we,Ke,ze,ht,xe),xt(ue,k,k+oe,ze,ht,ge),P-=oe,J+=oe*g.c,k+=oe}e(k==x),g.C=g.Ma=x}function Vt(){this.ub=this.yd=this.td=this.Rb=0}function nn(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function yn(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function en(){this.Yb=(function(){var g=[];return(function x(k,P,J){for(var ne=J[P],oe=0;oe<ne&&(k.push(J.length>P+1?[]:0),!(J.length<P+1));oe++)x(k[oe],P+1,J)})(g,0,[3,11]),g})()}function wn(){this.jb=o(3),this.Wc=c([4,8],en),this.Xc=c([4,17],en)}function In(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function Tn(){this.ld=this.La=this.dd=this.tc=0}function Vn(){this.Na=this.la=0}function Ei(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ts(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function fs(){this.uc=this.M=this.Nb=0,this.wa=Array(new Tn),this.Y=0,this.ya=Array(new ts),this.aa=0,this.l=new Ar}function Mo(){this.y=o(16),this.f=o(8),this.ea=o(8)}function Lr(){this.cb=this.a=0,this.sc="",this.m=new j,this.Od=new Vt,this.Kc=new nn,this.ed=new In,this.Qa=new yn,this.Ic=this.$c=this.Aa=0,this.D=new fs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,j),this.ia=0,this.pb=l(4,Ei),this.Pa=new wn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Mo),this.Hd=0,this.rb=Array(new Vn),this.sb=0,this.wa=Array(new Tn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ts),this.L=this.aa=0,this.gd=c([4,2],Tn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ar(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Vs(){var g=new Lr;return g!=null&&(g.a=0,g.sc="OK",g.cb=0,g.Xb=0,Ls||(Ls=no)),g}function Yn(g,x,k){return g.a==0&&(g.a=x,g.sc=k,g.cb=0),0}function ai(g,x,k){return 3<=k&&g[x+0]==157&&g[x+1]==1&&g[x+2]==42}function tl(g,x){if(g==null)return 0;if(g.a=0,g.sc="OK",x==null)return Yn(g,2,"null VP8Io passed to VP8GetHeaders()");var k=x.data,P=x.w,J=x.ha;if(4>J)return Yn(g,7,"Truncated header.");var ne=k[P+0]|k[P+1]<<8|k[P+2]<<16,oe=g.Od;if(oe.Rb=!(1&ne),oe.td=ne>>1&7,oe.yd=ne>>4&1,oe.ub=ne>>5,3<oe.td)return Yn(g,3,"Incorrect keyframe parameters.");if(!oe.yd)return Yn(g,4,"Frame not displayable.");P+=3,J-=3;var ue=g.Kc;if(oe.Rb){if(7>J)return Yn(g,7,"cannot parse picture header");if(!ai(k,P,J))return Yn(g,3,"Bad code word");ue.c=16383&(k[P+4]<<8|k[P+3]),ue.Td=k[P+4]>>6,ue.i=16383&(k[P+6]<<8|k[P+5]),ue.Ud=k[P+6]>>6,P+=7,J-=7,g.za=ue.c+15>>4,g.Ub=ue.i+15>>4,x.width=ue.c,x.height=ue.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,s((ne=g.Pa).jb,0,255,ne.jb.length),e((ne=g.Qa)!=null),ne.Cb=0,ne.Bb=0,ne.Fb=1,s(ne.Zb,0,0,ne.Zb.length),s(ne.Lb,0,0,ne.Lb)}if(oe.ub>J)return Yn(g,7,"bad partition length");q(ne=g.m,k,P,oe.ub),P+=oe.ub,J-=oe.ub,oe.Rb&&(ue.Ld=De(ne),ue.Kd=De(ne)),ue=g.Qa;var ge,xe=g.Pa;if(e(ne!=null),e(ue!=null),ue.Cb=De(ne),ue.Cb){if(ue.Bb=De(ne),De(ne)){for(ue.Fb=De(ne),ge=0;4>ge;++ge)ue.Zb[ge]=De(ne)?V(ne,7):0;for(ge=0;4>ge;++ge)ue.Lb[ge]=De(ne)?V(ne,6):0}if(ue.Bb)for(ge=0;3>ge;++ge)xe.jb[ge]=De(ne)?re(ne,8):255}else ue.Bb=0;if(ne.Ka)return Yn(g,3,"cannot parse segment header");if((ue=g.ed).zd=De(ne),ue.Tb=re(ne,6),ue.wb=re(ne,3),ue.Pc=De(ne),ue.Pc&&De(ne)){for(xe=0;4>xe;++xe)De(ne)&&(ue.vd[xe]=V(ne,6));for(xe=0;4>xe;++xe)De(ne)&&(ue.od[xe]=V(ne,6))}if(g.L=ue.Tb==0?0:ue.zd?1:2,ne.Ka)return Yn(g,3,"cannot parse filter header");var ze=J;if(J=ge=P,P=ge+ze,ue=ze,g.Xb=(1<<re(g.m,2))-1,ze<3*(xe=g.Xb))k=7;else{for(ge+=3*xe,ue-=3*xe,ze=0;ze<xe;++ze){var ht=k[J+0]|k[J+1]<<8|k[J+2]<<16;ht>ue&&(ht=ue),q(g.Jc[+ze],k,ge,ht),ge+=ht,ue-=ht,J+=3}q(g.Jc[+xe],k,ge,ue),k=ge<P?0:5}if(k!=0)return Yn(g,k,"cannot parse partitions");for(k=re(ge=g.m,7),J=De(ge)?V(ge,4):0,P=De(ge)?V(ge,4):0,ue=De(ge)?V(ge,4):0,xe=De(ge)?V(ge,4):0,ge=De(ge)?V(ge,4):0,ze=g.Qa,ht=0;4>ht;++ht){if(ze.Cb){var we=ze.Zb[ht];ze.Fb||(we+=k)}else{if(0<ht){g.pb[ht]=g.pb[0];continue}we=k}var Ke=g.pb[ht];Ke.Sc[0]=Cu[Xn(we+J,127)],Ke.Sc[1]=ku[Xn(we+0,127)],Ke.Eb[0]=2*Cu[Xn(we+P,127)],Ke.Eb[1]=101581*ku[Xn(we+ue,127)]>>16,8>Ke.Eb[1]&&(Ke.Eb[1]=8),Ke.Qc[0]=Cu[Xn(we+xe,117)],Ke.Qc[1]=ku[Xn(we+ge,127)],Ke.lc=we+ge}if(!oe.Rb)return Yn(g,4,"Not a key frame.");for(De(ne),oe=g.Pa,k=0;4>k;++k){for(J=0;8>J;++J)for(P=0;3>P;++P)for(ue=0;11>ue;++ue)xe=Be(ne,Fl[k][J][P][ue])?re(ne,8):ra[k][J][P][ue],oe.Wc[k][J].Yb[P][ue]=xe;for(J=0;17>J;++J)oe.Xc[k][J]=oe.Wc[k][hp[J]]}return g.kc=De(ne),g.kc&&(g.Bd=re(ne,8)),g.cb=1}function no(g,x,k,P,J,ne,oe){var ue=x[J].Yb[k];for(k=0;16>J;++J){if(!Be(g,ue[k+0]))return J;for(;!Be(g,ue[k+1]);)if(ue=x[++J].Yb[0],k=0,J==16)return 16;var ge=x[J+1].Yb;if(Be(g,ue[k+2])){var xe=g,ze=0;if(Be(xe,(we=ue)[(ht=k)+3]))if(Be(xe,we[ht+6])){for(ue=0,ht=2*(ze=Be(xe,we[ht+8]))+(we=Be(xe,we[ht+9+ze])),ze=0,we=as[ht];we[ue];++ue)ze+=ze+Be(xe,we[ue]);ze+=3+(8<<ht)}else Be(xe,we[ht+7])?(ze=7+2*Be(xe,165),ze+=Be(xe,145)):ze=5+Be(xe,159);else ze=Be(xe,we[ht+4])?3+Be(xe,we[ht+5]):2;ue=ge[2]}else ze=1,ue=ge[1];ge=oe+yi[J],0>(xe=g).b&&Ae(xe);var ht,we=xe.b,Ke=(ht=xe.Ca>>1)-(xe.I>>we)>>31;--xe.b,xe.Ca+=Ke,xe.Ca|=1,xe.I-=(ht+1&Ke)<<we,ne[ge]=((ze^Ke)-Ke)*P[(0<J)+0]}return 16}function Ro(g){var x=g.rb[g.sb-1];x.la=0,x.Na=0,s(g.zc,0,0,g.zc.length),g.ja=0}function ns(g,x,k,P,J){J=g[x+k+32*P]+(J>>3),g[x+k+32*P]=-256&J?0>J?0:255:J}function dr(g,x,k,P,J,ne){ns(g,x,0,k,P+J),ns(g,x,1,k,P+ne),ns(g,x,2,k,P-ne),ns(g,x,3,k,P-J)}function $n(g){return(20091*g>>16)+g}function ks(g,x,k,P){var J,ne=0,oe=o(16);for(J=0;4>J;++J){var ue=g[x+0]+g[x+8],ge=g[x+0]-g[x+8],xe=(35468*g[x+4]>>16)-$n(g[x+12]),ze=$n(g[x+4])+(35468*g[x+12]>>16);oe[ne+0]=ue+ze,oe[ne+1]=ge+xe,oe[ne+2]=ge-xe,oe[ne+3]=ue-ze,ne+=4,x++}for(J=ne=0;4>J;++J)ue=(g=oe[ne+0]+4)+oe[ne+8],ge=g-oe[ne+8],xe=(35468*oe[ne+4]>>16)-$n(oe[ne+12]),ns(k,P,0,0,ue+(ze=$n(oe[ne+4])+(35468*oe[ne+12]>>16))),ns(k,P,1,0,ge+xe),ns(k,P,2,0,ge-xe),ns(k,P,3,0,ue-ze),ne++,P+=32}function Dr(g,x,k,P){var J=g[x+0]+4,ne=35468*g[x+4]>>16,oe=$n(g[x+4]),ue=35468*g[x+1]>>16;dr(k,P,0,J+oe,g=$n(g[x+1]),ue),dr(k,P,1,J+ne,g,ue),dr(k,P,2,J-ne,g,ue),dr(k,P,3,J-oe,g,ue)}function Or(g,x,k,P,J){ks(g,x,k,P),J&&ks(g,x+16,k,P+4)}function Qo(g,x,k,P){Qi(g,x+0,k,P,1),Qi(g,x+32,k,P+128,1)}function zn(g,x,k,P){var J;for(g=g[x+0]+4,J=0;4>J;++J)for(x=0;4>x;++x)ns(k,P,x,J,g)}function hr(g,x,k,P){g[x+0]&&No(g,x+0,k,P),g[x+16]&&No(g,x+16,k,P+4),g[x+32]&&No(g,x+32,k,P+128),g[x+48]&&No(g,x+48,k,P+128+4)}function io(g,x,k,P){var J,ne=o(16);for(J=0;4>J;++J){var oe=g[x+0+J]+g[x+12+J],ue=g[x+4+J]+g[x+8+J],ge=g[x+4+J]-g[x+8+J],xe=g[x+0+J]-g[x+12+J];ne[0+J]=oe+ue,ne[8+J]=oe-ue,ne[4+J]=xe+ge,ne[12+J]=xe-ge}for(J=0;4>J;++J)oe=(g=ne[0+4*J]+3)+ne[3+4*J],ue=ne[1+4*J]+ne[2+4*J],ge=ne[1+4*J]-ne[2+4*J],xe=g-ne[3+4*J],k[P+0]=oe+ue>>3,k[P+16]=xe+ge>>3,k[P+32]=oe-ue>>3,k[P+48]=xe-ge>>3,P+=64}function so(g,x,k){var P,J=x-32,ne=Ws,oe=255-g[J-1];for(P=0;P<k;++P){var ue,ge=ne,xe=oe+g[x-1];for(ue=0;ue<k;++ue)g[x+ue]=ge[xe+g[J+ue]];x+=32}}function Ht(g,x){so(g,x,4)}function _n(g,x){so(g,x,8)}function Ui(g,x){so(g,x,16)}function is(g,x){var k;for(k=0;16>k;++k)i(g,x+32*k,g,x-32,16)}function qi(g,x){var k;for(k=16;0<k;--k)s(g,x,g[x-1],16),x+=32}function ss(g,x,k){var P;for(P=0;16>P;++P)s(x,k+32*P,g,16)}function Vi(g,x){var k,P=16;for(k=0;16>k;++k)P+=g[x-1+32*k]+g[x+k-32];ss(P>>5,g,x)}function Oi(g,x){var k,P=8;for(k=0;16>k;++k)P+=g[x-1+32*k];ss(P>>4,g,x)}function Fn(g,x){var k,P=8;for(k=0;16>k;++k)P+=g[x+k-32];ss(P>>4,g,x)}function mi(g,x){ss(128,g,x)}function cn(g,x,k){return g+2*x+k+2>>2}function Io(g,x){var k,P=x-32;for(P=new Uint8Array([cn(g[P-1],g[P+0],g[P+1]),cn(g[P+0],g[P+1],g[P+2]),cn(g[P+1],g[P+2],g[P+3]),cn(g[P+2],g[P+3],g[P+4])]),k=0;4>k;++k)i(g,x+32*k,P,0,P.length)}function Po(g,x){var k=g[x-1],P=g[x-1+32],J=g[x-1+64],ne=g[x-1+96];Fe(g,x+0,16843009*cn(g[x-1-32],k,P)),Fe(g,x+32,16843009*cn(k,P,J)),Fe(g,x+64,16843009*cn(P,J,ne)),Fe(g,x+96,16843009*cn(J,ne,ne))}function bs(g,x){var k,P=4;for(k=0;4>k;++k)P+=g[x+k-32]+g[x-1+32*k];for(P>>=3,k=0;4>k;++k)s(g,x+32*k,P,4)}function bo(g,x){var k=g[x-1+0],P=g[x-1+32],J=g[x-1+64],ne=g[x-1-32],oe=g[x+0-32],ue=g[x+1-32],ge=g[x+2-32],xe=g[x+3-32];g[x+0+96]=cn(P,J,g[x-1+96]),g[x+1+96]=g[x+0+64]=cn(k,P,J),g[x+2+96]=g[x+1+64]=g[x+0+32]=cn(ne,k,P),g[x+3+96]=g[x+2+64]=g[x+1+32]=g[x+0+0]=cn(oe,ne,k),g[x+3+64]=g[x+2+32]=g[x+1+0]=cn(ue,oe,ne),g[x+3+32]=g[x+2+0]=cn(ge,ue,oe),g[x+3+0]=cn(xe,ge,ue)}function os(g,x){var k=g[x+1-32],P=g[x+2-32],J=g[x+3-32],ne=g[x+4-32],oe=g[x+5-32],ue=g[x+6-32],ge=g[x+7-32];g[x+0+0]=cn(g[x+0-32],k,P),g[x+1+0]=g[x+0+32]=cn(k,P,J),g[x+2+0]=g[x+1+32]=g[x+0+64]=cn(P,J,ne),g[x+3+0]=g[x+2+32]=g[x+1+64]=g[x+0+96]=cn(J,ne,oe),g[x+3+32]=g[x+2+64]=g[x+1+96]=cn(ne,oe,ue),g[x+3+64]=g[x+2+96]=cn(oe,ue,ge),g[x+3+96]=cn(ue,ge,ge)}function Ys(g,x){var k=g[x-1+0],P=g[x-1+32],J=g[x-1+64],ne=g[x-1-32],oe=g[x+0-32],ue=g[x+1-32],ge=g[x+2-32],xe=g[x+3-32];g[x+0+0]=g[x+1+64]=ne+oe+1>>1,g[x+1+0]=g[x+2+64]=oe+ue+1>>1,g[x+2+0]=g[x+3+64]=ue+ge+1>>1,g[x+3+0]=ge+xe+1>>1,g[x+0+96]=cn(J,P,k),g[x+0+64]=cn(P,k,ne),g[x+0+32]=g[x+1+96]=cn(k,ne,oe),g[x+1+32]=g[x+2+96]=cn(ne,oe,ue),g[x+2+32]=g[x+3+96]=cn(oe,ue,ge),g[x+3+32]=cn(ue,ge,xe)}function fr(g,x){var k=g[x+0-32],P=g[x+1-32],J=g[x+2-32],ne=g[x+3-32],oe=g[x+4-32],ue=g[x+5-32],ge=g[x+6-32],xe=g[x+7-32];g[x+0+0]=k+P+1>>1,g[x+1+0]=g[x+0+64]=P+J+1>>1,g[x+2+0]=g[x+1+64]=J+ne+1>>1,g[x+3+0]=g[x+2+64]=ne+oe+1>>1,g[x+0+32]=cn(k,P,J),g[x+1+32]=g[x+0+96]=cn(P,J,ne),g[x+2+32]=g[x+1+96]=cn(J,ne,oe),g[x+3+32]=g[x+2+96]=cn(ne,oe,ue),g[x+3+64]=cn(oe,ue,ge),g[x+3+96]=cn(ue,ge,xe)}function Vr(g,x){var k=g[x-1+0],P=g[x-1+32],J=g[x-1+64],ne=g[x-1+96];g[x+0+0]=k+P+1>>1,g[x+2+0]=g[x+0+32]=P+J+1>>1,g[x+2+32]=g[x+0+64]=J+ne+1>>1,g[x+1+0]=cn(k,P,J),g[x+3+0]=g[x+1+32]=cn(P,J,ne),g[x+3+32]=g[x+1+64]=cn(J,ne,ne),g[x+3+64]=g[x+2+64]=g[x+0+96]=g[x+1+96]=g[x+2+96]=g[x+3+96]=ne}function Uo(g,x){var k=g[x-1+0],P=g[x-1+32],J=g[x-1+64],ne=g[x-1+96],oe=g[x-1-32],ue=g[x+0-32],ge=g[x+1-32],xe=g[x+2-32];g[x+0+0]=g[x+2+32]=k+oe+1>>1,g[x+0+32]=g[x+2+64]=P+k+1>>1,g[x+0+64]=g[x+2+96]=J+P+1>>1,g[x+0+96]=ne+J+1>>1,g[x+3+0]=cn(ue,ge,xe),g[x+2+0]=cn(oe,ue,ge),g[x+1+0]=g[x+3+32]=cn(k,oe,ue),g[x+1+32]=g[x+3+64]=cn(P,k,oe),g[x+1+64]=g[x+3+96]=cn(J,P,k),g[x+1+96]=cn(ne,J,P)}function Ea(g,x){var k;for(k=0;8>k;++k)i(g,x+32*k,g,x-32,8)}function oo(g,x){var k;for(k=0;8>k;++k)s(g,x,g[x-1],8),x+=32}function wo(g,x,k){var P;for(P=0;8>P;++P)s(x,k+32*P,g,8)}function Yr(g,x){var k,P=8;for(k=0;8>k;++k)P+=g[x+k-32]+g[x-1+32*k];wo(P>>4,g,x)}function ws(g,x){var k,P=4;for(k=0;8>k;++k)P+=g[x+k-32];wo(P>>3,g,x)}function li(g,x){var k,P=4;for(k=0;8>k;++k)P+=g[x-1+32*k];wo(P>>3,g,x)}function Gr(g,x){wo(128,g,x)}function Zo(g,x,k){var P=g[x-k],J=g[x+0],ne=3*(J-P)+Dd[1020+g[x-2*k]-g[x+k]],oe=Rl[112+(ne+4>>3)];g[x-k]=Ws[255+P+Rl[112+(ne+3>>3)]],g[x+0]=Ws[255+J-oe]}function Kr(g,x,k,P){var J=g[x+0],ne=g[x+k];return br[255+g[x-2*k]-g[x-k]]>P||br[255+ne-J]>P}function Xr(g,x,k,P){return 4*br[255+g[x-k]-g[x+0]]+br[255+g[x-2*k]-g[x+k]]<=P}function jr(g,x,k,P,J){var ne=g[x-3*k],oe=g[x-2*k],ue=g[x-k],ge=g[x+0],xe=g[x+k],ze=g[x+2*k],ht=g[x+3*k];return 4*br[255+ue-ge]+br[255+oe-xe]>P?0:br[255+g[x-4*k]-ne]<=J&&br[255+ne-oe]<=J&&br[255+oe-ue]<=J&&br[255+ht-ze]<=J&&br[255+ze-xe]<=J&&br[255+xe-ge]<=J}function Fo(g,x,k,P){var J=2*P+1;for(P=0;16>P;++P)Xr(g,x+P,k,J)&&Zo(g,x+P,k)}function Jo(g,x,k,P){var J=2*P+1;for(P=0;16>P;++P)Xr(g,x+P*k,1,J)&&Zo(g,x+P*k,1)}function ro(g,x,k,P){var J;for(J=3;0<J;--J)Fo(g,x+=4*k,k,P)}function nl(g,x,k,P){var J;for(J=3;0<J;--J)Jo(g,x+=4,k,P)}function _o(g,x,k,P,J,ne,oe,ue){for(ne=2*ne+1;0<J--;){if(jr(g,x,k,ne,oe))if(Kr(g,x,k,ue))Zo(g,x,k);else{var ge=g,xe=x,ze=k,ht=ge[xe-2*ze],we=ge[xe-ze],Ke=ge[xe+0],ot=ge[xe+ze],kt=ge[xe+2*ze],ut=27*(Ot=Dd[1020+3*(Ke-we)+Dd[1020+ht-ot]])+63>>7,jt=18*Ot+63>>7,Ot=9*Ot+63>>7;ge[xe-3*ze]=Ws[255+ge[xe-3*ze]+Ot],ge[xe-2*ze]=Ws[255+ht+jt],ge[xe-ze]=Ws[255+we+ut],ge[xe+0]=Ws[255+Ke-ut],ge[xe+ze]=Ws[255+ot-jt],ge[xe+2*ze]=Ws[255+kt-Ot]}x+=P}}function ao(g,x,k,P,J,ne,oe,ue){for(ne=2*ne+1;0<J--;){if(jr(g,x,k,ne,oe))if(Kr(g,x,k,ue))Zo(g,x,k);else{var ge=g,xe=x,ze=k,ht=ge[xe-ze],we=ge[xe+0],Ke=ge[xe+ze],ot=Rl[112+(4+(kt=3*(we-ht))>>3)],kt=Rl[112+(kt+3>>3)],ut=ot+1>>1;ge[xe-2*ze]=Ws[255+ge[xe-2*ze]+ut],ge[xe-ze]=Ws[255+ht+kt],ge[xe+0]=Ws[255+we-ot],ge[xe+ze]=Ws[255+Ke-ut]}x+=P}}function N(g,x,k,P,J,ne){_o(g,x,k,1,16,P,J,ne)}function Z(g,x,k,P,J,ne){_o(g,x,1,k,16,P,J,ne)}function _e(g,x,k,P,J,ne){var oe;for(oe=3;0<oe;--oe)ao(g,x+=4*k,k,1,16,P,J,ne)}function Ie(g,x,k,P,J,ne){var oe;for(oe=3;0<oe;--oe)ao(g,x+=4,1,k,16,P,J,ne)}function et(g,x,k,P,J,ne,oe,ue){_o(g,x,J,1,8,ne,oe,ue),_o(k,P,J,1,8,ne,oe,ue)}function Mt(g,x,k,P,J,ne,oe,ue){_o(g,x,1,J,8,ne,oe,ue),_o(k,P,1,J,8,ne,oe,ue)}function Wt(g,x,k,P,J,ne,oe,ue){ao(g,x+4*J,J,1,8,ne,oe,ue),ao(k,P+4*J,J,1,8,ne,oe,ue)}function sn(g,x,k,P,J,ne,oe,ue){ao(g,x+4,1,J,8,ne,oe,ue),ao(k,P+4,1,J,8,ne,oe,ue)}function fn(){this.ba=new Dt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Qt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function xn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function An(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Gn(){this.ua=0,this.Wa=new Ne,this.vb=new Ne,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ie,this.yc=new M}function ji(){this.xb=this.a=0,this.l=new Ar,this.ca=new Dt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new U,this.Pb=0,this.wd=new U,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Gn,this.ab=0,this.gc=l(4,An),this.Oc=0}function Fi(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ar,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function pi(g,x,k,P,J,ne,oe){for(g=g==null?0:g[x+0],x=0;x<oe;++x)J[ne+x]=g+k[P+x]&255,g=J[ne+x]}function Xi(g,x,k,P,J,ne,oe){var ue;if(g==null)pi(null,null,k,P,J,ne,oe);else for(ue=0;ue<oe;++ue)J[ne+ue]=g[x+ue]+k[P+ue]&255}function Si(g,x,k,P,J,ne,oe){if(g==null)pi(null,null,k,P,J,ne,oe);else{var ue,ge=g[x+0],xe=ge,ze=ge;for(ue=0;ue<oe;++ue)xe=ze+(ge=g[x+ue])-xe,ze=k[P+ue]+(-256&xe?0>xe?0:255:xe)&255,xe=ge,J[ne+ue]=ze}}function _s(g,x,k,P){var J=x.width,ne=x.o;if(e(g!=null&&x!=null),0>k||0>=P||k+P>ne)return null;if(!g.Cc){if(g.ga==null){var oe;if(g.ga=new Fi,(oe=g.ga==null)||(oe=x.width*x.o,e(g.Gb.length==0),g.Gb=o(oe),g.Uc=0,g.Gb==null?oe=0:(g.mb=g.Gb,g.nb=g.Uc,g.rc=null,oe=1),oe=!oe),!oe){oe=g.ga;var ue=g.Fa,ge=g.P,xe=g.qc,ze=g.mb,ht=g.nb,we=ge+1,Ke=xe-1,ot=oe.l;if(e(ue!=null&&ze!=null&&x!=null),aa[0]=null,aa[1]=pi,aa[2]=Xi,aa[3]=Si,oe.ca=ze,oe.tb=ht,oe.c=x.width,oe.i=x.height,e(0<oe.c&&0<oe.i),1>=xe)x=0;else if(oe.$a=3&ue[ge+0],oe.Z=ue[ge+0]>>2&3,oe.Lc=ue[ge+0]>>4&3,ge=ue[ge+0]>>6&3,0>oe.$a||1<oe.$a||4<=oe.Z||1<oe.Lc||ge)x=0;else if(ot.put=Te,ot.ac=Sn,ot.bc=Qe,ot.ma=oe,ot.width=x.width,ot.height=x.height,ot.Da=x.Da,ot.v=x.v,ot.va=x.va,ot.j=x.j,ot.o=x.o,oe.$a)e:{e(oe.$a==1),x=ke();t:for(;;){if(x==null){x=0;break e}if(e(oe!=null),oe.mc=x,x.c=oe.c,x.i=oe.i,x.l=oe.l,x.l.ma=oe,x.l.width=oe.c,x.l.height=oe.i,x.a=0,se(x.m,ue,we,Ke),!pt(oe.c,oe.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&Nt(x.s)?(oe.ic=1,ue=x.c*x.i,x.Ta=null,x.Ua=0,x.V=o(ue),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(oe.ic=0,x=Lt(x,oe.c)),!x))break t;x=1;break e}oe.mc=null,x=0}else x=Ke>=oe.c*oe.i;oe=!x}if(oe)return null;g.ga.Lc!=1?g.Ga=0:P=ne-k}e(g.ga!=null),e(k+P<=ne);e:{if(x=(ue=g.ga).c,ne=ue.l.o,ue.$a==0){if(we=g.rc,Ke=g.Vc,ot=g.Fa,ge=g.P+1+k*x,xe=g.mb,ze=g.nb+k*x,e(ge<=g.P+g.qc),ue.Z!=0)for(e(aa[ue.Z]!=null),oe=0;oe<P;++oe)aa[ue.Z](we,Ke,ot,ge,xe,ze,x),we=xe,Ke=ze,ze+=x,ge+=x;else for(oe=0;oe<P;++oe)i(xe,ze,ot,ge,x),we=xe,Ke=ze,ze+=x,ge+=x;g.rc=we,g.Vc=Ke}else{if(e(ue.mc!=null),x=k+P,e((oe=ue.mc)!=null),e(x<=oe.i),oe.C>=x)x=1;else if(ue.ic||Qr(),ue.ic){ue=oe.V,we=oe.Ba,Ke=oe.c;var kt=oe.i,ut=(ot=1,ge=oe.$/Ke,xe=oe.$%Ke,ze=oe.m,ht=oe.s,oe.$),jt=Ke*kt,Ot=Ke*x,zt=ht.wc,$t=ut<Ot?Pe(ht,xe,ge):null;e(ut<=jt),e(x<=kt),e(Nt(ht));t:for(;;){for(;!ze.h&&ut<Ot;){if(xe&zt||($t=Pe(ht,xe,ge)),e($t!=null),ye(ze),256>(kt=Le($t.G[0],$t.H[0],ze)))ue[we+ut]=kt,++ut,++xe>=Ke&&(xe=0,++ge<=x&&!(ge%16)&&st(oe,ge));else{if(!(280>kt)){ot=0;break t}kt=ve(kt-256,ze);var gn,rn=Le($t.G[4],$t.H[4],ze);if(ye(ze),!(ut>=(rn=He(Ke,rn=ve(rn,ze)))&&jt-ut>=kt)){ot=0;break t}for(gn=0;gn<kt;++gn)ue[we+ut+gn]=ue[we+ut+gn-rn];for(ut+=kt,xe+=kt;xe>=Ke;)xe-=Ke,++ge<=x&&!(ge%16)&&st(oe,ge);ut<Ot&&xe&zt&&($t=Pe(ht,xe,ge))}e(ze.h==X(ze))}st(oe,ge>x?x:ge);break t}!ot||ze.h&&ut<jt?(ot=0,oe.a=ze.h?5:3):oe.$=ut,x=ot}else x=St(oe,oe.V,oe.Ba,oe.c,oe.i,x,Yt);if(!x){P=0;break e}}k+P>=ne&&(g.Cc=1),P=1}if(!P)return null;if(g.Cc&&((P=g.ga)!=null&&(P.mc=null),g.ga=null,0<g.Ga))return alert("todo:WebPDequantizeLevels"),null}return g.nb+k*J}function mr(g,x,k,P,J,ne){for(;0<J--;){var oe,ue=g,ge=x+(k?1:0),xe=g,ze=x+(k?0:3);for(oe=0;oe<P;++oe){var ht=xe[ze+4*oe];ht!=255&&(ht*=32897,ue[ge+4*oe+0]=ue[ge+4*oe+0]*ht>>23,ue[ge+4*oe+1]=ue[ge+4*oe+1]*ht>>23,ue[ge+4*oe+2]=ue[ge+4*oe+2]*ht>>23)}x+=ne}}function Mr(g,x,k,P,J){for(;0<P--;){var ne;for(ne=0;ne<k;++ne){var oe=g[x+2*ne+0],ue=15&(xe=g[x+2*ne+1]),ge=4369*ue,xe=(240&xe|xe>>4)*ge>>16;g[x+2*ne+0]=(240&oe|oe>>4)*ge>>16&240|(15&oe|oe<<4)*ge>>16>>4&15,g[x+2*ne+1]=240&xe|ue}x+=J}}function gc(g,x,k,P,J,ne,oe,ue){var ge,xe,ze=255;for(xe=0;xe<J;++xe){for(ge=0;ge<P;++ge){var ht=g[x+ge];ne[oe+4*ge]=ht,ze&=ht}x+=k,oe+=ue}return ze!=255}function Gs(g,x,k,P,J){var ne;for(ne=0;ne<J;++ne)k[P+ne]=g[x+ne]>>8}function Qr(){_c=mr,er=Mr,tr=gc,jl=Gs}function $o(g,x,k){D[g]=function(P,J,ne,oe,ue,ge,xe,ze,ht,we,Ke,ot,kt,ut,jt,Ot,zt){var $t,gn=zt-1>>1,rn=ue[ge+0]|xe[ze+0]<<16,jn=ht[we+0]|Ke[ot+0]<<16;e(P!=null);var ln=3*rn+jn+131074>>2;for(x(P[J+0],255&ln,ln>>16,kt,ut),ne!=null&&(ln=3*jn+rn+131074>>2,x(ne[oe+0],255&ln,ln>>16,jt,Ot)),$t=1;$t<=gn;++$t){var Qn=ue[ge+$t]|xe[ze+$t]<<16,Ss=ht[we+$t]|Ke[ot+$t]<<16,Dn=rn+Qn+jn+Ss+524296,un=Dn+2*(Qn+jn)>>3;ln=un+rn>>1,rn=(Dn=Dn+2*(rn+Ss)>>3)+Qn>>1,x(P[J+2*$t-1],255&ln,ln>>16,kt,ut+(2*$t-1)*k),x(P[J+2*$t-0],255&rn,rn>>16,kt,ut+(2*$t-0)*k),ne!=null&&(ln=Dn+jn>>1,rn=un+Ss>>1,x(ne[oe+2*$t-1],255&ln,ln>>16,jt,Ot+(2*$t-1)*k),x(ne[oe+2*$t+0],255&rn,rn>>16,jt,Ot+(2*$t+0)*k)),rn=Qn,jn=Ss}1&zt||(ln=3*rn+jn+131074>>2,x(P[J+zt-1],255&ln,ln>>16,kt,ut+(zt-1)*k),ne!=null&&(ln=3*jn+rn+131074>>2,x(ne[oe+zt-1],255&ln,ln>>16,jt,Ot+(zt-1)*k)))}}function pr(){zs[co]=Oa,zs[xc]=la,zs[oa]=cl,zs[Eu]=Md,zs[Il]=Rd,zs[Ca]=Ec,zs[Od]=Id,zs[Tu]=la,zs[al]=Md,zs[ka]=Rd,zs[Sc]=Ec}function y(g){return g&-16384?0>g?0:255:g>>c1}function L(g,x){return y((19077*g>>8)+(26149*x>>8)-14234)}function B(g,x,k){return y((19077*g>>8)-(6419*x>>8)-(13320*k>>8)+8708)}function he(g,x){return y((19077*g>>8)+(33050*x>>8)-17685)}function it(g,x,k,P,J){P[J+0]=L(g,k),P[J+1]=B(g,x,k),P[J+2]=he(g,x)}function Et(g,x,k,P,J){P[J+0]=he(g,x),P[J+1]=B(g,x,k),P[J+2]=L(g,k)}function Gt(g,x,k,P,J){var ne=B(g,x,k);x=ne<<3&224|he(g,x)>>3,P[J+0]=248&L(g,k)|ne>>5,P[J+1]=x}function Pn(g,x,k,P,J){var ne=240&he(g,x)|15;P[J+0]=240&L(g,k)|B(g,x,k)>>4,P[J+1]=ne}function Ti(g,x,k,P,J){P[J+0]=255,it(g,x,k,P,J+1)}function Hn(g,x,k,P,J){Et(g,x,k,P,J),P[J+3]=255}function ms(g,x,k,P,J){it(g,x,k,P,J),P[J+3]=255}function Xn(g,x){return 0>g?0:g>x?x:g}function xs(g,x,k){D[g]=function(P,J,ne,oe,ue,ge,xe,ze,ht){for(var we=ze+(-2&ht)*k;ze!=we;)x(P[J+0],ne[oe+0],ue[ge+0],xe,ze),x(P[J+1],ne[oe+0],ue[ge+0],xe,ze+k),J+=2,++oe,++ge,ze+=2*k;1&ht&&x(P[J+0],ne[oe+0],ue[ge+0],xe,ze)}}function $s(g,x,k){return k==0?g==0?x==0?6:5:x==0?4:0:k}function Bo(g,x,k,P,J){switch(g>>>30){case 3:Qi(x,k,P,J,0);break;case 2:sa(x,k,P,J);break;case 1:No(x,k,P,J)}}function lo(g,x){var k,P,J=x.M,ne=x.Nb,oe=g.oc,ue=g.pc+40,ge=g.oc,xe=g.pc+584,ze=g.oc,ht=g.pc+600;for(k=0;16>k;++k)oe[ue+32*k-1]=129;for(k=0;8>k;++k)ge[xe+32*k-1]=129,ze[ht+32*k-1]=129;for(0<J?oe[ue-1-32]=ge[xe-1-32]=ze[ht-1-32]=129:(s(oe,ue-32-1,127,21),s(ge,xe-32-1,127,9),s(ze,ht-32-1,127,9)),P=0;P<g.za;++P){var we=x.ya[x.aa+P];if(0<P){for(k=-1;16>k;++k)i(oe,ue+32*k-4,oe,ue+32*k+12,4);for(k=-1;8>k;++k)i(ge,xe+32*k-4,ge,xe+32*k+4,4),i(ze,ht+32*k-4,ze,ht+32*k+4,4)}var Ke=g.Gd,ot=g.Hd+P,kt=we.ad,ut=we.Hc;if(0<J&&(i(oe,ue-32,Ke[ot].y,0,16),i(ge,xe-32,Ke[ot].f,0,8),i(ze,ht-32,Ke[ot].ea,0,8)),we.Za){var jt=oe,Ot=ue-32+16;for(0<J&&(P>=g.za-1?s(jt,Ot,Ke[ot].y[15],4):i(jt,Ot,Ke[ot+1].y,0,4)),k=0;4>k;k++)jt[Ot+128+k]=jt[Ot+256+k]=jt[Ot+384+k]=jt[Ot+0+k];for(k=0;16>k;++k,ut<<=2)jt=oe,Ot=ue+$l[k],Eo[we.Ob[k]](jt,Ot),Bo(ut,kt,16*+k,jt,Ot)}else if(jt=$s(P,J,we.Ob[0]),Da[jt](oe,ue),ut!=0)for(k=0;16>k;++k,ut<<=2)Bo(ut,kt,16*+k,oe,ue+$l[k]);for(k=we.Gc,jt=$s(P,J,we.Dd),ir[jt](ge,xe),ir[jt](ze,ht),ut=kt,jt=ge,Ot=xe,255&(we=0|k)&&(170&we?yr(ut,256,jt,Ot):Ol(ut,256,jt,Ot)),we=ze,ut=ht,255&(k>>=8)&&(170&k?yr(kt,320,we,ut):Ol(kt,320,we,ut)),J<g.Ub-1&&(i(Ke[ot].y,0,oe,ue+480,16),i(Ke[ot].f,0,ge,xe+224,8),i(Ke[ot].ea,0,ze,ht+224,8)),k=8*ne*g.B,Ke=g.sa,ot=g.ta+16*P+16*ne*g.R,kt=g.qa,we=g.ra+8*P+k,ut=g.Ha,jt=g.Ia+8*P+k,k=0;16>k;++k)i(Ke,ot+k*g.R,oe,ue+32*k,16);for(k=0;8>k;++k)i(kt,we+k*g.B,ge,xe+32*k,8),i(ut,jt+k*g.B,ze,ht+32*k,8)}}function yc(g,x,k,P,J,ne,oe,ue,ge){var xe=[0],ze=[0],ht=0,we=ge!=null?ge.kd:0,Ke=ge??new xn;if(g==null||12>k)return 7;Ke.data=g,Ke.w=x,Ke.ha=k,x=[x],k=[k],Ke.gb=[Ke.gb];e:{var ot=x,kt=k,ut=Ke.gb;if(e(g!=null),e(kt!=null),e(ut!=null),ut[0]=0,12<=kt[0]&&!t(g,ot[0],"RIFF")){if(t(g,ot[0]+8,"WEBP")){ut=3;break e}var jt=Ce(g,ot[0]+4);if(12>jt||4294967286<jt){ut=3;break e}if(we&&jt>kt[0]-8){ut=7;break e}ut[0]=jt,ot[0]+=12,kt[0]-=12}ut=0}if(ut!=0)return ut;for(jt=0<Ke.gb[0],k=k[0];;){e:{var Ot=g;kt=x,ut=k;var zt=xe,$t=ze,gn=ot=[0];if((ln=ht=[ht])[0]=0,8>ut[0])ut=7;else{if(!t(Ot,kt[0],"VP8X")){if(Ce(Ot,kt[0]+4)!=10){ut=3;break e}if(18>ut[0]){ut=7;break e}var rn=Ce(Ot,kt[0]+8),jn=1+at(Ot,kt[0]+12);if(2147483648<=jn*(Ot=1+at(Ot,kt[0]+15))){ut=3;break e}gn!=null&&(gn[0]=rn),zt!=null&&(zt[0]=jn),$t!=null&&($t[0]=Ot),kt[0]+=18,ut[0]-=18,ln[0]=1}ut=0}}if(ht=ht[0],ot=ot[0],ut!=0)return ut;if(kt=!!(2&ot),!jt&&ht)return 3;if(ne!=null&&(ne[0]=!!(16&ot)),oe!=null&&(oe[0]=kt),ue!=null&&(ue[0]=0),oe=xe[0],ot=ze[0],ht&&kt&&ge==null){ut=0;break}if(4>k){ut=7;break}if(jt&&ht||!jt&&!ht&&!t(g,x[0],"ALPH")){k=[k],Ke.na=[Ke.na],Ke.P=[Ke.P],Ke.Sa=[Ke.Sa];e:{rn=g,ut=x,jt=k;var ln=Ke.gb;zt=Ke.na,$t=Ke.P,gn=Ke.Sa,jn=22,e(rn!=null),e(jt!=null),Ot=ut[0];var Qn=jt[0];for(e(zt!=null),e(gn!=null),zt[0]=null,$t[0]=null,gn[0]=0;;){if(ut[0]=Ot,jt[0]=Qn,8>Qn){ut=7;break e}var Ss=Ce(rn,Ot+4);if(4294967286<Ss){ut=3;break e}var Dn=8+Ss+1&-2;if(jn+=Dn,0<ln&&jn>ln){ut=3;break e}if(!t(rn,Ot,"VP8 ")||!t(rn,Ot,"VP8L")){ut=0;break e}if(Qn[0]<Dn){ut=7;break e}t(rn,Ot,"ALPH")||(zt[0]=rn,$t[0]=Ot+8,gn[0]=Ss),Ot+=Dn,Qn-=Dn}}if(k=k[0],Ke.na=Ke.na[0],Ke.P=Ke.P[0],Ke.Sa=Ke.Sa[0],ut!=0)break}k=[k],Ke.Ja=[Ke.Ja],Ke.xa=[Ke.xa];e:if(ln=g,ut=x,jt=k,zt=Ke.gb[0],$t=Ke.Ja,gn=Ke.xa,rn=ut[0],Ot=!t(ln,rn,"VP8 "),jn=!t(ln,rn,"VP8L"),e(ln!=null),e(jt!=null),e($t!=null),e(gn!=null),8>jt[0])ut=7;else{if(Ot||jn){if(ln=Ce(ln,rn+4),12<=zt&&ln>zt-12){ut=3;break e}if(we&&ln>jt[0]-8){ut=7;break e}$t[0]=ln,ut[0]+=8,jt[0]-=8,gn[0]=jn}else gn[0]=5<=jt[0]&&ln[rn+0]==47&&!(ln[rn+4]>>5),$t[0]=jt[0];ut=0}if(k=k[0],Ke.Ja=Ke.Ja[0],Ke.xa=Ke.xa[0],x=x[0],ut!=0)break;if(4294967286<Ke.Ja)return 3;if(ue==null||kt||(ue[0]=Ke.xa?2:1),oe=[oe],ot=[ot],Ke.xa){if(5>k){ut=7;break}ue=oe,we=ot,kt=ne,g==null||5>k?g=0:5<=k&&g[x+0]==47&&!(g[x+4]>>5)?(jt=[0],ln=[0],zt=[0],se($t=new U,g,x,k),dt($t,jt,ln,zt)?(ue!=null&&(ue[0]=jt[0]),we!=null&&(we[0]=ln[0]),kt!=null&&(kt[0]=zt[0]),g=1):g=0):g=0}else{if(10>k){ut=7;break}ue=ot,g==null||10>k||!ai(g,x+3,k-3)?g=0:(we=g[x+0]|g[x+1]<<8|g[x+2]<<16,kt=16383&(g[x+7]<<8|g[x+6]),g=16383&(g[x+9]<<8|g[x+8]),1&we||3<(we>>1&7)||!(we>>4&1)||we>>5>=Ke.Ja||!kt||!g?g=0:(oe&&(oe[0]=kt),ue&&(ue[0]=g),g=1))}if(!g||(oe=oe[0],ot=ot[0],ht&&(xe[0]!=oe||ze[0]!=ot)))return 3;ge!=null&&(ge[0]=Ke,ge.offset=x-ge.w,e(4294967286>x-ge.w),e(ge.offset==ge.ha-k));break}return ut==0||ut==7&&ht&&ge==null?(ne!=null&&(ne[0]|=Ke.na!=null&&0<Ke.na.length),P!=null&&(P[0]=oe),J!=null&&(J[0]=ot),0):ut}function Ks(g,x,k){var P=x.width,J=x.height,ne=0,oe=0,ue=P,ge=J;if(x.Da=g!=null&&0<g.Da,x.Da&&(ue=g.cd,ge=g.bd,ne=g.v,oe=g.j,11>k||(ne&=-2,oe&=-2),0>ne||0>oe||0>=ue||0>=ge||ne+ue>P||oe+ge>J))return 0;if(x.v=ne,x.j=oe,x.va=ne+ue,x.o=oe+ge,x.U=ue,x.T=ge,x.da=g!=null&&0<g.da,x.da){if(!Ve(ue,ge,k=[g.ib],ne=[g.hb]))return 0;x.ib=k[0],x.hb=ne[0]}return x.ob=g!=null&&g.ob,x.Kb=g==null||!g.Sd,x.da&&(x.ob=x.ib<3*P/4&&x.hb<3*J/4,x.Kb=0),1}function xo(g){if(g==null)return 2;if(11>g.S){var x=g.f.RGBA;x.fb+=(g.height-1)*x.A,x.A=-x.A}else x=g.f.kb,g=g.height,x.O+=(g-1)*x.fa,x.fa=-x.fa,x.N+=(g-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(g-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(g-1)*x.lb,x.lb=-x.lb);return 0}function il(g,x,k,P){if(P==null||0>=g||0>=x)return 2;if(k!=null){if(k.Da){var J=k.cd,ne=k.bd,oe=-2&k.v,ue=-2&k.j;if(0>oe||0>ue||0>=J||0>=ne||oe+J>g||ue+ne>x)return 2;g=J,x=ne}if(k.da){if(!Ve(g,x,J=[k.ib],ne=[k.hb]))return 2;g=J[0],x=ne[0]}}P.width=g,P.height=x;e:{var ge=P.width,xe=P.height;if(g=P.S,0>=ge||0>=xe||!(g>=co&&13>g))g=2;else{if(0>=P.Rd&&P.sd==null){oe=ne=J=x=0;var ze=(ue=ge*gp[g])*xe;if(11>g||(ne=(xe+1)/2*(x=(ge+1)/2),g==12&&(oe=(J=ge)*xe)),(xe=o(ze+2*ne+oe))==null){g=1;break e}P.sd=xe,11>g?((ge=P.f.RGBA).eb=xe,ge.fb=0,ge.A=ue,ge.size=ze):((ge=P.f.kb).y=xe,ge.O=0,ge.fa=ue,ge.Fd=ze,ge.f=xe,ge.N=0+ze,ge.Ab=x,ge.Cd=ne,ge.ea=xe,ge.W=0+ze+ne,ge.Db=x,ge.Ed=ne,g==12&&(ge.F=xe,ge.J=0+ze+2*ne),ge.Tc=oe,ge.lb=J)}if(x=1,J=P.S,ne=P.width,oe=P.height,J>=co&&13>J)if(11>J)g=P.f.RGBA,x&=(ue=Math.abs(g.A))*(oe-1)+ne<=g.size,x&=ue>=ne*gp[J],x&=g.eb!=null;else{g=P.f.kb,ue=(ne+1)/2,ze=(oe+1)/2,ge=Math.abs(g.fa),xe=Math.abs(g.Ab);var ht=Math.abs(g.Db),we=Math.abs(g.lb),Ke=we*(oe-1)+ne;x&=ge*(oe-1)+ne<=g.Fd,x&=xe*(ze-1)+ue<=g.Cd,x=(x&=ht*(ze-1)+ue<=g.Ed)&ge>=ne&xe>=ue&ht>=ue,x&=g.y!=null,x&=g.f!=null,x&=g.ea!=null,J==12&&(x&=we>=ne,x&=Ke<=g.Tc,x&=g.F!=null)}else x=0;g=x?0:2}}return g!=0||k!=null&&k.fd&&(g=xo(P)),g}var gr=64,Zr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],vc=24,Ta=32,rs=8,qh=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];lt("Predictor0","PredictorAdd0"),D.Predictor0=function(){return 4278190080},D.Predictor1=function(g){return g},D.Predictor2=function(g,x,k){return x[k+0]},D.Predictor3=function(g,x,k){return x[k+1]},D.Predictor4=function(g,x,k){return x[k-1]},D.Predictor5=function(g,x,k){return pe(pe(g,x[k+1]),x[k+0])},D.Predictor6=function(g,x,k){return pe(g,x[k-1])},D.Predictor7=function(g,x,k){return pe(g,x[k+0])},D.Predictor8=function(g,x,k){return pe(x[k-1],x[k+0])},D.Predictor9=function(g,x,k){return pe(x[k+0],x[k+1])},D.Predictor10=function(g,x,k){return pe(pe(g,x[k-1]),pe(x[k+0],x[k+1]))},D.Predictor11=function(g,x,k){var P=x[k+0];return 0>=Ee(P>>24&255,g>>24&255,(x=x[k-1])>>24&255)+Ee(P>>16&255,g>>16&255,x>>16&255)+Ee(P>>8&255,g>>8&255,x>>8&255)+Ee(255&P,255&g,255&x)?P:g},D.Predictor12=function(g,x,k){var P=x[k+0];return(be((g>>24&255)+(P>>24&255)-((x=x[k-1])>>24&255))<<24|be((g>>16&255)+(P>>16&255)-(x>>16&255))<<16|be((g>>8&255)+(P>>8&255)-(x>>8&255))<<8|be((255&g)+(255&P)-(255&x)))>>>0},D.Predictor13=function(g,x,k){var P=x[k-1];return(Se((g=pe(g,x[k+0]))>>24&255,P>>24&255)<<24|Se(g>>16&255,P>>16&255)<<16|Se(g>>8&255,P>>8&255)<<8|Se(255&g,255&P))>>>0};var Jr=D.PredictorAdd0;D.PredictorAdd1=Ye,lt("Predictor2","PredictorAdd2"),lt("Predictor3","PredictorAdd3"),lt("Predictor4","PredictorAdd4"),lt("Predictor5","PredictorAdd5"),lt("Predictor6","PredictorAdd6"),lt("Predictor7","PredictorAdd7"),lt("Predictor8","PredictorAdd8"),lt("Predictor9","PredictorAdd9"),lt("Predictor10","PredictorAdd10"),lt("Predictor11","PredictorAdd11"),lt("Predictor12","PredictorAdd12"),lt("Predictor13","PredictorAdd13");var ea=D.PredictorAdd2;bt("ColorIndexInverseTransform","MapARGB","32b",function(g){return g>>8&255},function(g){return g}),bt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(g){return g},function(g){return g>>8&255});var bc,xu=D.ColorIndexInverseTransform,Bs=D.MapARGB,ta=D.VP8LColorIndexInverseTransformAlpha,sl=D.MapAlpha,ol=D.VP8LPredictorsAdd=[];ol.length=16,(D.VP8LPredictors=[]).length=16,(D.VP8LPredictorsAdd_C=[]).length=16,(D.VP8LPredictors_C=[]).length=16;var na,wc,So,ia,gi,Ni,$i,Qi,sa,yr,No,Ol,Vh,rl,Yh,Gh,Kh,lp,cp,up,Xh,Qh,kd,vr,_c,er,tr,jl,Ld=o(511),Su=o(2041),Nu=o(225),Ad=o(767),Ml=0,Dd=Su,Rl=Nu,Ws=Ad,br=Ld,co=0,xc=1,oa=2,Eu=3,Il=4,Ca=5,Od=6,Tu=7,al=8,ka=9,Sc=10,jd=[2,3,7],wr=[3,3,11],nr=[280,256,256,256,40],Pl=[0,1,1,1,0],La=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Aa=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Ul=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],dp=8,Cu=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ku=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ls=null,as=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],yi=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ll=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],ra=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Zh=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Fl=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],hp=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Da=[],Eo=[],ir=[],fp=1,Nc=2,aa=[],zs=[];$o("UpsampleRgbLinePair",it,3),$o("UpsampleBgrLinePair",Et,3),$o("UpsampleRgbaLinePair",ms,4),$o("UpsampleBgraLinePair",Hn,4),$o("UpsampleArgbLinePair",Ti,4),$o("UpsampleRgba4444LinePair",Pn,2),$o("UpsampleRgb565LinePair",Gt,2);var Oa=D.UpsampleRgbLinePair,cl=D.UpsampleBgrLinePair,la=D.UpsampleRgbaLinePair,Md=D.UpsampleBgraLinePair,Rd=D.UpsampleArgbLinePair,Ec=D.UpsampleRgba4444LinePair,Id=D.UpsampleRgb565LinePair,ca=16,As=1<<ca-1,ul=-227,Pd=482,c1=6,mp=0,u1=o(256),Ds=o(256),Jh=o(256),Lu=o(256),Au=o(Pd-ul),ef=o(Pd-ul);xs("YuvToRgbRow",it,3),xs("YuvToBgrRow",Et,3),xs("YuvToRgbaRow",ms,4),xs("YuvToBgraRow",Hn,4),xs("YuvToArgbRow",Ti,4),xs("YuvToRgba4444Row",Pn,2),xs("YuvToRgb565Row",Gt,2);var $l=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],ja=[0,2,8],d1=[8,7,6,4,4,2,2,2,1,1,1,1],pp=1;this.WebPDecodeRGBA=function(g,x,k,P,J){var ne=xc,oe=new fn,ue=new Dt;oe.ba=ue,ue.S=ne,ue.width=[ue.width],ue.height=[ue.height];var ge=ue.width,xe=ue.height,ze=new Ut;if(ze==null||g==null)var ht=2;else e(ze!=null),ht=yc(g,x,k,ze.width,ze.height,ze.Pd,ze.Qd,ze.format,null);if(ht!=0?ge=0:(ge!=null&&(ge[0]=ze.width[0]),xe!=null&&(xe[0]=ze.height[0]),ge=1),ge){ue.width=ue.width[0],ue.height=ue.height[0],P!=null&&(P[0]=ue.width),J!=null&&(J[0]=ue.height);e:{if(P=new Ar,(J=new xn).data=g,J.w=x,J.ha=k,J.kd=1,x=[0],e(J!=null),((g=yc(J.data,J.w,J.ha,null,null,null,x,null,J))==0||g==7)&&x[0]&&(g=4),(x=g)==0){if(e(oe!=null),P.data=J.data,P.w=J.w+J.offset,P.ha=J.ha-J.offset,P.put=Te,P.ac=Sn,P.bc=Qe,P.ma=oe,J.xa){if((g=ke())==null){oe=1;break e}if((function(we,Ke){var ot=[0],kt=[0],ut=[0];t:for(;;){if(we==null)return 0;if(Ke==null)return we.a=2,0;if(we.l=Ke,we.a=0,se(we.m,Ke.data,Ke.w,Ke.ha),!dt(we.m,ot,kt,ut)){we.a=3;break t}if(we.xb=Nc,Ke.width=ot[0],Ke.height=kt[0],!pt(ot[0],kt[0],1,we,null))break t;return 1}return e(we.a!=0),0})(g,P)){if(P=(x=il(P.width,P.height,oe.Oa,oe.ba))==0){t:{P=g;n:for(;;){if(P==null){P=0;break t}if(e(P.s.yc!=null),e(P.s.Ya!=null),e(0<P.s.Wb),e((k=P.l)!=null),e((J=k.ma)!=null),P.xb!=0){if(P.ca=J.ba,P.tb=J.tb,e(P.ca!=null),!Ks(J.Oa,k,Eu)){P.a=2;break n}if(!Lt(P,k.width)||k.da)break n;if((k.da||gt(P.ca.S))&&Qr(),11>P.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),P.ca.f.kb.F!=null&&Qr()),P.Pb&&0<P.s.ua&&P.s.vb.X==null&&!ce(P.s.vb,P.s.Wa.Xa)){P.a=1;break n}P.xb=0}if(!St(P,P.V,P.Ba,P.c,P.i,k.o,rt))break n;J.Dc=P.Ma,P=1;break t}e(P.a!=0),P=0}P=!P}P&&(x=g.a)}else x=g.a}else{if((g=new Vs)==null){oe=1;break e}if(g.Fa=J.na,g.P=J.P,g.qc=J.Sa,tl(g,P)){if((x=il(P.width,P.height,oe.Oa,oe.ba))==0){if(g.Aa=0,k=oe.Oa,e((J=g)!=null),k!=null){if(0<(ge=0>(ge=k.Md)?0:100<ge?255:255*ge/100)){for(xe=ze=0;4>xe;++xe)12>(ht=J.pb[xe]).lc&&(ht.ia=ge*d1[0>ht.lc?0:ht.lc]>>3),ze|=ht.ia;ze&&(alert("todo:VP8InitRandom"),J.ia=1)}J.Ga=k.Id,100<J.Ga?J.Ga=100:0>J.Ga&&(J.Ga=0)}(function(we,Ke){if(we==null)return 0;if(Ke==null)return Yn(we,2,"NULL VP8Io parameter in VP8Decode().");if(!we.cb&&!tl(we,Ke))return 0;if(e(we.cb),Ke.ac==null||Ke.ac(Ke)){Ke.ob&&(we.L=0);var ot=ja[we.L];if(we.L==2?(we.yb=0,we.zb=0):(we.yb=Ke.v-ot>>4,we.zb=Ke.j-ot>>4,0>we.yb&&(we.yb=0),0>we.zb&&(we.zb=0)),we.Va=Ke.o+15+ot>>4,we.Hb=Ke.va+15+ot>>4,we.Hb>we.za&&(we.Hb=we.za),we.Va>we.Ub&&(we.Va=we.Ub),0<we.L){var kt=we.ed;for(ot=0;4>ot;++ot){var ut;if(we.Qa.Cb){var jt=we.Qa.Lb[ot];we.Qa.Fb||(jt+=kt.Tb)}else jt=kt.Tb;for(ut=0;1>=ut;++ut){var Ot=we.gd[ot][ut],zt=jt;if(kt.Pc&&(zt+=kt.vd[0],ut&&(zt+=kt.od[0])),0<(zt=0>zt?0:63<zt?63:zt)){var $t=zt;0<kt.wb&&($t=4<kt.wb?$t>>2:$t>>1)>9-kt.wb&&($t=9-kt.wb),1>$t&&($t=1),Ot.dd=$t,Ot.tc=2*zt+$t,Ot.ld=40<=zt?2:15<=zt?1:0}else Ot.tc=0;Ot.La=ut}}}ot=0}else Yn(we,6,"Frame setup failed"),ot=we.a;if(ot=ot==0){if(ot){we.$c=0,0<we.Aa||(we.Ic=pp);t:{ot=we.Ic,kt=4*($t=we.za);var gn=32*$t,rn=$t+1,jn=0<we.L?$t*(0<we.Aa?2:1):0,ln=(we.Aa==2?2:1)*$t;if((Ot=kt+832+(ut=3*(16*ot+ja[we.L])/2*gn)+(jt=we.Fa!=null&&0<we.Fa.length?we.Kc.c*we.Kc.i:0))!=Ot)ot=0;else{if(Ot>we.Vb){if(we.Vb=0,we.Ec=o(Ot),we.Fc=0,we.Ec==null){ot=Yn(we,1,"no memory during frame initialization.");break t}we.Vb=Ot}Ot=we.Ec,zt=we.Fc,we.Ac=Ot,we.Bc=zt,zt+=kt,we.Gd=l(gn,Mo),we.Hd=0,we.rb=l(rn+1,Vn),we.sb=1,we.wa=jn?l(jn,Tn):null,we.Y=0,we.D.Nb=0,we.D.wa=we.wa,we.D.Y=we.Y,0<we.Aa&&(we.D.Y+=$t),e(!0),we.oc=Ot,we.pc=zt,zt+=832,we.ya=l(ln,ts),we.aa=0,we.D.ya=we.ya,we.D.aa=we.aa,we.Aa==2&&(we.D.aa+=$t),we.R=16*$t,we.B=8*$t,$t=(gn=ja[we.L])*we.R,gn=gn/2*we.B,we.sa=Ot,we.ta=zt+$t,we.qa=we.sa,we.ra=we.ta+16*ot*we.R+gn,we.Ha=we.qa,we.Ia=we.ra+8*ot*we.B+gn,we.$c=0,zt+=ut,we.mb=jt?Ot:null,we.nb=jt?zt:null,e(zt+jt<=we.Fc+we.Vb),Ro(we),s(we.Ac,we.Bc,0,kt),ot=1}}if(ot){if(Ke.ka=0,Ke.y=we.sa,Ke.O=we.ta,Ke.f=we.qa,Ke.N=we.ra,Ke.ea=we.Ha,Ke.Vd=we.Ia,Ke.fa=we.R,Ke.Rc=we.B,Ke.F=null,Ke.J=0,!Ml){for(ot=-255;255>=ot;++ot)Ld[255+ot]=0>ot?-ot:ot;for(ot=-1020;1020>=ot;++ot)Su[1020+ot]=-128>ot?-128:127<ot?127:ot;for(ot=-112;112>=ot;++ot)Nu[112+ot]=-16>ot?-16:15<ot?15:ot;for(ot=-255;510>=ot;++ot)Ad[255+ot]=0>ot?0:255<ot?255:ot;Ml=1}$i=io,Qi=Or,yr=Qo,No=zn,Ol=hr,sa=Dr,Vh=N,rl=Z,Yh=et,Gh=Mt,Kh=_e,lp=Ie,cp=Wt,up=sn,Xh=Fo,Qh=Jo,kd=ro,vr=nl,Eo[0]=bs,Eo[1]=Ht,Eo[2]=Io,Eo[3]=Po,Eo[4]=bo,Eo[5]=Ys,Eo[6]=os,Eo[7]=fr,Eo[8]=Uo,Eo[9]=Vr,Da[0]=Vi,Da[1]=Ui,Da[2]=is,Da[3]=qi,Da[4]=Oi,Da[5]=Fn,Da[6]=mi,ir[0]=Yr,ir[1]=_n,ir[2]=Ea,ir[3]=oo,ir[4]=li,ir[5]=ws,ir[6]=Gr,ot=1}else ot=0}ot&&(ot=(function(Qn,Ss){for(Qn.M=0;Qn.M<Qn.Va;++Qn.M){var Dn,un=Qn.Jc[Qn.M&Qn.Xb],Jt=Qn.m,Zi=Qn;for(Dn=0;Dn<Zi.za;++Dn){var Mn=Jt,Wn=Zi,hn=Wn.Ac,Un=Wn.Bc+4*Dn,oi=Wn.zc,Bi=Wn.ya[Wn.aa+Dn];if(Wn.Qa.Bb?Bi.$b=Be(Mn,Wn.Pa.jb[0])?2+Be(Mn,Wn.Pa.jb[2]):Be(Mn,Wn.Pa.jb[1]):Bi.$b=0,Wn.kc&&(Bi.Ad=Be(Mn,Wn.Bd)),Bi.Za=!Be(Mn,145)+0,Bi.Za){var ps=Bi.Ob,gs=0;for(Wn=0;4>Wn;++Wn){var ls,Kn=oi[0+Wn];for(ls=0;4>ls;++ls){Kn=Zh[hn[Un+ls]][Kn];for(var ri=ll[Be(Mn,Kn[0])];0<ri;)ri=ll[2*ri+Be(Mn,Kn[ri])];Kn=-ri,hn[Un+ls]=Kn}i(ps,gs,hn,Un,4),gs+=4,oi[0+Wn]=Kn}}else Kn=Be(Mn,156)?Be(Mn,128)?1:3:Be(Mn,163)?2:0,Bi.Ob[0]=Kn,s(hn,Un,Kn,4),s(oi,0,Kn,4);Bi.Dd=Be(Mn,142)?Be(Mn,114)?Be(Mn,183)?1:3:2:0}if(Zi.m.Ka)return Yn(Qn,7,"Premature end-of-partition0 encountered.");for(;Qn.ja<Qn.za;++Qn.ja){if(Zi=un,Mn=(Jt=Qn).rb[Jt.sb-1],hn=Jt.rb[Jt.sb+Jt.ja],Dn=Jt.ya[Jt.aa+Jt.ja],Un=Jt.kc?Dn.Ad:0)Mn.la=hn.la=0,Dn.Za||(Mn.Na=hn.Na=0),Dn.Hc=0,Dn.Gc=0,Dn.ia=0;else{var cs,Nn;if(Mn=hn,hn=Zi,Un=Jt.Pa.Xc,oi=Jt.ya[Jt.aa+Jt.ja],Bi=Jt.pb[oi.$b],Wn=oi.ad,ps=0,gs=Jt.rb[Jt.sb-1],Kn=ls=0,s(Wn,ps,0,384),oi.Za)var Os=0,sr=Un[3];else{ri=o(16);var us=Mn.Na+gs.Na;if(us=Ls(hn,Un[1],us,Bi.Eb,0,ri,0),Mn.Na=gs.Na=(0<us)+0,1<us)$i(ri,0,Wn,ps);else{var To=ri[0]+3>>3;for(ri=0;256>ri;ri+=16)Wn[ps+ri]=To}Os=1,sr=Un[0]}var Ci=15&Mn.la,ys=15&gs.la;for(ri=0;4>ri;++ri){var Co=1&ys;for(To=Nn=0;4>To;++To)Ci=Ci>>1|(Co=(us=Ls(hn,sr,us=Co+(1&Ci),Bi.Sc,Os,Wn,ps))>Os)<<7,Nn=Nn<<2|(3<us?3:1<us?2:Wn[ps+0]!=0),ps+=16;Ci>>=4,ys=ys>>1|Co<<7,ls=(ls<<8|Nn)>>>0}for(sr=Ci,Os=ys>>4,cs=0;4>cs;cs+=2){for(Nn=0,Ci=Mn.la>>4+cs,ys=gs.la>>4+cs,ri=0;2>ri;++ri){for(Co=1&ys,To=0;2>To;++To)us=Co+(1&Ci),Ci=Ci>>1|(Co=0<(us=Ls(hn,Un[2],us,Bi.Qc,0,Wn,ps)))<<3,Nn=Nn<<2|(3<us?3:1<us?2:Wn[ps+0]!=0),ps+=16;Ci>>=2,ys=ys>>1|Co<<5}Kn|=Nn<<4*cs,sr|=Ci<<4<<cs,Os|=(240&ys)<<cs}Mn.la=sr,gs.la=Os,oi.Hc=ls,oi.Gc=Kn,oi.ia=43690&Kn?0:Bi.ia,Un=!(ls|Kn)}if(0<Jt.L&&(Jt.wa[Jt.Y+Jt.ja]=Jt.gd[Dn.$b][Dn.Za],Jt.wa[Jt.Y+Jt.ja].La|=!Un),Zi.Ka)return Yn(Qn,7,"Premature end-of-file encountered.")}if(Ro(Qn),Jt=Ss,Zi=1,Dn=(un=Qn).D,Mn=0<un.L&&un.M>=un.zb&&un.M<=un.Va,un.Aa==0)t:{if(Dn.M=un.M,Dn.uc=Mn,lo(un,Dn),Zi=1,Dn=(Nn=un.D).Nb,Mn=(Kn=ja[un.L])*un.R,hn=Kn/2*un.B,ri=16*Dn*un.R,To=8*Dn*un.B,Un=un.sa,oi=un.ta-Mn+ri,Bi=un.qa,Wn=un.ra-hn+To,ps=un.Ha,gs=un.Ia-hn+To,ys=(Ci=Nn.M)==0,ls=Ci>=un.Va-1,un.Aa==2&&lo(un,Nn),Nn.uc)for(Co=(us=un).D.M,e(us.D.uc),Nn=us.yb;Nn<us.Hb;++Nn){Os=Nn,sr=Co;var Xs=(Mi=(Ms=us).D).Nb;cs=Ms.R;var Mi=Mi.wa[Mi.Y+Os],ci=Ms.sa,uo=Ms.ta+16*Xs*cs+16*Os,Qs=Mi.dd,_i=Mi.tc;if(_i!=0)if(e(3<=_i),Ms.L==1)0<Os&&Qh(ci,uo,cs,_i+4),Mi.La&&vr(ci,uo,cs,_i),0<sr&&Xh(ci,uo,cs,_i+4),Mi.La&&kd(ci,uo,cs,_i);else{var ko=Ms.B,js=Ms.qa,ua=Ms.ra+8*Xs*ko+8*Os,Rr=Ms.Ha,Ms=Ms.Ia+8*Xs*ko+8*Os;Xs=Mi.ld,0<Os&&(rl(ci,uo,cs,_i+4,Qs,Xs),Gh(js,ua,Rr,Ms,ko,_i+4,Qs,Xs)),Mi.La&&(lp(ci,uo,cs,_i,Qs,Xs),up(js,ua,Rr,Ms,ko,_i,Qs,Xs)),0<sr&&(Vh(ci,uo,cs,_i+4,Qs,Xs),Yh(js,ua,Rr,Ms,ko,_i+4,Qs,Xs)),Mi.La&&(Kh(ci,uo,cs,_i,Qs,Xs),cp(js,ua,Rr,Ms,ko,_i,Qs,Xs))}}if(un.ia&&alert("todo:DitherRow"),Jt.put!=null){if(Nn=16*Ci,Ci=16*(Ci+1),ys?(Jt.y=un.sa,Jt.O=un.ta+ri,Jt.f=un.qa,Jt.N=un.ra+To,Jt.ea=un.Ha,Jt.W=un.Ia+To):(Nn-=Kn,Jt.y=Un,Jt.O=oi,Jt.f=Bi,Jt.N=Wn,Jt.ea=ps,Jt.W=gs),ls||(Ci-=Kn),Ci>Jt.o&&(Ci=Jt.o),Jt.F=null,Jt.J=null,un.Fa!=null&&0<un.Fa.length&&Nn<Ci&&(Jt.J=_s(un,Jt,Nn,Ci-Nn),Jt.F=un.mb,Jt.F==null&&Jt.F.length==0)){Zi=Yn(un,3,"Could not decode alpha data.");break t}Nn<Jt.j&&(Kn=Jt.j-Nn,Nn=Jt.j,e(!(1&Kn)),Jt.O+=un.R*Kn,Jt.N+=un.B*(Kn>>1),Jt.W+=un.B*(Kn>>1),Jt.F!=null&&(Jt.J+=Jt.width*Kn)),Nn<Ci&&(Jt.O+=Jt.v,Jt.N+=Jt.v>>1,Jt.W+=Jt.v>>1,Jt.F!=null&&(Jt.J+=Jt.v),Jt.ka=Nn-Jt.j,Jt.U=Jt.va-Jt.v,Jt.T=Ci-Nn,Zi=Jt.put(Jt))}Dn+1!=un.Ic||ls||(i(un.sa,un.ta-Mn,Un,oi+16*un.R,Mn),i(un.qa,un.ra-hn,Bi,Wn+8*un.B,hn),i(un.Ha,un.Ia-hn,ps,gs+8*un.B,hn))}if(!Zi)return Yn(Qn,6,"Output aborted.")}return 1})(we,Ke)),Ke.bc!=null&&Ke.bc(Ke),ot&=1}return ot?(we.cb=0,ot):0})(g,P)||(x=g.a)}}else x=g.a}x==0&&oe.Oa!=null&&oe.Oa.fd&&(x=xo(oe.ba))}oe=x}ne=oe!=0?null:11>ne?ue.f.RGBA.eb:ue.f.kb.y}else ne=null;return ne};var gp=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(D,F){for(var E="",O=0;O<4;O++)E+=String.fromCharCode(D[F++]);return E}function p(D,F){return D[F+0]|D[F+1]<<8}function v(D,F){return(D[F+0]|D[F+1]<<8|D[F+2]<<16)>>>0}function _(D,F){return(D[F+0]|D[F+1]<<8|D[F+2]<<16|D[F+3]<<24)>>>0}new d;var b=[0],T=[0],C=[],A=new d,I=n,ee=(function(D,F){var E={},O=0,M=!1,Y=0,ie=0;if(E.frames=[],!(function(j,U){for(var $=0;$<4;$++)if(j[U+$]!="RIFF".charCodeAt($))return!0;return!1})(D,F)){for(_(D,F+=4),F+=8;F<D.length;){var q=f(D,F),re=_(D,F+=4);F+=4;var V=re+(1&re);switch(q){case"VP8 ":case"VP8L":E.frames[O]===void 0&&(E.frames[O]={}),(te=E.frames[O]).src_off=M?ie:F-8,te.src_size=Y+re+8,O++,M&&(M=!1,Y=0,ie=0);break;case"VP8X":(te=E.header={}).feature_flags=D[F];var se=F+4;te.canvas_width=1+v(D,se),se+=3,te.canvas_height=1+v(D,se),se+=3;break;case"ALPH":M=!0,Y=V+8,ie=F-8;break;case"ANIM":(te=E.header).bgcolor=_(D,F),se=F+4,te.loop_count=p(D,se),se+=2;break;case"ANMF":var W,te;(te=E.frames[O]={}).offset_x=2*v(D,F),F+=3,te.offset_y=2*v(D,F),F+=3,te.width=1+v(D,F),F+=3,te.height=1+v(D,F),F+=3,te.duration=v(D,F),F+=3,W=D[F++],te.dispose=1&W,te.blend=W>>1&1}q!="ANMF"&&(F+=V)}return E}})(I,0);ee.response=I,ee.rgbaoutput=!0,ee.dataurl=!1;var G=ee.header?ee.header:null,K=ee.frames?ee.frames:null;if(G){G.loop_counter=G.loop_count,b=[G.canvas_height],T=[G.canvas_width];for(var de=0;de<K.length&&K[de].blend!=0;de++);}var le=K[0],z=A.WebPDecodeRGBA(I,le.src_off,le.src_size,T,b);le.rgba=z,le.imgwidth=T[0],le.imgheight=b[0];for(var R=0;R<T[0]*b[0]*4;R++)C[R]=z[R];return this.width=T,this.height=b,this.data=C,this}(function(n){var e,t,i,s,o,l,c,d,f,p=function(j){return j=j||{},this.isStrokeTransparent=j.isStrokeTransparent||!1,this.strokeOpacity=j.strokeOpacity||1,this.strokeStyle=j.strokeStyle||"#000000",this.fillStyle=j.fillStyle||"#000000",this.isFillTransparent=j.isFillTransparent||!1,this.fillOpacity=j.fillOpacity||1,this.font=j.font||"10px sans-serif",this.textBaseline=j.textBaseline||"alphabetic",this.textAlign=j.textAlign||"left",this.lineWidth=j.lineWidth||1,this.lineJoin=j.lineJoin||"miter",this.lineCap=j.lineCap||"butt",this.path=j.path||[],this.transform=j.transform!==void 0?j.transform.clone():new d,this.globalCompositeOperation=j.globalCompositeOperation||"normal",this.globalAlpha=j.globalAlpha||1,this.clip_path=j.clip_path||[],this.currentPoint=j.currentPoint||new l,this.miterLimit=j.miterLimit||10,this.lastPoint=j.lastPoint||new l,this.lineDashOffset=j.lineDashOffset||0,this.lineDash=j.lineDash||[],this.margin=j.margin||[0,0,0,0],this.prevPageLastElemOffset=j.prevPageLastElemOffset||0,this.ignoreClearRect=typeof j.ignoreClearRect!="boolean"||j.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new v(this),e=this.internal.f2,t=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,l=this.internal.Point,c=this.internal.Rectangle,d=this.internal.Matrix,f=new p}]);var v=function(j){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var U=j;Object.defineProperty(this,"pdf",{get:function(){return U}});var $=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return $},set:function(Ce){$=!!Ce}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(Ce){X=!!Ce}});var Q=0;Object.defineProperty(this,"posX",{get:function(){return Q},set:function(Ce){isNaN(Ce)||(Q=Ce)}});var ye=0;Object.defineProperty(this,"posY",{get:function(){return ye},set:function(Ce){isNaN(Ce)||(ye=Ce)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(Ce){var ce;typeof Ce=="number"?ce=[Ce,Ce,Ce,Ce]:((ce=new Array(4))[0]=Ce[0],ce[1]=Ce.length>=2?Ce[1]:ce[0],ce[2]=Ce.length>=3?Ce[2]:ce[0],ce[3]=Ce.length>=4?Ce[3]:ce[1]),f.margin=ce}});var Ae=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Ae},set:function(Ce){Ae=Ce}});var De=0;Object.defineProperty(this,"lastBreak",{get:function(){return De},set:function(Ce){De=Ce}});var Be=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Be},set:function(Ce){Be=Ce}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(Ce){Ce instanceof p&&(f=Ce)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(Ce){f.path=Ce}});var Fe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Fe},set:function(Ce){Fe=Ce}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ce){var ce;ce=_(Ce),this.ctx.fillStyle=ce.style,this.ctx.isFillTransparent=ce.a===0,this.ctx.fillOpacity=ce.a,this.pdf.setFillColor(ce.r,ce.g,ce.b,{a:ce.a}),this.pdf.setTextColor(ce.r,ce.g,ce.b,{a:ce.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ce){var ce=_(Ce);this.ctx.strokeStyle=ce.style,this.ctx.isStrokeTransparent=ce.a===0,this.ctx.strokeOpacity=ce.a,ce.a===0?this.pdf.setDrawColor(255,255,255):(ce.a,this.pdf.setDrawColor(ce.r,ce.g,ce.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ce){["butt","round","square"].indexOf(Ce)!==-1&&(this.ctx.lineCap=Ce,this.pdf.setLineCap(Ce))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ce){isNaN(Ce)||(this.ctx.lineWidth=Ce,this.pdf.setLineWidth(Ce))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ce){["bevel","round","miter"].indexOf(Ce)!==-1&&(this.ctx.lineJoin=Ce,this.pdf.setLineJoin(Ce))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ce){isNaN(Ce)||(this.ctx.miterLimit=Ce,this.pdf.setMiterLimit(Ce))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ce){this.ctx.textBaseline=Ce}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ce){["right","end","center","left","start"].indexOf(Ce)!==-1&&(this.ctx.textAlign=Ce)}});var Ct=null,at=null;Object.defineProperty(this,"fontFaces",{get:function(){return at},set:function(Ce){Ct=null,at=Ce}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ce){var ce;if(this.ctx.font=Ce,(ce=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ce))!==null){var _t=ce[1];ce[2];var Ne=ce[3],Ve=ce[4];ce[5];var We=ce[6],tt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ve)[2];Ve=Math.floor(tt==="px"?parseFloat(Ve)*this.pdf.internal.scaleFactor:tt==="em"?parseFloat(Ve)*this.pdf.getFontSize():parseFloat(Ve)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ve);var lt=(function(Xe){var bt,qt,fe=[],Ze=Xe.trim();if(Ze==="")return b2;if(Ze in t4)return[t4[Ze]];for(;Ze!=="";){switch(qt=null,bt=(Ze=i4(Ze)).charAt(0)){case'"':case"'":qt=mW(Ze.substring(1),bt);break;default:qt=pW(Ze)}if(qt===null||(fe.push(qt[0]),(Ze=i4(qt[1]))!==""&&Ze.charAt(0)!==","))return b2;Ze=Ze.replace(/^,/,"")}return fe})(We);if(this.fontFaces){var $e=(function(Xe,bt){if(Ct===null){var qt=(function(fe){var Ze=[];return Object.keys(fe).forEach(function(Je){fe[Je].forEach(function(mt){var Tt=null;switch(mt){case"bold":Tt={family:Je,weight:"bold"};break;case"italic":Tt={family:Je,style:"italic"};break;case"bolditalic":Tt={family:Je,weight:"bold",style:"italic"};break;case"":case"normal":Tt={family:Je}}Tt!==null&&(Tt.ref={name:Je,style:mt},Ze.push(Tt))})}),Ze})(Xe.getFontList());Ct=(function(fe){for(var Ze={},Je=0;Je<fe.length;++Je){var mt=v2(fe[Je]),Tt=mt.family,It=mt.stretch,gt=mt.style,tn=mt.weight;Ze[Tt]=Ze[Tt]||{},Ze[Tt][It]=Ze[Tt][It]||{},Ze[Tt][It][gt]=Ze[Tt][It][gt]||{},Ze[Tt][It][gt][tn]=mt}return Ze})(qt.concat(bt))}return Ct})(this.pdf,this.fontFaces),pe=lt.map(function(Xe){return{family:Xe,stretch:"normal",weight:Ne,style:_t}}),be=(function(Xe,bt,qt){for(var fe=(qt=qt||{}).defaultFontFamily||"times",Ze=Object.assign({},fW,qt.genericFontFamilies||{}),Je=null,mt=null,Tt=0;Tt<bt.length;++Tt)if(Ze[(Je=v2(bt[Tt])).family]&&(Je.family=Ze[Je.family]),Xe.hasOwnProperty(Je.family)){mt=Xe[Je.family];break}if(!(mt=mt||Xe[fe]))throw new Error("Could not find a font-family for the rule '"+n4(Je)+"' and default family '"+fe+"'.");if(mt=(function(It,gt){if(gt[It])return gt[It];var tn=mv[It],Zt=tn<=mv.normal?-1:1,Dt=e4(gt,QC,tn,Zt);if(!Dt)throw new Error("Could not find a matching font-stretch value for "+It);return Dt})(Je.stretch,mt),mt=(function(It,gt){if(gt[It])return gt[It];for(var tn=XC[It],Zt=0;Zt<tn.length;++Zt)if(gt[tn[Zt]])return gt[tn[Zt]];throw new Error("Could not find a matching font-style for "+It)})(Je.style,mt),!(mt=(function(It,gt){if(gt[It])return gt[It];if(It===400&&gt[500])return gt[500];if(It===500&&gt[400])return gt[400];var tn=hW[It],Zt=e4(gt,ZC,tn,It<400?-1:1);if(!Zt)throw new Error("Could not find a matching font-weight for value "+It);return Zt})(Je.weight,mt)))throw new Error("Failed to resolve a font for the rule '"+n4(Je)+"'.");return mt})($e,pe);this.pdf.setFont(be.ref.name,be.ref.style)}else{var Se="";(Ne==="bold"||parseInt(Ne,10)>=700||_t==="bold")&&(Se="bold"),_t==="italic"&&(Se+="italic"),Se.length===0&&(Se="normal");for(var Ee="",Ye={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},qe=0;qe<lt.length;qe++){if(this.pdf.internal.getFont(lt[qe],Se,{noFallback:!0,disableWarning:!0})!==void 0){Ee=lt[qe];break}if(Se==="bolditalic"&&this.pdf.internal.getFont(lt[qe],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ee=lt[qe],Se="bold";else if(this.pdf.internal.getFont(lt[qe],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ee=lt[qe],Se="normal";break}}if(Ee===""){for(var Ue=0;Ue<lt.length;Ue++)if(Ye[lt[Ue]]){Ee=Ye[lt[Ue]];break}}Ee=Ee===""?"Times":Ee,this.pdf.setFont(Ee,Se)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ce){this.ctx.globalCompositeOperation=Ce}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ce){this.ctx.globalAlpha=Ce}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ce){this.ctx.lineDashOffset=Ce,te.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ce){this.ctx.lineDash=Ce,te.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ce){this.ctx.ignoreClearRect=!!Ce}})};v.prototype.setLineDash=function(j){this.lineDash=j},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){K.call(this,"fill",!1)},v.prototype.stroke=function(){K.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(j,U){if(isNaN(j)||isNaN(U))throw zi.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var $=this.ctx.transform.applyToPoint(new l(j,U));this.path.push({type:"mt",x:$.x,y:$.y}),this.ctx.lastPoint=new l(j,U)},v.prototype.closePath=function(){var j=new l(0,0),U=0;for(U=this.path.length-1;U!==-1;U--)if(this.path[U].type==="begin"&&Di(this.path[U+1])==="object"&&typeof this.path[U+1].x=="number"){j=new l(this.path[U+1].x,this.path[U+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(j.x,j.y)},v.prototype.lineTo=function(j,U){if(isNaN(j)||isNaN(U))throw zi.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var $=this.ctx.transform.applyToPoint(new l(j,U));this.path.push({type:"lt",x:$.x,y:$.y}),this.ctx.lastPoint=new l($.x,$.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),K.call(this,null,!0)},v.prototype.quadraticCurveTo=function(j,U,$,X){if(isNaN($)||isNaN(X)||isNaN(j)||isNaN(U))throw zi.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Q=this.ctx.transform.applyToPoint(new l($,X)),ye=this.ctx.transform.applyToPoint(new l(j,U));this.path.push({type:"qct",x1:ye.x,y1:ye.y,x:Q.x,y:Q.y}),this.ctx.lastPoint=new l(Q.x,Q.y)},v.prototype.bezierCurveTo=function(j,U,$,X,Q,ye){if(isNaN(Q)||isNaN(ye)||isNaN(j)||isNaN(U)||isNaN($)||isNaN(X))throw zi.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Ae=this.ctx.transform.applyToPoint(new l(Q,ye)),De=this.ctx.transform.applyToPoint(new l(j,U)),Be=this.ctx.transform.applyToPoint(new l($,X));this.path.push({type:"bct",x1:De.x,y1:De.y,x2:Be.x,y2:Be.y,x:Ae.x,y:Ae.y}),this.ctx.lastPoint=new l(Ae.x,Ae.y)},v.prototype.arc=function(j,U,$,X,Q,ye){if(isNaN(j)||isNaN(U)||isNaN($)||isNaN(X)||isNaN(Q))throw zi.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ye=!!ye,!this.ctx.transform.isIdentity){var Ae=this.ctx.transform.applyToPoint(new l(j,U));j=Ae.x,U=Ae.y;var De=this.ctx.transform.applyToPoint(new l(0,$)),Be=this.ctx.transform.applyToPoint(new l(0,0));$=Math.sqrt(Math.pow(De.x-Be.x,2)+Math.pow(De.y-Be.y,2))}Math.abs(Q-X)>=2*Math.PI&&(X=0,Q=2*Math.PI),this.path.push({type:"arc",x:j,y:U,radius:$,startAngle:X,endAngle:Q,counterclockwise:ye})},v.prototype.arcTo=function(j,U,$,X,Q){throw new Error("arcTo not implemented.")},v.prototype.rect=function(j,U,$,X){if(isNaN(j)||isNaN(U)||isNaN($)||isNaN(X))throw zi.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(j,U),this.lineTo(j+$,U),this.lineTo(j+$,U+X),this.lineTo(j,U+X),this.lineTo(j,U),this.lineTo(j+$,U),this.lineTo(j,U)},v.prototype.fillRect=function(j,U,$,X){if(isNaN(j)||isNaN(U)||isNaN($)||isNaN(X))throw zi.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!b.call(this)){var Q={};this.lineCap!=="butt"&&(Q.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Q.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(j,U,$,X),this.fill(),Q.hasOwnProperty("lineCap")&&(this.lineCap=Q.lineCap),Q.hasOwnProperty("lineJoin")&&(this.lineJoin=Q.lineJoin)}},v.prototype.strokeRect=function(j,U,$,X){if(isNaN(j)||isNaN(U)||isNaN($)||isNaN(X))throw zi.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");T.call(this)||(this.beginPath(),this.rect(j,U,$,X),this.stroke())},v.prototype.clearRect=function(j,U,$,X){if(isNaN(j)||isNaN(U)||isNaN($)||isNaN(X))throw zi.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(j,U,$,X))},v.prototype.save=function(j){j=typeof j!="boolean"||j;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,$=0;$<this.pdf.internal.getNumberOfPages();$++)this.pdf.setPage($+1),this.pdf.internal.out("q");if(this.pdf.setPage(U),j){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new p(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},v.prototype.restore=function(j){j=typeof j!="boolean"||j;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,$=0;$<this.pdf.internal.getNumberOfPages();$++)this.pdf.setPage($+1),this.pdf.internal.out("Q");this.pdf.setPage(U),j&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var _=function(j){var U,$,X,Q;if(j.isCanvasGradient===!0&&(j=j.getColor()),!j)return{r:0,g:0,b:0,a:0,style:j};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(j))U=0,$=0,X=0,Q=0;else{var ye=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(j);if(ye!==null)U=parseInt(ye[1]),$=parseInt(ye[2]),X=parseInt(ye[3]),Q=1;else if((ye=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(j))!==null)U=parseInt(ye[1]),$=parseInt(ye[2]),X=parseInt(ye[3]),Q=parseFloat(ye[4]);else{if(Q=1,typeof j=="string"&&j.charAt(0)!=="#"){var Ae=new zC(j);j=Ae.ok?Ae.toHex():"#000000"}j.length===4?(U=j.substring(1,2),U+=U,$=j.substring(2,3),$+=$,X=j.substring(3,4),X+=X):(U=j.substring(1,3),$=j.substring(3,5),X=j.substring(5,7)),U=parseInt(U,16),$=parseInt($,16),X=parseInt(X,16)}}return{r:U,g:$,b:X,a:Q,style:j}},b=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},T=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(j,U,$,X){if(isNaN(U)||isNaN($)||typeof j!="string")throw zi.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!b.call(this)){var Q=V(this.ctx.transform.rotation),ye=this.ctx.transform.scaleX;O.call(this,{text:j,x:U,y:$,scale:ye,angle:Q,align:this.textAlign,maxWidth:X})}},v.prototype.strokeText=function(j,U,$,X){if(isNaN(U)||isNaN($)||typeof j!="string")throw zi.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!T.call(this)){X=isNaN(X)?void 0:X;var Q=V(this.ctx.transform.rotation),ye=this.ctx.transform.scaleX;O.call(this,{text:j,x:U,y:$,scale:ye,renderingMode:"stroke",angle:Q,align:this.textAlign,maxWidth:X})}},v.prototype.measureText=function(j){if(typeof j!="string")throw zi.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var U=this.pdf,$=this.pdf.internal.scaleFactor,X=U.internal.getFontSize(),Q=U.getStringUnitWidth(j)*X/U.internal.scaleFactor;return new function(ye){var Ae=(ye=ye||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Ae}}),this}({width:Q*=Math.round(96*$/72*1e4)/1e4})},v.prototype.scale=function(j,U){if(isNaN(j)||isNaN(U))throw zi.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var $=new d(j,0,0,U,0,0);this.ctx.transform=this.ctx.transform.multiply($)},v.prototype.rotate=function(j){if(isNaN(j))throw zi.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var U=new d(Math.cos(j),Math.sin(j),-Math.sin(j),Math.cos(j),0,0);this.ctx.transform=this.ctx.transform.multiply(U)},v.prototype.translate=function(j,U){if(isNaN(j)||isNaN(U))throw zi.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var $=new d(1,0,0,1,j,U);this.ctx.transform=this.ctx.transform.multiply($)},v.prototype.transform=function(j,U,$,X,Q,ye){if(isNaN(j)||isNaN(U)||isNaN($)||isNaN(X)||isNaN(Q)||isNaN(ye))throw zi.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Ae=new d(j,U,$,X,Q,ye);this.ctx.transform=this.ctx.transform.multiply(Ae)},v.prototype.setTransform=function(j,U,$,X,Q,ye){j=isNaN(j)?1:j,U=isNaN(U)?0:U,$=isNaN($)?0:$,X=isNaN(X)?1:X,Q=isNaN(Q)?0:Q,ye=isNaN(ye)?0:ye,this.ctx.transform=new d(j,U,$,X,Q,ye)};var C=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(j,U,$,X,Q,ye,Ae,De,Be){var Fe=this.pdf.getImageProperties(j),Ct=1,at=1,Ce=1,ce=1;X!==void 0&&De!==void 0&&(Ce=De/X,ce=Be/Q,Ct=Fe.width/X*De/X,at=Fe.height/Q*Be/Q),ye===void 0&&(ye=U,Ae=$,U=0,$=0),X!==void 0&&De===void 0&&(De=X,Be=Q),X===void 0&&De===void 0&&(De=Fe.width,Be=Fe.height);for(var _t,Ne=this.ctx.transform.decompose(),Ve=V(Ne.rotate.shx),We=new d,tt=(We=(We=(We=We.multiply(Ne.translate)).multiply(Ne.skew)).multiply(Ne.scale)).applyToRectangle(new c(ye-U*Ce,Ae-$*ce,X*Ct,Q*at)),lt=A.call(this,tt),$e=[],pe=0;pe<lt.length;pe+=1)$e.indexOf(lt[pe])===-1&&$e.push(lt[pe]);if(G($e),this.autoPaging)for(var be=$e[0],Se=$e[$e.length-1],Ee=be;Ee<Se+1;Ee++){this.pdf.setPage(Ee);var Ye=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],qe=Ee===1?this.posY+this.margin[0]:this.margin[0],Ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Xe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],bt=Ee===1?0:Ue+(Ee-2)*Xe;if(this.ctx.clip_path.length!==0){var qt=this.path;_t=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ee(_t,this.posX+this.margin[3],-bt+qe+this.ctx.prevPageLastElemOffset),de.call(this,"fill",!0),this.path=qt}var fe=JSON.parse(JSON.stringify(tt));fe=ee([fe],this.posX+this.margin[3],-bt+qe+this.ctx.prevPageLastElemOffset)[0];var Ze=(Ee>be||Ee<Se)&&C.call(this);Ze&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ye,Xe,null).clip().discardPath()),this.pdf.addImage(j,"JPEG",fe.x,fe.y,fe.w,fe.h,null,null,Ve),Ze&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(j,"JPEG",tt.x,tt.y,tt.w,tt.h,null,null,Ve)};var A=function(j,U,$){var X=[];U=U||this.pdf.internal.pageSize.width,$=$||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Q=this.posY+this.ctx.prevPageLastElemOffset;switch(j.type){default:case"mt":case"lt":X.push(Math.floor((j.y+Q)/$)+1);break;case"arc":X.push(Math.floor((j.y+Q-j.radius)/$)+1),X.push(Math.floor((j.y+Q+j.radius)/$)+1);break;case"qct":var ye=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x,j.y);X.push(Math.floor((ye.y+Q)/$)+1),X.push(Math.floor((ye.y+ye.h+Q)/$)+1);break;case"bct":var Ae=W(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x2,j.y2,j.x,j.y);X.push(Math.floor((Ae.y+Q)/$)+1),X.push(Math.floor((Ae.y+Ae.h+Q)/$)+1);break;case"rect":X.push(Math.floor((j.y+Q)/$)+1),X.push(Math.floor((j.y+j.h+Q)/$)+1)}for(var De=0;De<X.length;De+=1)for(;this.pdf.internal.getNumberOfPages()<X[De];)I.call(this);return X},I=function(){var j=this.fillStyle,U=this.strokeStyle,$=this.font,X=this.lineCap,Q=this.lineWidth,ye=this.lineJoin;this.pdf.addPage(),this.fillStyle=j,this.strokeStyle=U,this.font=$,this.lineCap=X,this.lineWidth=Q,this.lineJoin=ye},ee=function(j,U,$){for(var X=0;X<j.length;X++)switch(j[X].type){case"bct":j[X].x2+=U,j[X].y2+=$;case"qct":j[X].x1+=U,j[X].y1+=$;default:j[X].x+=U,j[X].y+=$}return j},G=function(j){return j.sort(function(U,$){return U-$})},K=function(j,U){for(var $,X,Q=this.fillStyle,ye=this.strokeStyle,Ae=this.lineCap,De=this.lineWidth,Be=Math.abs(De*this.ctx.transform.scaleX),Fe=this.lineJoin,Ct=JSON.parse(JSON.stringify(this.path)),at=JSON.parse(JSON.stringify(this.path)),Ce=[],ce=0;ce<at.length;ce++)if(at[ce].x!==void 0)for(var _t=A.call(this,at[ce]),Ne=0;Ne<_t.length;Ne+=1)Ce.indexOf(_t[Ne])===-1&&Ce.push(_t[Ne]);for(var Ve=0;Ve<Ce.length;Ve++)for(;this.pdf.internal.getNumberOfPages()<Ce[Ve];)I.call(this);if(G(Ce),this.autoPaging)for(var We=Ce[0],tt=Ce[Ce.length-1],lt=We;lt<tt+1;lt++){this.pdf.setPage(lt),this.fillStyle=Q,this.strokeStyle=ye,this.lineCap=Ae,this.lineWidth=Be,this.lineJoin=Fe;var $e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],pe=lt===1?this.posY+this.margin[0]:this.margin[0],be=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Se=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ee=lt===1?0:be+(lt-2)*Se;if(this.ctx.clip_path.length!==0){var Ye=this.path;$=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ee($,this.posX+this.margin[3],-Ee+pe+this.ctx.prevPageLastElemOffset),de.call(this,j,!0),this.path=Ye}if(X=JSON.parse(JSON.stringify(Ct)),this.path=ee(X,this.posX+this.margin[3],-Ee+pe+this.ctx.prevPageLastElemOffset),U===!1||lt===0){var qe=(lt>We||lt<tt)&&C.call(this);qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$e,Se,null).clip().discardPath()),de.call(this,j,U),qe&&this.pdf.restoreGraphicsState()}this.lineWidth=De}else this.lineWidth=Be,de.call(this,j,U),this.lineWidth=De;this.path=Ct},de=function(j,U){if((j!=="stroke"||U||!T.call(this))&&(j==="stroke"||U||!b.call(this))){for(var $,X,Q=[],ye=this.path,Ae=0;Ae<ye.length;Ae++){var De=ye[Ae];switch(De.type){case"begin":Q.push({begin:!0});break;case"close":Q.push({close:!0});break;case"mt":Q.push({start:De,deltas:[],abs:[]});break;case"lt":var Be=Q.length;if(ye[Ae-1]&&!isNaN(ye[Ae-1].x)&&($=[De.x-ye[Ae-1].x,De.y-ye[Ae-1].y],Be>0)){for(;Be>=0;Be--)if(Q[Be-1].close!==!0&&Q[Be-1].begin!==!0){Q[Be-1].deltas.push($),Q[Be-1].abs.push(De);break}}break;case"bct":$=[De.x1-ye[Ae-1].x,De.y1-ye[Ae-1].y,De.x2-ye[Ae-1].x,De.y2-ye[Ae-1].y,De.x-ye[Ae-1].x,De.y-ye[Ae-1].y],Q[Q.length-1].deltas.push($);break;case"qct":var Fe=ye[Ae-1].x+2/3*(De.x1-ye[Ae-1].x),Ct=ye[Ae-1].y+2/3*(De.y1-ye[Ae-1].y),at=De.x+2/3*(De.x1-De.x),Ce=De.y+2/3*(De.y1-De.y),ce=De.x,_t=De.y;$=[Fe-ye[Ae-1].x,Ct-ye[Ae-1].y,at-ye[Ae-1].x,Ce-ye[Ae-1].y,ce-ye[Ae-1].x,_t-ye[Ae-1].y],Q[Q.length-1].deltas.push($);break;case"arc":Q.push({deltas:[],abs:[],arc:!0}),Array.isArray(Q[Q.length-1].abs)&&Q[Q.length-1].abs.push(De)}}X=U?null:j==="stroke"?"stroke":"fill";for(var Ne=!1,Ve=0;Ve<Q.length;Ve++)if(Q[Ve].arc)for(var We=Q[Ve].abs,tt=0;tt<We.length;tt++){var lt=We[tt];lt.type==="arc"?R.call(this,lt.x,lt.y,lt.radius,lt.startAngle,lt.endAngle,lt.counterclockwise,void 0,U,!Ne):M.call(this,lt.x,lt.y),Ne=!0}else if(Q[Ve].close===!0)this.pdf.internal.out("h"),Ne=!1;else if(Q[Ve].begin!==!0){var $e=Q[Ve].start.x,pe=Q[Ve].start.y;Y.call(this,Q[Ve].deltas,$e,pe),Ne=!0}X&&D.call(this,X),U&&F.call(this)}},le=function(j){var U=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,$=U*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return j-$;case"top":return j+U-$;case"hanging":return j+U-2*$;case"middle":return j+U/2-$;default:return j}},z=function(j){return j+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var j=function(){};return j.colorStops=[],j.addColorStop=function(U,$){this.colorStops.push([U,$])},j.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},j.isCanvasGradient=!0,j},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var R=function(j,U,$,X,Q,ye,Ae,De,Be){for(var Fe=q.call(this,$,X,Q,ye),Ct=0;Ct<Fe.length;Ct++){var at=Fe[Ct];Ct===0&&(Be?E.call(this,at.x1+j,at.y1+U):M.call(this,at.x1+j,at.y1+U)),ie.call(this,j,U,at.x2,at.y2,at.x3,at.y3,at.x4,at.y4)}De?F.call(this):D.call(this,Ae)},D=function(j){switch(j){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},F=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(j,U){this.pdf.internal.out(t(j)+" "+i(U)+" m")},O=function(j){var U;switch(j.align){case"right":case"end":U="right";break;case"center":U="center";break;default:U="left"}var $=this.pdf.getTextDimensions(j.text),X=le.call(this,j.y),Q=z.call(this,X)-$.h,ye=this.ctx.transform.applyToPoint(new l(j.x,X)),Ae=this.ctx.transform.decompose(),De=new d;De=(De=(De=De.multiply(Ae.translate)).multiply(Ae.skew)).multiply(Ae.scale);for(var Be,Fe,Ct,at=this.ctx.transform.applyToRectangle(new c(j.x,X,$.w,$.h)),Ce=De.applyToRectangle(new c(j.x,Q,$.w,$.h)),ce=A.call(this,Ce),_t=[],Ne=0;Ne<ce.length;Ne+=1)_t.indexOf(ce[Ne])===-1&&_t.push(ce[Ne]);if(G(_t),this.autoPaging)for(var Ve=_t[0],We=_t[_t.length-1],tt=Ve;tt<We+1;tt++){this.pdf.setPage(tt);var lt=tt===1?this.posY+this.margin[0]:this.margin[0],$e=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],pe=this.pdf.internal.pageSize.height-this.margin[2],be=pe-this.margin[0],Se=this.pdf.internal.pageSize.width-this.margin[1],Ee=Se-this.margin[3],Ye=tt===1?0:$e+(tt-2)*be;if(this.ctx.clip_path.length!==0){var qe=this.path;Be=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ee(Be,this.posX+this.margin[3],-1*Ye+lt),de.call(this,"fill",!0),this.path=qe}var Ue=ee([JSON.parse(JSON.stringify(Ce))],this.posX+this.margin[3],-Ye+lt+this.ctx.prevPageLastElemOffset)[0];j.scale>=.01&&(Fe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Fe*j.scale),Ct=this.lineWidth,this.lineWidth=Ct*j.scale);var Xe=this.autoPaging!=="text";if(Xe||Ue.y+Ue.h<=pe){if(Xe||Ue.y>=lt&&Ue.x<=Se){var bt=Xe?j.text:this.pdf.splitTextToSize(j.text,j.maxWidth||Se-Ue.x)[0],qt=ee([JSON.parse(JSON.stringify(at))],this.posX+this.margin[3],-Ye+lt+this.ctx.prevPageLastElemOffset)[0],fe=Xe&&(tt>Ve||tt<We)&&C.call(this);fe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ee,be,null).clip().discardPath()),this.pdf.text(bt,qt.x,qt.y,{angle:j.angle,align:U,renderingMode:j.renderingMode}),fe&&this.pdf.restoreGraphicsState()}}else Ue.y<pe&&(this.ctx.prevPageLastElemOffset+=pe-Ue.y);j.scale>=.01&&(this.pdf.setFontSize(Fe),this.lineWidth=Ct)}else j.scale>=.01&&(Fe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Fe*j.scale),Ct=this.lineWidth,this.lineWidth=Ct*j.scale),this.pdf.text(j.text,ye.x+this.posX,ye.y+this.posY,{angle:j.angle,align:U,renderingMode:j.renderingMode,maxWidth:j.maxWidth}),j.scale>=.01&&(this.pdf.setFontSize(Fe),this.lineWidth=Ct)},M=function(j,U,$,X){$=$||0,X=X||0,this.pdf.internal.out(t(j+$)+" "+i(U+X)+" l")},Y=function(j,U,$){return this.pdf.lines(j,U,$,null,null)},ie=function(j,U,$,X,Q,ye,Ae,De){this.pdf.internal.out([e(s($+j)),e(o(X+U)),e(s(Q+j)),e(o(ye+U)),e(s(Ae+j)),e(o(De+U)),"c"].join(" "))},q=function(j,U,$,X){for(var Q=2*Math.PI,ye=Math.PI/2;U>$;)U-=Q;var Ae=Math.abs($-U);Ae<Q&&X&&(Ae=Q-Ae);for(var De=[],Be=X?-1:1,Fe=U;Ae>1e-5;){var Ct=Fe+Be*Math.min(Ae,ye);De.push(re.call(this,j,Fe,Ct)),Ae-=Math.abs(Ct-Fe),Fe=Ct}return De},re=function(j,U,$){var X=($-U)/2,Q=j*Math.cos(X),ye=j*Math.sin(X),Ae=Q,De=-ye,Be=Ae*Ae+De*De,Fe=Be+Ae*Q+De*ye,Ct=4/3*(Math.sqrt(2*Be*Fe)-Fe)/(Ae*ye-De*Q),at=Ae-Ct*De,Ce=De+Ct*Ae,ce=at,_t=-Ce,Ne=X+U,Ve=Math.cos(Ne),We=Math.sin(Ne);return{x1:j*Math.cos(U),y1:j*Math.sin(U),x2:at*Ve-Ce*We,y2:at*We+Ce*Ve,x3:ce*Ve-_t*We,y3:ce*We+_t*Ve,x4:j*Math.cos($),y4:j*Math.sin($)}},V=function(j){return 180*j/Math.PI},se=function(j,U,$,X,Q,ye){var Ae=j+.5*($-j),De=U+.5*(X-U),Be=Q+.5*($-Q),Fe=ye+.5*(X-ye),Ct=Math.min(j,Q,Ae,Be),at=Math.max(j,Q,Ae,Be),Ce=Math.min(U,ye,De,Fe),ce=Math.max(U,ye,De,Fe);return new c(Ct,Ce,at-Ct,ce-Ce)},W=function(j,U,$,X,Q,ye,Ae,De){var Be,Fe,Ct,at,Ce,ce,_t,Ne,Ve,We,tt,lt,$e,pe,be=$-j,Se=X-U,Ee=Q-$,Ye=ye-X,qe=Ae-Q,Ue=De-ye;for(Fe=0;Fe<41;Fe++)Ve=(_t=(Ct=j+(Be=Fe/40)*be)+Be*((Ce=$+Be*Ee)-Ct))+Be*(Ce+Be*(Q+Be*qe-Ce)-_t),We=(Ne=(at=U+Be*Se)+Be*((ce=X+Be*Ye)-at))+Be*(ce+Be*(ye+Be*Ue-ce)-Ne),Fe==0?(tt=Ve,lt=We,$e=Ve,pe=We):(tt=Math.min(tt,Ve),lt=Math.min(lt,We),$e=Math.max($e,Ve),pe=Math.max(pe,We));return new c(Math.round(tt),Math.round(lt),Math.round($e-tt),Math.round(pe-lt))},te=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var j,U,$=(j=this.ctx.lineDash,U=this.ctx.lineDashOffset,JSON.stringify({lineDash:j,lineDashOffset:U}));this.prevLineDash!==$&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=$)}}})(vn.API),(function(n){var e=function(l){var c,d,f,p,v,_,b,T,C,A;for(d=[],f=0,p=(l+=c="\0\0\0\0".slice(l.length%4||4)).length;p>f;f+=4)(v=(l.charCodeAt(f)<<24)+(l.charCodeAt(f+1)<<16)+(l.charCodeAt(f+2)<<8)+l.charCodeAt(f+3))!==0?(_=(v=((v=((v=((v=(v-(A=v%85))/85)-(C=v%85))/85)-(T=v%85))/85)-(b=v%85))/85)%85,d.push(_+33,b+33,T+33,C+33,A+33)):d.push(122);return(function(I,ee){for(var G=ee;G>0;G--)I.pop()})(d,c.length),String.fromCharCode.apply(String,d)+"~>"},t=function(l){var c,d,f,p,v,_=String,b="length",T=255,C="charCodeAt",A="slice",I="replace";for(l[A](-2),l=l[A](0,-2)[I](/\s/g,"")[I]("z","!!!!!"),f=[],p=0,v=(l+=c="uuuuu"[A](l[b]%5||5))[b];v>p;p+=5)d=52200625*(l[C](p)-33)+614125*(l[C](p+1)-33)+7225*(l[C](p+2)-33)+85*(l[C](p+3)-33)+(l[C](p+4)-33),f.push(T&d>>24,T&d>>16,T&d>>8,T&d);return(function(ee,G){for(var K=G;K>0;K--)ee.pop()})(f,c[b]),_.fromCharCode.apply(_,f)},i=function(l){return l.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(l){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),c.test(l)===!1)return"";for(var d="",f=0;f<l.length;f+=2)d+=String.fromCharCode("0x"+(l[f]+l[f+1]));return d},o=function(l){for(var c=new Uint8Array(l.length),d=l.length;d--;)c[d]=l.charCodeAt(d);return(c=av(c)).reduce(function(f,p){return f+String.fromCharCode(p)},"")};n.processDataByFilters=function(l,c){var d=0,f=l||"",p=[];for(typeof(c=c||[])=="string"&&(c=[c]),d=0;d<c.length;d+=1)switch(c[d]){case"ASCII85Decode":case"/ASCII85Decode":f=t(f),p.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=e(f),p.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=s(f),p.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=i(f),p.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=o(f),p.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[d]+'" is not implemented')}return{data:f,reverseChain:p.reverse().join(" ")}}})(vn.API),(function(n){n.loadFile=function(e,t,i){return(function(s,o,l){o=o!==!1,l=typeof l=="function"?l:function(){};var c=void 0;try{c=(function(d,f,p){var v=new XMLHttpRequest,_=0,b=function(T){var C=T.length,A=[],I=String.fromCharCode;for(_=0;_<C;_+=1)A.push(I(255&T.charCodeAt(_)));return A.join("")};if(v.open("GET",d,!f),v.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(v.onload=function(){v.status===200?p(b(this.responseText)):p(void 0)}),v.send(null),f&&v.status===200)return b(v.responseText)})(s,o,l)}catch{}return c})(e,t,i)},n.loadImageFile=n.loadFile})(vn.API),(function(n){function e(){return(Rn.html2canvas?Promise.resolve(Rn.html2canvas):e2(()=>import("./html2canvas.esm-B0tyYwQk.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function t(){return(Rn.DOMPurify?Promise.resolve(Rn.DOMPurify):e2(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var i=function(c){var d=Di(c);return d==="undefined"?"undefined":d==="string"||c instanceof String?"string":d==="number"||c instanceof Number?"number":d==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":d==="object"?"object":"unknown"},s=function(c,d){var f=document.createElement(c);for(var p in d.className&&(f.className=d.className),d.innerHTML&&d.dompurify&&(f.innerHTML=d.dompurify.sanitize(d.innerHTML)),d.style)f.style[p]=d.style[p];return f},o=function c(d,f){for(var p=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),v=d.firstChild;v;v=v.nextSibling)f!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||p.appendChild(c(v,f));return d.nodeType===1&&(d.nodeName==="CANVAS"?(p.width=d.width,p.height=d.height,p.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(p.value=d.value),p.addEventListener("load",function(){p.scrollTop=d.scrollTop,p.scrollLeft=d.scrollLeft},!0)),p},l=function c(d){var f=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),p=c.convert(Promise.resolve(),f);return(p=p.setProgress(1,c,1,[c])).set(d)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(c,d){return c.__proto__=d||l.prototype,c},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(c,d){return this.then(function(){switch(d=d||(function(f){switch(i(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),d){case"string":return this.then(t).then(function(f){return this.set({src:s("div",{innerHTML:c,dompurify:f})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},l.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},d=o(this.prop.src,this.opt.html2canvas.javascriptEnabled);d.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(d),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(d){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,d(this.prop.container,f)}).then(function(d){(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(d){var f=this.opt.jsPDF,p=this.opt.fontFaces,v=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,_=Object.assign({async:!0,allowTaint:!0,scale:v,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete _.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=p,p)for(var b=0;b<p.length;++b){var T=p[b],C=T.src.find(function(A){return A.format==="truetype"});C&&f.addFont(C.url,T.ref.name,T.ref.style)}return _.windowHeight=_.windowHeight||0,_.windowHeight=_.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):_.windowHeight,f.context2d.save(!0),d(this.prop.container,_)}).then(function(d){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(c,d,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(c,d):this.outputPdf(c,d)},l.prototype.outputPdf=function(c,d){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,d)})},l.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},l.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(c){if(i(c)!=="object")return this;var d=Object.keys(c||{}).map(function(f){if(f in l.template.prop)return function(){this.prop[f]=c[f]};switch(f){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[f]=c[f]}}},this);return this.then(function(){return this.thenList(d)})},l.prototype.get=function(c,d){return this.then(function(){var f=c in l.template.prop?this.prop[c]:this.opt[c];return d?d(f):f})},l.prototype.setMargin=function(c){return this.then(function(){switch(i(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},l.prototype.setPageSize=function(c){function d(f,p){return Math.floor(f*p/72*96)}return this.then(function(){(c=c||vn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:d(c.inner.width,c.k),height:d(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},l.prototype.setProgress=function(c,d,f,p){return c!=null&&(this.progress.val=c),d!=null&&(this.progress.state=d),f!=null&&(this.progress.n=f),p!=null&&(this.progress.stack=p),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(c,d,f,p){return this.setProgress(c?this.progress.val+c:null,d||null,f?this.progress.n+f:null,p?this.progress.stack.concat(p):null)},l.prototype.then=function(c,d){var f=this;return this.thenCore(c,d,function(p,v){return f.updateProgress(null,null,1,[p]),Promise.prototype.then.call(this,function(_){return f.updateProgress(null,p),_}).then(p,v).then(function(_){return f.updateProgress(1),_})})},l.prototype.thenCore=function(c,d,f){f=f||Promise.prototype.then;var p=this;c&&(c=c.bind(p)),d&&(d=d.bind(p));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?p:l.convert(Object.assign({},p),Promise.prototype),_=f.call(v,c,d);return l.convert(_,p.__proto__)},l.prototype.thenExternal=function(c,d){return Promise.prototype.then.call(this,c,d)},l.prototype.thenList=function(c){var d=this;return c.forEach(function(f){d=d.thenCore(f)}),d},l.prototype.catch=function(c){c&&(c=c.bind(this));var d=Promise.prototype.catch.call(this,c);return l.convert(d,this)},l.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},l.prototype.error=function(c){return this.then(function(){throw new Error(c)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,vn.getPageSize=function(c,d,f){if(Di(c)==="object"){var p=c;c=p.orientation,d=p.unit||d,f=p.format||f}d=d||"mm",f=f||"a4",c=(""+(c||"P")).toLowerCase();var v,_=(""+f).toLowerCase(),b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(d){case"pt":v=1;break;case"mm":v=72/25.4;break;case"cm":v=72/2.54;break;case"in":v=72;break;case"px":v=.75;break;case"pc":case"em":v=12;break;case"ex":v=6;break;default:throw"Invalid unit: "+d}var T,C=0,A=0;if(b.hasOwnProperty(_))C=b[_][1]/v,A=b[_][0]/v;else try{C=f[1],A=f[0]}catch{throw new Error("Invalid format: "+f)}if(c==="p"||c==="portrait")c="p",A>C&&(T=A,A=C,C=T);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",C>A&&(T=A,A=C,C=T)}return{width:A,height:C,unit:d,k:v,orientation:c}},n.html=function(c,d){(d=d||{}).callback=d.callback||function(){},d.html2canvas=d.html2canvas||{},d.html2canvas.canvas=d.html2canvas.canvas||this.canvas,d.jsPDF=d.jsPDF||this,d.fontFaces=d.fontFaces?d.fontFaces.map(v2):null;var f=new l(d);return d.worker?f:f.from(c).doCallback()}})(vn.API),vn.API.addJS=function(n){return o4=n,this.internal.events.subscribe("postPutResources",function(){Rg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Rg+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),s4=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+o4+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Rg!==void 0&&s4!==void 0&&this.internal.out("/Names <</JavaScript "+Rg+" 0 R>>")}),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=t.outline.render().split(/\r\n/),o=0;o<s.length;o++){var l=s[o],c=i.exec(l);if(c!=null){var d=c[1];t.internal.newObjectDeferredBegin(d,!1)}t.internal.write(l)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,p=[];for(o=0;o<f;o++){var v=t.internal.newObject();p.push(v);var _=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+_.objId+" 0 R /XYZ null null null]>> endobj")}var b=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<p.length;o++)t.internal.write("(page_"+(o+1)+")"+p[o]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+b+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(i,s,o){var l={title:s,options:o,children:[]};return i==null&&(i=this.root),i.children.push(l),l},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(i){i.id=t.internal.newObjectDeferred();for(var s=0;s<i.children.length;s++)this.genIds_r(i.children[s])},t.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},t.outline.renderItems=function(i){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<i.children.length;o++){var l=i.children[o];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(i)),o>0&&this.line("/Prev "+this.makeRef(i.children[o-1])),o<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[o+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var c=this.count=this.count_r({count:0},l);if(c>0&&this.line("/Count "+c),l.options&&l.options.pageNumber){var d=t.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+d.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var f=0;f<i.children.length;f++)this.renderItems(i.children[f])},t.outline.line=function(i){this.ctx.val+=i+`\r
`},t.outline.makeRef=function(i){return i.id+" 0 R"},t.outline.makeString=function(i){return"("+t.internal.pdfEscape(i)+")"},t.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(i,s){for(var o=0;o<s.children.length;o++)i.count++,this.count_r(i,s.children[o]);return i.count}}])})(vn.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,i,s,o,l,c){var d,f=this.decode.DCT_DECODE,p=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=l||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,d=(function(v){for(var _,b=256*v.charCodeAt(4)+v.charCodeAt(5),T=v.length,C={width:0,height:0,numcomponents:1},A=4;A<T;A+=2){if(A+=b,e.indexOf(v.charCodeAt(A+1))!==-1){_=256*v.charCodeAt(A+5)+v.charCodeAt(A+6),C={width:256*v.charCodeAt(A+7)+v.charCodeAt(A+8),height:_,numcomponents:v.charCodeAt(A+9)};break}b=256*v.charCodeAt(A+2)+v.charCodeAt(A+3)}return C})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),d.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}p={data:t,width:d.width,height:d.height,colorSpace:c,bitsPerComponent:8,filter:f,index:i,alias:s}}return p}})(vn.API),vn.API.processPNG=function(n,e,t,i){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var s,o=ZB(n,{checkCrc:!0}),l=o.width,c=o.height,d=o.channels,f=o.palette,p=o.depth;s=f&&d===1?(function(z){for(var R=z.width,D=z.height,F=z.data,E=z.palette,O=z.depth,M=!1,Y=[],ie=[],q=void 0,re=!1,V=0,se=0;se<E.length;se++){var W=cN(E[se],4),te=W[0],j=W[1],U=W[2],$=W[3];Y.push(te,j,U),$!=null&&($===0?(V++,ie.length<1&&ie.push(se)):$<255&&(re=!0))}if(re||V>1){M=!0,ie=void 0;var X=R*D;q=new Uint8Array(X);for(var Q=new DataView(F.buffer),ye=0;ye<X;ye++){var Ae=w2(Q,ye,O),De=cN(E[Ae],4)[3];q[ye]=De}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:F,alphaBytes:q,needSMask:M,palette:Y,mask:ie}})(o):d===2||d===4?(function(z){for(var R=z.data,D=z.width,F=z.height,E=z.channels,O=z.depth,M=E===2?"DeviceGray":"DeviceRGB",Y=E-1,ie=D*F,q=Y,re=ie*q,V=1*ie,se=Math.ceil(re*O/8),W=Math.ceil(V*O/8),te=new Uint8Array(se),j=new Uint8Array(W),U=new DataView(R.buffer),$=new DataView(te.buffer),X=new DataView(j.buffer),Q=!1,ye=0;ye<ie;ye++){for(var Ae=ye*E,De=0;De<q;De++)m4($,w2(U,Ae+De,O),ye*q+De,O);var Be=w2(U,Ae+q,O);Be<(1<<O)-1&&(Q=!0),m4(X,Be,1*ye,O)}return{colorSpace:M,colorsPerPixel:Y,colorBytes:te,alphaBytes:j,needSMask:Q}})(o):(function(z){var R=z.data,D=z.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:D,colorsPerPixel:D==="DeviceGray"?1:3,colorBytes:R instanceof Uint8Array?R:new Uint8Array(R.buffer),needSMask:!1}})(o);var v,_,b,T=s,C=T.colorSpace,A=T.colorsPerPixel,I=T.colorBytes,ee=T.alphaBytes,G=T.needSMask,K=T.palette,de=T.mask,le=null;return i!==vn.API.image_compression.NONE&&typeof av=="function"?(le=(function(z){var R;switch(z){case vn.API.image_compression.FAST:R=11;break;case vn.API.image_compression.MEDIUM:R=13;break;case vn.API.image_compression.SLOW:R=14;break;default:R=12}return R})(i),v=this.decode.FLATE_DECODE,_="/Predictor ".concat(le," "),n=c4(I,l*A,A,i),G&&(b=c4(ee,l,1,i))):(v=void 0,_="",n=I,G&&(b=ee)),_+="/Colors ".concat(A," /BitsPerComponent ").concat(p," /Columns ").concat(l),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(b&&this.__addimage__.isArrayBuffer(b)||this.__addimage__.isArrayBufferView(b))&&(b=this.__addimage__.arrayBufferToBinaryString(b)),{alias:t,data:n,index:e,filter:v,decodeParameters:_,transparency:de,palette:K,sMask:b,predictor:le,width:l,height:c,bitsPerComponent:p,colorSpace:C}}},(function(n){n.processGIF89A=function(e,t,i,s){var o=new bW(e),l=o.width,c=o.height,d=[];o.decodeAndBlitFrameRGBA(0,d);var f={data:d,width:l,height:c},p=new _2(100).encode(f,100);return n.processJPEG.call(this,p,t,i,s)},n.processGIF87A=n.processGIF89A})(vn.API),$a.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:i,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},$a.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){zi.log("bit decode error:"+t)}},$a.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<e;s++)for(var o=this.datav.getUint8(this.pos++,!0),l=i*this.width*4+8*s*4,c=0;c<8&&8*s+c<this.width;c++){var d=this.palette[o>>7-c&1];this.data[l+4*c]=d.blue,this.data[l+4*c+1]=d.green,this.data[l+4*c+2]=d.red,this.data[l+4*c+3]=255}t!==0&&(this.pos+=4-t)}},$a.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,s=0;s<n;s++){var o=this.datav.getUint8(this.pos++,!0),l=i*this.width*4+2*s*4,c=o>>4,d=15&o,f=this.palette[c];if(this.data[l]=f.blue,this.data[l+1]=f.green,this.data[l+2]=f.red,this.data[l+3]=255,2*s+1>=this.width)break;f=this.palette[d],this.data[l+4]=f.blue,this.data[l+4+1]=f.green,this.data[l+4+2]=f.red,this.data[l+4+3]=255}e!==0&&(this.pos+=4-e)}},$a.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*i;if(s<this.palette.length){var l=this.palette[s];this.data[o]=l.red,this.data[o+1]=l.green,this.data[o+2]=l.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}n!==0&&(this.pos+=4-n)}},$a.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&e)/e*255|0,d=(o>>10&e)/e*255|0,f=o>>15?255:0,p=i*this.width*4+4*s;this.data[p]=d,this.data[p+1]=c,this.data[p+2]=l,this.data[p+3]=f}this.pos+=n}},$a.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var s=this.bottom_up?i:this.height-1-i,o=0;o<this.width;o++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(l&e)/e*255|0,d=(l>>5&t)/t*255|0,f=(l>>11)/e*255|0,p=s*this.width*4+4*o;this.data[p]=f,this.data[p+1]=d,this.data[p+2]=c,this.data[p+3]=255}this.pos+=n}},$a.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*t;this.data[l]=o,this.data[l+1]=s,this.data[l+2]=i,this.data[l+3]=255}this.pos+=this.width%4}},$a.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*t;this.data[c]=o,this.data[c+1]=s,this.data[c+2]=i,this.data[c+3]=l}},$a.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,i,s){var o=new $a(e,!1),l=o.width,c=o.height,d={data:o.getData(),width:l,height:c},f=new _2(100).encode(d,100);return n.processJPEG.call(this,f,t,i,s)}})(vn.API),g4.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,i,s){var o=new g4(e),l=o.width,c=o.height,d={data:o.getData(),width:l,height:c},f=new _2(100).encode(d,100);return n.processJPEG.call(this,f,t,i,s)}})(vn.API),vn.API.processRGBA=function(n,e,t){for(var i=n.data,s=i.length,o=new Uint8Array(s/4*3),l=new Uint8Array(s/4),c=0,d=0,f=0;f<s;f+=4){var p=i[f],v=i[f+1],_=i[f+2],b=i[f+3];o[c++]=p,o[c++]=v,o[c++]=_,l[d++]=b}var T=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:T,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},vn.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ah=vn.API,Ig=ah.getCharWidthsArray=function(n,e){var t,i,s=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),l=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:s.metadata.Unicode.widths,d=c.fof?c.fof:1,f=e.kerning?e.kerning:s.metadata.Unicode.kerning,p=f.fof?f.fof:1,v=e.doKerning!==!1,_=0,b=n.length,T=0,C=c[0]||d,A=[];for(t=0;t<b;t++)i=n.charCodeAt(t),typeof s.metadata.widthOfString=="function"?A.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(i))+l*(1e3/o)||0)/1e3):(_=v&&Di(f[i])==="object"&&!isNaN(parseInt(f[i][T],10))?f[i][T]/p:0,A.push((c[i]||C)/d+_)),T=i;return A},r4=ah.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),i=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return ah.processArabic&&(n=ah.processArabic(n)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(n,t,s)/t:Ig.apply(this,arguments).reduce(function(o,l){return o+l},0)},a4=function(n,e,t,i){for(var s=[],o=0,l=n.length,c=0;o!==l&&c+e[o]<t;)c+=e[o],o++;s.push(n.slice(0,o));var d=o;for(c=0;o!==l;)c+e[o]>i&&(s.push(n.slice(d,o)),c=0,d=o),c+=e[o],o++;return d!==o&&s.push(n.slice(d,o)),s},l4=function(n,e,t){t||(t={});var i,s,o,l,c,d,f,p=[],v=[p],_=t.textIndent||0,b=0,T=0,C=n.split(" "),A=Ig.apply(this,[" ",t])[0];if(d=t.lineIndent===-1?C[0].length+2:t.lineIndent||0){var I=Array(d).join(" "),ee=[];C.map(function(K){(K=K.split(/\s*\n/)).length>1?ee=ee.concat(K.map(function(de,le){return(le&&de.length?`
`:"")+de})):ee.push(K[0])}),C=ee,d=r4.apply(this,[I,t])}for(o=0,l=C.length;o<l;o++){var G=0;if(i=C[o],d&&i[0]==`
`&&(i=i.substr(1),G=1),_+b+(T=(s=Ig.apply(this,[i,t])).reduce(function(K,de){return K+de},0))>e||G){if(T>e){for(c=a4.apply(this,[i,s,e-(_+b),e]),p.push(c.shift()),p=[c.pop()];c.length;)v.push([c.shift()]);T=s.slice(i.length-(p[0]?p[0].length:0)).reduce(function(K,de){return K+de},0)}else p=[i];v.push(p),_=T+d,b=A}else p.push(i),_+=b+T,b=A}return f=d?function(K,de){return(de?I:"")+K.join(" ")}:function(K){return K.join(" ")},v.map(f)},ah.splitTextToSize=function(n,e,t){var i,s=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(p){if(p.widths&&p.kerning)return{widths:p.widths,kerning:p.kerning};var v=this.internal.getFont(p.fontName,p.fontStyle),_="Unicode";return v.metadata[_]?{widths:v.metadata[_].widths||{0:1},kerning:v.metadata[_].kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);i=Array.isArray(n)?n:String(n).split(/\r?\n/);var l=1*this.internal.scaleFactor*e/s;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/s:0,o.lineIndent=t.lineIndent;var c,d,f=[];for(c=0,d=i.length;c<d;c++)f=f.concat(l4.apply(this,[i[c],l,o]));return f},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",i={},s={},o=0;o<16;o++)i[t[o]]=e[o],s[e[o]]=t[o];var l=function(_){return"0x"+parseInt(_,10).toString(16)},c=n.__fontmetrics__.compress=function(_){var b,T,C,A,I=["{"];for(var ee in _){if(b=_[ee],isNaN(parseInt(ee,10))?T="'"+ee+"'":(ee=parseInt(ee,10),T=(T=l(ee).slice(2)).slice(0,-1)+s[T.slice(-1)]),typeof b=="number")b<0?(C=l(b).slice(3),A="-"):(C=l(b).slice(2),A=""),C=A+C.slice(0,-1)+s[C.slice(-1)];else{if(Di(b)!=="object")throw new Error("Don't know what to do with value type "+Di(b)+".");C=c(b)}I.push(T+C)}return I.push("}"),I.join("")},d=n.__fontmetrics__.uncompress=function(_){if(typeof _!="string")throw new Error("Invalid argument passed to uncompress.");for(var b,T,C,A,I={},ee=1,G=I,K=[],de="",le="",z=_.length-1,R=1;R<z;R+=1)(A=_[R])=="'"?b?(C=b.join(""),b=void 0):b=[]:b?b.push(A):A=="{"?(K.push([G,C]),G={},C=void 0):A=="}"?((T=K.pop())[0][T[1]]=G,C=void 0,G=T[0]):A=="-"?ee=-1:C===void 0?i.hasOwnProperty(A)?(de+=i[A],C=parseInt(de,16)*ee,ee=1,de=""):de+=A:i.hasOwnProperty(A)?(le+=i[A],G[C]=parseInt(le,16)*ee,ee=1,C=void 0,le=""):le+=A;return I},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:d("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},p={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},v={Unicode:{"Courier-Oblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":d("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":d("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:d("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:d("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":d("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":d("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(_){var b=_.font,T=v.Unicode[b.postScriptName];T&&(b.metadata.Unicode={},b.metadata.Unicode.widths=T.widths,b.metadata.Unicode.kerning=T.kerning);var C=p.Unicode[b.postScriptName];C&&(b.metadata.Unicode.encoding=C,b.encoding=C.codePages[0])}])})(vn.API),(function(n){var e=function(t){for(var i=t.length,s=new Uint8Array(i),o=0;o<i;o++)s[o]=t.charCodeAt(o);return s};n.API.events.push(["addFont",function(t){var i=void 0,s=t.font,o=t.instance;if(!s.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(i=o.existsFileInVFS(s.postScriptName)===!1?o.loadFile(s.postScriptName):o.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(l,c){c=/^\x00\x01\x00\x00/.test(c)?e(c):e(Vg(c)),l.metadata=n.API.TTFFont.open(c),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(s,i)}}])})(vn),vn.API.addSvgAsImage=function(n,e,t,i,s,o,l,c){if(isNaN(e)||isNaN(t))throw zi.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw zi.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=i,d.height=s;var f=d.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,d.width,d.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},v=this;return(Rn.canvg?Promise.resolve(Rn.canvg):e2(()=>import("./index.es-CuE084Zh.js"),[])).catch(function(_){return Promise.reject(new Error("Could not load canvg: "+_))}).then(function(_){return _.default?_.default:_}).then(function(_){return _.fromString(f,n,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(_){return _.render(p)}).then(function(){v.addImage(d.toDataURL("image/jpeg",1),e,t,i,s,l,c)})},vn.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var s=0;s<this.internal.pages[i].length;s++)this.internal.pages[i][s]=this.internal.pages[i][s].replace(e,t);return this},vn.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var i,s,o,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(l),d=[],f=0,p=0,v=0;function _(T,C){var A,I=!1;for(A=0;A<T.length;A+=1)T[A]===C&&(I=!0);return I}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var b=c.length;for(v=0;v<b;v+=1)t[c[v]].value=t[c[v]].defaultValue,t[c[v]].explicitSet=!1}if(Di(n)==="object"){for(s in n)if(o=n[s],_(c,s)&&o!==void 0){if(t[s].type==="boolean"&&typeof o=="boolean")t[s].value=o;else if(t[s].type==="name"&&_(t[s].valueSet,o))t[s].value=o;else if(t[s].type==="integer"&&Number.isInteger(o))t[s].value=o;else if(t[s].type==="array"){for(f=0;f<o.length;f+=1)if(i=!0,o[f].length===1&&typeof o[f][0]=="number")d.push(String(o[f]-1));else if(o[f].length>1){for(p=0;p<o[f].length;p+=1)typeof o[f][p]!="number"&&(i=!1);i===!0&&d.push([o[f][0]-1,o[f][1]-1].join(" "))}t[s].value="["+d.join(" ")+"]"}else t[s].value=t[s].defaultValue;t[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var T,C=[];for(T in t)t[T].explicitSet===!0&&(t[T].type==="name"?C.push("/"+T+" /"+t[T].value):C.push("/"+T+" "+t[T].value));C.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+C.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var e=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(i)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),d=unescape(encodeURIComponent("</x:xmpmeta>")),f=o.length+l.length+c.length+s.length+d.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(s+o+l+c+d),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(i,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(vn.API),(function(n){var e=n.API,t=e.pdfEscape16=function(o,l){for(var c,d=l.metadata.Unicode.widths,f=["","0","00","000","0000"],p=[""],v=0,_=o.length;v<_;++v){if(c=l.metadata.characterToGlyph(o.charCodeAt(v)),l.metadata.glyIdsUsed.push(c),l.metadata.toUnicode[c]=o.charCodeAt(v),d.indexOf(c)==-1&&(d.push(c),d.push([parseInt(l.metadata.widthOfGlyph(c),10)])),c=="0")return p.join("");c=c.toString(16),p.push(f[4-c.length],c)}return p.join("")},i=function(o){var l,c,d,f,p,v,_;for(p=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,d=[],v=0,_=(c=Object.keys(o).sort(function(b,T){return b-T})).length;v<_;v++)l=c[v],d.length>=100&&(p+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar`,d=[]),o[l]!==void 0&&o[l]!==null&&typeof o[l].toString=="function"&&(f=("0000"+o[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),d.push("<"+l+"><"+f+">"));return d.length&&(p+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar
`),p+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(l){var c=l.font,d=l.out,f=l.newObject,p=l.putStream;if(c.metadata instanceof n.API.TTFFont&&c.encoding==="Identity-H"){for(var v=c.metadata.Unicode.widths,_=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),b="",T=0;T<_.length;T++)b+=String.fromCharCode(_[T]);var C=f();p({data:b,addLength1:!0,objectId:C}),d("endobj");var A=f();p({data:i(c.metadata.toUnicode),addLength1:!0,objectId:A}),d("endobj");var I=f();d("<<"),d("/Type /FontDescriptor"),d("/FontName /"+ch(c.fontName)),d("/FontFile2 "+C+" 0 R"),d("/FontBBox "+n.API.PDFObject.convert(c.metadata.bbox)),d("/Flags "+c.metadata.flags),d("/StemV "+c.metadata.stemV),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d(">>"),d("endobj");var ee=f();d("<<"),d("/Type /Font"),d("/BaseFont /"+ch(c.fontName)),d("/FontDescriptor "+I+" 0 R"),d("/W "+n.API.PDFObject.convert(v)),d("/CIDToGIDMap /Identity"),d("/DW 1000"),d("/Subtype /CIDFontType2"),d("/CIDSystemInfo"),d("<<"),d("/Supplement 0"),d("/Registry (Adobe)"),d("/Ordering ("+c.encoding+")"),d(">>"),d(">>"),d("endobj"),c.objectNumber=f(),d("<<"),d("/Type /Font"),d("/Subtype /Type0"),d("/ToUnicode "+A+" 0 R"),d("/BaseFont /"+ch(c.fontName)),d("/Encoding /"+c.encoding),d("/DescendantFonts ["+ee+" 0 R]"),d(">>"),d("endobj"),c.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(l){var c=l.font,d=l.out,f=l.newObject,p=l.putStream;if(c.metadata instanceof n.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var v=c.metadata.rawData,_="",b=0;b<v.length;b++)_+=String.fromCharCode(v[b]);var T=f();p({data:_,addLength1:!0,objectId:T}),d("endobj");var C=f();p({data:i(c.metadata.toUnicode),addLength1:!0,objectId:C}),d("endobj");var A=f();d("<<"),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d("/StemV "+c.metadata.stemV),d("/Type /FontDescriptor"),d("/FontFile2 "+T+" 0 R"),d("/Flags 96"),d("/FontBBox "+n.API.PDFObject.convert(c.metadata.bbox)),d("/FontName /"+ch(c.fontName)),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d(">>"),d("endobj"),c.objectNumber=f();for(var I=0;I<c.metadata.hmtx.widths.length;I++)c.metadata.hmtx.widths[I]=parseInt(c.metadata.hmtx.widths[I]*(1e3/c.metadata.head.unitsPerEm));d("<</Subtype/TrueType/Type/Font/ToUnicode "+C+" 0 R/BaseFont/"+ch(c.fontName)+"/FontDescriptor "+A+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),d("endobj"),c.isAlreadyPutted=!0}})(o)}]);var s=function(o){var l,c=o.text||"",d=o.x,f=o.y,p=o.options||{},v=o.mutex||{},_=v.pdfEscape,b=v.activeFontKey,T=v.fonts,C=b,A="",I=0,ee="",G=T[C].encoding;if(T[C].encoding!=="Identity-H")return{text:c,x:d,y:f,options:p,mutex:v};for(ee=c,C=b,Array.isArray(c)&&(ee=c[0]),I=0;I<ee.length;I+=1)T[C].metadata.hasOwnProperty("cmap")&&(l=T[C].metadata.cmap.unicode.codeMap[ee[I].charCodeAt(0)]),l||ee[I].charCodeAt(0)<256&&T[C].metadata.hasOwnProperty("Unicode")?A+=ee[I]:A+="";var K="";return parseInt(C.slice(1))<14||G==="WinAnsiEncoding"?K=_(A,C).split("").map(function(de){return de.charCodeAt(0).toString(16)}).join(""):G==="Identity-H"&&(K=t(A,T[C])),v.isHex=!0,{text:K,x:d,y:f,options:p,mutex:v}};e.events.push(["postProcessText",function(o){var l=o.text||"",c=[],d={text:l,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(l)){var f=0;for(f=0;f<l.length;f+=1)Array.isArray(l[f])&&l[f].length===3?c.push([s(Object.assign({},d,{text:l[f][0]})).text,l[f][1],l[f][2]]):c.push(s(Object.assign({},d,{text:l[f]})).text);o.text=c}else o.text=s(Object.assign({},d,{text:l})).text}])})(vn),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,i){return e.call(this),this.internal.vFS[t]=i,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(vn.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(i){var s,o,l,c,d,f,p,v=e,_=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],b=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],T={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},C={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},A=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],I=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),ee=!1,G=0;this.__bidiEngine__={};var K=function(E){var O=E.charCodeAt(),M=O>>8,Y=C[M];return Y!==void 0?v[256*Y+(255&O)]:M===252||M===253?"AL":I.test(M)?"L":M===8?"R":"N"},de=function(E){for(var O,M=0;M<E.length;M++){if((O=K(E.charAt(M)))==="L")return!1;if(O==="R")return!0}return!1},le=function(E,O,M,Y){var ie,q,re,V,se=O[Y];switch(se){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":ee=!1;break;case"N":case"AN":break;case"EN":ee&&(se="AN");break;case"AL":ee=!0,se="R";break;case"WS":case"BN":se="N";break;case"CS":Y<1||Y+1>=O.length||(ie=M[Y-1])!=="EN"&&ie!=="AN"||(q=O[Y+1])!=="EN"&&q!=="AN"?se="N":ee&&(q="AN"),se=q===ie?q:"N";break;case"ES":se=(ie=Y>0?M[Y-1]:"B")==="EN"&&Y+1<O.length&&O[Y+1]==="EN"?"EN":"N";break;case"ET":if(Y>0&&M[Y-1]==="EN"){se="EN";break}if(ee){se="N";break}for(re=Y+1,V=O.length;re<V&&O[re]==="ET";)re++;se=re<V&&O[re]==="EN"?"EN":"N";break;case"NSM":if(l&&!c){for(V=O.length,re=Y+1;re<V&&O[re]==="NSM";)re++;if(re<V){var W=E[Y],te=W>=1425&&W<=2303||W===64286;if(ie=O[re],te&&(ie==="R"||ie==="AL")){se="R";break}}}se=Y<1||(ie=O[Y-1])==="B"?"N":M[Y-1];break;case"B":ee=!1,s=!0,se=G;break;case"S":o=!0,se="N"}return se},z=function(E,O,M){var Y=E.split("");return M&&R(Y,M,{hiLevel:G}),Y.reverse(),O&&O.reverse(),Y.join("")},R=function(E,O,M){var Y,ie,q,re,V,se=-1,W=E.length,te=0,j=[],U=G?b:_,$=[];for(ee=!1,s=!1,o=!1,ie=0;ie<W;ie++)$[ie]=K(E[ie]);for(q=0;q<W;q++){if(V=te,j[q]=le(E,$,j,q),Y=240&(te=U[V][T[j[q]]]),te&=15,O[q]=re=U[te][5],Y>0)if(Y===16){for(ie=se;ie<q;ie++)O[ie]=1;se=-1}else se=-1;if(U[te][6])se===-1&&(se=q);else if(se>-1){for(ie=se;ie<q;ie++)O[ie]=re;se=-1}$[q]==="B"&&(O[q]=0),M.hiLevel|=re}o&&(function(X,Q,ye){for(var Ae=0;Ae<ye;Ae++)if(X[Ae]==="S"){Q[Ae]=G;for(var De=Ae-1;De>=0&&X[De]==="WS";De--)Q[De]=G}})($,O,W)},D=function(E,O,M,Y,ie){if(!(ie.hiLevel<E)){if(E===1&&G===1&&!s)return O.reverse(),void(M&&M.reverse());for(var q,re,V,se,W=O.length,te=0;te<W;){if(Y[te]>=E){for(V=te+1;V<W&&Y[V]>=E;)V++;for(se=te,re=V-1;se<re;se++,re--)q=O[se],O[se]=O[re],O[re]=q,M&&(q=M[se],M[se]=M[re],M[re]=q);te=V}te++}}},F=function(E,O,M){var Y=E.split(""),ie={hiLevel:G};return M||(M=[]),R(Y,M,ie),(function(q,re,V){if(V.hiLevel!==0&&p)for(var se,W=0;W<q.length;W++)re[W]===1&&(se=A.indexOf(q[W]))>=0&&(q[W]=A[se+1])})(Y,M,ie),D(2,Y,O,M,ie),D(1,Y,O,M,ie),Y.join("")};return this.__bidiEngine__.doBidiReorder=function(E,O,M){if((function(ie,q){if(q)for(var re=0;re<ie.length;re++)q[re]=re;c===void 0&&(c=de(ie)),f===void 0&&(f=de(ie))})(E,O),l||!d||f)if(l&&d&&c^f)G=c?1:0,E=z(E,O,M);else if(!l&&d&&f)G=c?1:0,E=F(E,O,M),E=z(E,O);else if(!l||c||d||f){if(l&&!d&&c^f)E=z(E,O),c?(G=0,E=F(E,O,M)):(G=1,E=F(E,O,M),E=z(E,O));else if(l&&c&&!d&&f)G=1,E=F(E,O,M),E=z(E,O);else if(!l&&!d&&c^f){var Y=p;c?(G=1,E=F(E,O,M),G=0,p=!1,E=F(E,O,M),p=Y):(G=0,E=F(E,O,M),E=z(E,O),G=1,p=!1,E=F(E,O,M),p=Y,E=z(E,O))}}else G=0,E=F(E,O,M);else G=c?1:0,E=F(E,O,M);return E},this.__bidiEngine__.setOptions=function(E){E&&(l=E.isInputVisual,d=E.isOutputVisual,c=E.isInputRtl,f=E.isOutputRtl,p=E.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(i){var s=i.text;i.x,i.y;var o=i.options||{};i.mutex,o.lang;var l=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(s)==="[object Array]"){var c=0;for(l=[],c=0;c<s.length;c+=1)Object.prototype.toString.call(s[c])==="[object Array]"?l.push([t.doBidiReorder(s[c][0]),s[c][1],s[c][2]]):l.push([t.doBidiReorder(s[c])]);i.text=l}else i.text=t.doBidiReorder(s);t.setOptions({isInputVisual:!0})}])})(vn),vn.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new gu(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new MW(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new wW(this.contents),this.head=new xW(this),this.name=new CW(this),this.cmap=new ek(this),this.toUnicode={},this.hhea=new SW(this),this.maxp=new kW(this),this.hmtx=new LW(this),this.post=new EW(this),this.os2=new NW(this),this.loca=new jW(this),this.glyf=new AW(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,i,s,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,c,d,f;for(f=[],l=0,c=(d=this.bbox).length;l<c;l++)e=d[l],f.push(Math.round(e*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(i=255&(s=this.post.italic_angle),32768&(t=s>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,i){var s,o,l,c;for(l=0,o=0,c=(e=""+e).length;0<=c?o<c:o>c;o=0<=c?++o:--o)s=e.charCodeAt(o),l+=this.widthOfGlyph(this.characterToGlyph(s))+i*(1e3/t)||0;return l*(t/1e3)},n.prototype.lineHeight=function(e,t){var i;return t==null&&(t=!1),i=t?this.lineGap:0,(this.ascender+i-this.decender)/1e3*e},n})();var el,gu=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,i;for(i=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)i[t]=String.fromCharCode(this.readByte());return i.join("")},n.prototype.writeString=function(e){var t,i,s;for(s=[],t=0,i=e.length;0<=i?t<i:t>i;t=0<=i?++t:--t)s.push(this.writeByte(e.charCodeAt(t)));return s},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,i,s,o,l,c,d;return e=this.readByte(),t=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),d=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^i)+4294967296*(255^s)+16777216*(255^o)+65536*(255^l)+256*(255^c)+(255^d)+1):72057594037927940*e+281474976710656*t+1099511627776*i+4294967296*s+16777216*o+65536*l+256*c+d},n.prototype.writeLongLong=function(e){var t,i;return t=Math.floor(e/4294967296),i=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,i;for(t=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)t.push(this.readByte());return t},n.prototype.write=function(e){var t,i,s,o;for(o=[],i=0,s=e.length;i<s;i++)t=e[i],o.push(this.writeByte(t));return o},n})(),wW=(function(){var n;function e(t){var i,s,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},s=0,o=this.tableCount;0<=o?s<o:s>o;s=0<=o?++s:--s)i={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[i.tag]=i}return e.prototype.encode=function(t){var i,s,o,l,c,d,f,p,v,_,b,T,C;for(C in b=Object.keys(t).length,d=Math.log(2),v=16*Math.floor(Math.log(b)/d),l=Math.floor(v/d),p=16*b-v,(s=new gu).writeInt(this.scalarType),s.writeShort(b),s.writeShort(v),s.writeShort(l),s.writeShort(p),o=16*b,f=s.pos+o,c=null,T=[],t)for(_=t[C],s.writeString(C),s.writeInt(n(_)),s.writeInt(f),s.writeInt(_.length),T=T.concat(_),C==="head"&&(c=f),f+=_.length;f%4;)T.push(0),f++;return s.write(T),i=2981146554-n(s.data),s.pos=c+8,s.writeUInt32(i),s.data},n=function(t){var i,s,o,l;for(t=tk.call(t);t.length%4;)t.push(0);for(o=new gu(t),s=0,i=0,l=t.length;i<l;i=i+=4)s+=o.readUInt32();return 4294967295&s},e})(),_W={}.hasOwnProperty,Dl=function(n,e){for(var t in e)_W.call(e,t)&&(n[t]=e[t]);function i(){this.constructor=n}return i.prototype=e.prototype,n.prototype=new i,n.__super__=e.prototype,n};el=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var xW=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Dl(n,el),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var t;return(t=new gu).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},n})(),y4=(function(){function n(e,t){var i,s,o,l,c,d,f,p,v,_,b,T,C,A,I,ee,G;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),v=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(d=0;d<256;++d)this.codeMap[d]=e.readByte();break;case 4:for(b=e.readUInt16(),_=b/2,e.pos+=6,o=(function(){var K,de;for(de=[],d=K=0;0<=_?K<_:K>_;d=0<=_?++K:--K)de.push(e.readUInt16());return de})(),e.pos+=2,C=(function(){var K,de;for(de=[],d=K=0;0<=_?K<_:K>_;d=0<=_?++K:--K)de.push(e.readUInt16());return de})(),f=(function(){var K,de;for(de=[],d=K=0;0<=_?K<_:K>_;d=0<=_?++K:--K)de.push(e.readUInt16());return de})(),p=(function(){var K,de;for(de=[],d=K=0;0<=_?K<_:K>_;d=0<=_?++K:--K)de.push(e.readUInt16());return de})(),s=(this.length-e.pos+this.offset)/2,c=(function(){var K,de;for(de=[],d=K=0;0<=s?K<s:K>s;d=0<=s?++K:--K)de.push(e.readUInt16());return de})(),d=I=0,G=o.length;I<G;d=++I)for(A=o[d],i=ee=T=C[d];T<=A?ee<=A:ee>=A;i=T<=A?++ee:--ee)p[d]===0?l=i+f[d]:(l=c[p[d]/2+(i-T)-(_-d)]||0)!==0&&(l+=f[d]),this.codeMap[i]=65535&l}e.pos=v}return n.encode=function(e,t){var i,s,o,l,c,d,f,p,v,_,b,T,C,A,I,ee,G,K,de,le,z,R,D,F,E,O,M,Y,ie,q,re,V,se,W,te,j,U,$,X,Q,ye,Ae,De,Be,Fe,Ct;switch(Y=new gu,l=Object.keys(e).sort(function(at,Ce){return at-Ce}),t){case"macroman":for(C=0,A=(function(){var at=[];for(T=0;T<256;++T)at.push(0);return at})(),ee={0:0},o={},ie=0,se=l.length;ie<se;ie++)ee[De=e[s=l[ie]]]==null&&(ee[De]=++C),o[s]={old:e[s],new:ee[e[s]]},A[s]=ee[e[s]];return Y.writeUInt16(1),Y.writeUInt16(0),Y.writeUInt32(12),Y.writeUInt16(0),Y.writeUInt16(262),Y.writeUInt16(0),Y.write(A),{charMap:o,subtable:Y.data,maxGlyphID:C+1};case"unicode":for(O=[],v=[],G=0,ee={},i={},I=f=null,q=0,W=l.length;q<W;q++)ee[de=e[s=l[q]]]==null&&(ee[de]=++G),i[s]={old:de,new:ee[de]},c=ee[de]-s,I!=null&&c===f||(I&&v.push(I),O.push(s),f=c),I=s;for(I&&v.push(I),v.push(65535),O.push(65535),F=2*(D=O.length),R=2*Math.pow(Math.log(D)/Math.LN2,2),_=Math.log(R/2)/Math.LN2,z=2*D-R,d=[],le=[],b=[],T=re=0,te=O.length;re<te;T=++re){if(E=O[T],p=v[T],E===65535){d.push(0),le.push(0);break}if(E-(M=i[E].new)>=32768)for(d.push(0),le.push(2*(b.length+D-T)),s=V=E;E<=p?V<=p:V>=p;s=E<=p?++V:--V)b.push(i[s].new);else d.push(M-E),le.push(0)}for(Y.writeUInt16(3),Y.writeUInt16(1),Y.writeUInt32(12),Y.writeUInt16(4),Y.writeUInt16(16+8*D+2*b.length),Y.writeUInt16(0),Y.writeUInt16(F),Y.writeUInt16(R),Y.writeUInt16(_),Y.writeUInt16(z),ye=0,j=v.length;ye<j;ye++)s=v[ye],Y.writeUInt16(s);for(Y.writeUInt16(0),Ae=0,U=O.length;Ae<U;Ae++)s=O[Ae],Y.writeUInt16(s);for(Be=0,$=d.length;Be<$;Be++)c=d[Be],Y.writeUInt16(c);for(Fe=0,X=le.length;Fe<X;Fe++)K=le[Fe],Y.writeUInt16(K);for(Ct=0,Q=b.length;Ct<Q;Ct++)C=b[Ct],Y.writeUInt16(C);return{charMap:i,subtable:Y.data,maxGlyphID:G+1}}},n})(),ek=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Dl(n,el),n.prototype.tag="cmap",n.prototype.parse=function(e){var t,i,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)t=new y4(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(e,t){var i,s;return t==null&&(t="macroman"),i=y4.encode(e,t),(s=new gu).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},n})(),SW=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Dl(n,el),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n})(),NW=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Dl(n,el),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,i;for(i=[],t=0;t<10;++t)i.push(e.readByte());return i})(),this.charRange=(function(){var t,i;for(i=[],t=0;t<4;++t)i.push(e.readInt());return i})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,i;for(i=[],t=0;t<2;t=++t)i.push(e.readInt());return i})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n})(),EW=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Dl(n,el),n.prototype.tag="post",n.prototype.parse=function(e){var t,i,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var o;for(i=e.readUInt16(),this.glyphNameIndex=[],o=0;0<=i?o<i:o>i;o=0<=i?++o:--o)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)t=e.readByte(),s.push(this.names.push(e.readString(t)));return s;case 151552:return i=e.readUInt16(),this.offsets=e.read(i);case 262144:return this.map=(function(){var l,c,d;for(d=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)d.push(e.readUInt32());return d}).call(this)}},n})(),TW=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},CW=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Dl(n,el),n.prototype.tag="name",n.prototype.parse=function(e){var t,i,s,o,l,c,d,f,p,v,_;for(e.pos=this.offset,e.readShort(),t=e.readShort(),c=e.readShort(),i=[],o=0;0<=t?o<t:o>t;o=0<=t?++o:--o)i.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+c+e.readShort()});for(d={},o=p=0,v=i.length;p<v;o=++p)s=i[o],e.pos=s.offset,f=e.readString(s.length),l=new TW(f,s),d[_=s.nameID]==null&&(d[_]=[]),d[s.nameID].push(l);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},n})(),kW=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Dl(n,el),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n})(),LW=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Dl(n,el),n.prototype.tag="hmtx",n.prototype.parse=function(e){var t,i,s,o,l,c,d;for(e.pos=this.offset,this.metrics=[],t=0,c=this.file.hhea.numberOfMetrics;0<=c?t<c:t>c;t=0<=c?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,p;for(p=[],t=f=0;0<=s?f<s:f>s;t=0<=s?++f:--f)p.push(e.readInt16());return p})(),this.widths=(function(){var f,p,v,_;for(_=[],f=0,p=(v=this.metrics).length;f<p;f++)o=v[f],_.push(o.advance);return _}).call(this),i=this.widths[this.widths.length-1],d=[],t=l=0;0<=s?l<s:l>s;t=0<=s?++l:--l)d.push(this.widths.push(i));return d},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n})(),tk=[].slice,AW=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Dl(n,el),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var t,i,s,o,l,c,d,f,p,v;return e in this.cache?this.cache[e]:(o=this.file.loca,t=this.file.contents,i=o.indexOf(e),(s=o.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+i,l=(c=new gu(t.read(s))).readShort(),f=c.readShort(),v=c.readShort(),d=c.readShort(),p=c.readShort(),this.cache[e]=l===-1?new OW(c,f,v,d,p):new DW(c,l,f,v,d,p),this.cache[e]))},n.prototype.encode=function(e,t,i){var s,o,l,c,d;for(l=[],o=[],c=0,d=t.length;c<d;c++)s=e[t[c]],o.push(l.length),s&&(l=l.concat(s.encode(i)));return o.push(l.length),{table:l,offsets:o}},n})(),DW=(function(){function n(e,t,i,s,o,l){this.raw=e,this.numberOfContours=t,this.xMin=i,this.yMin=s,this.xMax=o,this.yMax=l,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),OW=(function(){function n(e,t,i,s,o){var l,c;for(this.raw=e,this.xMin=t,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;c=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&c;)l.pos+=1&c?4:2,128&c?l.pos+=8:64&c?l.pos+=4:8&c&&(l.pos+=2)}return n.prototype.encode=function(){var e,t,i;for(t=new gu(tk.call(this.raw.data)),e=0,i=this.glyphIDs.length;e<i;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),jW=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Dl(n,el),n.prototype.tag="loca",n.prototype.parse=function(e){var t,i;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var s,o;for(o=[],i=0,s=this.length;i<s;i+=2)o.push(2*e.readUInt16());return o}).call(this):(function(){var s,o;for(o=[],i=0,s=this.length;i<s;i+=4)o.push(e.readUInt32());return o}).call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,t){for(var i=new Uint32Array(this.offsets.length),s=0,o=0,l=0;l<i.length;++l)if(i[l]=s,o<t.length&&t[o]==l){++o,i[l]=s;var c=this.offsets[l],d=this.offsets[l+1]-c;d>0&&(s+=d)}for(var f=new Array(4*i.length),p=0;p<i.length;++p)f[4*p+3]=255&i[p],f[4*p+2]=(65280&i[p])>>8,f[4*p+1]=(16711680&i[p])>>16,f[4*p]=(4278190080&i[p])>>24;return f},n})(),MW=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,i,s,o;for(t in s=this.font.cmap.tables[0].codeMap,e={},o=this.subset)i=o[t],e[t]=s[i];return e},n.prototype.glyphsFor=function(e){var t,i,s,o,l,c,d;for(s={},l=0,c=e.length;l<c;l++)s[o=e[l]]=this.font.glyf.glyphFor(o);for(o in t=[],s)(i=s[o])!=null&&i.compound&&t.push.apply(t,i.glyphIDs);if(t.length>0)for(o in d=this.glyphsFor(t))i=d[o],s[o]=i;return s},n.prototype.encode=function(e,t){var i,s,o,l,c,d,f,p,v,_,b,T,C,A,I;for(s in i=ek.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(e),b={0:0},I=i.charMap)b[(d=I[s]).old]=d.new;for(T in _=i.maxGlyphID,l)T in b||(b[T]=_++);return p=(function(ee){var G,K;for(G in K={},ee)K[ee[G]]=G;return K})(b),v=Object.keys(p).sort(function(ee,G){return ee-G}),C=(function(){var ee,G,K;for(K=[],ee=0,G=v.length;ee<G;ee++)c=v[ee],K.push(p[c]);return K})(),o=this.font.glyf.encode(l,C,b),f=this.font.loca.encode(o.offsets,C),A={cmap:this.font.cmap.raw(),glyf:o.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(A["OS/2"]=this.font.os2.raw()),this.font.directory.encode(A)},n})();vn.API.PDFObject=(function(){var n;function e(){}return n=function(t,i){return(Array(i+1).join("0")+t).slice(-i)},e.convert=function(t){var i,s,o,l;if(Array.isArray(t))return"["+(function(){var c,d,f;for(f=[],c=0,d=t.length;c<d;c++)i=t[c],f.push(e.convert(i));return f})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(s in o=["<<"],t)l=t[s],o.push("/"+s+" "+e.convert(l));return o.push(">>"),o.join(`
`)}return""+t},e})();const v4=(n,e)=>{try{const t=new Date,i=t.getFullYear(),s=t.getMonth()+1,o=new Date(i,s,0).getDate();console.log("📊 Monthly energy calculation:",{currentYear:i,currentMonth:s,daysInMonth:o,selectedOutlets:[...new Set(e)],totalOutlets:e.length,uniqueOutlets:[...new Set(e)].length});const l=new Set;let c=0;return e.forEach((d,f)=>{if(l.has(d)){console.log(`📊 Skipping duplicate outlet: ${d}`);return}l.add(d);const p=d.replace(" ","_"),v=n[p];if(v&&v.daily_logs){let _=0;for(let b=1;b<=o;b++){const T=`day_${i}_${String(s).padStart(2,"0")}_${String(b).padStart(2,"0")}`,C=v.daily_logs[T];C&&C.total_energy!==void 0&&(_+=C.total_energy)}c+=_,console.log(`📊 Outlet ${d} (${p}) monthly energy: ${(_*1e3).toFixed(0)}Wh`)}else console.log(`📊 No data found for outlet: ${d} (${p})`)}),console.log(`📊 Total combined monthly energy: ${(c*1e3).toFixed(0)}Wh`),c}catch(t){return console.error("📊 Error calculating combined monthly energy:",t),0}};op.register(sC,oC,KT,GT,QT,tC,iC,JT);function RW(){const n=()=>{const Te=new Date,Qe=Te.getFullYear(),dt=String(Te.getMonth()+1).padStart(2,"0"),ve=String(Te.getDate()).padStart(2,"0");return`day_${Qe}_${dt}_${ve}`},e=(Te,Qe=3)=>Te.toLocaleString("en-US",{minimumFractionDigits:Qe,maximumFractionDigits:Qe}),t=async Te=>{const Qe=new Date,dt=Qe.getFullYear(),ve=Qe.getMonth()+1,He=new Date(dt,ve,0).getDate();let Le=0,Re=0;try{const Nt=Me(je,"devices"),xt=await Pt(Nt);if(xt.exists()){const st=xt.val();for(let St=1;St<=He;St++){const yt=String(St).padStart(2,"0"),ke=`day_${dt}_${String(ve).padStart(2,"0")}_${yt}`;let pt=0;Te.forEach(Lt=>{const Yt=Lt.outletId,Vt=st[Yt];if(!Vt)return;const yn=(Vt.daily_logs||{})[ke];if(yn){const en=yn.total_energy||0,wn=yn.avg_power||0,In=yn.usage_time_hours||0,Tn=wn*In/1e3;let Vn=en;if(In>0&&wn>0){const Ei=Math.abs(en-Tn);Math.min(en,Tn)/Math.max(en,Tn)<.95&&Ei>.1&&(Vn=Tn)}pt+=Vn}}),pt>0&&(Le+=pt,Re++)}}}catch(Nt){console.error("Error calculating daily average:",Nt),Le=Te.reduce((st,St)=>st+(St.total_energy||0),0),Re=1}const Pe=Re>0?Le/Re:0,At=Pe*He,rt=At*Fe;return console.log(`Reports estimated monthly bill: Daily average = ${Pe.toFixed(3)} kWh, Days in month = ${He}, Estimated monthly energy = ${At.toFixed(3)} kWh, Estimated bill = PHP ${rt.toFixed(2)}`),rt},i=async Te=>{let Qe=0;const dt=new Date,ve=dt.getFullYear(),He=dt.getMonth()+1,Le=new Date(ve,He,0).getDate();try{const Re=Me(je,"devices"),Pe=await Pt(Re);if(Pe.exists()){const At=Pe.val();console.log(`🔍 Current bill calculation: Processing ${ve}-${String(He).padStart(2,"0")} with ${Le} days`);for(const rt of Te){const Nt=rt.outletId,xt=At[Nt];if(xt&&xt.daily_logs){let st=0;for(let ke=1;ke<=Le;ke++){const pt=`day_${ve}_${String(He).padStart(2,"0")}_${String(ke).padStart(2,"0")}`,Lt=xt.daily_logs[pt];Lt&&(st+=Lt.total_energy||0)}const St=st*Fe,yt=Math.floor(St*100)/100;Qe+=yt,console.log(`📊 Device ${Nt}: Monthly energy = ${st.toFixed(6)} kWh, Cost = PHP ${yt.toFixed(2)}`)}}}}catch(Re){console.error("❌ Error calculating current bill:",Re);const At=Te.reduce((rt,Nt)=>rt+(Nt.total_energy||0),0)*Fe;Qe=Math.floor(At*100)/100}return console.log("📊 Current bill calculation results:"),console.log(`   Total bill (sum of truncated costs): PHP ${Qe.toFixed(2)}`),Qe},s=(Te,Qe)=>{if(Qe===0)return{percentage:0,isPositive:!0};const dt=(Te-Qe)/Qe*100;return{percentage:Math.abs(dt),isPositive:dt>=0}},o=(Te,Qe)=>{const dt=s(Te,Qe);return dt.percentage===0?null:u.jsxs("span",{className:`trend-indicator ${dt.isPositive?"positive":"negative"}`,children:[dt.isPositive?"↑":"↓"," ",dt.percentage.toFixed(1),"%"]})},l=Te=>{const Qe=new Date;switch(Te){case"Week":return`Last 7 days (${new Date(Qe.getTime()-6048e5).toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${Qe.toLocaleDateString("en-US",{month:"short",day:"numeric"})})`;case"Month":return Qe.toLocaleDateString("en-US",{month:"long",year:"numeric"});case"Year":return Qe.getFullYear().toString();default:return Te}},c=(Te,Qe)=>{if(!Qe.trim())return Te;const dt=Qe.toLowerCase();return Te.filter(ve=>`Outlet ${ve.outletId.split("_")[1]}`.toLowerCase().includes(dt)||ve.outletId.toLowerCase().includes(dt))},d=()=>{F("")},f=(Te,Qe,dt,ve)=>{if(!Te||!Te.timeRange&&!Te.startTime)return Qe==="on";const He=new Date,Le=He.getHours()*60+He.getMinutes(),Re=He.getDay();let Pe,At;if(Te.startTime&&Te.endTime){const[st,St]=Te.startTime.split(":").map(Number),[yt,ke]=Te.endTime.split(":").map(Number);Pe=st*60+St,At=yt*60+ke}else if(Te.timeRange){const st=Te.timeRange,[St,yt]=st.split(" - "),ke=pt=>{const[Lt,Yt]=pt.split(" ");let[Vt,nn]=Lt.split(":").map(Number);return Vt===12&&(Vt=0),Yt==="PM"&&(Vt+=12),Vt*60+nn};Pe=ke(St),At=ke(yt)}else return Qe==="on";const rt=Le>=Pe&&Le<At,Nt=Te.frequency||"";let xt=!1;if(Nt.toLowerCase()==="daily")xt=!0;else if(Nt.toLowerCase()==="weekdays")xt=Re>=1&&Re<=5;else if(Nt.toLowerCase()==="weekends")xt=Re===0||Re===6;else if(Nt.includes(",")){const st={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6};xt=Nt.split(",").map(yt=>{const ke=yt.trim().toLowerCase();return st[ke]}).filter(yt=>yt!==void 0).includes(Re)}else if(Nt){const St={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6}[Nt.toLowerCase()];St!==void 0&&(xt=St===Re)}if(dt&&!ve){const st=dt.relay_control?.auto_cutoff?.power_limit||0,St=new Date,yt=`day_${St.getFullYear()}_${String(St.getMonth()+1).padStart(2,"0")}_${String(St.getDate()).padStart(2,"0")}`,pt=dt?.daily_logs?.[yt]?.total_energy||0;if(st>0&&pt>=st)return console.log("Reports: Schedule check - Device power limit exceeded:",{todayTotalEnergy:`${(pt*1e3).toFixed(3)}Wh`,powerLimit:`${st*1e3}Wh`,todayDateKey:yt,scheduleResult:!1,reason:"Today's energy consumption exceeded power limit"}),!1}return rt&&xt},p=()=>{lt(!0)},v=Te=>Te?new Date(Te).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"",_=async()=>{if(!Ze||!mt)return;Zt(!0),console.log("Date range selected:",{selectedStartDate:Ze,selectedEndDate:mt,selectedOffice:qt,selectedPdfDepartment:qe});let Te=E;qe!=="All Departments"&&(Te=E.filter(Pe=>Pe.office_info&&Pe.office_info.department?Pe.office_info.department.toLowerCase()===qe.toLowerCase():!1)),qt!=="All Offices"&&(Te=Te.filter(Pe=>Pe.officeRoom===qt)),console.log("Filtered devices:",Te.length,"Department:",qe,"Office:",qt);const Qe=new Date(Ze),dt=new Date(mt);let ve=0,He=Te.length;const Le=[];console.log("Processing date range:",{startDate:Qe,endDate:dt});for(const Pe of Te){const At=Me(je,`devices/${Pe.outletId}`);try{const rt=await Pt(At);if(rt.exists()){const Nt=rt.val();let xt=0,st=0;if(console.log(`Processing device ${Pe.outletId}:`,Nt),Nt.daily_logs){console.log(`Daily logs for ${Pe.outletId}:`,Object.keys(Nt.daily_logs));for(const[St,yt]of Object.entries(Nt.daily_logs)){let ke;try{if(ke=new Date(St),isNaN(ke.getTime())&&St.startsWith("day_")){const pt=St.replace("day_","").replace(/_/g,"-");ke=new Date(pt)}if(isNaN(ke.getTime())){const pt=St.match(/(\d{4})_(\d{2})_(\d{2})/);if(pt){const[,Lt,Yt,Vt]=pt;ke=new Date(parseInt(Lt),parseInt(Yt)-1,parseInt(Vt))}}}catch(pt){console.error(`Error parsing date ${St}:`,pt);continue}if(console.log(`Checking date ${St}:`,{logDate:ke,startDate:Qe,endDate:dt,inRange:ke>=Qe&&ke<=dt}),ke>=Qe&&ke<=dt){const pt=yt;console.log(`Adding data for ${St}:`,pt),xt+=pt.total_energy||0,st+=pt.usage_time_hours||0}}}console.log(`Device ${Pe.outletId} total energy:`,xt),ve+=xt,Le.push({outletId:Pe.outletId,appliance:Pe.appliances||"Unassigned",powerLimit:(Pe.relay_control?.auto_cutoff?.power_limit||0)*1e3,monthlyEnergy:xt*1e3,totalHours:st,monthlyCost:xt*Fe})}else console.log(`No data found for device ${Pe.outletId}`),Le.push({outletId:Pe.outletId,appliance:Pe.appliances||"Unassigned",powerLimit:(Pe.relay_control?.auto_cutoff?.power_limit||0)*1e3,monthlyEnergy:0,totalHours:0,monthlyCost:0})}catch(rt){console.error(`Error fetching data for device ${Pe.outletId}:`,rt),Le.push({outletId:Pe.outletId,appliance:Pe.appliances||"Unassigned",powerLimit:(Pe.relay_control?.auto_cutoff?.power_limit||0)*1e3,monthlyEnergy:0,totalHours:0,monthlyCost:0})}}const Re=Le.reduce((Pe,At)=>Pe+Math.floor(At.monthlyCost*100)/100,0);console.log("Preview data calculated:",{deviceCount:He,totalEnergy:ve,estimatedCost:Re,currentRate:Fe,deviceTableData:Le}),gt({deviceCount:He,totalEnergy:ve,estimatedCost:Re,filteredDevices:Te,deviceTableData:Le}),Zt(!1),Se(!1),Ye(!0)},b=()=>{T(qt,Ze,mt),Ye(!1)},T=async(Te="",Qe,dt)=>{try{console.log("PDF Generation started with:",{targetOffice:Te,startDate:Qe,endDate:dt});const ve=new Date,He=ve.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});let Le=E,Re="All Offices";qe!=="All Departments"&&(Le=E.filter(Ht=>Ht.office_info&&Ht.office_info.department?Ht.office_info.department.toLowerCase()===qe.toLowerCase():!1)),Te&&Te!=="All Offices"&&(Le=Le.filter(Ht=>Ht.officeRoom===Te),Re=Te);const Pe=Le.length,At=ve.getFullYear(),rt=ve.getMonth()+1,Nt=new Date(At,rt,0).getDate(),xt=await Promise.all(Le.map(async Ht=>{try{const _n=Me(je,"devices"),Ui=await Pt(_n);if(Ui.exists()){const qi=Ui.val()[Ht.outletId];if(qi&&qi.daily_logs){let ss=0,Vi=0;if(Qe&&dt){const Fn=new Date(Qe),mi=new Date(dt);for(const[cn,Io]of Object.entries(qi.daily_logs)){let Po;try{if(Po=new Date(cn),isNaN(Po.getTime())&&cn.startsWith("day_")){const bs=cn.replace("day_","").replace(/_/g,"-");Po=new Date(bs)}if(isNaN(Po.getTime())){const bs=cn.match(/(\d{4})_(\d{2})_(\d{2})/);if(bs){const[,bo,os,Ys]=bs;Po=new Date(parseInt(bo),parseInt(os)-1,parseInt(Ys))}}}catch(bs){console.error(`Error parsing date ${cn}:`,bs);continue}if(Po>=Fn&&Po<=mi){const bs=Io;console.log(`PDF: Adding data for ${cn} in date range:`,bs),ss+=bs.total_energy||0,Vi+=bs.usage_time_hours||0}}}else for(let Fn=1;Fn<=Nt;Fn++){const mi=`day_${At}_${String(rt).padStart(2,"0")}_${String(Fn).padStart(2,"0")}`,cn=qi.daily_logs[mi];cn&&(ss+=cn.total_energy||0,Vi+=cn.usage_time_hours||0)}const Oi={outletId:Ht.outletId,appliance:Ht.appliances||"Unassigned",powerLimit:(Ht.relay_control?.auto_cutoff?.power_limit||0)*1e3,monthlyEnergy:ss*1e3,totalHours:Vi,monthlyCost:ss*Fe};return console.log(`PDF: Device ${Ht.outletId} calculated data:`,Oi),Oi}}return{outletId:Ht.outletId,appliance:Ht.appliances||"Unassigned",powerLimit:(Ht.relay_control?.auto_cutoff?.power_limit||0)*1e3,monthlyEnergy:0,totalHours:0,monthlyCost:0}}catch(_n){return console.error(`Error calculating data for ${Ht.outletId}:`,_n),{outletId:Ht.outletId,appliance:Ht.appliances||"Unassigned",powerLimit:(Ht.relay_control?.auto_cutoff?.power_limit||0)*1e3,monthlyEnergy:0,totalHours:0,monthlyCost:0}}}));console.log("PDF: All device data calculated:",xt),console.log("PDF: Total devices:",xt.length),console.log("PDF: Total energy:",xt.reduce((Ht,_n)=>Ht+_n.monthlyEnergy/1e3,0),"kWh"),console.log("PDF: Total cost:",xt.reduce((Ht,_n)=>Ht+_n.monthlyCost,0),"PHP");const st=new vn,St=st.internal.pageSize.getWidth(),yt=st.internal.pageSize.getHeight();let ke=20;const pt=(Ht,_n,Ui,is={})=>{st.setFontSize(is.fontSize||12),st.setTextColor(is.color||"#000000"),is.bold?st.setFont("arial","bold"):st.setFont("arial","normal"),st.text(Ht,_n,Ui)},Lt=(Ht,_n,Ui,is)=>{st.setDrawColor(200,200,200),st.line(Ht,_n,Ui,is)},Yt=(Ht,_n,Ui,is,qi)=>{qi&&(st.setFillColor(qi[0],qi[1],qi[2]),st.rect(Ht,_n,Ui,is,"F")),st.setDrawColor(0,0,0),st.rect(Ht,_n,Ui,is,"S")},Vt=(Ht=20)=>ke+Ht>yt-20?(st.addPage(),ke=20,!0):!1;if(qe!=="All Departments"&&(st.setFontSize(12),st.setFont("arial","normal"),st.text(qe,St/2,ke,{align:"center"}),ke+=8),st.setFontSize(12),st.setFont("arial","normal"),st.text("Camarines Norte State College",St/2,ke,{align:"center"}),ke+=8,st.setFontSize(12),st.setFont("arial","normal"),st.text("Daet, Camarines Norte",St/2,ke,{align:"center"}),ke+=15,st.setFontSize(16),st.setFont("arial","bold"),st.text("EcoPlug Performance Summary Report",St/2,ke,{align:"center"}),ke+=20,Lt(20,ke,St-20,ke),ke+=15,Qe&&dt){const Ht=new Date(Qe).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),_n=new Date(dt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});pt(`Date Range: ${Ht} to ${_n}`,20,ke,{fontSize:12})}else pt(`Date: ${He}`,20,ke,{fontSize:12});ke+=7,qe!=="All Departments"&&(pt(`Department: ${qe}`,20,ke,{fontSize:12}),ke+=7),pt(`Offices: ${Re}`,20,ke,{fontSize:12}),ke+=7,pt(`No. of EcoPlug: ${Pe}`,20,ke,{fontSize:12}),ke+=7,pt(`Electricity Rate: PHP ${Fe.toFixed(4)} per kWh`,20,ke,{fontSize:12}),ke+=15,Vt(50),pt("I. Outlet Performance Breakdown",20,ke,{fontSize:14,bold:!0}),ke+=10;const nn=[20,30,25,30,25,25,20],yn=16;let en=20;const wn=[173,216,230];nn.forEach(Ht=>{Yt(en,ke-2,Ht,yn,wn),en+=Ht}),en=20,pt("Outlet",en+2,ke+4,{fontSize:10,bold:!0}),en+=nn[0],pt("Appliance",en+2,ke+4,{fontSize:10,bold:!0}),en+=nn[1],pt("Power Limit",en+2,ke+3,{fontSize:10,bold:!0}),pt("(Wh)",en+2,ke+9,{fontSize:10,bold:!0}),en+=nn[2],pt("Total Power",en+2,ke+2,{fontSize:10,bold:!0}),pt("Usage",en+2,ke+6,{fontSize:10,bold:!0}),pt("(Wh)",en+2,ke+10,{fontSize:10,bold:!0}),en+=nn[3],pt("Total No. of",en+2,ke+2,{fontSize:10,bold:!0}),pt("Hours",en+2,ke+6,{fontSize:10,bold:!0}),pt("(hrs)",en+2,ke+10,{fontSize:10,bold:!0}),en+=nn[4],pt("Monthly Cost",en+2,ke+4,{fontSize:10,bold:!0}),pt("(PHP)",en+2,ke+8,{fontSize:10,bold:!0}),en+=nn[5],pt("Share of",en+2,ke+2,{fontSize:10,bold:!0}),pt("Total",en+2,ke+6,{fontSize:10,bold:!0}),pt("(%)",en+2,ke+10,{fontSize:10,bold:!0}),ke+=yn+2;const In=xt.map((Ht,_n)=>{const Ui=Ht.outletId.split("_")[1]||(_n+1).toString();let is="";const qi=Ht.outletId.replace("_"," ");if(Dt?.enabled&&Dt?.selectedOutlets?.includes(qi))if(String(Dt.combinedLimit)==="No Limit")is="No Limit";else{const mi=Dt.combinedLimit;is=mi!=null&&!isNaN(mi)?mi.toFixed(3):"No Limit"}else{const mi=Ht.powerLimit;is=mi!=null&&!isNaN(mi)?mi.toFixed(3):"No Limit"}const ss=Ht.monthlyEnergy.toFixed(3),Vi=Ht.totalHours.toFixed(3),Oi=`PHP ${(Math.floor(Ht.monthlyCost*100)/100).toFixed(2)}`,Fn=xt.reduce((mi,cn)=>mi+cn.monthlyEnergy,0)>0?(Ht.monthlyEnergy/xt.reduce((mi,cn)=>mi+cn.monthlyEnergy,0)*100).toFixed(3):"0.000";return[`Outlet ${Ui}`,Ht.appliance,is,ss,Vi,Oi,Fn]}),Tn=10;In.forEach(Ht=>{Vt(15),en=20,nn.forEach(_n=>{Yt(en,ke-2,_n,Tn),en+=_n}),en=20,Ht.forEach((_n,Ui)=>{pt(_n,en+2,ke+4,{fontSize:9}),en+=nn[Ui]}),ke+=Tn}),Vt(20);const Vn=xt.reduce((Ht,_n)=>Ht+_n.monthlyEnergy,0),Ei=xt.reduce((Ht,_n)=>Ht+Math.floor(_n.monthlyCost*100)/100,0),ts=xt.reduce((Ht,_n)=>Ht+_n.totalHours,0),fs=nn.reduce((Ht,_n)=>Ht+_n,0);Yt(20,ke-2,fs,Tn),pt(`Total Usage: ${Vn.toFixed(3)} Wh (${ts.toFixed(3)} hours)`,22,ke+4,{fontSize:10,bold:!0}),ke+=Tn,Yt(20,ke-2,fs,Tn),pt(`Estimated Cost: PHP ${Ei.toFixed(2)}`,22,ke+4,{fontSize:10,bold:!0}),ke+=Tn,ke+=10,Vt(60),st.setFont("helvetica","normal"),st.setFontSize(12),st.setTextColor("#000000");let Mo="";Dt?.enabled&&Dt?.combinedLimit>0?Mo=`The outlet performance data shows a total power usage of ${Vn.toFixed(3)} Wh across all monitored appliances, operating for a combined ${ts.toFixed(3)} hours, which resulted in an estimated monthly cost of PHP ${Ei.toFixed(2)}. The analysis covers ${Pe} EcoPlug devices in ${Re}, with a combined power limit of ${(Dt.combinedLimit/1e3).toFixed(0)} kilowatts.`:Mo=`The outlet performance data shows a total power usage of ${Vn.toFixed(3)} Wh across all monitored appliances, operating for a combined ${ts.toFixed(3)} hours, which resulted in an estimated monthly cost of PHP ${Ei.toFixed(2)}. The analysis covers ${Pe} EcoPlug devices in ${Re}, with individual power limits ranging from ${Math.min(...xt.map(Ht=>Ht.powerLimit).filter(Ht=>Ht>0)).toFixed(3)} Wh to ${Math.max(...xt.map(Ht=>Ht.powerLimit).filter(Ht=>Ht>0)).toFixed(3)} Wh.`;const Lr=St-40;st.splitTextToSize(Mo,Lr).forEach(Ht=>{Vt(15),st.text(Ht,20,ke),ke+=6}),ke+=20,Vt(80),pt("II. Power Saving Recommendation",20,ke,{fontSize:14,bold:!0}),ke+=15;const Vs=[24,34,29,29,29,29],Yn=16;let ai=20;const tl=[173,216,230];Vs.forEach(Ht=>{Yt(ai,ke-2,Ht,Yn,tl),ai+=Ht}),ai=20,pt("Outlet",ai+2,ke+4,{fontSize:10,bold:!0}),ai+=Vs[0],pt("Appliance",ai+2,ke+4,{fontSize:10,bold:!0}),ai+=Vs[1],pt("Avg. Daily",ai+2,ke+2,{fontSize:10,bold:!0}),pt("Power Usage",ai+2,ke+6,{fontSize:10,bold:!0}),pt("(Wh)",ai+2,ke+10,{fontSize:10,bold:!0}),ai+=Vs[2],pt("Power Limit",ai+2,ke+4,{fontSize:10,bold:!0}),ai+=Vs[3],pt("Total Power",ai+2,ke+2,{fontSize:10,bold:!0}),pt("Usage (Wh)",ai+2,ke+6,{fontSize:10,bold:!0}),ai+=Vs[4],pt("Recommended",ai+2,ke+2,{fontSize:10,bold:!0}),pt("Power Limit",ai+2,ke+6,{fontSize:10,bold:!0}),ke+=Yn+2;const no=xt.map((Ht,_n)=>{const Ui=Ht.outletId.split("_")[1]||(_n+1).toString(),is=Ht.totalHours>0?(Ht.monthlyEnergy/Nt).toFixed(3):"0.000";let qi="";const ss=Ht.outletId.replace("_"," ");if(Dt?.enabled&&Dt?.selectedOutlets?.includes(ss))if(String(Dt.combinedLimit)==="No Limit")qi="No Limit";else{const Fn=Dt.combinedLimit;qi=Fn!=null&&!isNaN(Fn)?Fn.toFixed(3):"No Limit"}else{const Fn=Ht.powerLimit;qi=Fn!=null&&!isNaN(Fn)?Fn.toFixed(3):"No Limit"}const Vi=Ht.monthlyEnergy.toFixed(3);let Oi="";if(Dt?.enabled&&Dt?.selectedOutlets?.includes(ss))if(String(Dt.combinedLimit)==="No Limit")Oi="No Limit";else{const Fn=Ht.monthlyEnergy;Fn!=null&&!isNaN(Fn)?Oi=Fn.toFixed(3):Oi="No Limit"}else{const Fn=Ht.monthlyEnergy;Fn!=null&&!isNaN(Fn)?Oi=Fn.toFixed(3):Oi="No Limit"}return[`Outlet ${Ui}`,Ht.appliance,is,qi,Vi,Oi]}),Ro=10;no.forEach(Ht=>{Vt(15),ai=20,Vs.forEach(_n=>{Yt(ai,ke-2,_n,Ro),ai+=_n}),ai=20,Ht.forEach((_n,Ui)=>{pt(_n,ai+2,ke+4,{fontSize:9}),ai+=Vs[Ui]}),ke+=Ro}),ke+=15,Vt(80),st.setFont("helvetica","normal"),st.setFontSize(12),st.setTextColor("#000000");const ns=xt.reduce((Ht,_n)=>Ht+_n.powerLimit,0),dr=xt.reduce((Ht,_n)=>Ht+_n.powerLimit*.9,0),$n=ns>0?((ns-dr)/ns*100).toFixed(1):"0",ks=`The power-saving analysis shows that all appliances in ${Re} operated under their respective power limits, but further optimization is still possible. The analysis covers ${Pe} devices with a total current power limit of ${ns.toFixed(3)} Wh. By implementing the recommended power limits totaling ${dr.toFixed(3)} Wh, potential savings of approximately ${$n}% could be achieved through optimized operating schedules and reduced standby consumption. This optimization strategy focuses on maintaining functionality while reducing energy waste, particularly during off-hours and low-usage periods.`,Dr=St-40;st.splitTextToSize(ks,Dr).forEach(Ht=>{Vt(15),st.text(Ht,20,ke),ke+=6}),ke+=20,Vt(40),Lt(20,ke,St-20,ke),ke+=10,pt("This report was generated automatically by the Energy Management System",20,ke,{fontSize:9,color:"#666666"}),ke+=5,qe!=="All Departments"?pt(`${qe} - Camarines Norte State College`,20,ke,{fontSize:9,color:"#666666"}):pt("Camarines Norte State College",20,ke,{fontSize:9,color:"#666666"}),ke+=5,pt("For questions or concerns, please contact the system administrator.",20,ke,{fontSize:9,color:"#666666"});const Qo=new Date().toISOString().split("T")[0],zn=Re==="All Offices"?"All_Offices":Re.replace(/\s+/g,"_"),hr=["of","and","the","in","for","a","an","to"],so=`CNSC_${qe==="All Departments"?"All_Departments":qe.split(" ").filter(Ht=>!hr.includes(Ht.toLowerCase())).map(Ht=>Ht.charAt(0).toUpperCase()).join("")}_Power_Report_${zn}_${Qo}.pdf`;st.save(so),pe(!1)}catch(ve){console.error("Error generating PDF report:",ve),alert("Error generating PDF report. Please try again.")}},[C,A]=me.useState(!1),[I,ee]=me.useState(!1),[G,K]=me.useState("Week"),[de,le]=me.useState("All Departments"),[z,R]=me.useState("All Offices"),[D,F]=me.useState(""),[E,O]=me.useState([]),[M,Y]=me.useState([]),[ie,q]=me.useState({}),[re,V]=me.useState([]),[se,W]=me.useState(["All Departments"]);me.useEffect(()=>{console.log("Departments state updated:",se),console.log("Available departments for dropdown:",se)},[se]);const[te,j]=me.useState(0),[U,$]=me.useState(0),[X,Q]=me.useState(0),[ye,Ae]=me.useState(0),[De,Be]=me.useState(0),[Fe,Ct]=me.useState(9.3885),[,at]=me.useState(0),[Ce,ce]=me.useState(0),[_t,Ne]=me.useState({labels:[],energyUsage:[]}),[Ve,We]=me.useState(!1),[tt,lt]=me.useState(!1),[$e,pe]=me.useState(!1),[be,Se]=me.useState(!1),[Ee,Ye]=me.useState(!1),[qe,Ue]=me.useState(""),[Xe,bt]=me.useState(""),[qt,fe]=me.useState(""),[Ze,Je]=me.useState(""),[mt,Tt]=me.useState(""),[It,gt]=me.useState(null),[tn,Zt]=me.useState(!1),[Dt,Ut]=me.useState({enabled:!1,selectedOutlets:[],combinedLimit:0}),Qt=me.useRef(null),an=async()=>{const Te=new Date,Qe=Te.getFullYear(),dt=Te.getMonth()+1,ve=Le=>{const Re=Le.getFullYear(),Pe=String(Le.getMonth()+1).padStart(2,"0"),At=String(Le.getDate()).padStart(2,"0");return`day_${Re}_${Pe}_${At}`},He=async Le=>{try{const Re=Me(je,"devices"),Pe=await Pt(Re);if(Pe.exists()){const At=Pe.val(),rt=[];return console.log(`Fetching data for date: ${Le}`),console.log("Available devices:",Object.keys(At)),M.forEach(Nt=>{const xt=At[Nt.outletId];if(xt&&xt.daily_logs&&xt.daily_logs[Le]){const st=xt.daily_logs[Le];console.log(`Found data for ${Nt.outletId} on ${Le}:`,st),rt.push(st.total_energy||0)}else console.log(`No data found for ${Nt.outletId} on ${Le}`),rt.push(0)}),console.log(`Device data for ${Le}:`,rt),rt}else console.log("No devices data found in database")}catch(Re){console.error("Error fetching device data for date:",Le,Re)}return M.map(()=>0)};switch(G){case"Week":const Le=[],Re=[];console.log("Generating week data...");for(let St=6;St>=0;St--){const yt=new Date(Te.getTime()-St*24*60*60*1e3),ke=yt.toLocaleDateString("en-US",{month:"short",day:"numeric"}),pt=ve(yt);Le.push(ke);const Lt=await He(pt);Re.push(Lt)}return console.log("Week data generated:",{labels:Le,energyUsage:Re}),{labels:Le,energyUsage:Re};case"Month":const Pe=[],At=[];console.log("Generating month data...");for(let St=29;St>=0;St--){const yt=new Date(Te.getTime()-St*24*60*60*1e3),ke=yt.toLocaleDateString("en-US",{month:"short",day:"numeric"}),pt=ve(yt);Pe.push(ke);const Lt=await He(pt);At.push(Lt)}return console.log("Month data generated:",{labels:Pe,energyUsage:At}),{labels:Pe,energyUsage:At};case"Year":const rt=[],Nt=[];console.log("Generating year data...");for(let St=11;St>=0;St--){const yt=new Date(Qe,dt-1-St,1),ke=yt.toLocaleDateString("en-US",{month:"long"});rt.push(ke);const pt=new Date(yt.getFullYear(),yt.getMonth(),1),Lt=new Date(yt.getFullYear(),yt.getMonth()+1,0),Yt=[];for(let Vt=0;Vt<Lt.getDate();Vt++){const nn=new Date(pt.getTime()+Vt*24*60*60*1e3),yn=ve(nn),en=await He(yn);Vt===0?en.forEach((wn,In)=>{Yt[In]=wn}):en.forEach((wn,In)=>{Yt[In]+=wn})}Nt.push(Yt)}return console.log("Year data generated:",{labels:rt,energyUsage:Nt}),{labels:rt,energyUsage:Nt};default:const xt=[],st=[];console.log("Generating default week data...");for(let St=6;St>=0;St--){const yt=new Date(Te.getTime()-St*24*60*60*1e3),ke=yt.toLocaleDateString("en-US",{month:"short",day:"numeric"}),pt=ve(yt);xt.push(ke);const Lt=await He(pt);st.push(Lt)}return console.log("Default week data generated:",{labels:xt,energyUsage:st}),{labels:xt,energyUsage:st}}},on=M.length===1;me.useEffect(()=>{(async()=>{if(M.length>0){console.log("Updating chart data for timeSegment:",G,"filteredDevices:",M.length);try{const Qe=await an();console.log("Chart data loaded:",Qe),Ne(Qe)}catch(Qe){console.error("Error loading chart data:",Qe),Ne({labels:[],energyUsage:[]})}}else Ne({labels:[],energyUsage:[]})})()},[G,M]),me.useEffect(()=>{const Te=Me(je,"rates/canoreco"),Qe=Go(Te,dt=>{const ve=dt.val();if(!ve)return;const He=Number(ve.rate??ve.value);!Number.isNaN(He)&&He>0&&Ct(He)});return()=>lr(Te,"value",Qe)},[]),me.useEffect(()=>{const Te=Me(je,"devices"),Qe=Go(Te,dt=>{const ve=dt.val();if(ve){const He=[],Le=n();Object.keys(ve).forEach(Re=>{const Pe=ve[Re];if(Pe.sensor_data){const At={"computer-lab-1":"Computer Laboratory 1","computer-lab-2":"Computer Laboratory 2","computer-lab-3":"Computer Laboratory 3","deans-office":"Dean's Office","faculty-office":"Faculty Office"},rt=Pe.office_info?.office||"",Nt=rt?At[rt]||rt:"—",xt=Pe.daily_logs?.[Le],st=Pe.lifetime_energy||0,St={outletId:Re,status:Pe.relay_control?.status||"OFF",power:Pe.sensor_data.power||0,energy:Pe.sensor_data.energy||0,current:Pe.sensor_data.current||0,voltage:Pe.sensor_data.voltage||0,power_factor:Pe.sensor_data.power_factor||0,timestamp:Pe.sensor_data.timestamp||"",avg_power:xt?.avg_power||0,peak_power:xt?.peak_power||0,total_energy:xt?.total_energy||0,lifetime_energy:st,officeRoom:Nt,appliances:Pe.office_info?.appliance||"Unassigned",office_info:Pe.office_info,relay_control:Pe.relay_control};He.push(St)}}),O(He),console.log("Reports data fetched:",{todayDateKey:Le,devicesCount:He.length,devices:He.map(Re=>({outletId:Re.outletId,total_energy:Re.total_energy,lifetime_energy:Re.lifetime_energy,peak_power:Re.peak_power,officeRoom:Re.officeRoom,office_info:Re.office_info}))})}});return()=>lr(Te,"value",Qe)},[]),me.useEffect(()=>{(async()=>{try{console.log("Fetching offices data from database...");const Qe=Me(je,"offices"),dt=await Pt(Qe);if(console.log("Database snapshot exists:",dt.exists()),console.log("Database snapshot value:",dt.val()),dt.exists()){const ve=dt.val();q(ve);const He=new Set,Le=new Set;console.log("Processing offices data:",Object.keys(ve)),Object.values(ve).forEach(At=>{console.log("Processing office entry:",{department:At.department,office:At.office,fullEntry:At}),At.department&&He.add(At.department),At.office&&Le.add(At.office)});const Re=Array.from(He);console.log("Fetched departments from database:",Re),console.log("Setting departments to:",["All Departments",...Re]),W(["All Departments",...Re]);const Pe=Array.from(Le);console.log("Fetched offices from database:",Pe),V(Pe)}else console.log("No offices data found in database"),W(["All Departments"])}catch(Qe){console.error("Error fetching offices data:",Qe),W(["All Departments"])}})()},[]);const dn=()=>{if(de==="All Departments")return["All Offices",...re];const Te=["All Offices"];return Object.values(ie).forEach(Qe=>{Qe.department===de&&Qe.office&&Te.push(Qe.office)}),Te},Sn=Te=>{if(console.log("PDF Office Filtering:",{pdfDepartment:Te,officesData:Object.values(ie),allOffices:re}),Te==="All Departments")return["All Offices",...re];const Qe=["All Offices"];return Object.values(ie).forEach(dt=>{console.log("Checking office data:",{officeData:dt,pdfDepartment:Te,departmentMatch:dt.department&&dt.department.toLowerCase()===Te.toLowerCase()}),dt.department&&dt.office&&dt.department.toLowerCase()===Te.toLowerCase()&&Qe.push(dt.office)}),console.log("Filtered offices for PDF:",Qe),Qe};return me.useEffect(()=>{R("All Offices")},[de]),me.useEffect(()=>{let Te=E;de!=="All Departments"&&(z!=="All Offices"?Te=E.filter(Qe=>{if(Qe.office_info&&Qe.office_info.department&&Qe.office_info.office)return console.log("Device filtering check (office_info):",{deviceOfficeRoom:Qe.officeRoom,deviceOfficeInfo:Qe.office_info,selectedOffice:z,selectedDepartment:de,officeMatch:Qe.office_info.office===z,departmentMatch:Qe.office_info.department===de}),Qe.office_info.department.toLowerCase()===de.toLowerCase()&&Qe.office_info.office.toLowerCase()===z.toLowerCase();if(ie&&Qe.officeRoom){const dt=Object.values(ie).find(ve=>ve.office===Qe.officeRoom);return console.log("Device filtering check (fallback):",{deviceOfficeRoom:Qe.officeRoom,selectedOffice:z,selectedDepartment:de,deviceOfficeData:dt,officeMatch:dt&&dt.office===z,departmentMatch:dt&&dt.department===de}),dt&&dt.office.toLowerCase()===z.toLowerCase()&&dt.department.toLowerCase()===de.toLowerCase()}return!1}):Te=E.filter(Qe=>{if(Qe.office_info&&Qe.office_info.department)return Qe.office_info.department.toLowerCase()===de.toLowerCase();if(ie&&Qe.officeRoom){const dt=Object.values(ie).find(ve=>ve.office===Qe.officeRoom);return dt&&dt.department.toLowerCase()===de.toLowerCase()}return!1})),Y(Te),console.log("Device filtering result:",{totalDevices:E.length,filteredDevices:Te.length,department:de,office:z,allDevicesOfficeInfo:E.map(Qe=>({outletId:Qe.outletId,officeRoom:Qe.officeRoom,office_info:Qe.office_info})),filteredDevicesList:Te.map(Qe=>({outletId:Qe.outletId,officeRoom:Qe.officeRoom,office_info:Qe.office_info}))})},[de,z,E,ie]),me.useEffect(()=>{if(M.length>0){const Te=M.reduce((Qe,dt)=>Qe+(dt.lifetime_energy||0),0);Q(Te)}else Q(0)},[M]),me.useEffect(()=>{M.length>0},[M,G]),me.useEffect(()=>{(async()=>{if(M.length>0)try{const Qe=new Date,dt=Qe.getFullYear(),ve=Qe.getMonth()+1,He=new Date(dt,ve,0).getDate();let Le=0;for(const Pe of M)try{const At=Me(je,`devices/${Pe.outletId}`),rt=await Pt(At);if(rt.exists()){const Nt=rt.val();if(Nt&&Nt.daily_logs){let xt=0;for(let st=1;st<=He;st++){const St=`day_${dt}_${String(ve).padStart(2,"0")}_${String(st).padStart(2,"0")}`,yt=Nt.daily_logs[St];yt&&(xt+=yt.total_energy||0)}Le+=xt}}}catch(At){console.error(`Error calculating monthly data for ${Pe.outletId}:`,At)}let Re=0;for(const Pe of M)try{const At=Me(je,`devices/${Pe.outletId}`),rt=await Pt(At);if(rt.exists()){const Nt=rt.val();if(Nt&&Nt.daily_logs){let xt=0;Object.keys(Nt.daily_logs).forEach(st=>{const St=Nt.daily_logs[st];St&&St.total_energy&&(xt+=St.total_energy)}),Re+=xt}}}catch(At){console.error(`Error calculating total energy for ${Pe.outletId}:`,At)}Be(te),Ae(U),j(Le),$(Re)}catch(Qe){console.error("Error calculating monthly stats:",Qe),j(0),$(0)}else j(0),$(0)})()},[M]),me.useEffect(()=>{(async()=>{if(M.length>0){const Qe=await t(M),dt=await i(M);at(Qe),ce(dt)}else at(0),ce(0)})()},[M,Fe]),me.useEffect(()=>{const Te=dt=>{Qt.current&&(Qt.current.contains(dt.target)||A(!1))},Qe=dt=>{dt.key==="Escape"&&A(!1)};return document.addEventListener("mousedown",Te),document.addEventListener("keydown",Qe),()=>{document.removeEventListener("mousedown",Te),document.removeEventListener("keydown",Qe)}},[]),me.useEffect(()=>{(async()=>{try{const Qe=Me(je,"combined_limit_settings"),dt=await Pt(Qe);if(dt.exists()){const ve=dt.val();Ut({enabled:ve.enabled||!1,selectedOutlets:ve.selected_outlets||[],combinedLimit:ve.combined_limit_watts!==void 0?ve.combined_limit_watts:0})}else Ut({enabled:!1,selectedOutlets:[],combinedLimit:0})}catch(Qe){console.error("Reports: Error fetching combined limit info:",Qe)}})()},[]),me.useEffect(()=>{const Te=async()=>{try{const Re=Me(je,"devices"),Pe=await Pt(Re);if(Pe.exists()){const At=Pe.val(),rt=new Date,Nt=rt.getHours()*60+rt.getMinutes(),xt=rt.getDay();console.log(`Reports: Real-time scheduler check at ${rt.toLocaleTimeString()}:`,{currentTime:`${Math.floor(Nt/60)}:${String(Nt%60).padStart(2,"0")}`,currentDay:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][xt]});for(const[st,St]of Object.entries(At)){const yt=St;if(console.log(`Reports: Checking device ${st}:`,{hasSchedule:!!(yt.schedule&&(yt.schedule.timeRange||yt.schedule.startTime)),enablePowerScheduling:yt.office_info?.enable_power_scheduling,schedule:yt.schedule}),yt.schedule&&(yt.schedule.timeRange||yt.schedule.startTime)){const ke=yt.control?.device||"off";if((yt.relay_control?.main_status||"ON")==="ON"){console.log(`Reports: Device ${st} has main_status = 'ON' - respecting bypass mode, skipping schedule check`);continue}const Lt=st.replace("_"," "),Yt=Dt?.enabled&&Dt?.selectedOutlets?.includes(Lt),Vt=f(yt.schedule,"on",yt,Yt);let nn=Vt?"on":"off";if(!Yt&&nn==="on"){const yn=yt.relay_control?.auto_cutoff?.power_limit||0;if(yn>0){const en=new Date,wn=`day_${en.getFullYear()}_${String(en.getMonth()+1).padStart(2,"0")}_${String(en.getDate()).padStart(2,"0")}`,Tn=yt?.daily_logs?.[wn]?.total_energy||0;Tn>=yn&&(nn="off",console.log(`🔒 Reports: AUTOMATIC UPDATE - Forcing ${st} OFF due to individual daily limit exceeded (${(Tn*1e3).toFixed(3)}Wh >= ${yn*1e3}Wh)`))}}console.log(`Reports: Schedule check for ${st}:`,{currentControlState:ke,shouldBeActive:Vt,newControlState:nn,needsUpdate:ke!==nn,isInCombinedGroup:Yt}),ke!==nn?(console.log(`Reports: Real-time update: ${st} control state from ${ke} to ${nn}`),await Kt(Me(je,`devices/${st}/control`),{device:nn})):console.log(`Reports: No update needed for ${st} - control state already ${ke}`)}}}}catch(Re){console.error("Reports: Error in real-time scheduler:",Re)}},Qe=async()=>{try{const Re=Me(je,"devices"),Pe=await Pt(Re);if(Pe.exists()){const At=Pe.val();console.log(`Reports: Power limit monitor running at ${new Date().toLocaleTimeString()}`);for(const[rt,Nt]of Object.entries(At)){const xt=Nt,st=xt.control?.device||"off",St=xt.relay_control?.main_status||"ON";if(st==="off")continue;if(St==="ON"){console.log(`Reports: Device ${rt} main_status is ON - respecting bypass mode, skipping automatic power limit enforcement`);continue}const yt=rt.replace("_"," "),ke=Dt?.enabled&&Dt?.selectedOutlets?.includes(yt);if(ke){if(console.log(`Reports: Device ${rt} is in combined group - checking combined group power limits`),Dt?.enabled&&Dt?.selectedOutlets?.length>0){const pt=v4(At,Dt.selectedOutlets),Lt=Dt.combinedLimit/1e3;console.log(`Reports: Combined group limit check for ${rt}:`,{totalMonthlyEnergy:`${(pt*1e3).toFixed(0)}W`,combinedLimit:`${Dt.combinedLimit}W`,exceedsLimit:pt>=Lt}),pt>=Lt&&(console.log(`Reports: Combined monthly limit exceeded - turning off ${rt}`),await Kt(Me(je,`devices/${rt}/control`),{device:"off"}),await Kt(Me(je,`devices/${rt}/relay_control`),{main_status:"OFF"}),console.log(`Reports: Device ${rt} turned OFF due to combined monthly limit exceeded`))}}else{console.log(`Reports: Device ${rt} main status is ${St} - checking individual power limits`);const pt=xt.relay_control?.auto_cutoff?.power_limit||0;if(pt>0){const Lt=new Date,Yt=`day_${Lt.getFullYear()}_${String(Lt.getMonth()+1).padStart(2,"0")}_${String(Lt.getDate()).padStart(2,"0")}`,nn=xt?.daily_logs?.[Yt]?.total_energy||0;console.log(`Reports: Power limit check for ${rt}:`,{powerLimit:`${pt*1e3}Wh`,todayTotalEnergy:`${nn*1e3}Wh`,todayDateKey:Yt,exceedsLimit:nn>=pt,currentControlState:st,isInCombinedGroup:ke}),nn>=pt&&(console.log(`Reports: POWER LIMIT EXCEEDED - Turning OFF ${rt} (${(nn*1e3).toFixed(3)}Wh >= ${pt*1e3}Wh)`),await Kt(Me(je,`devices/${rt}/control`),{device:"off"}),await Kt(Me(je,`devices/${rt}/relay_control`),{main_status:"OFF"}),console.log(`Reports: Device ${rt} turned OFF due to power limit exceeded`))}}}}}catch(Re){console.error("Reports: Error in power limit monitor:",Re)}},dt=async()=>{try{if(!Dt?.enabled||Dt?.selectedOutlets?.length===0)return;const Re=Me(je,"devices"),Pe=await Pt(Re);if(Pe.exists()){const At=Pe.val(),rt=v4(At,Dt.selectedOutlets),Nt=Dt.combinedLimit,xt=Nt/1e3;if(console.log(`Reports: Monthly limit check - Total: ${(rt*1e3).toFixed(0)}W / Limit: ${Nt}W`),rt>=xt){console.log("Reports: Monthly limit exceeded! Turning off all devices in combined group.");for(const st of Dt.selectedOutlets){const St=st.replace(" ","_");try{const yt=Me(je,`devices/${St}/control`);await Kt(yt,{device:"off"});const ke=Me(je,`devices/${St}/relay_control`);await Kt(ke,{main_status:"OFF"}),console.log(`✅ TURNED OFF: ${st} (${St}) due to monthly limit`)}catch(yt){console.error(`❌ FAILED to turn off ${st}:`,yt)}}}}}catch(Re){console.error("Reports: Error in monthly limit check:",Re)}};Te(),Qe(),dt(),window.testReportsSchedule=Te,window.testReportsPowerLimits=Qe,window.checkReportsCurrentTime=()=>{const Re=new Date,Pe=Re.getHours()*60+Re.getMinutes(),At=Re.getDay();console.log("Reports current time debug:",{time:Re.toLocaleTimeString(),minutes:Pe,day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][At],date:Re.toLocaleDateString()})};const ve=setInterval(Te,1e4),He=setInterval(Qe,3e4),Le=setInterval(dt,6e4);return()=>{clearInterval(ve),clearInterval(He),clearInterval(Le)}},[]),u.jsxs("div",{className:"reports-container",children:[u.jsxs("section",{className:"reports-hero",children:[u.jsxs("div",{className:"hero-left",children:[u.jsx("div",{className:"hero-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"#dbe7ff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("polyline",{points:"14,2 14,8 20,8",stroke:"#dbe7ff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13",stroke:"#dbe7ff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17",stroke:"#dbe7ff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("polyline",{points:"10,9 9,9 8,9",stroke:"#dbe7ff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsxs("div",{className:"hero-text",children:[u.jsx("h1",{children:"Power Consumption Report"}),u.jsx("p",{children:"Comprehensive analysis of energy usage patterns"})]})]}),u.jsxs("div",{className:"hero-actions",children:[u.jsxs("button",{className:"print-report-btn",type:"button",onClick:()=>p(),title:"Generate PDF Report",children:[u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M6 9V2h12v7M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2M6 14h12v8H6v-8z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Print Report"]}),u.jsxs("div",{className:"dropdowns-container",ref:Qt,children:[u.jsxs("div",{className:"dropdown",children:[u.jsxs("button",{className:"hero-pill",type:"button",onClick:()=>A(Te=>!Te),"aria-haspopup":"listbox","aria-expanded":C,"aria-controls":"dept-menu",children:[u.jsx("span",{children:de}),u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",style:{transform:C?"rotate(180deg)":"rotate(0deg)",transition:"transform .2s ease"},children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})]}),C&&u.jsx("ul",{id:"dept-menu",role:"listbox",className:"dropdown-menu",children:se.map(Te=>u.jsx("li",{children:u.jsx("button",{role:"option","aria-selected":de===Te,className:`menu-item ${de===Te?"selected":""}`,onClick:()=>{le(Te),A(!1)},children:Te})},Te))})]}),de!=="All Departments"&&u.jsxs("div",{className:"dropdown",children:[u.jsxs("button",{className:"hero-pill",type:"button",onClick:()=>ee(Te=>!Te),"aria-haspopup":"listbox","aria-expanded":I,"aria-controls":"office-menu",children:[u.jsx("span",{children:z}),u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",style:{transform:I?"rotate(180deg)":"rotate(0deg)",transition:"transform .2s ease"},children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})]}),I&&u.jsx("ul",{id:"office-menu",role:"listbox",className:"dropdown-menu",children:dn().map(Te=>u.jsx("li",{children:u.jsx("button",{role:"option","aria-selected":z===Te,className:`menu-item ${z===Te?"selected":""}`,onClick:()=>{R(Te),ee(!1)},children:Te})},Te))})]})]})]})]}),u.jsxs("section",{className:"metrics-overview",children:[de!=="All Departments"&&u.jsxs("div",{className:"panel-subtitle",children:["Showing data for ",de,z!=="All Offices"?` - ${z}`:""," (",M.length," devices)"]}),u.jsxs("div",{className:"metrics-grid",children:[u.jsxs("article",{className:"metric-card metric-blue",children:[u.jsx("div",{className:"metric-icon",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M13 3L4 14h6l-1 7 9-11h-6l1-7z",fill:"#ffffff"})})}),u.jsxs("div",{className:"metric-content",children:[u.jsx("div",{className:"metric-title",children:"Total Consumption"}),u.jsxs("div",{className:"metric-value",children:[e(U*1e3)," Wh"]}),u.jsxs("div",{className:"metric-trend positive",children:["Live data from database",o(U,ye)]})]})]}),u.jsxs("article",{className:"metric-card metric-blue",children:[u.jsx("div",{className:"metric-icon",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2",fill:"#ffffff"}),u.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6",stroke:"#ffffff",strokeWidth:"2"}),u.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6",stroke:"#ffffff",strokeWidth:"2"}),u.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10",stroke:"#ffffff",strokeWidth:"2"})]})}),u.jsxs("div",{className:"metric-content",children:[u.jsx("div",{className:"metric-title",children:"Current Power Usage This Month"}),u.jsxs("div",{className:"metric-value",children:[e(te*1e3)," Wh"]}),u.jsxs("div",{className:"metric-trend positive",children:["Monthly power consumption",o(te,De)]})]})]}),u.jsxs("article",{className:"metric-card metric-green",children:[u.jsx("div",{className:"metric-icon",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("polyline",{points:"14,2 14,8 20,8",stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13",stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17",stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9",stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsxs("div",{className:"metric-content",children:[u.jsx("div",{className:"metric-title",children:"Current Bill"}),u.jsxs("div",{className:"metric-value",children:["PHP ",e(Ce,2)]}),u.jsx("div",{className:"metric-trend positive",children:"Based on current consumption"})]})]})]})]}),u.jsx("section",{className:"reports-content",children:u.jsxs("div",{className:"content-grid",children:[u.jsxs("div",{className:"chart-panel",children:[u.jsxs("div",{className:"chart-header",children:[u.jsxs("h3",{children:[G," Consumption"]}),u.jsx("div",{className:"chart-subtitle",children:l(G)}),u.jsx("div",{className:"chart-controls",children:u.jsxs("div",{className:"time-segments",children:[u.jsx("button",{className:`segment-btn ${G==="Week"?"active":""}`,onClick:()=>K("Week"),children:"Week"}),u.jsx("button",{className:`segment-btn ${G==="Month"?"active":""}`,onClick:()=>K("Month"),children:"Month"}),u.jsx("button",{className:`segment-btn ${G==="Year"?"active":""}`,onClick:()=>K("Year"),children:"Year"})]})})]}),u.jsx("div",{className:"chart-area",onClick:()=>We(!0),style:{cursor:"pointer"},children:_t.energyUsage.length>0&&_t.labels.length>0?on?u.jsx(nu,{data:{labels:_t.labels,datasets:[{label:"Energy Usage (Wh)",data:_t.energyUsage.map(Te=>(Te[0]||0)*1e3),backgroundColor:"#2563eb",borderColor:"#2563eb",borderWidth:2,borderRadius:0,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{top:0,bottom:0,left:5,right:5}},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#eab308",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(Te){const Qe=Te.parsed.y;return`Energy Usage: ${e(Qe)} Wh`}}}},scales:{y:{beginAtZero:!0,grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:12},padding:2,maxTicksLimit:6},border:{display:!1},title:{display:!0,text:"Energy (Wh)",color:"#374151",font:{size:14,weight:"bold"},padding:{top:2,bottom:2}}},x:{grid:{display:!1},ticks:{color:"#6b7280",font:{size:14,weight:"bold"},padding:5},border:{display:!1},title:{display:!0,text:"Date",color:"#374151",font:{size:14,weight:"bold"},padding:{top:2,bottom:2}}}}}}):u.jsx(nu,{data:{labels:_t.labels,datasets:M.map((Te,Qe)=>{const dt=["#2563eb","#059669","#dc2626","#7c3aed","#ea580c","#0891b2","#be123c","#65a30d"],ve=dt[Qe%dt.length];return{label:`Outlet ${Te.outletId.split("_")[1]} - Energy (Wh)`,data:_t.energyUsage.map(He=>(He[Qe]||0)*1e3),backgroundColor:ve,borderColor:ve,borderWidth:2,borderRadius:0,borderSkipped:!1}})},options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{top:0,bottom:0,left:2,right:2}},plugins:{legend:{display:!0,position:"top",labels:{usePointStyle:!0,padding:5,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#eab308",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(Te){const Qe=Te.parsed.y;return`${Te.dataset.label||""}: ${e(Qe)} Wh`}}}},scales:{y:{beginAtZero:!0,grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:10},padding:2,maxTicksLimit:5},border:{display:!1},title:{display:!0,text:"Energy (Wh)",color:"#374151",font:{size:12,weight:"bold"},padding:{top:2,bottom:2}}},x:{grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:10},padding:2},border:{display:!1},title:{display:!0,text:"Date",color:"#374151",font:{size:12,weight:"bold"},padding:{top:2,bottom:2}}}}}}):u.jsxs("div",{className:"chart-no-data",children:[u.jsx("div",{className:"chart-no-data-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#6b7280",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z",stroke:"#6b7280",strokeWidth:"2"})]})}),u.jsxs("p",{children:["No data available for ",G.toLowerCase()," period"]}),u.jsx("p",{className:"chart-no-data-subtitle",children:"Try selecting a different time period or check if devices have recent data"})]})})]}),u.jsxs("div",{className:"device-panel",children:[u.jsx("h3",{className:"device-title",children:"Usage per device"}),u.jsx("div",{className:"search-container",children:u.jsxs("div",{className:"search-input-wrapper",children:[u.jsx("input",{type:"text",placeholder:"Search device (e.g., Outlet 1, Outlet 2)",value:D,onChange:Te=>F(Te.target.value),className:"device-search"}),D&&u.jsx("button",{type:"button",onClick:d,className:"search-clear-btn","aria-label":"Clear search",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})}),u.jsx("div",{className:"device-list-container",children:u.jsxs("div",{className:"device-list",children:[c(M,D).map((Te,Qe)=>{const dt=Te.lifetime_energy||0,ve=`${e(dt*1e3)} Wh`,He=dt,Le=X>0?He/X*100:0;return u.jsxs("div",{className:"device-item",children:[u.jsxs("div",{className:"device-info",children:[u.jsxs("span",{className:"device-name",children:["Outlet ",Te.outletId.split("_")[1]]}),u.jsxs("span",{className:"device-usage",children:[ve," (",e(Le,1),"%)"]})]}),u.jsx("div",{className:"device-progress",children:u.jsx("div",{className:"device-progress-fill",style:{width:`${Le}%`}})})]},Qe)}),M.length>0&&c(M,D).length===0&&u.jsx("div",{className:"no-devices",children:u.jsxs("p",{children:['No devices found matching "',D,'"']})}),M.length===0&&u.jsx("div",{className:"no-devices",children:u.jsxs("p",{children:["No devices found in ",de,z!=="All Offices"?` - ${z}`:""]})})]})})]})]})}),Ve&&u.jsx("div",{className:"chart-modal-overlay",onClick:()=>We(!1),children:u.jsxs("div",{className:"chart-modal-content",onClick:Te=>Te.stopPropagation(),children:[u.jsxs("div",{className:"chart-modal-header",children:[u.jsxs("h3",{children:[G," Consumption - Full View"]}),u.jsx("button",{className:"chart-modal-close",onClick:()=>We(!1),"aria-label":"Close modal",children:u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsx("div",{className:"chart-modal-body",children:_t.energyUsage.length>0&&_t.labels.length>0?on?u.jsx(nu,{data:{labels:_t.labels,datasets:[{label:"Energy Usage (Wh)",data:_t.energyUsage.map(Te=>(Te[0]||0)*1e3),backgroundColor:"#2563eb",borderColor:"#2563eb",borderWidth:2,borderRadius:0,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:30,bottom:30,left:20,right:20}},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#eab308",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(Te){return`Energy Usage: ${Te.parsed.y.toFixed(3)} W`}}}},scales:{y:{beginAtZero:!0,grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:14},padding:8,maxTicksLimit:8},border:{display:!1},title:{display:!0,text:"Energy (Wh)",color:"#374151",font:{size:16,weight:"bold"},padding:{top:2,bottom:2}}},x:{grid:{display:!1},ticks:{color:"#6b7280",font:{size:16,weight:"bold"},padding:10},border:{display:!1},title:{display:!0,text:"Date",color:"#374151",font:{size:16,weight:"bold"},padding:{top:2,bottom:2}}}}}}):u.jsx(nu,{data:{labels:_t.labels,datasets:M.map((Te,Qe)=>{const dt=["#2563eb","#059669","#dc2626","#7c3aed","#ea580c","#0891b2","#be123c","#65a30d"],ve=dt[Qe%dt.length];return{label:`Outlet ${Te.outletId.split("_")[1]} - Energy (Wh)`,data:_t.energyUsage.map(He=>(He[Qe]||0)*1e3),backgroundColor:ve,borderColor:ve,borderWidth:2,borderRadius:0,borderSkipped:!1}})},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:20,bottom:20,left:10,right:10}},plugins:{legend:{display:!0,position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#eab308",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(Te){const Qe=Te.parsed.y;return`${Te.dataset.label||""}: ${e(Qe)} Wh`}}}},scales:{y:{beginAtZero:!0,grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:12},padding:5,maxTicksLimit:6},border:{display:!1},title:{display:!0,text:"Energy (Wh)",color:"#374151",font:{size:14,weight:"bold"},padding:{top:2,bottom:2}}},x:{grid:{color:"#f3f4f6"},ticks:{color:"#6b7280",font:{size:12},padding:5},border:{display:!1},title:{display:!0,text:"Date",color:"#374151",font:{size:14,weight:"bold"},padding:{top:2,bottom:2}}}}}}):u.jsxs("div",{className:"chart-no-data",children:[u.jsx("div",{className:"chart-no-data-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#6b7280",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z",stroke:"#6b7280",strokeWidth:"2"})]})}),u.jsxs("p",{children:["No data available for ",G.toLowerCase()," period"]}),u.jsx("p",{className:"chart-no-data-subtitle",children:"Try selecting a different time period or check if devices have recent data"})]})})]})}),tt&&u.jsx("div",{className:"chart-modal-overlay",onClick:()=>lt(!1),children:u.jsxs("div",{className:"chart-modal-content office-selection-modal",onClick:Te=>Te.stopPropagation(),children:[u.jsxs("div",{className:"chart-modal-header",children:[u.jsx("h3",{children:"Select Department for PDF Report"}),u.jsx("button",{className:"chart-modal-close",onClick:()=>lt(!1),"aria-label":"Close modal",children:u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsx("div",{className:"chart-modal-body",children:u.jsxs("div",{className:"office-selection-grid",children:[u.jsx("button",{className:"office-option",onClick:()=>{Ue("All Departments"),lt(!1),Se(!0)},children:u.jsxs("div",{className:"office-option-content",children:[u.jsx("h4",{children:"All Departments"}),u.jsx("p",{children:"Generate report for all devices across all departments"}),u.jsx("div",{className:"office-stats",children:u.jsxs("span",{children:[E.length," devices"]})})]})}),se.filter(Te=>Te!=="All Departments").map(Te=>{const Qe=E.filter(dt=>dt.office_info&&dt.office_info.department?dt.office_info.department.toLowerCase()===Te.toLowerCase():!1);return u.jsx("button",{className:"office-option",onClick:()=>{Ue(Te),lt(!1),pe(!0)},children:u.jsxs("div",{className:"office-option-content",children:[u.jsx("h4",{children:Te}),u.jsx("p",{children:"Generate report for devices in this department"}),u.jsx("div",{className:"office-stats",children:u.jsxs("span",{children:[Qe.length," devices"]})})]})},Te)})]})})]})}),$e&&u.jsx("div",{className:"chart-modal-overlay",onClick:()=>pe(!1),children:u.jsxs("div",{className:"chart-modal-content office-selection-modal",onClick:Te=>Te.stopPropagation(),children:[u.jsxs("div",{className:"chart-modal-header",children:[u.jsxs("h3",{children:["Select Office for ",qe]}),u.jsx("button",{className:"chart-modal-close",onClick:()=>pe(!1),"aria-label":"Close modal",children:u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsx("div",{className:"chart-modal-body",children:u.jsxs("div",{className:"office-selection-grid",children:[u.jsx("button",{className:"office-option",onClick:()=>{bt("All Offices"),fe("All Offices"),pe(!1),Se(!0)},children:u.jsxs("div",{className:"office-option-content",children:[u.jsx("h4",{children:"All Offices"}),u.jsxs("p",{children:["Generate report for all devices in ",qe]}),u.jsx("div",{className:"office-stats",children:u.jsxs("span",{children:[E.filter(Te=>Te.office_info&&Te.office_info.department?Te.office_info.department.toLowerCase()===qe.toLowerCase():!1).length," devices"]})})]})}),Sn(qe).filter(Te=>Te!=="All Offices").map(Te=>{const Qe=E.filter(dt=>dt.office_info&&dt.office_info.department&&dt.office_info.office?dt.office_info.department.toLowerCase()===qe.toLowerCase()&&dt.office_info.office.toLowerCase()===Te.toLowerCase():!1);return u.jsx("button",{className:"office-option",onClick:()=>{bt(Te),fe(Te),pe(!1),Se(!0)},children:u.jsxs("div",{className:"office-option-content",children:[u.jsx("h4",{children:Te}),u.jsx("p",{children:"Generate report for devices in this office"}),u.jsx("div",{className:"office-stats",children:u.jsxs("span",{children:[Qe.length," devices"]})})]})},Te)})]})})]})}),be&&u.jsx("div",{className:"chart-modal-overlay",onClick:()=>Se(!1),children:u.jsxs("div",{className:"chart-modal-content date-range-modal",onClick:Te=>Te.stopPropagation(),children:[u.jsxs("div",{className:"chart-modal-header",children:[u.jsxs("h3",{children:["Select Date Range for ",qe,Xe&&Xe!=="All Offices"?` - ${Xe}`:""]}),u.jsx("button",{className:"chart-modal-close",onClick:()=>Se(!1),"aria-label":"Close modal",children:u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsx("div",{className:"chart-modal-body",children:u.jsxs("div",{className:"date-range-container",children:[u.jsxs("div",{className:"date-input-group",children:[u.jsx("label",{htmlFor:"start-date",children:"Start Date:"}),u.jsx("input",{id:"start-date",type:"date",value:Ze,onChange:Te=>Je(Te.target.value),className:"date-input"})]}),u.jsxs("div",{className:"date-input-group",children:[u.jsx("label",{htmlFor:"end-date",children:"End Date:"}),u.jsx("input",{id:"end-date",type:"date",value:mt,onChange:Te=>Tt(Te.target.value),className:"date-input",min:Ze})]}),u.jsxs("div",{className:"date-range-actions",children:[u.jsx("button",{className:"btn-secondary",onClick:()=>Se(!1),children:"Cancel"}),u.jsx("button",{className:"btn-primary",onClick:()=>_(),disabled:!Ze||!mt||tn,children:tn?"Loading...":"Preview Report"})]})]})})]})}),Ee&&u.jsx("div",{className:"chart-modal-overlay",onClick:()=>Ye(!1),children:u.jsxs("div",{className:"chart-modal-content pdf-preview-modal",onClick:Te=>Te.stopPropagation(),children:[u.jsxs("div",{className:"chart-modal-header",children:[u.jsxs("h3",{children:["PDF Report Preview - ",qe,qt&&qt!=="All Offices"?` - ${qt}`:""]}),u.jsx("button",{className:"chart-modal-close",onClick:()=>Ye(!1),"aria-label":"Close modal",children:u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsx("div",{className:"chart-modal-body",children:u.jsxs("div",{className:"pdf-preview-container",children:[u.jsxs("div",{className:"pdf-preview-content",children:[u.jsxs("div",{className:"pdf-preview-header",children:[u.jsxs("div",{style:{textAlign:"center",marginBottom:"16px"},children:[qe!=="All Departments"&&u.jsx("p",{style:{margin:"4px 0",fontSize:"14px",fontWeight:"500"},children:qe}),u.jsx("p",{style:{margin:"4px 0",fontSize:"14px",fontWeight:"500"},children:"Camarines Norte State College"}),u.jsx("p",{style:{margin:"4px 0",fontSize:"14px",fontWeight:"500"},children:"Daet, Camarines Norte"})]}),u.jsx("h2",{style:{textAlign:"center",marginTop:"16px"},children:"EcoPlug Performance Summary Report"}),u.jsx("div",{className:"pdf-preview-separator"}),u.jsxs("div",{className:"pdf-preview-details",style:{fontSize:"12px",lineHeight:"1.8"},children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Date Range:"})," ",v(Ze)," to ",v(mt)]}),qe!=="All Departments"&&u.jsxs("p",{children:[u.jsx("strong",{children:"Department:"})," ",qe]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Offices:"})," ",qt]}),u.jsxs("p",{children:[u.jsx("strong",{children:"No. of EcoPlug:"})," ",It?.deviceCount||0]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Electricity Rate:"})," PHP ",Fe.toFixed(4)," per kWh"]})]})]}),It?.deviceTableData?.length===0&&u.jsxs("div",{className:"no-data-message",children:[u.jsx("p",{children:"⚠️ No data found for the selected date range. Please check:"}),u.jsxs("ul",{children:[u.jsx("li",{children:"Date range is correct"}),u.jsx("li",{children:"Devices have data for this period"}),u.jsx("li",{children:"Database connection is working"})]})]}),u.jsxs("div",{className:"pdf-preview-table",children:[u.jsx("h3",{children:"I. Outlet Performance Breakdown"}),u.jsxs("div",{className:"table-preview",children:[u.jsxs("div",{className:"table-header",children:[u.jsx("div",{className:"table-cell",children:"Outlet"}),u.jsx("div",{className:"table-cell",children:"Appliance"}),u.jsx("div",{className:"table-cell",children:"Power Limit (Wh)"}),u.jsx("div",{className:"table-cell",children:"Total Power Usage (Wh)"}),u.jsx("div",{className:"table-cell",children:"Total No. of Hours (hrs)"}),u.jsx("div",{className:"table-cell",children:"Monthly Cost (PHP)"}),u.jsx("div",{className:"table-cell",children:"Share of Total (%)"})]}),It?.deviceTableData?.slice(0,5).map((Te,Qe)=>{const dt=It.totalEnergy||0,ve=dt>0?(Te.monthlyEnergy/(dt*1e3)*100).toFixed(3):"0.000";return u.jsxs("div",{className:"table-row",children:[u.jsx("div",{className:"table-cell",children:Te.outletId}),u.jsx("div",{className:"table-cell",children:Te.appliance}),u.jsx("div",{className:"table-cell",children:Te.powerLimit.toFixed(3)}),u.jsx("div",{className:"table-cell",children:Te.monthlyEnergy.toFixed(3)}),u.jsx("div",{className:"table-cell",children:Te.totalHours.toFixed(3)}),u.jsxs("div",{className:"table-cell",children:["PHP ",(Math.floor(Te.monthlyCost*100)/100).toFixed(2)]}),u.jsx("div",{className:"table-cell",children:ve})]},Qe)}),It?.deviceTableData?.length>5&&u.jsx("div",{className:"table-row more-devices",children:u.jsxs("div",{className:"table-cell",style:{gridColumn:"1 / -1"},children:["... and ",It.deviceTableData.length-5," more devices"]})}),It?.deviceTableData?.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"table-row",style:{fontWeight:"bold",background:"#f8fafc"},children:u.jsxs("div",{className:"table-cell",style:{gridColumn:"1 / -1"},children:["Total Usage: ",It.totalEnergy.toFixed(3)," kWh (",It.deviceTableData.reduce((Te,Qe)=>Te+Qe.totalHours,0).toFixed(3)," hours)"]})}),u.jsx("div",{className:"table-row",style:{fontWeight:"bold",background:"#f8fafc"},children:u.jsxs("div",{className:"table-cell",style:{gridColumn:"1 / -1"},children:["Estimated Cost: PHP ",It.estimatedCost.toFixed(2)]})})]})]})]}),u.jsxs("div",{className:"pdf-preview-table",children:[u.jsx("h3",{children:"II. Power Saving Recommendation"}),u.jsxs("div",{className:"table-preview",children:[u.jsxs("div",{className:"table-header",children:[u.jsx("div",{className:"table-cell",children:"Outlet"}),u.jsx("div",{className:"table-cell",children:"Appliance"}),u.jsx("div",{className:"table-cell",children:"Avg. Daily Power Usage (Wh)"}),u.jsx("div",{className:"table-cell",children:"Power Limit"}),u.jsx("div",{className:"table-cell",children:"Total Power Usage (Wh)"}),u.jsx("div",{className:"table-cell",children:"Recommended Power Limit"})]}),It?.deviceTableData?.slice(0,3).map((Te,Qe)=>{const dt=Math.ceil((new Date(mt).getTime()-new Date(Ze).getTime())/864e5),ve=dt>0?(Te.monthlyEnergy/dt).toFixed(3):"0.000",He=Te.monthlyEnergy.toFixed(3);return u.jsxs("div",{className:"table-row",children:[u.jsx("div",{className:"table-cell",children:Te.outletId}),u.jsx("div",{className:"table-cell",children:Te.appliance}),u.jsx("div",{className:"table-cell",children:ve}),u.jsx("div",{className:"table-cell",children:Te.powerLimit.toFixed(3)}),u.jsx("div",{className:"table-cell",children:Te.monthlyEnergy.toFixed(3)}),u.jsx("div",{className:"table-cell",children:He})]},Qe)}),It?.deviceTableData?.length>3&&u.jsx("div",{className:"table-row more-devices",children:u.jsxs("div",{className:"table-cell",style:{gridColumn:"1 / -1"},children:["... and ",It.deviceTableData.length-3," more devices"]})})]})]})]}),u.jsxs("div",{className:"preview-actions",children:[u.jsx("button",{className:"btn-secondary",onClick:()=>{Ye(!1),Se(!0)},children:"Back to Date Selection"}),u.jsx("button",{className:"btn-primary",onClick:()=>b(),children:"Generate PDF"})]})]})})]})})]})}const b4=(n,e)=>{try{const t=new Date,i=t.getFullYear(),s=t.getMonth()+1,o=new Date(i,s,0).getDate();console.log("📊 Monthly energy calculation:",{currentYear:i,currentMonth:s,daysInMonth:o,selectedOutlets:[...new Set(e)],totalOutlets:e.length,uniqueOutlets:[...new Set(e)].length});const l=new Set;let c=0;return e.forEach((d,f)=>{if(l.has(d)){console.log(`⚠️ DUPLICATE SKIPPED: ${d} (already processed)`);return}l.add(d);const p=d.replace(" ","_"),v=n[p];if(console.log(`🔍 Processing outlet ${f+1}/${e.length}: ${d} -> ${p}`),v&&v.daily_logs){let _=0;for(let b=1;b<=o;b++){const T=`day_${i}_${String(s).padStart(2,"0")}_${String(b).padStart(2,"0")}`,C=v.daily_logs[T];C&&C.total_energy&&(_+=C.total_energy)}console.log(`📊 ${d}: ${_.toFixed(3)}kW for month ${s}/${i}`),c+=_}else console.log(`⚠️ ${d}: No data found or no daily_logs`)}),console.log(`📊 TOTAL MONTHLY ENERGY: ${c.toFixed(3)}kW (${(c*1e3).toFixed(3)}W)`),c*1e3}catch(t){return console.error("❌ Error calculating combined monthly energy:",t),0}},IW=({onNavigate:n,currentView:e="users"})=>{const t=(fe,Ze=3)=>fe.toLocaleString("en-US",{minimumFractionDigits:Ze,maximumFractionDigits:Ze}),[i,s]=me.useState(""),[o,l]=me.useState(""),[c,d]=me.useState("all"),[f,p]=me.useState([]),[v,_]=me.useState([]),[b,T]=me.useState([]),[C,A]=me.useState(""),[I,ee]=me.useState("all"),[G,K]=me.useState(!1),[de,le]=me.useState(null),[z,R]=me.useState(null),[D,F]=me.useState("Coordinator"),[E,O]=me.useState(null),[M,Y]=me.useState(!1),[ie,q]=me.useState(e==="userLogs"?"UserLogs":e==="deviceLogs"?"Device Logs":e==="offices"?"Offices":"UserManagement"),[re,V]=me.useState({enabled:!1,selectedOutlets:[],combinedLimit:0}),[se,W]=me.useState([]),[te,j]=me.useState({department:"",office:""}),[U,$]=me.useState({id:"",department:"",office:""}),[X,Q]=me.useState(null),[ye,Ae]=me.useState([]),[De,Be]=me.useState(!1),Fe=me.useRef(null);me.useEffect(()=>{const fe=Me(je,"users"),Ze=Je=>{const mt=Je.val();if(mt){const Tt=Object.entries(mt).map(([It,gt])=>({id:It,name:gt.displayName||((gt.firstName||"")+" "+(gt.lastName||"")).trim()||gt.email||It,email:gt.email||"",role:gt.role||"Coordinator"}));p(Tt)}else p([])};return Go(fe,Ze),()=>lr(fe,"value",Ze)},[]),me.useEffect(()=>{const fe=async()=>{try{const gt=Me(je,"devices"),tn=await Pt(gt);if(tn.exists()){const Zt=tn.val(),Dt=new Date,Ut=Dt.getHours()*60+Dt.getMinutes(),Qt=Dt.getDay();console.log(`UserManagement: Real-time scheduler check at ${Dt.toLocaleTimeString()}:`,{currentTime:`${Math.floor(Ut/60)}:${String(Ut%60).padStart(2,"0")}`,currentDay:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][Qt]});for(const[an,on]of Object.entries(Zt)){const dn=on;if(console.log(`UserManagement: Checking device ${an}:`,{hasSchedule:!!(dn.schedule&&(dn.schedule.timeRange||dn.schedule.startTime)),enablePowerScheduling:dn.office_info?.enable_power_scheduling,schedule:dn.schedule}),dn.schedule&&(dn.schedule.timeRange||dn.schedule.startTime)){const Sn=dn.control?.device||"off";if((dn.relay_control?.main_status||"ON")==="ON"){console.log(`UserManagement: Device ${an} has main_status = 'ON' - respecting bypass mode, skipping schedule check`);continue}const Qe=an.replace("_"," "),dt=re?.enabled&&re?.selectedOutlets?.includes(Qe),ve=Ve(dn.schedule,"on",dn,dt);let He=ve?"on":"off";if(!dt&&He==="on"){const Le=dn.relay_control?.auto_cutoff?.power_limit||0;if(Le>0){const Re=new Date,Pe=`day_${Re.getFullYear()}_${String(Re.getMonth()+1).padStart(2,"0")}_${String(Re.getDate()).padStart(2,"0")}`,rt=dn?.daily_logs?.[Pe]?.total_energy||0;rt>=Le&&(He="off",console.log(`🔒 UserManagement: AUTOMATIC UPDATE - Forcing ${an} OFF due to individual daily limit exceeded (${(rt*1e3).toFixed(3)}W >= ${Le*1e3}W)`))}}console.log(`UserManagement: Schedule check for ${an}:`,{currentControlState:Sn,shouldBeActive:ve,newControlState:He,needsUpdate:Sn!==He,isInCombinedGroup:dt}),Sn!==He?(console.log(`UserManagement: Real-time update: ${an} control state from ${Sn} to ${He}`),await Kt(Me(je,`devices/${an}/control`),{device:He})):console.log(`UserManagement: No update needed for ${an} - control state already ${Sn}`)}}}}catch(gt){console.error("UserManagement: Error in real-time scheduler:",gt)}},Ze=async()=>{try{const gt=Me(je,"devices"),tn=await Pt(gt);if(tn.exists()){const Zt=tn.val();console.log(`UserManagement: Power limit monitor running at ${new Date().toLocaleTimeString()}`);for(const[Dt,Ut]of Object.entries(Zt)){const Qt=Ut,an=Qt.control?.device||"off",on=Qt.relay_control?.main_status||"ON";if(an==="off")continue;if(on==="ON"){console.log(`UserManagement: Device ${Dt} main_status is ON - respecting bypass mode, skipping automatic power limit enforcement`);continue}const dn=Dt.replace("_"," "),Sn=re?.enabled&&re?.selectedOutlets?.includes(dn);if(Sn){if(console.log(`UserManagement: Device ${Dt} is in combined group - checking combined group power limits`),re?.enabled&&re?.selectedOutlets?.length>0){const Te=b4(Zt,re.selectedOutlets),Qe=re.combinedLimit/1e3;console.log(`UserManagement: Combined group limit check for ${Dt}:`,{totalMonthlyEnergy:`${(Te*1e3).toFixed(0)}W`,combinedLimit:`${re.combinedLimit}W`,exceedsLimit:Te>=Qe}),Te>=Qe&&(console.log(`UserManagement: Combined monthly limit exceeded - turning off ${Dt}`),await Kt(Me(je,`devices/${Dt}/control`),{device:"off"}),await Kt(Me(je,`devices/${Dt}/relay_control`),{main_status:"OFF"}),console.log(`UserManagement: Device ${Dt} turned OFF due to combined monthly limit exceeded`))}}else{console.log(`UserManagement: Device ${Dt} main status is ${on} - checking individual power limits`);const Te=Qt.relay_control?.auto_cutoff?.power_limit||0;if(Te>0){const Qe=new Date,dt=`day_${Qe.getFullYear()}_${String(Qe.getMonth()+1).padStart(2,"0")}_${String(Qe.getDate()).padStart(2,"0")}`,He=Qt?.daily_logs?.[dt]?.total_energy||0;console.log(`UserManagement: Power limit check for ${Dt}:`,{powerLimit:`${Te*1e3}W`,todayTotalEnergy:`${He*1e3}W`,todayDateKey:dt,exceedsLimit:He>=Te,currentControlState:an,isInCombinedGroup:Sn}),He>=Te&&(console.log(`UserManagement: POWER LIMIT EXCEEDED - Turning OFF ${Dt} (${(He*1e3).toFixed(3)}W >= ${Te*1e3}W)`),await Kt(Me(je,`devices/${Dt}/control`),{device:"off"}),await Kt(Me(je,`devices/${Dt}/relay_control`),{main_status:"OFF"}),console.log(`UserManagement: Device ${Dt} turned OFF due to power limit exceeded`))}}}}}catch(gt){console.error("UserManagement: Error in power limit monitor:",gt)}},Je=async()=>{try{if(!re?.enabled||re?.selectedOutlets?.length===0)return;const gt=Me(je,"devices"),tn=await Pt(gt);if(tn.exists()){const Zt=tn.val(),Dt=b4(Zt,re.selectedOutlets),Ut=re.combinedLimit,Qt=Ut/1e3;if(console.log(`UserManagement: Monthly limit check - Total: ${(Dt*1e3).toFixed(0)}W / Limit: ${Ut}W`),Dt>=Qt){console.log("UserManagement: Monthly limit exceeded! Turning off all devices in combined group.");for(const an of re.selectedOutlets){const on=an.replace(" ","_");try{const dn=Me(je,`devices/${on}/control`);await Kt(dn,{device:"off"});const Sn=Me(je,`devices/${on}/relay_control`);await Kt(Sn,{main_status:"OFF"}),console.log(`✅ TURNED OFF: ${an} (${on}) due to monthly limit`)}catch(dn){console.error(`❌ FAILED to turn off ${an}:`,dn)}}}}}catch(gt){console.error("UserManagement: Error in monthly limit check:",gt)}};fe(),Ze(),Je(),window.testUserManagementSchedule=fe,window.testUserManagementPowerLimits=Ze,window.checkUserManagementCurrentTime=()=>{const gt=new Date,tn=gt.getHours()*60+gt.getMinutes(),Zt=gt.getDay();console.log("UserManagement current time debug:",{time:gt.toLocaleTimeString(),minutes:tn,day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][Zt],date:gt.toLocaleDateString()})};const mt=setInterval(fe,1e4),Tt=setInterval(Ze,3e4),It=setInterval(Je,6e4);return()=>{clearInterval(mt),clearInterval(Tt),clearInterval(It)}},[]),me.useEffect(()=>{const fe=Me(je,"user_logs"),Ze=Je=>{const mt=Je.val();if(mt){const Tt=Object.entries(mt).map(([It,gt])=>({id:It,user:gt.user||"Unknown",role:gt.userId?Ct(gt.userId):"Unknown",action:gt.action||"Unknown Action",timestamp:gt.timestamp||new Date().toISOString(),status:gt.type==="success"||gt.type==="info"?"Success":"Failed",authProvider:gt.authProvider||"email"}));Tt.sort((It,gt)=>new Date(gt.timestamp).getTime()-new Date(It.timestamp).getTime()),_(Tt)}else _([])};return Go(fe,Ze),()=>lr(fe,"value",Ze)},[f]),me.useEffect(()=>{const fe=Me(je,"device_logs"),Ze=Je=>{const mt=Je.val();if(mt){const Tt=Object.entries(mt).map(([It,gt])=>({id:It,user:gt.user||"Unknown",activity:gt.activity||"Unknown Activity",officeRoom:gt.officeRoom||"Unknown",outletSource:gt.outletSource||"Unknown",applianceConnected:gt.applianceConnected||"Unknown",timestamp:gt.timestamp||new Date().toISOString(),userId:gt.userId,userRole:gt.userRole}));Tt.sort((It,gt)=>new Date(gt.timestamp).getTime()-new Date(It.timestamp).getTime()),T(Tt)}else T([])};return Go(fe,Ze),()=>lr(fe,"value",Ze)},[]);const Ct=fe=>{const Ze=f.find(Je=>Je.id===fe);return Ze?Ze.role:"Unknown"};me.useEffect(()=>{const fe=Ze=>{Fe.current&&!Fe.current.contains(Ze.target)&&Y(!1),Be(!1)};return M&&document.addEventListener("mousedown",fe),()=>{document.removeEventListener("mousedown",fe)}},[M]),me.useEffect(()=>{e==="userLogs"?q("UserLogs"):e==="deviceLogs"?q("Device Logs"):e==="offices"?q("Offices"):e==="users"&&q("UserManagement")},[e]),me.useEffect(()=>{(async()=>{try{const Ze=Me(je,"combined_limit_settings"),Je=await Pt(Ze);if(Je.exists()){const mt=Je.val();V({enabled:mt.enabled||!1,selectedOutlets:mt.selected_outlets||[],combinedLimit:mt.combined_limit_watts||0})}else V({enabled:!1,selectedOutlets:[],combinedLimit:0})}catch(Ze){console.error("UserManagement: Error fetching combined limit info:",Ze)}})()},[]),me.useEffect(()=>{const fe=Me(je,"offices"),Ze=Je=>{const mt=Je.val();if(mt){const Tt=Object.entries(mt).map(([gt,tn])=>({id:gt,department:tn.department||"",office:tn.office||""}));W(Tt);const It=[...new Set(Tt.map(gt=>gt.department))].filter(gt=>gt);Ae(It)}else W([]),Ae([])};return Go(fe,Ze),()=>lr(fe,"value",Ze)},[]);const at=f.filter(fe=>fe.name.toLowerCase().includes(i.toLowerCase())||fe.email.toLowerCase().includes(i.toLowerCase())),ce=((fe,Ze)=>{if(Ze==="all")return fe;const Je=new Date,mt=new Date;return fe.filter(Tt=>{switch(mt.setTime(new Date(Tt.timestamp).getTime()),Ze){case"day":return mt.toDateString()===Je.toDateString();case"week":const It=new Date(Je.getTime()-10080*60*1e3);return mt>=It;case"month":return mt.getMonth()===Je.getMonth()&&mt.getFullYear()===Je.getFullYear();case"year":return mt.getFullYear()===Je.getFullYear();default:return!0}})})(v.filter(fe=>fe.user.toLowerCase().includes(o.toLowerCase())||fe.action.toLowerCase().includes(o.toLowerCase())||fe.role.toLowerCase().includes(o.toLowerCase())),c),Ne=((fe,Ze)=>{if(Ze==="all")return fe;const Je=new Date,mt=new Date;return fe.filter(Tt=>{switch(mt.setTime(new Date(Tt.timestamp).getTime()),Ze){case"day":return mt.toDateString()===Je.toDateString();case"week":const It=new Date(Je.getTime()-10080*60*1e3);return mt>=It;case"month":return mt.getMonth()===Je.getMonth()&&mt.getFullYear()===Je.getFullYear();case"year":return mt.getFullYear()===Je.getFullYear();default:return!0}})})(b.filter(fe=>fe.user.toLowerCase().includes(C.toLowerCase())||fe.activity.toLowerCase().includes(C.toLowerCase())||fe.officeRoom.toLowerCase().includes(C.toLowerCase())||fe.outletSource.toLowerCase().includes(C.toLowerCase())||fe.applianceConnected.toLowerCase().includes(C.toLowerCase())),I),Ve=(fe,Ze,Je,mt)=>{if(!fe||!fe.timeRange&&!fe.startTime)return Ze==="on";const Tt=new Date,It=Tt.getHours()*60+Tt.getMinutes(),gt=Tt.getDay();let tn,Zt;if(fe.startTime&&fe.endTime){const[an,on]=fe.startTime.split(":").map(Number),[dn,Sn]=fe.endTime.split(":").map(Number);tn=an*60+on,Zt=dn*60+Sn}else if(fe.timeRange){const an=fe.timeRange,[on,dn]=an.split(" - "),Sn=Te=>{const[Qe,dt]=Te.split(" ");let[ve,He]=Qe.split(":").map(Number);return ve===12&&(ve=0),dt==="PM"&&(ve+=12),ve*60+He};tn=Sn(on),Zt=Sn(dn)}else return Ze==="on";const Dt=It>=tn&&It<Zt,Ut=fe.frequency||"";let Qt=!1;if(Ut.toLowerCase()==="daily")Qt=!0;else if(Ut.toLowerCase()==="weekdays")Qt=gt>=1&&gt<=5;else if(Ut.toLowerCase()==="weekends")Qt=gt===0||gt===6;else if(Ut.includes(",")){const an={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6};Qt=Ut.split(",").map(dn=>{const Sn=dn.trim().toLowerCase();return an[Sn]}).filter(dn=>dn!==void 0).includes(gt)}else if(Ut){const on={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6}[Ut.toLowerCase()];on!==void 0&&(Qt=on===gt)}if(Je&&!mt){const an=Je.relay_control?.auto_cutoff?.power_limit||0,on=new Date,dn=`day_${on.getFullYear()}_${String(on.getMonth()+1).padStart(2,"0")}_${String(on.getDate()).padStart(2,"0")}`,Te=Je?.daily_logs?.[dn]?.total_energy||0;if(an>0&&Te>=an)return console.log("UserManagement: Schedule check - Device power limit exceeded:",{todayTotalEnergy:`${t(Te*1e3)}W`,powerLimit:`${an*1e3}W`,todayDateKey:dn,scheduleResult:!1,reason:"Today's energy consumption exceeded power limit"}),!1}return Dt&&Qt},We=fe=>{R(fe),F(fe.role||"Coordinator"),le("edit"),K(!0)},tt=fe=>{R(fe),le("delete"),K(!0)},lt=()=>{K(!1),le(null),R(null),Q(null),O(null),j({department:"",office:""}),$({id:"",department:"",office:""}),Be(!1)},$e=fe=>{const Ze=f.find(Je=>Je.id===fe);Ze&&We(Ze)},pe=fe=>{const Ze=f.find(Je=>Je.id===fe);Ze&&tt(Ze)},be=async()=>{if(z){if(z.role===D){O({success:!1,message:"No changes made."}),le("feedback");return}try{await Kt(Me(je,`users/${z.id}`),{role:D}),O({success:!0,message:"Role updated successfully."}),le("feedback")}catch{O({success:!1,message:"Failed to update role."}),le("feedback")}}},Se=async()=>{if(z)try{await dh(Me(je,`users/${z.id}`)),O({success:!0,message:"User deleted successfully."}),le("feedback")}catch{O({success:!1,message:"Failed to delete user."}),le("feedback")}},Ee=async()=>{if(!te.department.trim()||!te.office.trim()){O({success:!1,message:"Please fill in both department and office fields."}),le("feedback");return}const fe=te.department.trim(),Ze=te.office.trim(),Je=se.find(mt=>mt.office.toLowerCase()===Ze.toLowerCase());if(Je){O({success:!1,message:`Office "${Ze}" already exists in the "${Je.department}" department. Please choose a different office name.`}),le("feedback");return}try{const mt=Me(je,"offices"),Tt={department:fe,office:Ze,createdAt:new Date().toISOString()};await Kt(mt,{[Date.now().toString()]:Tt}),O({success:!0,message:"Office added successfully."}),le("feedback"),j({department:"",office:""})}catch(mt){console.error("Error adding office:",mt),O({success:!1,message:"Failed to add office."}),le("feedback")}},Ye=async()=>{if(!U.department.trim()||!U.office.trim()){O({success:!1,message:"Please fill in both department and office fields."}),le("feedback");return}const fe=U.department.trim(),Ze=U.office.trim(),Je=se.find(mt=>mt.id!==U.id&&mt.office.toLowerCase()===Ze.toLowerCase());if(Je){O({success:!1,message:`Office "${Ze}" already exists in the "${Je.department}" department. Please choose a different office name.`}),le("feedback");return}try{const mt=Me(je,`offices/${U.id}`),Tt={department:fe,office:Ze,updatedAt:new Date().toISOString()};await Kt(mt,Tt),O({success:!0,message:"Office updated successfully."}),le("feedback"),$({id:"",department:"",office:""})}catch(mt){console.error("Error updating office:",mt),O({success:!1,message:"Failed to update office."}),le("feedback")}},qe=async()=>{if(X)try{const fe=Me(je,`offices/${X.id}`);await dh(fe),O({success:!0,message:"Office deleted successfully."}),le("feedback"),Q(null)}catch(fe){console.error("Error deleting office:",fe),O({success:!1,message:"Failed to delete office."}),le("feedback")}},Ue=fe=>{Q(fe),$({id:fe.id,department:fe.department,office:fe.office}),le("editOffice"),K(!0)},Xe=fe=>{Q(fe),le("deleteOffice"),K(!0)},bt=fe=>{q(fe),Y(!1),fe==="UserLogs"&&n?n("userLogs"):fe==="Device Logs"&&n?n("deviceLogs"):fe==="Offices"&&n?n("offices"):fe==="UserManagement"&&n&&n("users")},qt=()=>{Y(!M)};return u.jsxs("div",{className:"user-management",children:[u.jsxs("div",{className:"um-header",children:[u.jsx("div",{className:"um-header-left",children:u.jsxs("div",{className:"um-user-info",children:[u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor",strokeWidth:"2"})]}),u.jsx("span",{children:e==="userLogs"?"User Logs":e==="deviceLogs"?"Device Logs":e==="offices"?"Offices":"User Management"})]})}),u.jsx("div",{className:"um-header-right",children:u.jsxs("div",{className:`um-dropdown-container ${M?"open":""}`,ref:Fe,children:[u.jsxs("button",{className:"um-dropdown-btn",onClick:qt,children:[u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M3 3v5h5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),ie,u.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"dropdown-arrow",children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),M&&u.jsxs("div",{className:"um-dropdown-menu",children:[u.jsx("button",{className:`um-dropdown-item ${ie==="UserManagement"?"active":""}`,onClick:()=>bt("UserManagement"),children:"UserManagement"}),u.jsx("button",{className:`um-dropdown-item ${ie==="UserLogs"?"active":""}`,onClick:()=>bt("UserLogs"),children:"UserLogs"}),u.jsx("button",{className:`um-dropdown-item ${ie==="Device Logs"?"active":""}`,onClick:()=>bt("Device Logs"),children:"Device Logs"}),u.jsx("button",{className:`um-dropdown-item ${ie==="Offices"?"active":""}`,onClick:()=>bt("Offices"),children:"Offices"})]})]})})]}),u.jsx("div",{className:"um-content",children:e==="offices"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"um-content-header",children:[u.jsx("h2",{children:"Offices"}),u.jsxs("div",{className:"um-controls",children:[u.jsxs("div",{className:"um-search",children:[u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"m21 21-4.35-4.35",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),u.jsx("input",{type:"text",placeholder:"Search offices...",value:i,onChange:fe=>s(fe.target.value)})]}),u.jsxs("button",{className:"um-add-btn",onClick:()=>{j({department:"",office:""}),le("addOffice"),K(!0)},title:"Add new office",children:[u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Add Office"]}),u.jsx("button",{className:"um-filter-btn",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M3 6h18M7 12h10M10 18h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),u.jsx("div",{className:"um-table-container",children:u.jsxs("table",{className:"um-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"No"}),u.jsx("th",{children:"Department"}),u.jsx("th",{children:"Office"}),u.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),u.jsx("tbody",{children:se.length>0?se.map((fe,Ze)=>u.jsxs("tr",{children:[u.jsx("td",{children:Ze+1}),u.jsx("td",{children:fe.department}),u.jsx("td",{children:fe.office}),u.jsx("td",{children:u.jsxs("div",{className:"um-actions",children:[u.jsx("button",{className:"action-btn edit-btn",onClick:()=>Ue(fe),"aria-label":"Edit office",title:"Edit office",children:u.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),u.jsx("button",{className:"action-btn delete-btn",onClick:()=>Xe(fe),"aria-label":"Delete office",title:"Delete office",children:u.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("path",{d:"M10 11v6M14 11v6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]})})]},fe.id)):u.jsx("tr",{children:u.jsx("td",{colSpan:4,style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:"No offices found"})})})]})})]}):e==="userLogs"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"um-content-header",children:[u.jsx("h2",{children:"User Logs"}),u.jsxs("div",{className:"um-controls",children:[u.jsxs("div",{className:"um-search",children:[u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"m21 21-4.35-4.35",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),u.jsx("input",{type:"text",placeholder:"Search user logs...",value:o,onChange:fe=>l(fe.target.value)})]}),u.jsx("div",{className:"um-filter-dropdown",children:u.jsxs("select",{value:c,onChange:fe=>d(fe.target.value),className:"um-filter-select",children:[u.jsx("option",{value:"all",children:"All Time"}),u.jsx("option",{value:"day",children:"Today"}),u.jsx("option",{value:"week",children:"This Week"}),u.jsx("option",{value:"month",children:"This Month"}),u.jsx("option",{value:"year",children:"This Year"})]})})]})]}),u.jsx("div",{className:"um-table-container",children:u.jsxs("table",{className:"um-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"User"}),u.jsx("th",{children:"Role"}),u.jsx("th",{children:"Action"}),u.jsx("th",{children:"Timestamp"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Auth Provider"})]})}),u.jsx("tbody",{children:ce.length>0?ce.map(fe=>u.jsxs("tr",{children:[u.jsx("td",{children:fe.user}),u.jsx("td",{children:fe.role.charAt(0).toUpperCase()+fe.role.slice(1)}),u.jsx("td",{children:fe.action}),u.jsx("td",{children:new Date(fe.timestamp).toLocaleString()}),u.jsx("td",{children:u.jsx("span",{className:`status-badge ${fe.status.toLowerCase()}`,children:fe.status})}),u.jsx("td",{children:u.jsx("span",{className:`auth-provider-badge ${fe.authProvider}`,children:fe.authProvider==="google"?"Google":fe.authProvider==="email"?"Email":fe.authProvider==="system"?"System":fe.authProvider})})]},fe.id)):u.jsx("tr",{children:u.jsx("td",{colSpan:6,style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:v.length===0?"No user logs found":"No logs match your search criteria"})})})]})})]}):e==="deviceLogs"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"um-content-header",children:[u.jsx("h2",{children:"Device Activity"}),u.jsxs("div",{className:"um-controls",children:[u.jsxs("div",{className:"um-search",children:[u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"m21 21-4.35-4.35",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),u.jsx("input",{type:"text",placeholder:"Search device logs...",value:C,onChange:fe=>A(fe.target.value)})]}),u.jsx("div",{className:"um-filter-dropdown",children:u.jsxs("select",{value:I,onChange:fe=>ee(fe.target.value),className:"um-filter-select",children:[u.jsx("option",{value:"all",children:"All Time"}),u.jsx("option",{value:"day",children:"Today"}),u.jsx("option",{value:"week",children:"This Week"}),u.jsx("option",{value:"month",children:"This Month"}),u.jsx("option",{value:"year",children:"This Year"})]})})]})]}),u.jsx("div",{className:"um-table-container",children:u.jsxs("table",{className:"um-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"User"}),u.jsx("th",{children:"Activity"}),u.jsx("th",{children:"Outlet/ Source"}),u.jsx("th",{children:"Appliance Connected"}),u.jsx("th",{children:"Timestamp"})]})}),u.jsx("tbody",{children:Ne.length>0?Ne.map(fe=>u.jsxs("tr",{children:[u.jsx("td",{children:fe.user}),u.jsx("td",{children:fe.activity}),u.jsx("td",{children:fe.outletSource}),u.jsx("td",{children:fe.applianceConnected}),u.jsx("td",{children:new Date(fe.timestamp).toLocaleString()})]},fe.id)):u.jsx("tr",{children:u.jsx("td",{colSpan:5,style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:b.length===0?"No device logs found":"No logs match your search criteria"})})})]})})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"um-content-header",children:[u.jsx("h2",{children:"Manage Users"}),u.jsxs("div",{className:"um-controls",children:[u.jsxs("div",{className:"um-search",children:[u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8",stroke:"currentColor",strokeWidth:"2"}),u.jsx("path",{d:"m21 21-4.35-4.35",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),u.jsx("input",{type:"text",placeholder:"Search users...",value:i,onChange:fe=>s(fe.target.value)})]}),u.jsx("button",{className:"um-filter-btn",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M3 6h18M7 12h10M10 18h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),u.jsx("div",{className:"um-table-container",children:u.jsxs("table",{className:"um-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"No"}),u.jsx("th",{children:"Name"}),u.jsx("th",{children:"Email"}),u.jsx("th",{children:"Roles"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:at.map((fe,Ze)=>u.jsxs("tr",{children:[u.jsx("td",{children:Ze+1}),u.jsx("td",{children:fe.name}),u.jsx("td",{children:fe.email}),u.jsx("td",{children:fe.role==="admin"?"GSO":fe.role.charAt(0).toUpperCase()+fe.role.slice(1)}),u.jsx("td",{children:u.jsxs("div",{className:"um-actions",children:[u.jsx("button",{className:"action-btn edit-btn",onClick:()=>$e(fe.id),"aria-label":`Edit ${fe.name}`,title:"Edit user",children:u.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),u.jsx("button",{className:"action-btn delete-btn",onClick:()=>pe(fe.id),"aria-label":`Delete ${fe.name}`,title:"Delete user",children:u.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("path",{d:"M10 11v6M14 11v6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]})})]},fe.id))})]})})]})}),G&&de==="edit"&&z&&u.jsx("div",{className:"um-modal-overlay",children:u.jsxs("div",{className:"um-modal",children:[u.jsxs("div",{className:"um-modal-header edit",children:[u.jsx("span",{className:"um-modal-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"44",height:"44",viewBox:"0 0 24 24",fill:"none",stroke:"#2563eb",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"}),u.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"})]})}),u.jsx("h3",{className:"um-modal-title",children:"Edit User Role"})]}),u.jsxs("div",{className:"um-modal-body",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Name:"})," ",z.name]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Email:"})," ",z.email]}),u.jsx("label",{htmlFor:"edit-role",className:"um-modal-label",children:"Role:"}),u.jsxs("select",{id:"edit-role",value:D,onChange:fe=>F(fe.target.value),children:[u.jsx("option",{value:"admin",children:"GSO"}),u.jsx("option",{value:"Coordinator",children:"Coordinator"})]})]}),u.jsxs("div",{className:"um-modal-actions",children:[u.jsx("button",{className:"um-modal-btn",onClick:be,children:"Save"}),u.jsx("button",{className:"um-modal-btn cancel",onClick:lt,children:"Cancel"})]})]})}),G&&de==="delete"&&z&&u.jsx("div",{className:"um-modal-overlay",children:u.jsxs("div",{className:"um-modal",children:[u.jsxs("div",{className:"um-modal-header delete",children:[u.jsx("span",{className:"um-modal-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"44",height:"44",viewBox:"0 0 24 24",fill:"none",stroke:"#ef4444",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),u.jsx("path",{d:"M10 11v6M14 11v6"})]})}),u.jsx("h3",{className:"um-modal-title",children:"Delete User"})]}),u.jsx("div",{className:"um-modal-body",children:u.jsxs("p",{children:["Are you sure you want to delete ",u.jsx("strong",{children:z.name}),"?"]})}),u.jsxs("div",{className:"um-modal-actions",children:[u.jsx("button",{className:"um-modal-btn delete",onClick:Se,children:"Delete"}),u.jsx("button",{className:"um-modal-btn cancel",onClick:lt,children:"Cancel"})]})]})}),G&&de==="addOffice"&&u.jsx("div",{className:"um-modal-overlay",children:u.jsxs("div",{className:"um-modal",style:{maxWidth:"500px",width:"90%",borderRadius:"16px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(8px)",background:"linear-gradient(145deg, #ffffff 0%, #f8fafc 100%)"},children:[u.jsxs("div",{className:"um-modal-header",style:{background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"white",padding:"2rem 2rem 1.5rem 2rem",borderRadius:"16px 16px 0 0",textAlign:"center",position:"relative",overflow:"hidden"},children:[u.jsx("div",{style:{position:"absolute",top:"-50%",right:"-20%",width:"120px",height:"120px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"50%",zIndex:0}}),u.jsx("div",{style:{position:"absolute",bottom:"-30%",left:"-10%",width:"80px",height:"80px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"50%",zIndex:0}}),u.jsxs("div",{style:{position:"relative",zIndex:1},children:[u.jsx("div",{style:{width:"64px",height:"64px",background:"rgba(255, 255, 255, 0.2)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem auto",backdropFilter:"blur(10px)",border:"2px solid rgba(255, 255, 255, 0.3)"},children:u.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("path",{d:"M12 5v14M5 12h14"})})}),u.jsx("h3",{style:{margin:0,fontSize:"1.5rem",fontWeight:"700",letterSpacing:"-0.025em"},children:"Add New Office"}),u.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.875rem",opacity:.9,fontWeight:"400"},children:"Create a new office entry for your organization"})]})]}),u.jsxs("div",{className:"um-modal-body",style:{padding:"2rem",background:"white"},children:[u.jsxs("div",{style:{marginBottom:"1.5rem"},children:[u.jsx("label",{htmlFor:"department",style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem",letterSpacing:"0.025em",textAlign:"left"},children:"Department"}),u.jsxs("div",{style:{position:"relative"},children:[u.jsx("input",{id:"department",type:"text",value:te.department,onChange:fe=>{j({...te,department:fe.target.value}),Be(!0)},placeholder:"Enter or select department",style:{width:"100%",padding:"0.875rem 1rem",border:"2px solid #e5e7eb",borderRadius:"12px",fontSize:"0.875rem",fontWeight:"500",background:"#fafafa",transition:"all 0.2s ease",outline:"none",boxSizing:"border-box"},onFocus:fe=>{fe.target.style.borderColor="#3b82f6",fe.target.style.background="white",fe.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)",Be(!0)},onBlur:fe=>{fe.target.style.borderColor="#e5e7eb",fe.target.style.background="#fafafa",fe.target.style.boxShadow="none"}}),De&&ye.length>0&&u.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"white",border:"2px solid #e5e7eb",borderRadius:"12px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)",zIndex:1e3,maxHeight:"200px",overflowY:"auto",marginTop:"4px"},children:ye.filter(fe=>fe.toLowerCase().includes(te.department.toLowerCase())).map((fe,Ze)=>u.jsx("div",{onClick:()=>{j({...te,department:fe}),Be(!1)},style:{padding:"0.75rem 1rem",cursor:"pointer",borderBottom:"1px solid #f3f4f6",fontSize:"0.875rem",fontWeight:"500",color:"#374151",transition:"all 0.15s ease"},onMouseEnter:Je=>{Je.currentTarget.style.backgroundColor="#f8fafc",Je.currentTarget.style.color="#1f2937"},onMouseLeave:Je=>{Je.currentTarget.style.backgroundColor="white",Je.currentTarget.style.color="#374151"},children:fe},Ze))})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"office",style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem",letterSpacing:"0.025em",textAlign:"left"},children:"Office Name"}),u.jsx("input",{id:"office",type:"text",value:te.office,onChange:fe=>j({...te,office:fe.target.value}),placeholder:"Enter office name",style:{width:"100%",padding:"0.875rem 1rem",border:"2px solid #e5e7eb",borderRadius:"12px",fontSize:"0.875rem",fontWeight:"500",background:"#fafafa",transition:"all 0.2s ease",outline:"none",boxSizing:"border-box"},onFocus:fe=>{fe.target.style.borderColor="#3b82f6",fe.target.style.background="white",fe.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:fe=>{fe.target.style.borderColor="#e5e7eb",fe.target.style.background="#fafafa",fe.target.style.boxShadow="none"}})]})]}),u.jsxs("div",{className:"um-modal-actions",style:{padding:"1rem 2rem 1.5rem 2rem",background:"linear-gradient(145deg, #f8fafc 0%, #ffffff 100%)",borderRadius:"0 0 16px 16px",display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[u.jsx("button",{className:"um-modal-btn cancel",onClick:lt,style:{background:"white",color:"#6b7280",border:"2px solid #e5e7eb",padding:"0.75rem 1.5rem",borderRadius:"10px",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px"},onMouseEnter:fe=>{fe.currentTarget.style.borderColor="#d1d5db",fe.currentTarget.style.color="#374151",fe.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:fe=>{fe.currentTarget.style.borderColor="#e5e7eb",fe.currentTarget.style.color="#6b7280",fe.currentTarget.style.transform="translateY(0)"},children:"Cancel"}),u.jsx("button",{className:"um-modal-btn",onClick:Ee,style:{background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"10px",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},onMouseEnter:fe=>{fe.currentTarget.style.transform="translateY(-2px)",fe.currentTarget.style.boxShadow="0 8px 20px rgba(59, 130, 246, 0.4)"},onMouseLeave:fe=>{fe.currentTarget.style.transform="translateY(0)",fe.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.3)"},children:"Save Office"})]})]})}),G&&de==="editOffice"&&X&&u.jsx("div",{className:"um-modal-overlay",children:u.jsxs("div",{className:"um-modal",style:{maxWidth:"500px",width:"90%",borderRadius:"16px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(8px)",background:"linear-gradient(145deg, #ffffff 0%, #f8fafc 100%)"},children:[u.jsxs("div",{className:"um-modal-header",style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",padding:"2rem 2rem 1.5rem 2rem",borderRadius:"16px 16px 0 0",textAlign:"center",position:"relative",overflow:"hidden"},children:[u.jsx("div",{style:{position:"absolute",top:"-50%",right:"-20%",width:"120px",height:"120px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"50%",zIndex:0}}),u.jsx("div",{style:{position:"absolute",bottom:"-30%",left:"-10%",width:"80px",height:"80px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"50%",zIndex:0}}),u.jsxs("div",{style:{position:"relative",zIndex:1},children:[u.jsx("div",{style:{width:"64px",height:"64px",background:"rgba(255, 255, 255, 0.2)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem auto",backdropFilter:"blur(10px)",border:"2px solid rgba(255, 255, 255, 0.3)"},children:u.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),u.jsx("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),u.jsx("h3",{style:{margin:0,fontSize:"1.5rem",fontWeight:"700",letterSpacing:"-0.025em"},children:"Edit Office"}),u.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.875rem",opacity:.9,fontWeight:"400"},children:"Update office information"})]})]}),u.jsxs("div",{className:"um-modal-body",style:{padding:"2rem",background:"white"},children:[u.jsxs("div",{style:{marginBottom:"1.5rem"},children:[u.jsx("label",{htmlFor:"edit-department",style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem",letterSpacing:"0.025em",textAlign:"left"},children:"Department"}),u.jsx("input",{id:"edit-department",type:"text",value:U.department,onChange:fe=>$({...U,department:fe.target.value}),placeholder:"Enter department",style:{width:"100%",padding:"0.875rem 1rem",border:"2px solid #e5e7eb",borderRadius:"12px",fontSize:"0.875rem",fontWeight:"500",background:"#fafafa",transition:"all 0.2s ease",outline:"none",boxSizing:"border-box"},onFocus:fe=>{fe.target.style.borderColor="#10b981",fe.target.style.background="white",fe.target.style.boxShadow="0 0 0 3px rgba(16, 185, 129, 0.1)"},onBlur:fe=>{fe.target.style.borderColor="#e5e7eb",fe.target.style.background="#fafafa",fe.target.style.boxShadow="none"}})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"edit-office",style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem",letterSpacing:"0.025em",textAlign:"left"},children:"Office Name"}),u.jsx("input",{id:"edit-office",type:"text",value:U.office,onChange:fe=>$({...U,office:fe.target.value}),placeholder:"Enter office name",style:{width:"100%",padding:"0.875rem 1rem",border:"2px solid #e5e7eb",borderRadius:"12px",fontSize:"0.875rem",fontWeight:"500",background:"#fafafa",transition:"all 0.2s ease",outline:"none",boxSizing:"border-box"},onFocus:fe=>{fe.target.style.borderColor="#10b981",fe.target.style.background="white",fe.target.style.boxShadow="0 0 0 3px rgba(16, 185, 129, 0.1)"},onBlur:fe=>{fe.target.style.borderColor="#e5e7eb",fe.target.style.background="#fafafa",fe.target.style.boxShadow="none"}})]})]}),u.jsxs("div",{className:"um-modal-actions",style:{padding:"1rem 2rem 1.5rem 2rem",background:"linear-gradient(145deg, #f8fafc 0%, #ffffff 100%)",borderRadius:"0 0 16px 16px",display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[u.jsx("button",{className:"um-modal-btn cancel",onClick:lt,style:{background:"white",color:"#6b7280",border:"2px solid #e5e7eb",padding:"0.75rem 1.5rem",borderRadius:"10px",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px"},onMouseEnter:fe=>{fe.currentTarget.style.borderColor="#d1d5db",fe.currentTarget.style.color="#374151",fe.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:fe=>{fe.currentTarget.style.borderColor="#e5e7eb",fe.currentTarget.style.color="#6b7280",fe.currentTarget.style.transform="translateY(0)"},children:"Cancel"}),u.jsx("button",{className:"um-modal-btn",onClick:Ye,style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"10px",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:"0 4px 12px rgba(16, 185, 129, 0.3)"},onMouseEnter:fe=>{fe.currentTarget.style.transform="translateY(-2px)",fe.currentTarget.style.boxShadow="0 8px 20px rgba(16, 185, 129, 0.4)"},onMouseLeave:fe=>{fe.currentTarget.style.transform="translateY(0)",fe.currentTarget.style.boxShadow="0 4px 12px rgba(16, 185, 129, 0.3)"},children:"Update Office"})]})]})}),G&&de==="deleteOffice"&&X&&u.jsx("div",{className:"um-modal-overlay",children:u.jsxs("div",{className:"um-modal",children:[u.jsxs("div",{className:"um-modal-header delete",children:[u.jsx("span",{className:"um-modal-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"44",height:"44",viewBox:"0 0 24 24",fill:"none",stroke:"#ef4444",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),u.jsx("path",{d:"M10 11v6M14 11v6"})]})}),u.jsx("h3",{className:"um-modal-title",children:"Delete Office"})]}),u.jsxs("div",{className:"um-modal-body",children:[u.jsxs("p",{children:["Are you sure you want to delete ",u.jsxs("strong",{children:[X.department," - ",X.office]}),"?"]}),u.jsx("p",{style:{color:"#ef4444",fontSize:"0.875rem",marginTop:"0.5rem"},children:"This action cannot be undone."})]}),u.jsxs("div",{className:"um-modal-actions",children:[u.jsx("button",{className:"um-modal-btn delete",onClick:qe,children:"Delete"}),u.jsx("button",{className:"um-modal-btn cancel",onClick:lt,children:"Cancel"})]})]})}),G&&de==="feedback"&&E&&u.jsx("div",{className:"um-modal-overlay",children:u.jsxs("div",{className:"um-modal",children:[u.jsxs("div",{className:`um-modal-header ${E.success?"success":"error"}`,children:[u.jsx("span",{className:"um-modal-icon","aria-hidden":"true",children:E.success?u.jsx("svg",{width:"44",height:"44",viewBox:"0 0 24 24",fill:"none",stroke:"#22c55e",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("path",{d:"M5 13l4 4L19 7"})}):u.jsxs("svg",{width:"44",height:"44",viewBox:"0 0 24 24",fill:"none",stroke:"#ef4444",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M12 8v4M12 16h.01"})]})}),u.jsx("h3",{className:"um-modal-title",children:E.success?"Success":"Error"}),u.jsx("button",{className:"um-modal-close",onClick:lt,"aria-label":"Close modal",children:"×"})]}),u.jsx("div",{className:"um-modal-body",children:u.jsx("p",{children:E.message})}),u.jsx("div",{className:"um-modal-actions",children:u.jsx("button",{className:"um-modal-btn",onClick:lt,children:"OK"})})]})})]})},PW=n=>{if(!n||n.toLowerCase()==="daily")return"Daily";const e={monday:"M",tuesday:"T",wednesday:"W",thursday:"TH",friday:"F",saturday:"SAT",sunday:"SUN",mon:"M",tue:"T",wed:"W",thu:"TH",fri:"F",sat:"SAT",sun:"SUN",m:"M",t:"T",w:"W",th:"TH",f:"F",s:"SAT"};return n.split(",").map(i=>{const s=i.trim().toLowerCase();return e[s]||i.trim()}).join(", ")},UW=me.memo(({successModal:n,setModalOpen:e,setSuccessModal:t})=>n.isOpen?u.jsx("div",{className:"modal-overlay success-overlay",onClick:()=>{e(!1),t({isOpen:!1,deviceName:"",action:""})},children:u.jsxs("div",{className:"active-device-success-modal",onClick:i=>i.stopPropagation(),children:[u.jsx("div",{className:"active-device-success-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#10b981",stroke:"#10b981",strokeWidth:"2"}),u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#ffffff",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("h3",{children:"Device Updated Successfully!"}),u.jsxs("p",{children:["The device ",u.jsxs("strong",{children:['"',n.deviceName,'"']})," has been ",n.action,"."]}),u.jsx("button",{className:"btn-primary",onClick:()=>{e(!1),t({isOpen:!1,deviceName:"",action:""})},children:"Continue"})]})}):null),FW=me.memo(({bypassModal:n,setModalOpen:e,setBypassModal:t,toggleDeviceStatus:i,userRole:s="Coordinator"})=>{if(!n.isOpen||!n.device)return null;const o=n.device,l=()=>{e(!1),t({isOpen:!1,device:null,reason:""}),i(o.id,!0)},c=()=>{e(!1),t({isOpen:!1,device:null,reason:""})};return u.jsx("div",{className:"modal-overlay warning-overlay",onClick:c,children:u.jsxs("div",{className:"warning-modal",onClick:d=>d.stopPropagation(),children:[u.jsx("div",{className:"warning-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z",fill:"#f59e0b"})]})}),s==="admin"?u.jsxs(u.Fragment,{children:[u.jsx("h3",{children:"Bypass Restrictions?"}),u.jsx("p",{children:u.jsxs("strong",{children:['"',o.outletName,'" has restrictions that prevent it from being turned ON.']})}),u.jsxs("div",{className:"warning-details",children:[u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Device:"}),u.jsx("span",{className:"value",children:o.outletName})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Location:"}),u.jsx("span",{className:"value",children:o.officeRoom})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Restriction:"}),u.jsx("span",{className:"value",children:n.reason})]})]}),u.jsx("p",{className:"warning-message",children:"Do you want to bypass these restrictions and turn ON this device anyway?"})]}):u.jsxs(u.Fragment,{children:[u.jsx("h3",{children:"Device Restrictions Active"}),u.jsx("p",{children:u.jsxs("strong",{children:['"',o.outletName,'" cannot be turned ON due to active restrictions.']})}),u.jsxs("div",{className:"warning-details",children:[u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Device:"}),u.jsx("span",{className:"value",children:o.outletName})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Location:"}),u.jsx("span",{className:"value",children:o.officeRoom})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Restriction:"}),u.jsx("span",{className:"value",children:n.reason})]})]}),u.jsx("p",{className:"warning-message",children:"As a Coordinator, you cannot bypass these restrictions. Only GSO can override device restrictions."})]}),s==="admin"&&u.jsxs("div",{className:"bypass-info",children:[u.jsxs("div",{className:"bypass-info-header",children:[u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#dbeafe",stroke:"#3b82f6",strokeWidth:"2"}),u.jsx("path",{d:"M12 16v-4m0-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",fill:"#3b82f6"})]}),u.jsx("span",{className:"bypass-info-title",children:"Important Notice"})]}),u.jsx("p",{className:"bypass-info-text",children:"When you bypass restrictions and turn ON this device, the **main_status** will be set to ON. This will **enable manual override mode** for this device. The device will remain ON until manually turned off, and automatic systems will not interfere with it."})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{type:"button",className:"btn-secondary",onClick:c,children:s==="admin"?"Cancel":"Close"}),s==="admin"&&u.jsx("button",{type:"button",className:"btn-primary",onClick:l,children:"Bypass & Turn ON"})]})]})})}),$W=(n,e)=>{e(t=>(t[n]&&(clearTimeout(t[n]),console.log(`🔄 Auto-turnoff: Cleared timer for ${n} - device is now idle or turned off`)),{...t,[n]:null}))};function BW({onNavigate:n,userRole:e="Coordinator"}){const t=(pe,be=3)=>pe.toLocaleString("en-US",{minimumFractionDigits:be,maximumFractionDigits:be}),i=(pe,be)=>{const Se=Date.now();if(Se-q<W)return console.log(`Modal ${pe} blocked - too soon since last modal (${Se-q}ms ago)`),!1;if(Y)return console.log(`Modal ${pe} blocked - another modal is already open`),!1;switch(ie(!0),re(Se),pe){case"scheduleConflict":E({isOpen:!0,device:be.device,reason:be.reason});break;case"powerLimit":C({isOpen:!0,device:be.device});break;case"success":v({isOpen:!0,deviceName:be.deviceName,action:be.action});break;case"error":b({isOpen:!0,message:be.message});break}return!0},[s,o]=me.useState(""),[l,c]=me.useState([]),[d,f]=me.useState(!0),[p,v]=me.useState({isOpen:!1,deviceName:"",action:""}),[_,b]=me.useState({isOpen:!1,message:""}),[T,C]=me.useState({isOpen:!1,device:null}),[A,I]=me.useState({isOpen:!1,device:null}),[ee,G]=me.useState("Day"),[K,de]=me.useState(9.3885),[le,z]=me.useState(""),[R,D]=me.useState({totalEnergy:0,totalCost:0,dailyData:[]}),[F,E]=me.useState({isOpen:!1,device:null,reason:""}),[O,M]=me.useState(new Set),[Y,ie]=me.useState(!1),[q,re]=me.useState(0),[V,se]=me.useState(0),W=2e3,te=1e3,[j,U]=me.useState({enabled:!1,selectedOutlets:[],combinedLimit:0}),[$,X]=me.useState({isOpen:!1,device:null,reason:""}),[Q,ye]=me.useState({}),[Ae,De]=me.useState({});me.useEffect(()=>{Object.values(Ae).forEach(pe=>{pe&&clearTimeout(pe)}),De({})},[]);const Be=()=>{const pe=new Date,be=pe.getFullYear(),Se=String(pe.getMonth()+1).padStart(2,"0"),Ee=String(pe.getDate()).padStart(2,"0"),Ye=`day_${be}_${Se}_${Ee}`;return console.log(`Today's date key: ${Ye}`),Ye},Fe=pe=>{if(!pe||pe==="Unassigned")return"Unassigned";const be=pe.replace(/[-_]/g," ").split(" ").map(Se=>Se.charAt(0).toUpperCase()+Se.slice(1).toLowerCase()).join(" ");return be.toLowerCase().includes("computer lab")&&!be.toLowerCase().includes("laboratory")?be.replace(/computer lab/i,"Computer Laboratory"):be.toLowerCase().includes("deans office")?be.replace(/deans office/i,"Dean's Office"):be},Ct=pe=>{if(!pe)return"";const[be,Se]=pe.split(":"),Ee=parseInt(be,10),Ye=Ee>=12?"PM":"AM";return`${Ee%12||12}:${Se} ${Ye}`},at=async(pe,be)=>{try{const Se=Me(je,`devices/${pe}`),Ee=await Pt(Se);if(!Ee.exists())return{totalEnergy:0,totalCost:0,dailyData:[]};const qe=Ee.val().daily_logs||{},Ue=new Date,Xe=Ue.getFullYear(),bt=Ue.getMonth()+1,qt=Ue.getDate();let fe=[],Ze=0,Je=0;return Object.keys(qe).forEach(mt=>{const[Tt,It,gt,tn]=mt.split("_"),Zt=parseInt(It),Dt=parseInt(gt),Ut=parseInt(tn);let Qt=!1;switch(be){case"Day":Qt=Zt===Xe&&Dt===bt&&Ut===qt;break;case"Week":const an=new Date(Zt,Dt-1,Ut),on=Math.floor((Ue.getTime()-an.getTime())/(1e3*60*60*24));Qt=on>=0&&on<7;break;case"Month":Qt=Zt===Xe&&Dt===bt;break;case"Year":Qt=Zt===Xe;break}if(Qt){const on=qe[mt].total_energy||0,dn=on*K,Sn=Math.floor(dn*100)/100;fe.push({date:`${Zt}-${gt.padStart(2,"0")}-${tn.padStart(2,"0")}`,energy:on,cost:Sn}),Ze+=on,Je+=Sn}}),fe.sort((mt,Tt)=>new Date(mt.date).getTime()-new Date(Tt.date).getTime()),{totalEnergy:Ze,totalCost:Je,dailyData:fe}}catch(Se){return console.error("Error calculating outlet cost:",Se),{totalEnergy:0,totalCost:0,dailyData:[]}}},Ce=async pe=>{const be=pe.outletName.replace(" ","_"),Se=await at(be,ee);D(Se)},ce=(pe,be,Se,Ee)=>{if(!pe||!pe.timeRange&&!pe.startTime)return be==="on";const Ye=new Date,qe=Ye.getHours()*60+Ye.getMinutes(),Ue=Ye.getDay();let Xe,bt;if(pe.startTime&&pe.endTime){const[Je,mt]=pe.startTime.split(":").map(Number),[Tt,It]=pe.endTime.split(":").map(Number);Xe=Je*60+mt,bt=Tt*60+It}else if(pe.timeRange){const Je=pe.timeRange,[mt,Tt]=Je.split(" - "),It=gt=>{const[tn,Zt]=gt.split(" ");let[Dt,Ut]=tn.split(":").map(Number);return Dt===12&&(Dt=0),Zt==="PM"&&(Dt+=12),Dt*60+Ut};Xe=It(mt),bt=It(Tt)}else return be==="on";const qt=qe>=Xe&&qe<bt,fe=pe.frequency||"";let Ze=!1;if(fe.toLowerCase()==="daily")Ze=!0;else if(fe.toLowerCase()==="weekdays")Ze=Ue>=1&&Ue<=5;else if(fe.toLowerCase()==="weekends")Ze=Ue===0||Ue===6;else if(fe.includes(",")){const Je={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6};Ze=fe.split(",").map(Tt=>{const It=Tt.trim().toLowerCase();return Je[It]}).filter(Tt=>Tt!==void 0).includes(Ue)}else if(fe){const mt={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6,sun:0,m:1,t:2,w:3,th:4,f:5,s:6}[fe.toLowerCase()];mt!==void 0&&(Ze=mt===Ue)}if(Se&&!Ee){const Je=Se.relay_control?.auto_cutoff?.power_limit||0,mt=new Date,Tt=`day_${mt.getFullYear()}_${String(mt.getMonth()+1).padStart(2,"0")}_${String(mt.getDate()).padStart(2,"0")}`,gt=Se?.daily_logs?.[Tt]?.total_energy||0;if(Je>0&&gt>=Je)return console.log(`Schedule check: Device ${Se.outletName||"Unknown"} power limit exceeded:`,{todayTotalEnergy:`${(gt*1e3).toFixed(3)}W`,powerLimit:`${Je*1e3}W`,todayDateKey:Tt,scheduleResult:!1,reason:"Today's energy consumption exceeded power limit"}),!1}return qt&&Ze};me.useEffect(()=>{const pe=Me(je,"devices"),be=Go(pe,Se=>{const Ee=Se.val();if(console.log("ActiveDevice: Firebase data received:",Ee),Ee){const Ye=[];let qe=1;Object.keys(Ee).forEach(Ue=>{const Xe=Ee[Ue],bt=Be(),qt=Xe.daily_logs?.[bt],fe=Xe.lifetime_energy||0,Ze=`${t(fe*1e3)} Wh`;console.log(`Outlet ${Ue}: Using lifetime_energy = ${fe}W (${fe}kW)`),Xe.relay_control?.auto_cutoff?.power_limit,console.log(`Outlet ${Ue} full data:`,Xe),console.log(`Outlet ${Ue} control object:`,Xe.control),console.log(`Outlet ${Ue} control.device value:`,Xe.control?.device);const mt=(Xe.control?.device||"off").toString().trim().toLowerCase(),Tt=Xe.relay_control?.main_status||"ON",It=qt?.total_energy||0,gt=`${t(It*1e3)} Wh`;console.log(`Outlet ${Ue}: Using total_energy = ${It}W (${It}kW)`);const Zt={"computer-lab-1":"Computer Laboratory 1","computer-lab-2":"Computer Laboratory 2","computer-lab-3":"Computer Laboratory 3","deans-office":"Dean's Office","faculty-office":"Faculty Office"},Dt=Xe.office_info?.office||"",Ut=Dt?Zt[Dt]||Fe(Dt):"—",an=Xe.status==="idle",on=Date.now(),dn=qt?.total_energy||0,Sn=qt?.avg_power||0,Te=qt?.peak_power||0,Qe=qt?.usage_time_millis||0,dt=`${dn}_${Sn}_${Te}_${Qe}`,ve=Q[Ue]||{lastEnergyUpdate:on,lastControlUpdate:on,lastTotalEnergy:dn,lastControlState:mt,lastStateHash:dt};!Q[Ue]&&dn>0&&ye(Lt=>({...Lt,[Ue]:{lastEnergyUpdate:on,lastControlUpdate:on,lastTotalEnergy:dn,lastControlState:mt,lastStateHash:dt}}));const He=ve.lastStateHash||"";ye(dt!==He?Lt=>({...Lt,[Ue]:{...ve,lastEnergyUpdate:on,lastTotalEnergy:dn,lastStateHash:dt}}):Lt=>({...Lt,[Ue]:{...ve,lastTotalEnergy:dn,lastStateHash:dt}})),mt!==ve.lastControlState&&ye(Lt=>({...Lt,[Ue]:{...ve,lastControlUpdate:on,lastControlState:mt}}));const Pe=on-ve.lastEnergyUpdate,At=on-ve.lastControlUpdate,rt=Pe>15e3&&At>15e3;let Nt;if((an||rt)&&mt==="on"?Nt="Idle":Nt=mt==="on"?"Active":"Inactive",$W(Ue,De),Xe.schedule&&(Xe.schedule.timeRange||Xe.schedule.startTime)){const Lt=new Date,Yt=Lt.getHours()*60+Lt.getMinutes(),Vt=Lt.getDay();console.log(`Outlet ${Ue}: Schedule debug - Current time: ${Lt.toLocaleTimeString()} (${Yt} min), Day: ${Vt}`),console.log(`Outlet ${Ue}: Schedule data:`,Xe.schedule);const nn=ce(Xe.schedule,"on",Xe);console.log(`Outlet ${Ue}: Should be active by schedule: ${nn}`)}const xt=Xe.office_info?.appliance||"Unassigned",st=Xe.sensor_data?.current||0,St=`${Math.round(st)} A`;let yt="No schedule",ke="No schedule";if(Xe.schedule){if(Xe.schedule.startTime&&Xe.schedule.endTime){const Lt=Ct(Xe.schedule.startTime),Yt=Ct(Xe.schedule.endTime);yt=`${Lt} - ${Yt}`}else Xe.schedule.timeRange&&(yt=Xe.schedule.timeRange);Xe.schedule.frequency&&(ke=PW(Xe.schedule.frequency))}const pt={id:String(qe).padStart(3,"0"),outletName:Ue.replace("_"," "),appliances:xt,officeRoom:Ut,powerUsage:Ze,status:Nt,todayUsage:gt,currentAmpere:St,schedule:{time:yt,days:ke},controlState:mt,mainStatus:Tt};Ye.push(pt),qe++}),console.log("ActiveDevice: Setting devices array:",Ye),c(Ye)}else console.log("ActiveDevice: No data in Firebase - all devices deleted or database empty"),c([]);f(!1)});return()=>lr(pe,"value",be)},[]),me.useEffect(()=>{(async()=>{try{const be=Me(je,"combined_limit_settings"),Se=await Pt(be);if(Se.exists()){const Ee=Se.val();U({enabled:Ee.enabled||!1,selectedOutlets:Ee.selected_outlets||[],combinedLimit:Ee.combined_limit_watts||0})}else U({enabled:!1,selectedOutlets:[],combinedLimit:0})}catch(be){console.error("ActiveDevice: Error fetching combined limit info:",be)}})()},[]),me.useEffect(()=>{const pe=async()=>{try{const Ye=Me(je,"devices"),qe=await Pt(Ye);if(qe.exists()){const Ue=qe.val(),Xe=new Date,bt=Xe.getHours()*60+Xe.getMinutes(),qt=Xe.getDay();console.log(`ActiveDevice: Real-time scheduler check at ${Xe.toLocaleTimeString()}:`,{currentTime:`${Math.floor(bt/60)}:${String(bt%60).padStart(2,"0")}`,currentDay:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][qt]});for(const[fe,Ze]of Object.entries(Ue)){const Je=Ze;if(console.log(`ActiveDevice: Checking device ${fe}:`,{hasSchedule:!!(Je.schedule&&(Je.schedule.timeRange||Je.schedule.startTime)),enablePowerScheduling:Je.office_info?.enable_power_scheduling,schedule:Je.schedule}),Je.schedule&&(Je.schedule.timeRange||Je.schedule.startTime)){const mt=Je.control?.device||"off",Tt=Je.relay_control?.main_status||"ON";if(Tt==="ON"){console.log(`ActiveDevice: Device ${fe} main_status is ON - respecting bypass mode, skipping automatic schedule control`);continue}console.log(`ActiveDevice: Device ${fe} main status is ${Tt} - applying automatic schedule control`);const It=fe.replace("_"," "),gt=j?.enabled&&j?.selectedOutlets?.includes(It),tn=ce(Je.schedule,"on",Je,gt);let Zt=tn?"on":"off";if(!gt&&Zt==="on"){const Dt=Je.relay_control?.auto_cutoff?.power_limit||0;if(Dt>0){const Ut=new Date,Qt=`day_${Ut.getFullYear()}_${String(Ut.getMonth()+1).padStart(2,"0")}_${String(Ut.getDate()).padStart(2,"0")}`,on=Je?.daily_logs?.[Qt]?.total_energy||0;on>=Dt&&(Zt="off",console.log(`🔒 ActiveDevice: AUTOMATIC UPDATE - Forcing ${fe} OFF due to individual daily limit exceeded (${(on*1e3).toFixed(3)}W >= ${Dt*1e3}W)`))}}if(console.log(`ActiveDevice: Schedule check for ${fe}:`,{currentControlState:mt,shouldBeActive:tn,newControlState:Zt,needsUpdate:mt!==Zt,isInCombinedGroup:gt}),mt!==Zt){if(Zt==="off"){const Dt=Date.now(),Ut=Q[fe]?.lastEnergyUpdate||0,Qt=Dt-Ut;if(Qt<12e4){console.log(`ActiveDevice: Keeping ${fe} ON - recent database activity detected (${Math.round(Qt/1e3)}s ago) during schedule check`);continue}}console.log(`ActiveDevice: Real-time update: ${fe} control state from ${mt} to ${Zt}`),await Kt(Me(je,`devices/${fe}/control`),{device:Zt})}else console.log(`ActiveDevice: No update needed for ${fe} - control state already ${mt}`)}}}}catch(Ye){console.error("ActiveDevice: Error in real-time scheduler:",Ye)}},be=async()=>{try{const Ye=Me(je,"devices"),qe=await Pt(Ye);if(qe.exists()){const Ue=qe.val();console.log(`ActiveDevice: Power limit monitor running at ${new Date().toLocaleTimeString()}`);for(const[Xe,bt]of Object.entries(Ue)){const qt=bt,fe=qt.control?.device||"off",Ze=qt.relay_control?.main_status||"ON";if(fe==="off")continue;if(Ze==="ON"){console.log(`ActiveDevice: Device ${Xe} main_status is ON - respecting bypass mode, skipping automatic power limit enforcement`);continue}const Je=Xe.replace("_"," "),mt=j?.enabled&&j?.selectedOutlets?.includes(Je);if(mt){if(console.log(`ActiveDevice: Device ${Xe} is in combined group - skipping individual daily limit check (monthly limit takes precedence)`),Ze==="ON"){console.log(`ActiveDevice: Device ${Xe} main_status is ON - respecting bypass mode, skipping combined group power limit enforcement`);continue}}else{if(console.log(`ActiveDevice: Device ${Xe} main status is ${Ze} - checking individual power limits`),Ze==="ON"){console.log(`ActiveDevice: Device ${Xe} main_status is ON - respecting bypass mode, skipping individual power limit enforcement`);continue}const Tt=qt.relay_control?.auto_cutoff?.power_limit||0;if(Tt>0){const It=new Date,gt=`day_${It.getFullYear()}_${String(It.getMonth()+1).padStart(2,"0")}_${String(It.getDate()).padStart(2,"0")}`,Zt=qt?.daily_logs?.[gt]?.total_energy||0;if(console.log(`ActiveDevice: Power limit check for ${Xe}:`,{powerLimit:`${Tt*1e3}W`,todayTotalEnergy:`${Zt*1e3}W`,todayDateKey:gt,exceedsLimit:Zt>=Tt,currentControlState:fe,isInCombinedGroup:mt}),Zt>=Tt){const Dt=Date.now(),Ut=Q[Xe]?.lastEnergyUpdate||0,Qt=Dt-Ut,an=Qt<12e4;console.log(`ActiveDevice: POWER LIMIT EXCEEDED for ${Xe}:`,{todayTotalEnergy:`${(Zt*1e3).toFixed(3)}W`,powerLimit:`${Tt*1e3}W`,timeSinceLastUpdate:`${Math.round(Qt/1e3)}s`,hasRecentActivity:an,willTurnOff:!an}),an?console.log(`ActiveDevice: Keeping ${Xe} ON - recent database activity detected (${Math.round(Qt/1e3)}s ago)`):(console.log(`ActiveDevice: Turning OFF ${Xe} - no recent database activity`),await Kt(Me(je,`devices/${Xe}/control`),{device:"off"}),console.log(`ActiveDevice: Device ${Xe} turned OFF due to power limit exceeded`))}}}}}}catch(Ye){console.error("ActiveDevice: Error in power limit monitor:",Ye)}};pe(),be(),window.testSchedule=pe,window.testPowerLimits=be,window.checkCurrentTime=()=>{const Ye=new Date,qe=Ye.getHours()*60+Ye.getMinutes(),Ue=Ye.getDay();console.log("Current time debug:",{time:Ye.toLocaleTimeString(),minutes:qe,day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][Ue],dayNumber:Ue})};const Se=setInterval(pe,1e4),Ee=setInterval(be,3e4);return()=>{clearInterval(Se),clearInterval(Ee),Object.values(Ae).forEach(Ye=>{Ye&&clearTimeout(Ye)})}},[]),me.useEffect(()=>{const pe=Me(je,"rates/canoreco"),be=Go(pe,Se=>{const Ee=Se.val();if(!Ee)return;const Ye=Number(Ee.rate??Ee.value);!Number.isNaN(Ye)&&Ye>0&&de(Ye);const qe=Ee.updatedAt??Date.now();try{const Ue=typeof qe=="number"?new Date(qe):new Date(qe);z(Ue.toLocaleString("en-PH"))}catch{z(new Date().toLocaleString("en-PH"))}});return()=>lr(pe,"value",be)},[]);const _t=me.useMemo(()=>l.filter(pe=>pe.outletName.toLowerCase().includes(s.toLowerCase())||pe.appliances.toLowerCase().includes(s.toLowerCase())||pe.officeRoom.toLowerCase().includes(s.toLowerCase())),[l,s]),Ne=async(pe,be=!1)=>{try{const Se=Date.now();if(Se-V<te){console.log(`Toggle blocked - too soon since last toggle (${Se-V}ms ago)`);return}if(O.has(pe)){console.log(`Toggle blocked - device ${pe} is already being updated`);return}const Ee=l.find(Ze=>Ze.id===pe);if(!Ee)return;M(Ze=>new Set(Ze).add(pe)),se(Se);const Ye=Ee.outletName.replace(" ","_"),qe=Ee.controlState,Ue=Ee.mainStatus;let Xe,bt;if(qe==="on")console.log(`ActiveDevice: Turning OFF ${Ye} - no validation needed`),Xe="off",bt="OFF";else if(be)console.log(`ActiveDevice: BYPASS CONFIRMED - Turning ON ${Ye} - bypassing all validation checks`),Xe="on",bt="ON";else{console.log(`ActiveDevice: Checking restrictions for ${Ye}`);const Ze=Me(je,`devices/${Ye}`),mt=(await Pt(Ze)).val(),Tt=Ye.replace("_"," "),It=j?.enabled&&j?.selectedOutlets?.includes(Tt);let gt=!1,tn="";if(It)console.log(`ActiveDevice: Skipping individual daily limit check for ${Ye} - device is in combined group (monthly limit takes precedence)`);else{const Zt=mt?.relay_control?.auto_cutoff?.power_limit||0;Zt<=0&&(gt=!0,tn="No power limit set - device requires power limit configuration");const Dt=new Date,Ut=`day_${Dt.getFullYear()}_${String(Dt.getMonth()+1).padStart(2,"0")}_${String(Dt.getDate()).padStart(2,"0")}`,an=mt?.daily_logs?.[Ut]?.total_energy||0;console.log(`Power limit check for ${Ye}:`,{powerLimit:`${Zt*1e3}W`,todayTotalEnergy:`${an*1e3}W`,todayDateKey:Ut,exceedsLimit:an>=Zt,isInCombinedGroup:It}),an>=Zt&&(gt=!0,tn=`Power limit exceeded: ${(an*1e3).toFixed(0)}W / ${Zt*1e3}W`)}if(mt.schedule&&(mt.schedule.timeRange||mt.schedule.startTime)&&!ce(mt.schedule,"on",mt,It)){gt=!0;const Dt=new Date,Ut=mt.schedule;Ut.timeRange&&Ut.timeRange!=="No schedule"?tn=`Outside scheduled time: ${Ut.timeRange} (Current: ${Dt.toLocaleTimeString()})`:Ut.startTime&&Ut.endTime?tn=`Outside scheduled time: ${Ut.startTime} - ${Ut.endTime} (Current: ${Dt.toLocaleTimeString()})`:tn="Outside scheduled time"}if(gt){X({isOpen:!0,device:Ee,reason:tn}),M(Zt=>{const Dt=new Set(Zt);return Dt.delete(pe),Dt});return}Xe="on",bt="ON"}console.log(`Toggling ${Ye} from control:${qe}/main:${Ue} to control:${Xe}/main:${bt}`),await Kt(Me(je,`devices/${Ye}/control`),{device:Xe}),await Kt(Me(je,`devices/${Ye}/relay_control`),{main_status:bt}),console.log(`Successfully toggled ${Ye} to control:${Xe}/main:${bt}`),await xF(Xe==="on"?"Turn on outlet":"Turn off outlet",Ee.outletName,Ee.officeRoom||"Unknown",Ee.appliances||"Unknown");const fe=Xe==="on"?"turned ON":"turned OFF";i("success",{deviceName:Ee.outletName,action:fe})}catch(Se){console.error("Error toggling device:",Se);const Ee=l.find(Ye=>Ye.id===pe)?.outletName||"Unknown Device";i("error",{message:`Failed to update device "${Ee}". Please try again.`})}finally{M(Se=>{const Ee=new Set(Se);return Ee.delete(pe),Ee})}},Ve=pe=>{const Se={Active:"status-active",Inactive:"status-inactive",Warning:"status-warning",Idle:"status-idle"}[pe]||"status-inactive";return u.jsxs("span",{className:`status-badge ${Se}`,children:[u.jsx("span",{className:`status-dot ${Se}`}),pe]})},We=pe=>u.jsx("span",{className:"schedule-badge",children:pe}),tt=pe=>pe.status==="Active"?"toggle-switch active":"toggle-switch inactive",lt=()=>_.isOpen?u.jsx("div",{className:"modal-overlay",onClick:()=>{ie(!1),b({isOpen:!1,message:""})},children:u.jsxs("div",{className:"error-modal",onClick:pe=>pe.stopPropagation(),children:[u.jsx("div",{className:"error-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef2f2",stroke:"#dc2626",strokeWidth:"2"}),u.jsx("path",{d:"M15 9l-6 6M9 9l6 6",stroke:"#dc2626",strokeWidth:"2",strokeLinecap:"round"})]})}),u.jsx("h3",{children:"Update Failed"}),u.jsx("p",{children:_.message}),u.jsx("button",{className:"btn-primary",onClick:()=>{ie(!1),b({isOpen:!1,message:""})},children:"Try Again"})]})}):null,$e=()=>{if(!F.isOpen||!F.device)return null;const pe=F.device;return u.jsx("div",{className:"modal-overlay warning-overlay",onClick:()=>{ie(!1),E({isOpen:!1,device:null,reason:""})},children:u.jsxs("div",{className:"warning-modal",onClick:be=>be.stopPropagation(),children:[u.jsx("div",{className:"warning-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",fill:"#f59e0b"})]})}),u.jsx("h3",{children:"Schedule Conflict"}),u.jsx("p",{children:u.jsxs("strong",{children:['"',pe.outletName,'" cannot be turned ON at this time.']})}),u.jsxs("div",{className:"warning-details",children:[u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Current Time:"}),u.jsx("span",{className:"value",children:new Date().toLocaleTimeString()})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Schedule:"}),u.jsx("span",{className:"value",children:pe.schedule?.time||"No schedule"})]}),u.jsxs("div",{className:"warning-stat",children:[u.jsx("span",{className:"label",children:"Reason:"}),u.jsx("span",{className:"value",children:"Outside scheduled time"})]})]}),u.jsx("p",{className:"warning-message",children:F.reason}),u.jsx("div",{className:"modal-footer",children:u.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{ie(!1),E({isOpen:!1,device:null,reason:""})},children:"Understood"})})]})})};return d?u.jsx("div",{className:"active-device-container",children:u.jsxs("div",{className:"loading-container",children:[u.jsx("div",{className:"loading-spinner"}),u.jsx("p",{children:"Loading devices..."})]})}):u.jsxs("div",{className:"active-device-container",children:[u.jsxs("section",{className:"active-device-hero",children:[u.jsxs("div",{className:"hero-left",children:[u.jsx("div",{className:"hero-icon","aria-hidden":"true",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z",stroke:"#ffffff",strokeWidth:"2"})]})}),u.jsxs("div",{className:"hero-text",children:[u.jsx("h1",{children:"Active Devices"}),u.jsx("p",{children:"Monitor and manage your connected devices"})]})]}),u.jsx("div",{className:"search-container",children:u.jsxs("div",{className:"search-input-wrapper",children:[u.jsxs("svg",{className:"search-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8",stroke:"#9ca3af",strokeWidth:"2"}),u.jsx("path",{d:"m21 21-4.35-4.35",stroke:"#9ca3af",strokeWidth:"2",strokeLinecap:"round"})]}),u.jsx("input",{type:"text",placeholder:"Search device",value:s,onChange:pe=>o(pe.target.value),className:"search-input"})]})})]}),u.jsx("section",{className:"active-device-content",children:u.jsxs("div",{className:"table-container",children:[u.jsxs("table",{className:"devices-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:"OUTLET NAME"}),u.jsx("th",{children:"APPLIANCES"}),u.jsx("th",{children:"OFFICE/ ROOM"}),u.jsx("th",{children:"POWER USAGE"}),u.jsx("th",{children:"STATUS"}),u.jsx("th",{children:"TODAY'S USAGE"}),u.jsx("th",{children:"CURRENT (A)"}),u.jsx("th",{children:"SCHEDULE"}),u.jsx("th",{children:"ACTION"})]})}),u.jsx("tbody",{children:_t.map(pe=>u.jsxs("tr",{className:"device-row",children:[u.jsx("td",{className:"device-id",children:pe.id}),u.jsx("td",{className:"outlet-name",children:u.jsx("button",{className:"outlet-name-btn",onClick:()=>{Y||(ie(!0),I({isOpen:!0,device:pe}),Ce(pe))},disabled:Y,title:"View outlet history",children:pe.outletName})}),u.jsx("td",{className:"appliances",children:pe.appliances}),u.jsx("td",{className:"office-room",children:pe.officeRoom}),u.jsx("td",{className:"power-usage",children:pe.powerUsage}),u.jsx("td",{className:"status-cell",children:Ve(pe.status)}),u.jsx("td",{className:"today-usage",children:pe.todayUsage}),u.jsx("td",{className:"current-ampere",children:pe.currentAmpere}),u.jsx("td",{className:"schedule-cell",children:u.jsxs("div",{className:"schedule-info",children:[u.jsx("span",{className:"schedule-time",children:pe.schedule.time}),pe.schedule.days!=="No schedule"&&We(pe.schedule.days)]})}),u.jsx("td",{className:"action-cell",children:u.jsxs("label",{className:`${tt(pe)} ${O.has(pe.id)?"loading":""}`,children:[u.jsx("input",{type:"checkbox",checked:pe.status==="Active",onChange:()=>Ne(pe.id),className:"toggle-input",disabled:O.has(pe.id)||Y}),u.jsx("span",{className:"toggle-slider"})]})})]},pe.id))})]}),_t.length===0&&u.jsxs("div",{className:"no-devices",children:[u.jsx("div",{className:"no-devices-icon",children:u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#9ca3af",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z",stroke:"#9ca3af",strokeWidth:"2"})]})}),u.jsx("h3",{children:"No devices found"}),u.jsxs("p",{children:['No devices match your search criteria "',s,'"']})]})]})}),u.jsx(UW,{successModal:p,setModalOpen:ie,setSuccessModal:v}),u.jsx(lt,{}),u.jsx($e,{}),u.jsx(FW,{bypassModal:$,setModalOpen:ie,setBypassModal:X,toggleDeviceStatus:Ne,userRole:e}),T.isOpen&&u.jsx("div",{className:"modal-overlay",onClick:()=>{ie(!1),C({isOpen:!1,device:null})},children:u.jsxs("div",{className:"modal-content power-limit-modal",onClick:pe=>pe.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("div",{className:"modal-icon warning",children:u.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",fill:"#f59e0b"})]})}),u.jsx("h3",{children:"Power Limit Exceeded!"}),u.jsx("button",{type:"button",className:"modal-close",onClick:()=>{ie(!1),C({isOpen:!1,device:null})},"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("p",{children:[u.jsxs("strong",{children:['"',T.device?.outletName,'"']})," cannot be turned ON because today's energy consumption has exceeded the power limit."]}),u.jsxs("div",{className:"power-limit-details",children:[u.jsxs("div",{className:"limit-stat",children:[u.jsx("span",{className:"label",children:"Today's Energy:"}),u.jsxs("span",{className:"value",children:[t(T.device?.todayTotalEnergy*1e3||0)," Wh"]})]}),u.jsxs("div",{className:"limit-stat",children:[u.jsx("span",{className:"label",children:"Power Limit:"}),u.jsxs("span",{className:"value",children:[T.device?.powerLimit*1e3||"0"," Wh"]})]}),u.jsxs("div",{className:"limit-stat",children:[u.jsx("span",{className:"label",children:"Date:"}),u.jsx("span",{className:"value",children:T.device?.currentDate||new Date().toLocaleDateString()})]}),u.jsxs("div",{className:"limit-stat",children:[u.jsx("span",{className:"label",children:"Time:"}),u.jsx("span",{className:"value",children:T.device?.currentTime||new Date().toLocaleTimeString()})]})]}),u.jsx("p",{className:"warning-message",children:"Today's total energy consumption has reached or exceeded the daily power limit. The device cannot be activated until tomorrow or the power limit is increased."})]}),u.jsx("div",{className:"modal-footer",children:u.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{ie(!1),C({isOpen:!1,device:null})},children:"Understood"})})]})}),A.isOpen&&A.device&&u.jsx("div",{className:"modal-overlay",onClick:()=>{ie(!1),I({isOpen:!1,device:null})},children:u.jsxs("div",{className:"modal-content history-modal",onClick:pe=>pe.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("div",{className:"modal-icon history",children:u.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#dbeafe",stroke:"#3b82f6",strokeWidth:"2"}),u.jsx("polyline",{points:"12,6 12,12 16,14",stroke:"#3b82f6",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("h3",{children:"Outlet History"}),u.jsx("button",{type:"button",className:"modal-close",onClick:()=>{ie(!1),I({isOpen:!1,device:null})},"aria-label":"Close modal",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{className:"device-info",children:[u.jsx("h4",{children:A.device.outletName}),u.jsxs("div",{className:"device-details",children:[u.jsx("span",{className:"appliance-type",children:A.device.appliances}),u.jsx("span",{className:"separator",children:"•"}),u.jsx("span",{className:"office-room",children:A.device.officeRoom})]})]}),u.jsxs("div",{className:"time-segment-filter",children:[u.jsx("label",{children:"Filter by:"}),u.jsxs("div",{className:"time-segments",children:[u.jsx("button",{className:`segment-btn ${ee==="Day"?"active":""}`,onClick:()=>{G("Day"),Ce(A.device)},children:"Day"}),u.jsx("button",{className:`segment-btn ${ee==="Week"?"active":""}`,onClick:()=>{G("Week"),Ce(A.device)},children:"Week"}),u.jsx("button",{className:`segment-btn ${ee==="Month"?"active":""}`,onClick:()=>{G("Month"),Ce(A.device)},children:"Month"}),u.jsx("button",{className:`segment-btn ${ee==="Year"?"active":""}`,onClick:()=>{G("Year"),Ce(A.device)},children:"Year"})]})]}),u.jsxs("div",{className:"history-summary",children:[u.jsxs("div",{className:"summary-card",children:[u.jsx("div",{className:"summary-icon energy",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),u.jsxs("div",{className:"summary-content",children:[u.jsx("div",{className:"summary-label",children:"Total Energy"}),u.jsxs("div",{className:"summary-value",children:[t(R.totalEnergy*1e3)," Wh"]})]})]}),u.jsxs("div",{className:"summary-card",children:[u.jsx("div",{className:"summary-icon cost",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("polyline",{points:"14,2 14,8 20,8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsxs("div",{className:"summary-content",children:[u.jsx("div",{className:"summary-label",children:"Total Cost"}),u.jsxs("div",{className:"summary-value",children:["₱",t(R.totalCost,2)]})]})]})]}),u.jsx("div",{className:"history-table-container",children:u.jsxs("table",{className:"history-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"Energy (Wh)"}),u.jsx("th",{children:"Cost (₱)"})]})}),u.jsx("tbody",{children:R.dailyData.length>0?R.dailyData.map((pe,be)=>u.jsxs("tr",{children:[u.jsx("td",{className:"date-cell",children:new Date(pe.date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),u.jsx("td",{className:"energy-cell",children:t(pe.energy*1e3)}),u.jsxs("td",{className:"cost-cell",children:["₱",t(pe.cost,2)]})]},be)):u.jsx("tr",{children:u.jsx("td",{colSpan:3,className:"no-data",children:"No data available for the selected time period"})})})]})}),u.jsxs("div",{className:"rate-info",children:[u.jsx("div",{className:"rate-label",children:"Electricity Rate:"}),u.jsxs("div",{className:"rate-value",children:["₱",t(K,2)," per kWh"]}),le&&u.jsxs("div",{className:"rate-update",style:{fontSize:"10px",marginTop:"4px",opacity:.7},children:["Last updated: ",le]})]})]}),u.jsx("div",{className:"modal-footer",children:u.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{ie(!1),I({isOpen:!1,device:null})},children:"Close"})})]})})]})}function WW(){const[n,e]=me.useState(!1),[t,i]=me.useState("User"),[s,o]=me.useState("Coordinator"),[l,c]=me.useState("login"),[d,f]=me.useState("dashboard"),[p,v]=me.useState(!0),[_,b]=me.useState(!1),[T,C]=me.useState(!1),[A,I]=me.useState([]);me.useEffect(()=>{const Y=()=>{const ie=window.innerWidth<=768;b(ie),v(!ie)};return Y(),window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]);const ee=(Y,ie)=>{const re=Date.now()-600*1e3,V=A.filter(W=>W.outletName===Y&&W.title===ie&&W.timestamp.getTime()>re),se=V.length===0;return console.log(`🔍 Should create notification for ${Y} - ${ie}: ${se} (recent count: ${V.length})`),se},G=(Y,ie)=>{try{const q=new Date,re=q.getFullYear(),V=q.getMonth()+1,se=new Date(re,V,0).getDate();let W=0;return ie.forEach(te=>{const j=Y[te];if(j&&j.daily_logs)for(let U=1;U<=se;U++){const $=`day_${re}_${String(V).padStart(2,"0")}_${String(U).padStart(2,"0")}`,X=j.daily_logs[$];X&&X.total_energy&&(W+=X.total_energy)}}),W*1e3}catch(q){return console.error("Error calculating combined monthly energy:",q),0}},K=async(Y,ie)=>{try{if(!ie.enabled||ie.selectedOutlets.length===0)return;const q=G(Y,ie.selectedOutlets),re=ie.combinedLimit;if(console.log("Global monthly limit check:",{totalMonthlyEnergy:q,combinedLimitWatts:re,selectedOutlets:ie.selectedOutlets}),q>=re){console.log("Global combined monthly limit exceeded! Following hierarchy: remove from group first.");try{const V=Me(je,"combined_limit_settings");if((await Pt(V)).exists()){const W=[];for(const te of ie.selectedOutlets){const j=te.replace("_"," ");console.log(`Global: Attempting to remove ${j} from combined group due to monthly limit exceeded`)}await Kt(V,{selected_outlets:W,enabled:W.length>0}),console.log("Global: Successfully removed all devices from combined group. Individual daily limits now control these devices.");for(const te of ie.selectedOutlets){const j=Y[te];if(j){const U=j.relay_control?.auto_cutoff?.power_limit||0;if(U>0){const $=new Date,X=`day_${$.getFullYear()}_${String($.getMonth()+1).padStart(2,"0")}_${String($.getDate()).padStart(2,"0")}`;if((j?.daily_logs?.[X]?.total_energy||0)>=U)try{const Ae=Me(je,`devices/${te}/control`);await Kt(Ae,{device:"off"}),console.log(`Global: Turned off device ${te} due to BOTH monthly and individual daily limits exceeded`)}catch(Ae){console.error(`Error turning off device ${te}:`,Ae)}else console.log(`Global: Device ${te} monthly limit exceeded but individual daily limit OK - keeping device on`)}}}}}catch(V){console.error("Error removing devices from combined group:",V),console.log("Global: Fallback - turning off all devices in combined group");for(const se of ie.selectedOutlets)try{const W=Me(je,`devices/${se}/control`);await Kt(W,{device:"off"}),console.log(`Global: Turned off device ${se} due to combined monthly limit (fallback)`)}catch(W){console.error(`Error turning off device ${se}:`,W)}}}}catch(q){console.error("Error checking combined monthly limit:",q)}};me.useEffect(()=>{console.log("🔔 Notification state updated:",{count:A.length,unread:A.filter(Y=>!Y.isRead).length,notifications:A.map(Y=>({id:Y.id,title:Y.title,isRead:Y.isRead}))})},[A]);const de=Y=>{console.log("🔔 Notification clicked:",Y),console.log("🔔 NavigateTo:",Y.navigateTo),Y.navigateTo?(f(Y.navigateTo),C(!1),console.log(`🔔 Navigated to ${Y.navigateTo} for notification:`,Y.title),console.log("🔔 Notification will auto-disappear when issue is resolved")):console.log("🔔 No navigation data for notification:",Y.title)},le=async()=>{try{const Y=Me(je,"devices"),ie=await Pt(Y);if(!ie.exists())return;const q=ie.val(),re=[];console.log(`🔍 Checking ${Object.keys(q).length} devices for notifications...`),Object.keys(q).forEach(V=>{const se=q[V],W=V.replace("_"," "),te=(se.control?.device||"off").toString().trim().toLowerCase();if(console.log(`🔍 Device ${W}: state=${te}, hasSchedule=${!!se.schedule}`),te==="off"&&se.schedule&&se.schedule.timeRange&&se.schedule.timeRange!=="No schedule"){const j=new Date,U=j.getHours()*60+j.getMinutes();console.log(`📅 Checking schedule for ${W}: ${se.schedule.timeRange}`);const[$,X]=se.schedule.timeRange.split(" - "),Q=Be=>{const[Fe,Ct]=Be.split(" "),[at,Ce]=Fe.split(":").map(Number);return Ct==="PM"&&at!==12?(at+12)*60+Ce:Ct==="AM"&&at===12?Ce:at*60+Ce},ye=Q($),Ae=Q(X);console.log(`⏰ Time check for ${W}: current=${Math.floor(U/60)}:${String(U%60).padStart(2,"0")}, schedule=${$}-${X}`);const De=U<ye||U>Ae;console.log(`📊 ${W}: isOutsideSchedule=${De}, shouldCreate=${ee(W,"Device Turned Off (Time Limit)")}`),De&&ee(W,"Device Turned Off (Time Limit)")&&(console.log(`🔔 Creating real-time notification for ${W} (off, outside schedule)`),re.push({id:`realtime_off_${V}_${Date.now()}`,type:"device_off",title:"Device Turned Off (Time Limit)",message:`${W} was turned off because it's outside its scheduled time (${se.schedule.timeRange}). Current time: ${j.toLocaleTimeString()}`,outletName:W,timestamp:new Date,isRead:!1,navigateTo:"schedule",deviceId:V}))}if(se.relay_control?.auto_cutoff?.power_limit){const j=se.relay_control.auto_cutoff.power_limit,U=new Date,$=`day_${U.getFullYear()}_${String(U.getMonth()+1).padStart(2,"0")}_${String(U.getDate()).padStart(2,"0")}`,Q=se?.daily_logs?.[$]?.total_energy||0;console.log(`⚡ Power check for ${W}: limit=${j}kW, current=${Q}kW`),Q>=j&&ee(W,"Device Auto-Turned Off (Power Limit)")&&(console.log(`🔔 Creating power limit notification for ${W}`),re.push({id:`power_limit_${V}_${Date.now()}`,type:"device_off",title:"Device Auto-Turned Off (Power Limit)",message:`${W} was automatically turned off because today's energy consumption (${Q.toFixed(3)}kW) exceeded the power limit (${j}kW)`,outletName:W,timestamp:new Date,isRead:!1,navigateTo:"setup",deviceId:V}))}}),console.log(`📊 Found ${re.length} new notifications to create`),I(V=>{const se=V,W=[...se];return re.forEach(te=>{se.some(U=>U.outletName===te.outletName&&U.title===te.title&&Math.abs(U.timestamp.getTime()-te.timestamp.getTime())<3e5)?console.log(`⚠️ Skipping duplicate notification: ${te.title} for ${te.outletName}`):(console.log(`✅ Adding new notification: ${te.title} for ${te.outletName}`),W.push(te))}),W.filter(te=>{if(!te.navigateTo||!te.deviceId)return!0;const j=q[te.deviceId];if(!j)return!0;const U=(j.control?.device||"off").toString().trim().toLowerCase(),$=j.schedule,X=j.relay_control?.auto_cutoff?.power_limit||0,Q=new Date,ye=`day_${Q.getFullYear()}_${String(Q.getMonth()+1).padStart(2,"0")}_${String(Q.getDate()).padStart(2,"0")}`,De=j?.daily_logs?.[ye]?.total_energy||0;if(te.title==="Device Turned Off (Time Limit)"||te.type==="device_off"&&te.navigateTo==="schedule"){let Be=!1,Fe="";if(!$||$.timeRange==="No schedule")Be=!0,Fe="Schedule has been removed";else if(U==="on")Be=!0,Fe="Device is now ON";else{const Ct=new Date,at=Ct.getHours()*60+Ct.getMinutes();console.log(`🔍 Checking schedule resolution for ${te.outletName}:`),console.log(`   Current time: ${Ct.toLocaleTimeString()} (${at} minutes)`),console.log(`   Schedule: ${$.timeRange}`),console.log(`   Control state: ${U}`);const[Ce,ce]=$.timeRange.split(" - "),_t=tt=>{const[lt,$e]=tt.split(" "),[pe,be]=lt.split(":").map(Number);return $e==="PM"&&pe!==12?(pe+12)*60+be:$e==="AM"&&pe===12?be:pe*60+be},Ne=_t(Ce),Ve=_t(ce);console.log(`   Start time: ${Ce} (${Ne} minutes)`),console.log(`   End time: ${ce} (${Ve} minutes)`);let We=!1;Ve>=Ne?(We=at>=Ne&&at<=Ve,console.log(`   Normal schedule: ${We}`)):(We=at>=Ne||at<=Ve,console.log(`   Midnight span schedule: ${We}`)),We?(Be=!0,Fe="Device is now within scheduled time",console.log(`✅ Schedule resolution detected: ${Fe}`)):console.log(`❌ Still outside schedule: current=${at}, start=${Ne}, end=${Ve}`)}return Be&&console.log(`✅ Auto-resolved schedule notification for ${te.outletName}: ${Fe}`),!Be}if(te.title==="Device Auto-Turned Off (Power Limit)"||te.type==="device_off"&&te.navigateTo==="setup"){let Be=!1,Fe="";return X===0?(Be=!0,Fe="Power limit has been removed"):U==="on"?(Be=!0,Fe="Device is now ON"):De<X*.8&&(Be=!0,Fe=`Energy consumption (${De.toFixed(3)}kW) is now below 80% of limit (${X}kW)`),Be&&console.log(`✅ Auto-resolved power limit notification for ${te.outletName}: ${Fe}`),!Be}if(te.type==="power_limit"){const Be=X===0||De<X*.8;return Be&&console.log(`✅ Auto-resolved power limit notification for ${te.outletName}`),!Be}if(te.type==="schedule_conflict"){const Be=U==="off"||!$||$.timeRange==="No schedule";return Be&&console.log(`✅ Auto-resolved schedule conflict notification for ${te.outletName}`),!Be}return!0})})}catch(Y){console.error("Error checking notification resolution:",Y)}},[z,R]=me.useState(!1),[D,F]=me.useState(null),[E,O]=me.useState({}),M=me.useMemo(()=>{const Y=new Date,ie=String(Y.getMonth()+1).padStart(2,"0"),q=String(Y.getDate()).padStart(2,"0"),re=Y.getFullYear();return`${ie}/${q}/${re}`},[n]);return me.useEffect(()=>{const Y=()=>{const ie=window.innerWidth<=768;b(ie),ie||v(!1)};return Y(),window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]),me.useEffect(()=>{console.log("Setting up Firebase auth state listener...");const Y=tD(Nr,ie=>{console.log("Firebase auth state changed:",ie?"User logged in":"User logged out"),console.log("User details:",ie?{uid:ie.uid,email:ie.email,displayName:ie.displayName}:"No user"),!ie&&n&&(console.log("⚠️ Firebase says user is logged out but local state says authenticated - syncing..."),e(!1),c("login"),i("User"),o("Coordinator"),f("dashboard"))});return()=>{console.log("Cleaning up Firebase auth state listener..."),Y()}},[n]),me.useEffect(()=>{if(!n)return;console.log("🔔 Setting up real-time notification listener...");const Y=Me(je,"devices");console.log("🔥 Testing Firebase connection..."),console.log("🔥 Firebase config:",je.app.options);let ie=!0;const q=setInterval(()=>{console.log("⏰ Periodic notification check..."),le()},1e4),re=Go(Y,async V=>{console.log("📡 Firebase data updated, checking for notifications..."),R(!0),F(new Date),console.log("🔗 Firebase connection status: CONNECTED"),console.log("⏰ Last update time:",new Date().toLocaleTimeString()),console.log("🔄 Forcing immediate notification check..."),setTimeout(()=>{le()},100);try{const j=Me(je,"combined_limit_settings"),U=await Pt(j);if(U.exists()){const $=U.val(),X={enabled:$.enabled||!1,selectedOutlets:$.selectedOutlets||[],combinedLimit:$.combinedLimit||0};if(X.enabled&&X.selectedOutlets.length>0){const Q=V.val();Q&&(console.log("🌙 Global monthly limit check triggered by Firebase data change"),await K(Q,X))}}}catch(j){console.error("Error checking combined monthly limits:",j)}const se=V.val();if(!se){console.log("⚠️ No data received from Firebase");return}if(ie){console.log("🔄 First load - initializing device states and checking for auto-turn-offs");const j={};Object.keys(se).forEach(U=>{const X=(se[U].control?.device||"off").toString().trim().toLowerCase();j[U]=X}),O(j),ie=!1,console.log("🔄 Initial states set:",j),console.log("🔍 Checking for existing auto-turn-offs on first load...")}const W=[];console.log(`🔍 Checking ${Object.keys(se).length} outlets for notifications...`),console.log("📊 Raw Firebase data:",se),console.log("📊 Previous device states:",E),Object.keys(se).forEach(j=>{const U=se[j],$=j.replace("_"," ");console.log(`🔌 Processing ${$}:`,U);const X=U.relay_control?.auto_cutoff?.power_limit||0,Q=(U.control?.device||"off").toString().trim().toLowerCase(),ye=U.relay_control?.main_status||"ON",Ae=new Date,De=`day_${Ae.getFullYear()}_${String(Ae.getMonth()+1).padStart(2,"0")}_${String(Ae.getDate()).padStart(2,"0")}`,Fe=U.daily_logs?.[De]?.total_energy||0;if(console.log(`🔌 ${$}: Today's Energy=${Fe.toFixed(3)}kW, Limit=${X}kW, Control=${Q}, Main=${ye}`),X>0){const Ce=Fe>=X,ce=Fe>=X*.8&&Fe<X;console.log(`⚠️ Power limit check for ${$}:`,{powerLimit:`${X}kW`,todayTotalEnergy:`${Fe}kW`,controlState:Q,mainStatus:ye,isExceeded:Ce,isNearLimit:ce}),Ce&&ee($,"Device Auto-Turned Off (Power Limit)")?(console.log(`🔌 Device ${$} power limit exceeded - generating notification`),W.push({id:`power_exceeded_${j}`,type:"device_off",title:"Device Auto-Turned Off (Power Limit)",message:`${$} was automatically turned off because today's energy consumption (${Fe.toFixed(3)}kW) exceeded the power limit (${X}kW)`,outletName:$,timestamp:new Date,isRead:!1,navigateTo:"setup",deviceId:j})):Q==="on"&&ce&&ee($,"Power Limit Warning")&&(console.log(`⚠️ Device ${$} is ON and approaching power limit`),W.push({id:`power_warning_${j}`,type:"power_limit",title:"Power Limit Warning",message:`${$} is approaching its daily power limit of ${X}kW. Today's consumption: ${Fe.toFixed(3)}kW`,outletName:$,timestamp:new Date,isRead:!1,navigateTo:"setup",deviceId:j}))}if(U.schedule){const Ce=U.schedule;if(Ce.timeRange&&Ce.timeRange!=="No schedule"){const ce=new Date,_t=ce.getHours()*60+ce.getMinutes(),Ne=ce.getDay(),[Ve,We]=Ce.timeRange.split(" - "),tt=qe=>{const[Ue,Xe]=qe.split(" "),[bt,qt]=Ue.split(":").map(Number);return Xe==="PM"&&bt!==12?(bt+12)*60+qt:Xe==="AM"&&bt===12?qt:bt*60+qt},lt=tt(Ve),$e=tt(We),pe=_t>=lt&&_t<=$e,be=Ce.frequency?.toLowerCase()||"";let Se=!1;if(be==="daily")Se=!0;else if(be==="weekdays")Se=Ne>=1&&Ne<=5;else if(be==="weekends")Se=Ne===0||Ne===6;else if(be.includes(",")){const qe={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0};Se=be.split(",").map(Xe=>qe[Xe.trim().toLowerCase()]).includes(Ne)}const Ee=pe&&Se,Ye=!Ee;console.log(`📅 Schedule monitoring for ${$}:`,{currentTime:`${Math.floor(_t/60)}:${String(_t%60).padStart(2,"0")}`,startTime:`${Math.floor(lt/60)}:${String(lt%60).padStart(2,"0")}`,endTime:`${Math.floor($e/60)}:${String($e%60).padStart(2,"0")}`,scheduleTimeRange:Ce.timeRange,frequency:be,currentDay:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][Ne],isCorrectDay:Se,isWithinTimeRange:pe,shouldBeActive:Ee,controlState:Q,previousState:E[j]}),Ye?(console.log(`📅 Schedule violation detected for ${$}: Outside ${Ce.timeRange} (Current: ${Math.floor(_t/60)}:${String(_t%60).padStart(2,"0")})`),Q==="on"&&ee($,"Schedule Conflict")?W.push({id:`schedule_conflict_${j}`,type:"schedule_conflict",title:"Schedule Conflict",message:`${$} is running outside its scheduled time (${Ce.timeRange}). Consider turning it off.`,outletName:$,timestamp:new Date,isRead:!1,navigateTo:"schedule",deviceId:j}):ee($,"Device Auto-Turned Off (Time Limit)")&&W.push({id:`schedule_auto_off_${j}`,type:"device_off",title:"Device Auto-Turned Off (Time Limit)",message:`${$} was automatically turned off because it's outside its scheduled time (${Ce.timeRange}). Current time: ${ce.toLocaleTimeString()}`,outletName:$,timestamp:new Date,isRead:!1,navigateTo:"schedule",deviceId:j})):E[j]==="on"&&Q==="off"&&Ye&&(console.log(`🔌 Proactive schedule turn-off detection: ${$} was likely turned off due to schedule violation`),W.push({id:`schedule_off_${j}_${Date.now()}`,type:"device_off",title:"Device Auto-Turned Off (Schedule)",message:`${$} was automatically turned off because it's outside its scheduled time (${Ce.timeRange}). Current time: ${ce.toLocaleTimeString()}`,outletName:$,timestamp:new Date,isRead:!1,navigateTo:"schedule",deviceId:j}))}}if(U.schedule&&U.schedule.timeRange&&U.schedule.timeRange!=="No schedule"){const Ce=new Date,ce=Ce.getHours()*60+Ce.getMinutes(),_t=Ce.getDay(),[Ne,Ve]=U.schedule.timeRange.split(" - "),We=Ye=>{const[qe,Ue]=Ye.split(" "),[Xe,bt]=qe.split(":").map(Number);return Ue==="PM"&&Xe!==12?(Xe+12)*60+bt:Ue==="AM"&&Xe===12?bt:Xe*60+bt},tt=We(Ne),lt=We(Ve),$e=ce>=tt&&ce<=lt,pe=U.schedule.frequency?.toLowerCase()||"";let be=!1;if(pe==="daily")be=!0;else if(pe==="weekdays")be=_t>=1&&_t<=5;else if(pe==="weekends")be=_t===0||_t===6;else if(pe.includes(",")){const Ye={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0};be=pe.split(",").map(Ue=>Ye[Ue.trim().toLowerCase()]).includes(_t)}!($e&&be)&&(console.log(`🔌 Device ${$} time limit violation detected (outside schedule)`),Q==="off"?W.push({id:`time_limit_off_${j}`,type:"device_off",title:"Device Turned Off (Time Limit)",message:`${$} was turned off because it's outside its scheduled time (${U.schedule.timeRange}). Current time: ${Ce.toLocaleTimeString()}`,outletName:$,timestamp:new Date,isRead:!1,navigateTo:"schedule",deviceId:j}):Q==="on"&&W.push({id:`time_limit_conflict_${j}`,type:"schedule_conflict",title:"Time Limit Conflict",message:`${$} is running outside its scheduled time (${U.schedule.timeRange}). Current time: ${Ce.toLocaleTimeString()}`,outletName:$,timestamp:new Date,isRead:!1,navigateTo:"schedule",deviceId:j}))}const Ct=(Ce,ce)=>{const _t=new Date,Ne=_t.getHours()*60+_t.getMinutes(),Ve=_t.getDay();if(X>0&&Fe>=X)return{cause:"power_limit",title:"Device Auto-Turned Off (Power Limit)",message:`${ce} was automatically turned off because today's energy consumption (${Fe.toFixed(3)}kW) exceeded the power limit (${X}kW)`,details:{powerLimit:X,todayEnergy:Fe,exceeded:!0}};if(Ce.schedule&&Ce.schedule.timeRange&&Ce.schedule.timeRange!=="No schedule"){const[We,tt]=Ce.schedule.timeRange.split(" - "),lt=Ue=>{const[Xe,bt]=Ue.split(" "),[qt,fe]=Xe.split(":").map(Number);return bt==="PM"&&qt!==12?(qt+12)*60+fe:bt==="AM"&&qt===12?fe:qt*60+fe},$e=lt(We),pe=lt(tt),be=Ne>=$e&&Ne<=pe,Se=Ce.schedule.frequency?.toLowerCase()||"";let Ee=!1;if(Se==="daily")Ee=!0;else if(Se==="weekdays")Ee=Ve>=1&&Ve<=5;else if(Se==="weekends")Ee=Ve===0||Ve===6;else if(Se.includes(",")){const Ue={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0};Ee=Se.split(",").map(bt=>Ue[bt.trim().toLowerCase()]).includes(Ve)}const Ye=be&&Ee,qe=!Ye;if(console.log(`🕐 Time checker for ${ce}:`,{currentTime:`${Math.floor(Ne/60)}:${String(Ne%60).padStart(2,"0")}`,startTime:`${Math.floor($e/60)}:${String($e%60).padStart(2,"0")}`,endTime:`${Math.floor(pe/60)}:${String(pe%60).padStart(2,"0")}`,scheduleTimeRange:Ce.schedule.timeRange,frequency:Se,currentDay:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][Ve],isCorrectDay:Ee,isWithinTimeRange:be,shouldBeActive:Ye,isOutsideSchedule:qe}),qe)return{cause:"schedule",title:"Device Auto-Turned Off (Schedule)",message:`${ce} was automatically turned off because it's outside its scheduled time (${Ce.schedule.timeRange}). Current time: ${_t.toLocaleTimeString()}`,details:{scheduleTimeRange:Ce.schedule.timeRange,frequency:Se,currentTime:_t.toLocaleTimeString(),isOutsideSchedule:!0,timeDetails:{current:`${Math.floor(Ne/60)}:${String(Ne%60).padStart(2,"0")}`,start:`${Math.floor($e/60)}:${String($e%60).padStart(2,"0")}`,end:`${Math.floor(pe/60)}:${String(pe%60).padStart(2,"0")}`}}}}return{cause:"manual",title:"Device Turned Off",message:`${ce} has been turned off.`,details:{}}},at=E[j];if(console.log(`🔍 Checking ${$}: previous=${at}, current=${Q}`),at==="on"&&Q==="off"){console.log(`🔌 Device turned off: ${$} (was on, now off)`);const Ce=Ct(U,$);console.log(`🔍 Turn-off analysis for ${$}:`,Ce),W.push({id:`off_${j}_${Date.now()}`,type:"device_off",title:Ce.title,message:Ce.message,outletName:$,timestamp:new Date,isRead:!1})}if(U.schedule&&U.schedule.timeRange&&U.schedule.timeRange!=="No schedule"){const Ce=new Date,ce=Ce.getHours()*60+Ce.getMinutes(),[_t,Ne]=U.schedule.timeRange.split(" - "),Ve=$e=>{const[pe,be]=$e.split(" "),[Se,Ee]=pe.split(":").map(Number);return be==="PM"&&Se!==12?(Se+12)*60+Ee:be==="AM"&&Se===12?Ee:Se*60+Ee},We=Ve(_t),tt=Ve(Ne),lt=ce>=We&&ce<=tt;Q==="off"&&lt&&at==="off"&&(console.log(`🔌 Proactive schedule turn-on detection: ${$} should be on according to schedule`),W.push({id:`schedule_on_${j}_${Date.now()}`,type:"device_on",title:"Device Should Be On (Schedule)",message:`${$} should be turned on according to its schedule (${U.schedule.timeRange}). Current time: ${Ce.toLocaleTimeString()}`,outletName:$,timestamp:new Date,isRead:!1}))}else if(at==="off"&&Q==="on"&&(console.log(`🔌 Device turned on: ${$} (was off, now on)`),U.schedule&&U.schedule.timeRange&&U.schedule.timeRange!=="No schedule")){const Ce=new Date,ce=Ce.getHours()*60+Ce.getMinutes(),[_t,Ne]=U.schedule.timeRange.split(" - "),Ve=lt=>{const[$e,pe]=lt.split(" "),[be,Se]=$e.split(":").map(Number);return pe==="PM"&&be!==12?(be+12)*60+Se:pe==="AM"&&be===12?Se:be*60+Se},We=Ve(_t),tt=Ve(Ne);ce>=We&&ce<=tt&&(console.log(`🔌 Auto turn-on due to schedule: ${$}`),W.push({id:`on_${j}_${Date.now()}`,type:"device_on",title:"Device Auto-Turned On (Schedule)",message:`${$} was automatically turned on because it's within its scheduled time (${U.schedule.timeRange}). Current time: ${Ce.toLocaleTimeString()}`,outletName:$,timestamp:new Date,isRead:!1}))}if((ie||at!==Q)&&Q==="off"&&U.schedule&&U.schedule.timeRange&&U.schedule.timeRange!=="No schedule"){const Ce=new Date,ce=Ce.getHours()*60+Ce.getMinutes(),[_t,Ne]=U.schedule.timeRange.split(" - "),Ve=$e=>{const[pe,be]=$e.split(" "),[Se,Ee]=pe.split(":").map(Number);return be==="PM"&&Se!==12?(Se+12)*60+Ee:be==="AM"&&Se===12?Ee:Se*60+Ee},We=Ve(_t),tt=Ve(Ne);(ce<We||ce>tt)&&(console.log(`🔔 Creating notification for ${$} (currently off, outside schedule)`),W.push({id:`current_off_${j}_${Date.now()}`,type:"device_off",title:"Device Turned Off (Time Limit)",message:`${$} was turned off because it's outside its scheduled time (${U.schedule.timeRange}). Current time: ${Ce.toLocaleTimeString()}`,outletName:$,timestamp:new Date,isRead:!1,navigateTo:"schedule",deviceId:j}))}}),I(j=>{console.log(`📊 Processing notifications: ${W.length} new, ${j.length} existing`);const U=new Set(W.map(De=>De.id)),$=j.filter(De=>{if(U.has(De.id))return console.log(`✅ Keeping active notification: ${De.title} for ${De.outletName}`),!0;if(De.type==="device_off"){const Be=new Date(Date.now()-3e5),Fe=De.timestamp>Be;return Fe||console.log(`🗑️ Removing old device_off notification: ${De.outletName}`),Fe}return console.log(`🗑️ Removing resolved notification: ${De.title} for ${De.outletName}`),!1}),X=new Set($.map(De=>De.id)),Q=new Set($.map(De=>`${De.outletName}_${De.title}`)),ye=W.filter(De=>{if(X.has(De.id))return console.log(`⚠️ Duplicate ID prevented: ${De.title} for ${De.outletName}`),!1;const Be=`${De.outletName}_${De.title}`;if(Q.has(Be))return console.log(`⚠️ Duplicate content prevented: ${De.title} for ${De.outletName}`),!1;const Fe=new Date(Date.now()-120*1e3);return $.some(at=>at.outletName===De.outletName&&at.title===De.title&&at.timestamp>Fe)?(console.log(`⚠️ Recent similar notification prevented: ${De.title} for ${De.outletName}`),!1):(console.log(`➕ Adding new notification: ${De.title} for ${De.outletName}`),!0)}),Ae=[...ye,...$].slice(0,50);return console.log(`📋 Final notification count: ${Ae.length} (${ye.length} new, ${$.length} kept)`),Ae.length!==j.length&&console.log(`🔄 Notification count changed: ${j.length} → ${Ae.length}`),Ae});const te={};Object.keys(se).forEach(j=>{const $=(se[j].control?.device||"off").toString().trim().toLowerCase();te[j]=$}),O(te)});return window.testNotification=()=>{console.log("🧪 Testing notification system..."),I(V=>[...V,{id:`test_${Date.now()}`,type:"device_off",title:"Test Notification",message:"This is a test notification to verify the system is working.",outletName:"Test Device",timestamp:new Date,isRead:!1}])},window.testScheduleNotification=()=>{console.log("🧪 Testing schedule notification..."),I(V=>[...V,{id:`test_schedule_${Date.now()}`,type:"device_off",title:"Device Auto-Turned Off (Schedule)",message:"Outlet_1 was automatically turned off because it's outside its scheduled time (8:35 AM - 8:36 AM). Current time: 8:37 AM",outletName:"Outlet 1",timestamp:new Date,isRead:!1,navigateTo:"schedule",deviceId:"test_device"}])},window.testPowerNotification=()=>{console.log("🧪 Testing power limit notification..."),I(V=>[...V,{id:`test_power_${Date.now()}`,type:"device_off",title:"Device Auto-Turned Off (Power Limit)",message:"Outlet_1 was automatically turned off because today's energy consumption (2.500kW) exceeded the power limit (2.000kW)",outletName:"Outlet 1",timestamp:new Date,isRead:!1,navigateTo:"setup",deviceId:"test_device"}])},window.clearNotifications=()=>{console.log("🗑️ Clearing all notifications..."),I([])},window.removeDuplicates=()=>{console.log("🧹 Removing duplicate notifications..."),I(V=>{const se=[],W=new Set;return V.forEach(te=>{const j=`${te.outletName}_${te.title}`;W.has(j)?console.log(`🗑️ Removing duplicate: ${te.title} for ${te.outletName}`):(W.add(j),se.push(te))}),console.log(`📊 Removed ${V.length-se.length} duplicates, kept ${se.length} unique notifications`),se})},window.addTestNotification=()=>{console.log("🧪 Adding test notification...");const V={id:`test_${Date.now()}`,type:"device_off",title:"Test Notification",message:"This is a test notification to verify the system is working",outletName:"Test Outlet",timestamp:new Date,isRead:!1,navigateTo:"setup",deviceId:"test_device"};I(se=>{console.log("📝 Adding notification:",V),console.log("📝 Previous notifications:",se.length);const W=[...se,V];return console.log("📝 Updated notifications:",W.length),W})},window.debugDeviceStates=()=>{console.log("🔍 Current device states:",E),console.log("🔍 Current notifications:",A)},window.forceNotificationCheck=()=>{console.log("🔄 Forcing notification check..."),le()},window.forceResolveCheck=()=>{console.log("🔄 Forcing immediate notification resolution check..."),le()},window.forceRealtimeCheck=async()=>{console.log("🔄 Forcing real-time check...");try{const V=Me(je,"devices"),se=await Pt(V);if(se.exists()){const W=se.val();console.log("📊 Current Firebase data:",W),Object.keys(W).forEach(te=>{const j=W[te],U=(j.control?.device||"off").toString().trim().toLowerCase(),$=te.replace("_"," ");U==="off"&&j.schedule&&(console.log(`🔔 Creating notification for ${$} (off with schedule)`),I(X=>[...X,{id:`force_${te}_${Date.now()}`,type:"device_off",title:"Device Turned Off (Schedule)",message:`${$} was turned off because it's outside its scheduled time.`,outletName:$,timestamp:new Date,isRead:!1,navigateTo:"schedule",deviceId:te}]))})}}catch(V){console.error("❌ Error in force real-time check:",V)}},window.testDeviceStateChange=()=>{console.log("🧪 Testing device state change detection..."),le()},window.monitorNotifications=()=>{console.log("👀 Starting notification monitoring..."),setInterval(()=>{console.log(`📊 Current notifications: ${A.length}`),A.forEach(V=>{console.log(`  - ${V.title} for ${V.outletName} (${V.timestamp.toLocaleTimeString()})`)})},5e3)},window.checkAllDevices=async()=>{console.log("🔍 Checking all devices in Firebase...");try{const V=Me(je,"devices"),se=await Pt(V);if(se.exists()){const W=se.val();console.log("📊 All devices in Firebase:",W),Object.keys(W).forEach(te=>{const j=W[te],U=te.replace("_"," "),$=(j.control?.device||"off").toString().trim().toLowerCase();if(console.log(`
🔍 Device: ${U}`),console.log(`  - State: ${$}`),console.log(`  - Schedule: ${j.schedule?.timeRange||"None"}`),console.log(`  - Power Limit: ${j.relay_control?.auto_cutoff?.power_limit||"None"}kW`),j.daily_logs){const X=new Date,Q=`day_${X.getFullYear()}_${String(X.getMonth()+1).padStart(2,"0")}_${String(X.getDate()).padStart(2,"0")}`,ye=j.daily_logs[Q];console.log(`  - Today's Energy: ${ye?.total_energy||0}kW`)}})}else console.log("❌ No devices found in Firebase")}catch(V){console.error("❌ Error checking devices:",V)}},window.forceNotification=()=>{console.log("🔔 Forcing immediate notification..."),I(V=>[...V,{id:`force_${Date.now()}`,type:"device_off",title:"Immediate Test Notification",message:"This notification was triggered immediately to test real-time functionality.",outletName:"Test Device",timestamp:new Date,isRead:!1}])},window.testTimeChecker=(V="Outlet_1")=>{console.log("🕐 Testing time checker for:",V);const se=Me(je,`devices/${V}`);Pt(se).then(W=>{if(W.exists()){const te=W.val(),j=V.replace("_"," "),U=new Date,$=`day_${U.getFullYear()}_${String(U.getMonth()+1).padStart(2,"0")}_${String(U.getDate()).padStart(2,"0")}`,Q=te.daily_logs?.[$]?.total_energy||0,ye=te.relay_control?.auto_cutoff?.power_limit||0;console.log("📊 Device data:",{outletName:j,controlState:te.control?.device,mainStatus:te.relay_control?.main_status,powerLimit:`${ye}kW`,todayEnergy:`${Q}kW`,schedule:te.schedule});const Ae=new Date,De=Ae.getHours()*60+Ae.getMinutes(),Be=Ae.getDay();if(console.log("🕐 Current time analysis:",{currentTime:`${Math.floor(De/60)}:${String(De%60).padStart(2,"0")}`,currentDay:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][Be],timestamp:Ae.toLocaleString()}),te.schedule&&te.schedule.timeRange){const[Fe,Ct]=te.schedule.timeRange.split(" - "),at=Ne=>{const[Ve,We]=Ne.split(" "),[tt,lt]=Ve.split(":").map(Number);return We==="PM"&&tt!==12?(tt+12)*60+lt:We==="AM"&&tt===12?lt:tt*60+lt},Ce=at(Fe),ce=at(Ct),_t=De>=Ce&&De<=ce;console.log("📅 Schedule analysis:",{scheduleTimeRange:te.schedule.timeRange,startTime:`${Math.floor(Ce/60)}:${String(Ce%60).padStart(2,"0")}`,endTime:`${Math.floor(ce/60)}:${String(ce%60).padStart(2,"0")}`,isWithinTimeRange:_t,frequency:te.schedule.frequency})}}else console.log("❌ Device not found:",V)}).catch(W=>{console.error("❌ Error testing time checker:",W)})},le(),()=>{lr(Y,"value",re),clearInterval(q)}},[n]),me.useEffect(()=>{if(!n)return;console.log("🌙 Setting up global monthly limit monitoring...");const Y=async()=>{try{const q=Me(je,"combined_limit_settings"),re=await Pt(q);if(re.exists()){const V=re.val(),se={enabled:V.enabled||!1,selectedOutlets:V.selectedOutlets||[],combinedLimit:V.combinedLimit||0};if(se.enabled&&se.selectedOutlets.length>0){const W=Me(je,"devices"),te=await Pt(W);if(te.exists()){const j=te.val();console.log("🌙 Global monthly limit check (scheduled)"),await K(j,se)}}}}catch(q){console.error("Error in global monthly limit check:",q)}};Y();const ie=setInterval(Y,3e5);return window.testGlobalMonthlyLimits=Y,console.log("🌙 Global monthly limit monitoring active"),console.log("🌙 Manual test: window.testGlobalMonthlyLimits()"),()=>{clearInterval(ie)}},[n]),n?u.jsxs("div",{style:{display:"flex",minHeight:"100dvh"},children:[u.jsx(n7,{onLogout:async()=>{try{if(console.log("Starting logout process..."),console.log("Current auth state:",Nr.currentUser),console.log("Current local auth state:",{isAuthed:n,userName:t,userRole:s}),!Nr.currentUser){console.log("No authenticated user found, performing local logout only"),e(!1),c("login"),i("User"),o("Coordinator"),f("dashboard");return}console.log("Signing out from Firebase..."),await nD(Nr),console.log("Firebase signOut completed successfully"),console.log("Verifying logout - current user:",Nr.currentUser),e(!1),c("login"),i("User"),o("Coordinator"),f("dashboard"),console.log("Logout completed successfully")}catch(Y){console.error("Logout error:",Y),console.error("Error details:",{code:Y?.code,message:Y?.message,stack:Y?.stack}),console.log("Performing local logout despite Firebase error"),e(!1),c("login"),i("User"),o("Coordinator"),f("dashboard")}},onNavigate:Y=>f(Y),isOpen:p,onToggle:()=>v(!p),activeView:d==="userLogs"||d==="offices"?"users":d,userRole:s}),u.jsxs("main",{style:{flex:1,padding:16,position:"relative",paddingTop:80,marginLeft:_?0:"260px",transition:"margin-left 0.3s ease"},children:[_&&u.jsx("button",{onClick:()=>v(!p),style:{position:"absolute",top:24,left:24,zIndex:1001,background:"#052f66",border:"none",borderRadius:"8px",padding:"8px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":"Toggle menu",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M3 12h18M3 6h18M3 18h18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),u.jsxs("div",{style:{position:"absolute",top:24,right:_?16:24,display:"flex",alignItems:"center",gap:_?12:16,marginLeft:_?60:0,zIndex:1e3,flexWrap:"nowrap"},children:[u.jsxs("button",{style:{display:"inline-grid",placeItems:"center",width:_?32:36,height:_?32:36,background:"#0b3e86",color:"#ffffff",border:"none",borderRadius:"50%",cursor:"pointer",transition:"all 0.2s ease",position:"relative",flexShrink:0},onMouseEnter:Y=>{Y.currentTarget.style.background="#052f66",Y.currentTarget.style.color="#ffffff"},onMouseLeave:Y=>{Y.currentTarget.style.background="#0b3e86",Y.currentTarget.style.color="#ffffff"},onClick:()=>{C(!0)},onDoubleClick:()=>{console.log("🧪 Adding manual test notification"),I(Y=>{const ie={id:`manual_test_${Date.now()}`,type:"device_off",title:"Manual Test",message:"This is a manually triggered test notification.",outletName:"Test Device",timestamp:new Date,isRead:!1};console.log("🧪 Adding notification:",ie),console.log("🧪 Previous notifications count:",Y.length);const q=[...Y,ie];return console.log("🧪 New notifications count:",q.length),q})},"aria-label":"Notifications",title:"Notifications",children:[u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{transform:"translateX(-8px)"},children:[u.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),A.filter(Y=>!Y.isRead).length>0&&u.jsx("span",{style:{position:"absolute",top:"2px",right:"2px",width:"8px",height:"8px",background:"#ef4444",borderRadius:"50%",border:"2px solid white"}})]}),u.jsx("span",{style:{display:"inline-grid",placeItems:"center",width:_?32:36,height:_?32:36,background:"#0b3e86",color:"#fff",borderRadius:"50%",flexShrink:0},children:u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"8",r:"3.2",stroke:"currentColor",strokeWidth:"1.8"}),u.jsx("path",{d:"M4.5 20c1.8-3.5 5-5.3 7.5-5.3S17.7 16.5 19.5 20",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})]})}),u.jsxs("div",{style:{lineHeight:1},children:[u.jsx("div",{style:{fontWeight:800,color:"#0b3e86",fontSize:18},children:t||"User"}),u.jsx("div",{style:{fontSize:13,color:"#4b5563"},children:M})]})]}),d==="dashboard"&&u.jsx(bF,{onNavigate:Y=>f(Y)}),d==="setup"&&u.jsx(IF,{}),d==="schedule"&&u.jsx(HF,{}),d==="activeDevice"&&u.jsx(BW,{userRole:s}),d==="reports"&&u.jsx(RW,{}),(d==="users"||d==="userLogs"||d==="deviceLogs"||d==="offices")&&u.jsx(IW,{onNavigate:Y=>f(Y),currentView:d})]}),T&&u.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",zIndex:2e3,padding:"80px 24px 24px 24px"},onClick:()=>C(!1),children:u.jsxs("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 20px 25px rgba(0, 0, 0, 0.1)",width:"400px",maxHeight:"600px",overflow:"hidden",display:"flex",flexDirection:"column"},onClick:Y=>Y.stopPropagation(),children:[u.jsxs("div",{style:{padding:"20px 24px 16px 24px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[u.jsx("h3",{style:{margin:0,fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:"Notifications"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",color:z?"#10b981":"#ef4444"},children:[u.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:z?"#10b981":"#ef4444",animation:z?"pulse 2s infinite":"none"}}),z?"Live":"Disconnected"]})]}),u.jsx("button",{onClick:()=>C(!1),style:{background:"none",border:"none",fontSize:"20px",cursor:"pointer",color:"#6b7280",padding:"4px"},children:"×"})]}),u.jsx("div",{style:{flex:1,overflowY:"auto",maxHeight:"500px"},children:A.length===0?u.jsxs("div",{style:{padding:"40px 24px",textAlign:"center",color:"#6b7280"},children:[u.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{margin:"0 auto 16px auto",opacity:.5},children:[u.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),u.jsx("p",{style:{margin:0,fontSize:"14px"},children:"No notifications yet"})]}):A.map(Y=>u.jsx("div",{style:{padding:"16px 24px",borderBottom:"1px solid #f3f4f6",cursor:Y.navigateTo?"pointer":"default",backgroundColor:Y.isRead?"white":"#f8fafc",transition:"background-color 0.2s ease",opacity:Y.navigateTo?1:.7},onClick:()=>{Y.navigateTo&&de(Y)},onMouseEnter:ie=>{Y.navigateTo&&(ie.currentTarget.style.backgroundColor=Y.isRead?"#f3f4f6":"#e5e7eb")},onMouseLeave:ie=>{Y.navigateTo&&(ie.currentTarget.style.backgroundColor=Y.isRead?"white":"#f8fafc")},children:u.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[u.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,backgroundColor:Y.type==="power_limit"?"#fef2f2":Y.type==="schedule_conflict"?"#fef3c7":Y.type==="device_on"?"#f0fdf4":"#f3f4f6"},children:Y.type==="power_limit"?u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",stroke:"#dc2626",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):Y.type==="schedule_conflict"?u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("rect",{x:"3",y:"4",width:"18",height:"17",rx:"2",stroke:"#f59e0b",strokeWidth:"2"}),u.jsx("path",{d:"M8 2v4M16 2v4M3 9h18",stroke:"#f59e0b",strokeWidth:"2",strokeLinecap:"round"})]}):Y.type==="device_on"?u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"#10b981",strokeWidth:"2"}),u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"#10b981",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}):u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"#6b7280",strokeWidth:"2"}),u.jsx("path",{d:"M8 12h8",stroke:"#6b7280",strokeWidth:"2",strokeLinecap:"round"})]})}),u.jsxs("div",{style:{flex:1,minWidth:0},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[u.jsx("h4",{style:{margin:0,fontSize:"14px",fontWeight:"600",color:"#1f2937"},children:Y.title}),!Y.isRead&&u.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"#3b82f6"}})]}),u.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"13px",color:"#6b7280",lineHeight:"1.4"},children:Y.message}),u.jsxs("div",{style:{fontSize:"12px",color:"#9ca3af",marginTop:"8px"},children:[Y.timestamp.toLocaleTimeString()," • ",Y.outletName]}),Y.navigateTo&&u.jsx("div",{style:{marginTop:"12px",display:"flex",justifyContent:"flex-end"},children:u.jsxs("button",{onClick:ie=>{ie.stopPropagation(),console.log("🔔 Resolve button clicked for:",Y.title),de(Y)},style:{background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",padding:"8px 16px",fontSize:"12px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(59, 130, 246, 0.3)"},onMouseEnter:ie=>{ie.currentTarget.style.background="#2563eb",ie.currentTarget.style.transform="translateY(-2px)",ie.currentTarget.style.boxShadow="0 4px 8px rgba(59, 130, 246, 0.4)"},onMouseLeave:ie=>{ie.currentTarget.style.background="#3b82f6",ie.currentTarget.style.transform="translateY(0)",ie.currentTarget.style.boxShadow="0 2px 4px rgba(59, 130, 246, 0.3)"},children:[u.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M9 12l2 2 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),u.jsx("span",{children:"Check & Resolve"})]})})]})]})},Y.id))}),A.length>0&&u.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("button",{onClick:()=>{I(Y=>Y.filter(q=>q.type!=="device_off"&&q.type!=="device_on").map(q=>({...q,isRead:!0})))},style:{background:"none",border:"none",color:"#3b82f6",fontSize:"14px",cursor:"pointer",fontWeight:"500"},children:"Mark all as read"}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[u.jsxs("span",{style:{fontSize:"12px",color:"#9ca3af"},children:[A.filter(Y=>!Y.isRead).length," unread"]}),D&&u.jsxs("span",{style:{fontSize:"10px",color:"#9ca3af",marginTop:"2px"},children:["Last update: ",D.toLocaleTimeString()]})]})]})]})})]}):l==="login"?u.jsx(e7,{onSuccess:(Y,ie)=>{i(Y),o(ie),e(!0)},onNavigateToSignUp:()=>c("signup")}):u.jsx(t7,{onSuccess:(Y,ie)=>{i(Y),o(ie),e(!0)},onNavigateToLogin:()=>c("login")})}mL.createRoot(document.getElementById("root")).render(u.jsx(me.StrictMode,{children:u.jsx(WW,{})}));export{Di as _,zW as c,sL as g};
